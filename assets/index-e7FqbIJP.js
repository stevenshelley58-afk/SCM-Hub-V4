(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const u of d.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function r(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(l){if(l.ep)return;l.ep=!0;const d=r(l);fetch(l.href,d)}})();function uc(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function tg(a){if(Object.prototype.hasOwnProperty.call(a,"__esModule"))return a;var t=a.default;if(typeof t=="function"){var r=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(a).forEach(function(s){var l=Object.getOwnPropertyDescriptor(a,s);Object.defineProperty(r,s,l.get?l:{enumerable:!0,get:function(){return a[s]}})}),r}var El={exports:{}},Se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xm;function rg(){if(xm)return Se;xm=1;var a=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function b(R){return R===null||typeof R!="object"?null:(R=v&&R[v]||R["@@iterator"],typeof R=="function"?R:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,j={};function C(R,F,ve){this.props=R,this.context=F,this.refs=j,this.updater=ve||_}C.prototype.isReactComponent={},C.prototype.setState=function(R,F){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,F,"setState")},C.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function A(){}A.prototype=C.prototype;function S(R,F,ve){this.props=R,this.context=F,this.refs=j,this.updater=ve||_}var D=S.prototype=new A;D.constructor=S,k(D,C.prototype),D.isPureReactComponent=!0;var L=Array.isArray,M=Object.prototype.hasOwnProperty,q={current:null},Q={key:!0,ref:!0,__self:!0,__source:!0};function me(R,F,ve){var we,Z={},ie=null,ue=null;if(F!=null)for(we in F.ref!==void 0&&(ue=F.ref),F.key!==void 0&&(ie=""+F.key),F)M.call(F,we)&&!Q.hasOwnProperty(we)&&(Z[we]=F[we]);var _e=arguments.length-2;if(_e===1)Z.children=ve;else if(1<_e){for(var Ee=Array(_e),$e=0;$e<_e;$e++)Ee[$e]=arguments[$e+2];Z.children=Ee}if(R&&R.defaultProps)for(we in _e=R.defaultProps,_e)Z[we]===void 0&&(Z[we]=_e[we]);return{$$typeof:a,type:R,key:ie,ref:ue,props:Z,_owner:q.current}}function ye(R,F){return{$$typeof:a,type:R.type,key:F,ref:R.ref,props:R.props,_owner:R._owner}}function J(R){return typeof R=="object"&&R!==null&&R.$$typeof===a}function ae(R){var F={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(ve){return F[ve]})}var K=/\/+/g;function Y(R,F){return typeof R=="object"&&R!==null&&R.key!=null?ae(""+R.key):F.toString(36)}function B(R,F,ve,we,Z){var ie=typeof R;(ie==="undefined"||ie==="boolean")&&(R=null);var ue=!1;if(R===null)ue=!0;else switch(ie){case"string":case"number":ue=!0;break;case"object":switch(R.$$typeof){case a:case t:ue=!0}}if(ue)return ue=R,Z=Z(ue),R=we===""?"."+Y(ue,0):we,L(Z)?(ve="",R!=null&&(ve=R.replace(K,"$&/")+"/"),B(Z,F,ve,"",function($e){return $e})):Z!=null&&(J(Z)&&(Z=ye(Z,ve+(!Z.key||ue&&ue.key===Z.key?"":(""+Z.key).replace(K,"$&/")+"/")+R)),F.push(Z)),1;if(ue=0,we=we===""?".":we+":",L(R))for(var _e=0;_e<R.length;_e++){ie=R[_e];var Ee=we+Y(ie,_e);ue+=B(ie,F,ve,Ee,Z)}else if(Ee=b(R),typeof Ee=="function")for(R=Ee.call(R),_e=0;!(ie=R.next()).done;)ie=ie.value,Ee=we+Y(ie,_e++),ue+=B(ie,F,ve,Ee,Z);else if(ie==="object")throw F=String(R),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.");return ue}function z(R,F,ve){if(R==null)return R;var we=[],Z=0;return B(R,we,"","",function(ie){return F.call(ve,ie,Z++)}),we}function U(R){if(R._status===-1){var F=R._result;F=F(),F.then(function(ve){(R._status===0||R._status===-1)&&(R._status=1,R._result=ve)},function(ve){(R._status===0||R._status===-1)&&(R._status=2,R._result=ve)}),R._status===-1&&(R._status=0,R._result=F)}if(R._status===1)return R._result.default;throw R._result}var re={current:null},G={transition:null},H={ReactCurrentDispatcher:re,ReactCurrentBatchConfig:G,ReactCurrentOwner:q};function te(){throw Error("act(...) is not supported in production builds of React.")}return Se.Children={map:z,forEach:function(R,F,ve){z(R,function(){F.apply(this,arguments)},ve)},count:function(R){var F=0;return z(R,function(){F++}),F},toArray:function(R){return z(R,function(F){return F})||[]},only:function(R){if(!J(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},Se.Component=C,Se.Fragment=r,Se.Profiler=l,Se.PureComponent=S,Se.StrictMode=s,Se.Suspense=y,Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,Se.act=te,Se.cloneElement=function(R,F,ve){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var we=k({},R.props),Z=R.key,ie=R.ref,ue=R._owner;if(F!=null){if(F.ref!==void 0&&(ie=F.ref,ue=q.current),F.key!==void 0&&(Z=""+F.key),R.type&&R.type.defaultProps)var _e=R.type.defaultProps;for(Ee in F)M.call(F,Ee)&&!Q.hasOwnProperty(Ee)&&(we[Ee]=F[Ee]===void 0&&_e!==void 0?_e[Ee]:F[Ee])}var Ee=arguments.length-2;if(Ee===1)we.children=ve;else if(1<Ee){_e=Array(Ee);for(var $e=0;$e<Ee;$e++)_e[$e]=arguments[$e+2];we.children=_e}return{$$typeof:a,type:R.type,key:Z,ref:ie,props:we,_owner:ue}},Se.createContext=function(R){return R={$$typeof:u,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:d,_context:R},R.Consumer=R},Se.createElement=me,Se.createFactory=function(R){var F=me.bind(null,R);return F.type=R,F},Se.createRef=function(){return{current:null}},Se.forwardRef=function(R){return{$$typeof:h,render:R}},Se.isValidElement=J,Se.lazy=function(R){return{$$typeof:g,_payload:{_status:-1,_result:R},_init:U}},Se.memo=function(R,F){return{$$typeof:x,type:R,compare:F===void 0?null:F}},Se.startTransition=function(R){var F=G.transition;G.transition={};try{R()}finally{G.transition=F}},Se.unstable_act=te,Se.useCallback=function(R,F){return re.current.useCallback(R,F)},Se.useContext=function(R){return re.current.useContext(R)},Se.useDebugValue=function(){},Se.useDeferredValue=function(R){return re.current.useDeferredValue(R)},Se.useEffect=function(R,F){return re.current.useEffect(R,F)},Se.useId=function(){return re.current.useId()},Se.useImperativeHandle=function(R,F,ve){return re.current.useImperativeHandle(R,F,ve)},Se.useInsertionEffect=function(R,F){return re.current.useInsertionEffect(R,F)},Se.useLayoutEffect=function(R,F){return re.current.useLayoutEffect(R,F)},Se.useMemo=function(R,F){return re.current.useMemo(R,F)},Se.useReducer=function(R,F,ve){return re.current.useReducer(R,F,ve)},Se.useRef=function(R){return re.current.useRef(R)},Se.useState=function(R){return re.current.useState(R)},Se.useSyncExternalStore=function(R,F,ve){return re.current.useSyncExternalStore(R,F,ve)},Se.useTransition=function(){return re.current.useTransition()},Se.version="18.3.1",Se}var vm;function mc(){return vm||(vm=1,El.exports=rg()),El.exports}var E=mc();const c=uc(E);var ii={},Sl={exports:{}},ht={},Nl={exports:{}},jl={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bm;function ng(){return bm||(bm=1,(function(a){function t(G,H){var te=G.length;G.push(H);e:for(;0<te;){var R=te-1>>>1,F=G[R];if(0<l(F,H))G[R]=H,G[te]=F,te=R;else break e}}function r(G){return G.length===0?null:G[0]}function s(G){if(G.length===0)return null;var H=G[0],te=G.pop();if(te!==H){G[0]=te;e:for(var R=0,F=G.length,ve=F>>>1;R<ve;){var we=2*(R+1)-1,Z=G[we],ie=we+1,ue=G[ie];if(0>l(Z,te))ie<F&&0>l(ue,Z)?(G[R]=ue,G[ie]=te,R=ie):(G[R]=Z,G[we]=te,R=we);else if(ie<F&&0>l(ue,te))G[R]=ue,G[ie]=te,R=ie;else break e}}return H}function l(G,H){var te=G.sortIndex-H.sortIndex;return te!==0?te:G.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;a.unstable_now=function(){return d.now()}}else{var u=Date,h=u.now();a.unstable_now=function(){return u.now()-h}}var y=[],x=[],g=1,v=null,b=3,_=!1,k=!1,j=!1,C=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(G){for(var H=r(x);H!==null;){if(H.callback===null)s(x);else if(H.startTime<=G)s(x),H.sortIndex=H.expirationTime,t(y,H);else break;H=r(x)}}function L(G){if(j=!1,D(G),!k)if(r(y)!==null)k=!0,U(M);else{var H=r(x);H!==null&&re(L,H.startTime-G)}}function M(G,H){k=!1,j&&(j=!1,A(me),me=-1),_=!0;var te=b;try{for(D(H),v=r(y);v!==null&&(!(v.expirationTime>H)||G&&!ae());){var R=v.callback;if(typeof R=="function"){v.callback=null,b=v.priorityLevel;var F=R(v.expirationTime<=H);H=a.unstable_now(),typeof F=="function"?v.callback=F:v===r(y)&&s(y),D(H)}else s(y);v=r(y)}if(v!==null)var ve=!0;else{var we=r(x);we!==null&&re(L,we.startTime-H),ve=!1}return ve}finally{v=null,b=te,_=!1}}var q=!1,Q=null,me=-1,ye=5,J=-1;function ae(){return!(a.unstable_now()-J<ye)}function K(){if(Q!==null){var G=a.unstable_now();J=G;var H=!0;try{H=Q(!0,G)}finally{H?Y():(q=!1,Q=null)}}else q=!1}var Y;if(typeof S=="function")Y=function(){S(K)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,z=B.port2;B.port1.onmessage=K,Y=function(){z.postMessage(null)}}else Y=function(){C(K,0)};function U(G){Q=G,q||(q=!0,Y())}function re(G,H){me=C(function(){G(a.unstable_now())},H)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(G){G.callback=null},a.unstable_continueExecution=function(){k||_||(k=!0,U(M))},a.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ye=0<G?Math.floor(1e3/G):5},a.unstable_getCurrentPriorityLevel=function(){return b},a.unstable_getFirstCallbackNode=function(){return r(y)},a.unstable_next=function(G){switch(b){case 1:case 2:case 3:var H=3;break;default:H=b}var te=b;b=H;try{return G()}finally{b=te}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(G,H){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var te=b;b=G;try{return H()}finally{b=te}},a.unstable_scheduleCallback=function(G,H,te){var R=a.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?R+te:R):te=R,G){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=te+F,G={id:g++,callback:H,priorityLevel:G,startTime:te,expirationTime:F,sortIndex:-1},te>R?(G.sortIndex=te,t(x,G),r(y)===null&&G===r(x)&&(j?(A(me),me=-1):j=!0,re(L,te-R))):(G.sortIndex=F,t(y,G),k||_||(k=!0,U(M))),G},a.unstable_shouldYield=ae,a.unstable_wrapCallback=function(G){var H=b;return function(){var te=b;b=H;try{return G.apply(this,arguments)}finally{b=te}}}})(jl)),jl}var wm;function sg(){return wm||(wm=1,Nl.exports=ng()),Nl.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _m;function ag(){if(_m)return ht;_m=1;var a=mc(),t=sg();function r(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)n+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,l={};function d(e,n){u(e,n),u(e+"Capture",n)}function u(e,n){for(l[e]=n,e=0;e<n.length;e++)s.add(n[e])}var h=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),y=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},v={};function b(e){return y.call(v,e)?!0:y.call(g,e)?!1:x.test(e)?v[e]=!0:(g[e]=!0,!1)}function _(e,n,i,m){if(i!==null&&i.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return m?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function k(e,n,i,m){if(n===null||typeof n>"u"||_(e,n,i,m))return!0;if(m)return!1;if(i!==null)switch(i.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function j(e,n,i,m,p,f,w){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=m,this.attributeNamespace=p,this.mustUseProperty=i,this.propertyName=e,this.type=n,this.sanitizeURL=f,this.removeEmptyString=w}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){C[e]=new j(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];C[n]=new j(n,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){C[e]=new j(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){C[e]=new j(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){C[e]=new j(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){C[e]=new j(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){C[e]=new j(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){C[e]=new j(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){C[e]=new j(e,5,!1,e.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function S(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(A,S);C[n]=new j(n,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(A,S);C[n]=new j(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(A,S);C[n]=new j(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){C[e]=new j(e,1,!1,e.toLowerCase(),null,!1,!1)}),C.xlinkHref=new j("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){C[e]=new j(e,1,!1,e.toLowerCase(),null,!0,!0)});function D(e,n,i,m){var p=C.hasOwnProperty(n)?C[n]:null;(p!==null?p.type!==0:m||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(k(n,i,p,m)&&(i=null),m||p===null?b(n)&&(i===null?e.removeAttribute(n):e.setAttribute(n,""+i)):p.mustUseProperty?e[p.propertyName]=i===null?p.type===3?!1:"":i:(n=p.attributeName,m=p.attributeNamespace,i===null?e.removeAttribute(n):(p=p.type,i=p===3||p===4&&i===!0?"":""+i,m?e.setAttributeNS(m,n,i):e.setAttribute(n,i))))}var L=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,M=Symbol.for("react.element"),q=Symbol.for("react.portal"),Q=Symbol.for("react.fragment"),me=Symbol.for("react.strict_mode"),ye=Symbol.for("react.profiler"),J=Symbol.for("react.provider"),ae=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),re=Symbol.for("react.offscreen"),G=Symbol.iterator;function H(e){return e===null||typeof e!="object"?null:(e=G&&e[G]||e["@@iterator"],typeof e=="function"?e:null)}var te=Object.assign,R;function F(e){if(R===void 0)try{throw Error()}catch(i){var n=i.stack.trim().match(/\n( *(at )?)/);R=n&&n[1]||""}return`
`+R+e}var ve=!1;function we(e,n){if(!e||ve)return"";ve=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch($){var m=$}Reflect.construct(e,[],n)}else{try{n.call()}catch($){m=$}e.call(n.prototype)}else{try{throw Error()}catch($){m=$}e()}}catch($){if($&&m&&typeof $.stack=="string"){for(var p=$.stack.split(`
`),f=m.stack.split(`
`),w=p.length-1,N=f.length-1;1<=w&&0<=N&&p[w]!==f[N];)N--;for(;1<=w&&0<=N;w--,N--)if(p[w]!==f[N]){if(w!==1||N!==1)do if(w--,N--,0>N||p[w]!==f[N]){var T=`
`+p[w].replace(" at new "," at ");return e.displayName&&T.includes("<anonymous>")&&(T=T.replace("<anonymous>",e.displayName)),T}while(1<=w&&0<=N);break}}}finally{ve=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?F(e):""}function Z(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=we(e.type,!1),e;case 11:return e=we(e.type.render,!1),e;case 1:return e=we(e.type,!0),e;default:return""}}function ie(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Q:return"Fragment";case q:return"Portal";case ye:return"Profiler";case me:return"StrictMode";case Y:return"Suspense";case B:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ae:return(e.displayName||"Context")+".Consumer";case J:return(e._context.displayName||"Context")+".Provider";case K:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case z:return n=e.displayName||null,n!==null?n:ie(e.type)||"Memo";case U:n=e._payload,e=e._init;try{return ie(e(n))}catch{}}return null}function ue(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ie(n);case 8:return n===me?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function _e(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ee(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function $e(e){var n=Ee(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),m=""+e[n];if(!e.hasOwnProperty(n)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var p=i.get,f=i.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return p.call(this)},set:function(w){m=""+w,f.call(this,w)}}),Object.defineProperty(e,n,{enumerable:i.enumerable}),{getValue:function(){return m},setValue:function(w){m=""+w},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function an(e){e._valueTracker||(e._valueTracker=$e(e))}function on(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var i=n.getValue(),m="";return e&&(m=Ee(e)?e.checked?"true":"false":e.value),e=m,e!==i?(n.setValue(e),!0):!1}function Ys(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Pi(e,n){var i=n.checked;return te({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function Sc(e,n){var i=n.defaultValue==null?"":n.defaultValue,m=n.checked!=null?n.checked:n.defaultChecked;i=_e(n.value!=null?n.value:i),e._wrapperState={initialChecked:m,initialValue:i,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function Nc(e,n){n=n.checked,n!=null&&D(e,"checked",n,!1)}function Ri(e,n){Nc(e,n);var i=_e(n.value),m=n.type;if(i!=null)m==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(m==="submit"||m==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?Di(e,n.type,i):n.hasOwnProperty("defaultValue")&&Di(e,n.type,_e(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function jc(e,n,i){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var m=n.type;if(!(m!=="submit"&&m!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,i||n===e.value||(e.value=n),e.defaultValue=n}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function Di(e,n,i){(n!=="number"||Ys(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var Yn=Array.isArray;function ln(e,n,i,m){if(e=e.options,n){n={};for(var p=0;p<i.length;p++)n["$"+i[p]]=!0;for(i=0;i<e.length;i++)p=n.hasOwnProperty("$"+e[i].value),e[i].selected!==p&&(e[i].selected=p),p&&m&&(e[i].defaultSelected=!0)}else{for(i=""+_e(i),n=null,p=0;p<e.length;p++){if(e[p].value===i){e[p].selected=!0,m&&(e[p].defaultSelected=!0);return}n!==null||e[p].disabled||(n=e[p])}n!==null&&(n.selected=!0)}}function Oi(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(r(91));return te({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Cc(e,n){var i=n.value;if(i==null){if(i=n.children,n=n.defaultValue,i!=null){if(n!=null)throw Error(r(92));if(Yn(i)){if(1<i.length)throw Error(r(93));i=i[0]}n=i}n==null&&(n=""),i=n}e._wrapperState={initialValue:_e(i)}}function Tc(e,n){var i=_e(n.value),m=_e(n.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),n.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),m!=null&&(e.defaultValue=""+m)}function Pc(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function Rc(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ai(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?Rc(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Xs,Dc=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,i,m,p){MSApp.execUnsafeLocalFunction(function(){return e(n,i,m,p)})}:e})(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(Xs=Xs||document.createElement("div"),Xs.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Xs.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Xn(e,n){if(n){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=n;return}}e.textContent=n}var Zn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sp=["Webkit","ms","Moz","O"];Object.keys(Zn).forEach(function(e){sp.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),Zn[n]=Zn[e]})});function Oc(e,n,i){return n==null||typeof n=="boolean"||n===""?"":i||typeof n!="number"||n===0||Zn.hasOwnProperty(e)&&Zn[e]?(""+n).trim():n+"px"}function Ac(e,n){e=e.style;for(var i in n)if(n.hasOwnProperty(i)){var m=i.indexOf("--")===0,p=Oc(i,n[i],m);i==="float"&&(i="cssFloat"),m?e.setProperty(i,p):e[i]=p}}var ap=te({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ii(e,n){if(n){if(ap[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(r(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(r(61))}if(n.style!=null&&typeof n.style!="object")throw Error(r(62))}}function Li(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mi=null;function $i(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qi=null,cn=null,dn=null;function Ic(e){if(e=ws(e)){if(typeof qi!="function")throw Error(r(280));var n=e.stateNode;n&&(n=wa(n),qi(e.stateNode,e.type,n))}}function Lc(e){cn?dn?dn.push(e):dn=[e]:cn=e}function Mc(){if(cn){var e=cn,n=dn;if(dn=cn=null,Ic(e),n)for(e=0;e<n.length;e++)Ic(n[e])}}function $c(e,n){return e(n)}function qc(){}var Bi=!1;function Bc(e,n,i){if(Bi)return e(n,i);Bi=!0;try{return $c(e,n,i)}finally{Bi=!1,(cn!==null||dn!==null)&&(qc(),Mc())}}function es(e,n){var i=e.stateNode;if(i===null)return null;var m=wa(i);if(m===null)return null;i=m[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(e=e.type,m=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!m;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(r(231,n,typeof i));return i}var Ui=!1;if(h)try{var ts={};Object.defineProperty(ts,"passive",{get:function(){Ui=!0}}),window.addEventListener("test",ts,ts),window.removeEventListener("test",ts,ts)}catch{Ui=!1}function ip(e,n,i,m,p,f,w,N,T){var $=Array.prototype.slice.call(arguments,3);try{n.apply(i,$)}catch(V){this.onError(V)}}var rs=!1,Zs=null,ea=!1,Fi=null,op={onError:function(e){rs=!0,Zs=e}};function lp(e,n,i,m,p,f,w,N,T){rs=!1,Zs=null,ip.apply(op,arguments)}function cp(e,n,i,m,p,f,w,N,T){if(lp.apply(this,arguments),rs){if(rs){var $=Zs;rs=!1,Zs=null}else throw Error(r(198));ea||(ea=!0,Fi=$)}}function Lr(e){var n=e,i=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(i=n.return),e=n.return;while(e)}return n.tag===3?i:null}function Uc(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function Fc(e){if(Lr(e)!==e)throw Error(r(188))}function dp(e){var n=e.alternate;if(!n){if(n=Lr(e),n===null)throw Error(r(188));return n!==e?null:e}for(var i=e,m=n;;){var p=i.return;if(p===null)break;var f=p.alternate;if(f===null){if(m=p.return,m!==null){i=m;continue}break}if(p.child===f.child){for(f=p.child;f;){if(f===i)return Fc(p),e;if(f===m)return Fc(p),n;f=f.sibling}throw Error(r(188))}if(i.return!==m.return)i=p,m=f;else{for(var w=!1,N=p.child;N;){if(N===i){w=!0,i=p,m=f;break}if(N===m){w=!0,m=p,i=f;break}N=N.sibling}if(!w){for(N=f.child;N;){if(N===i){w=!0,i=f,m=p;break}if(N===m){w=!0,m=f,i=p;break}N=N.sibling}if(!w)throw Error(r(189))}}if(i.alternate!==m)throw Error(r(190))}if(i.tag!==3)throw Error(r(188));return i.stateNode.current===i?e:n}function zc(e){return e=dp(e),e!==null?Hc(e):null}function Hc(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Hc(e);if(n!==null)return n;e=e.sibling}return null}var Wc=t.unstable_scheduleCallback,Kc=t.unstable_cancelCallback,up=t.unstable_shouldYield,mp=t.unstable_requestPaint,qe=t.unstable_now,hp=t.unstable_getCurrentPriorityLevel,zi=t.unstable_ImmediatePriority,Vc=t.unstable_UserBlockingPriority,ta=t.unstable_NormalPriority,pp=t.unstable_LowPriority,Qc=t.unstable_IdlePriority,ra=null,Bt=null;function fp(e){if(Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(ra,e,void 0,(e.current.flags&128)===128)}catch{}}var Rt=Math.clz32?Math.clz32:xp,gp=Math.log,yp=Math.LN2;function xp(e){return e>>>=0,e===0?32:31-(gp(e)/yp|0)|0}var na=64,sa=4194304;function ns(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function aa(e,n){var i=e.pendingLanes;if(i===0)return 0;var m=0,p=e.suspendedLanes,f=e.pingedLanes,w=i&268435455;if(w!==0){var N=w&~p;N!==0?m=ns(N):(f&=w,f!==0&&(m=ns(f)))}else w=i&~p,w!==0?m=ns(w):f!==0&&(m=ns(f));if(m===0)return 0;if(n!==0&&n!==m&&(n&p)===0&&(p=m&-m,f=n&-n,p>=f||p===16&&(f&4194240)!==0))return n;if((m&4)!==0&&(m|=i&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=m;0<n;)i=31-Rt(n),p=1<<i,m|=e[i],n&=~p;return m}function vp(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bp(e,n){for(var i=e.suspendedLanes,m=e.pingedLanes,p=e.expirationTimes,f=e.pendingLanes;0<f;){var w=31-Rt(f),N=1<<w,T=p[w];T===-1?((N&i)===0||(N&m)!==0)&&(p[w]=vp(N,n)):T<=n&&(e.expiredLanes|=N),f&=~N}}function Hi(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Gc(){var e=na;return na<<=1,(na&4194240)===0&&(na=64),e}function Wi(e){for(var n=[],i=0;31>i;i++)n.push(e);return n}function ss(e,n,i){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-Rt(n),e[n]=i}function wp(e,n){var i=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var m=e.eventTimes;for(e=e.expirationTimes;0<i;){var p=31-Rt(i),f=1<<p;n[p]=0,m[p]=-1,e[p]=-1,i&=~f}}function Ki(e,n){var i=e.entangledLanes|=n;for(e=e.entanglements;i;){var m=31-Rt(i),p=1<<m;p&n|e[m]&n&&(e[m]|=n),i&=~p}}var Ce=0;function Jc(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Yc,Vi,Xc,Zc,ed,Qi=!1,ia=[],lr=null,cr=null,dr=null,as=new Map,is=new Map,ur=[],_p="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function td(e,n){switch(e){case"focusin":case"focusout":lr=null;break;case"dragenter":case"dragleave":cr=null;break;case"mouseover":case"mouseout":dr=null;break;case"pointerover":case"pointerout":as.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":is.delete(n.pointerId)}}function os(e,n,i,m,p,f){return e===null||e.nativeEvent!==f?(e={blockedOn:n,domEventName:i,eventSystemFlags:m,nativeEvent:f,targetContainers:[p]},n!==null&&(n=ws(n),n!==null&&Vi(n)),e):(e.eventSystemFlags|=m,n=e.targetContainers,p!==null&&n.indexOf(p)===-1&&n.push(p),e)}function kp(e,n,i,m,p){switch(n){case"focusin":return lr=os(lr,e,n,i,m,p),!0;case"dragenter":return cr=os(cr,e,n,i,m,p),!0;case"mouseover":return dr=os(dr,e,n,i,m,p),!0;case"pointerover":var f=p.pointerId;return as.set(f,os(as.get(f)||null,e,n,i,m,p)),!0;case"gotpointercapture":return f=p.pointerId,is.set(f,os(is.get(f)||null,e,n,i,m,p)),!0}return!1}function rd(e){var n=Mr(e.target);if(n!==null){var i=Lr(n);if(i!==null){if(n=i.tag,n===13){if(n=Uc(i),n!==null){e.blockedOn=n,ed(e.priority,function(){Xc(i)});return}}else if(n===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function oa(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var i=Ji(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var m=new i.constructor(i.type,i);Mi=m,i.target.dispatchEvent(m),Mi=null}else return n=ws(i),n!==null&&Vi(n),e.blockedOn=i,!1;n.shift()}return!0}function nd(e,n,i){oa(e)&&i.delete(n)}function Ep(){Qi=!1,lr!==null&&oa(lr)&&(lr=null),cr!==null&&oa(cr)&&(cr=null),dr!==null&&oa(dr)&&(dr=null),as.forEach(nd),is.forEach(nd)}function ls(e,n){e.blockedOn===n&&(e.blockedOn=null,Qi||(Qi=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Ep)))}function cs(e){function n(p){return ls(p,e)}if(0<ia.length){ls(ia[0],e);for(var i=1;i<ia.length;i++){var m=ia[i];m.blockedOn===e&&(m.blockedOn=null)}}for(lr!==null&&ls(lr,e),cr!==null&&ls(cr,e),dr!==null&&ls(dr,e),as.forEach(n),is.forEach(n),i=0;i<ur.length;i++)m=ur[i],m.blockedOn===e&&(m.blockedOn=null);for(;0<ur.length&&(i=ur[0],i.blockedOn===null);)rd(i),i.blockedOn===null&&ur.shift()}var un=L.ReactCurrentBatchConfig,la=!0;function Sp(e,n,i,m){var p=Ce,f=un.transition;un.transition=null;try{Ce=1,Gi(e,n,i,m)}finally{Ce=p,un.transition=f}}function Np(e,n,i,m){var p=Ce,f=un.transition;un.transition=null;try{Ce=4,Gi(e,n,i,m)}finally{Ce=p,un.transition=f}}function Gi(e,n,i,m){if(la){var p=Ji(e,n,i,m);if(p===null)po(e,n,m,ca,i),td(e,m);else if(kp(p,e,n,i,m))m.stopPropagation();else if(td(e,m),n&4&&-1<_p.indexOf(e)){for(;p!==null;){var f=ws(p);if(f!==null&&Yc(f),f=Ji(e,n,i,m),f===null&&po(e,n,m,ca,i),f===p)break;p=f}p!==null&&m.stopPropagation()}else po(e,n,m,null,i)}}var ca=null;function Ji(e,n,i,m){if(ca=null,e=$i(m),e=Mr(e),e!==null)if(n=Lr(e),n===null)e=null;else if(i=n.tag,i===13){if(e=Uc(n),e!==null)return e;e=null}else if(i===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return ca=e,null}function sd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hp()){case zi:return 1;case Vc:return 4;case ta:case pp:return 16;case Qc:return 536870912;default:return 16}default:return 16}}var mr=null,Yi=null,da=null;function ad(){if(da)return da;var e,n=Yi,i=n.length,m,p="value"in mr?mr.value:mr.textContent,f=p.length;for(e=0;e<i&&n[e]===p[e];e++);var w=i-e;for(m=1;m<=w&&n[i-m]===p[f-m];m++);return da=p.slice(e,1<m?1-m:void 0)}function ua(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function ma(){return!0}function id(){return!1}function xt(e){function n(i,m,p,f,w){this._reactName=i,this._targetInst=p,this.type=m,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var N in e)e.hasOwnProperty(N)&&(i=e[N],this[N]=i?i(f):f[N]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?ma:id,this.isPropagationStopped=id,this}return te(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=ma)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=ma)},persist:function(){},isPersistent:ma}),n}var mn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xi=xt(mn),ds=te({},mn,{view:0,detail:0}),jp=xt(ds),Zi,eo,us,ha=te({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ro,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==us&&(us&&e.type==="mousemove"?(Zi=e.screenX-us.screenX,eo=e.screenY-us.screenY):eo=Zi=0,us=e),Zi)},movementY:function(e){return"movementY"in e?e.movementY:eo}}),od=xt(ha),Cp=te({},ha,{dataTransfer:0}),Tp=xt(Cp),Pp=te({},ds,{relatedTarget:0}),to=xt(Pp),Rp=te({},mn,{animationName:0,elapsedTime:0,pseudoElement:0}),Dp=xt(Rp),Op=te({},mn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ap=xt(Op),Ip=te({},mn,{data:0}),ld=xt(Ip),Lp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$p={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qp(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=$p[e])?!!n[e]:!1}function ro(){return qp}var Bp=te({},ds,{key:function(e){if(e.key){var n=Lp[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=ua(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Mp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ro,charCode:function(e){return e.type==="keypress"?ua(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ua(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Up=xt(Bp),Fp=te({},ha,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cd=xt(Fp),zp=te({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ro}),Hp=xt(zp),Wp=te({},mn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kp=xt(Wp),Vp=te({},ha,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Qp=xt(Vp),Gp=[9,13,27,32],no=h&&"CompositionEvent"in window,ms=null;h&&"documentMode"in document&&(ms=document.documentMode);var Jp=h&&"TextEvent"in window&&!ms,dd=h&&(!no||ms&&8<ms&&11>=ms),ud=" ",md=!1;function hd(e,n){switch(e){case"keyup":return Gp.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hn=!1;function Yp(e,n){switch(e){case"compositionend":return pd(n);case"keypress":return n.which!==32?null:(md=!0,ud);case"textInput":return e=n.data,e===ud&&md?null:e;default:return null}}function Xp(e,n){if(hn)return e==="compositionend"||!no&&hd(e,n)?(e=ad(),da=Yi=mr=null,hn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return dd&&n.locale!=="ko"?null:n.data;default:return null}}var Zp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fd(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Zp[e.type]:n==="textarea"}function gd(e,n,i,m){Lc(m),n=xa(n,"onChange"),0<n.length&&(i=new Xi("onChange","change",null,i,m),e.push({event:i,listeners:n}))}var hs=null,ps=null;function ef(e){Ad(e,0)}function pa(e){var n=xn(e);if(on(n))return e}function tf(e,n){if(e==="change")return n}var yd=!1;if(h){var so;if(h){var ao="oninput"in document;if(!ao){var xd=document.createElement("div");xd.setAttribute("oninput","return;"),ao=typeof xd.oninput=="function"}so=ao}else so=!1;yd=so&&(!document.documentMode||9<document.documentMode)}function vd(){hs&&(hs.detachEvent("onpropertychange",bd),ps=hs=null)}function bd(e){if(e.propertyName==="value"&&pa(ps)){var n=[];gd(n,ps,e,$i(e)),Bc(ef,n)}}function rf(e,n,i){e==="focusin"?(vd(),hs=n,ps=i,hs.attachEvent("onpropertychange",bd)):e==="focusout"&&vd()}function nf(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return pa(ps)}function sf(e,n){if(e==="click")return pa(n)}function af(e,n){if(e==="input"||e==="change")return pa(n)}function of(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Dt=typeof Object.is=="function"?Object.is:of;function fs(e,n){if(Dt(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var i=Object.keys(e),m=Object.keys(n);if(i.length!==m.length)return!1;for(m=0;m<i.length;m++){var p=i[m];if(!y.call(n,p)||!Dt(e[p],n[p]))return!1}return!0}function wd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function _d(e,n){var i=wd(e);e=0;for(var m;i;){if(i.nodeType===3){if(m=e+i.textContent.length,e<=n&&m>=n)return{node:i,offset:n-e};e=m}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=wd(i)}}function kd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?kd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Ed(){for(var e=window,n=Ys();n instanceof e.HTMLIFrameElement;){try{var i=typeof n.contentWindow.location.href=="string"}catch{i=!1}if(i)e=n.contentWindow;else break;n=Ys(e.document)}return n}function io(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function lf(e){var n=Ed(),i=e.focusedElem,m=e.selectionRange;if(n!==i&&i&&i.ownerDocument&&kd(i.ownerDocument.documentElement,i)){if(m!==null&&io(i)){if(n=m.start,e=m.end,e===void 0&&(e=n),"selectionStart"in i)i.selectionStart=n,i.selectionEnd=Math.min(e,i.value.length);else if(e=(n=i.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var p=i.textContent.length,f=Math.min(m.start,p);m=m.end===void 0?f:Math.min(m.end,p),!e.extend&&f>m&&(p=m,m=f,f=p),p=_d(i,f);var w=_d(i,m);p&&w&&(e.rangeCount!==1||e.anchorNode!==p.node||e.anchorOffset!==p.offset||e.focusNode!==w.node||e.focusOffset!==w.offset)&&(n=n.createRange(),n.setStart(p.node,p.offset),e.removeAllRanges(),f>m?(e.addRange(n),e.extend(w.node,w.offset)):(n.setEnd(w.node,w.offset),e.addRange(n)))}}for(n=[],e=i;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<n.length;i++)e=n[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var cf=h&&"documentMode"in document&&11>=document.documentMode,pn=null,oo=null,gs=null,lo=!1;function Sd(e,n,i){var m=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;lo||pn==null||pn!==Ys(m)||(m=pn,"selectionStart"in m&&io(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),gs&&fs(gs,m)||(gs=m,m=xa(oo,"onSelect"),0<m.length&&(n=new Xi("onSelect","select",null,n,i),e.push({event:n,listeners:m}),n.target=pn)))}function fa(e,n){var i={};return i[e.toLowerCase()]=n.toLowerCase(),i["Webkit"+e]="webkit"+n,i["Moz"+e]="moz"+n,i}var fn={animationend:fa("Animation","AnimationEnd"),animationiteration:fa("Animation","AnimationIteration"),animationstart:fa("Animation","AnimationStart"),transitionend:fa("Transition","TransitionEnd")},co={},Nd={};h&&(Nd=document.createElement("div").style,"AnimationEvent"in window||(delete fn.animationend.animation,delete fn.animationiteration.animation,delete fn.animationstart.animation),"TransitionEvent"in window||delete fn.transitionend.transition);function ga(e){if(co[e])return co[e];if(!fn[e])return e;var n=fn[e],i;for(i in n)if(n.hasOwnProperty(i)&&i in Nd)return co[e]=n[i];return e}var jd=ga("animationend"),Cd=ga("animationiteration"),Td=ga("animationstart"),Pd=ga("transitionend"),Rd=new Map,Dd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hr(e,n){Rd.set(e,n),d(n,[e])}for(var uo=0;uo<Dd.length;uo++){var mo=Dd[uo],df=mo.toLowerCase(),uf=mo[0].toUpperCase()+mo.slice(1);hr(df,"on"+uf)}hr(jd,"onAnimationEnd"),hr(Cd,"onAnimationIteration"),hr(Td,"onAnimationStart"),hr("dblclick","onDoubleClick"),hr("focusin","onFocus"),hr("focusout","onBlur"),hr(Pd,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ys="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(ys));function Od(e,n,i){var m=e.type||"unknown-event";e.currentTarget=i,cp(m,n,void 0,e),e.currentTarget=null}function Ad(e,n){n=(n&4)!==0;for(var i=0;i<e.length;i++){var m=e[i],p=m.event;m=m.listeners;e:{var f=void 0;if(n)for(var w=m.length-1;0<=w;w--){var N=m[w],T=N.instance,$=N.currentTarget;if(N=N.listener,T!==f&&p.isPropagationStopped())break e;Od(p,N,$),f=T}else for(w=0;w<m.length;w++){if(N=m[w],T=N.instance,$=N.currentTarget,N=N.listener,T!==f&&p.isPropagationStopped())break e;Od(p,N,$),f=T}}}if(ea)throw e=Fi,ea=!1,Fi=null,e}function De(e,n){var i=n[bo];i===void 0&&(i=n[bo]=new Set);var m=e+"__bubble";i.has(m)||(Id(n,e,2,!1),i.add(m))}function ho(e,n,i){var m=0;n&&(m|=4),Id(i,e,m,n)}var ya="_reactListening"+Math.random().toString(36).slice(2);function xs(e){if(!e[ya]){e[ya]=!0,s.forEach(function(i){i!=="selectionchange"&&(mf.has(i)||ho(i,!1,e),ho(i,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[ya]||(n[ya]=!0,ho("selectionchange",!1,n))}}function Id(e,n,i,m){switch(sd(n)){case 1:var p=Sp;break;case 4:p=Np;break;default:p=Gi}i=p.bind(null,n,i,e),p=void 0,!Ui||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(p=!0),m?p!==void 0?e.addEventListener(n,i,{capture:!0,passive:p}):e.addEventListener(n,i,!0):p!==void 0?e.addEventListener(n,i,{passive:p}):e.addEventListener(n,i,!1)}function po(e,n,i,m,p){var f=m;if((n&1)===0&&(n&2)===0&&m!==null)e:for(;;){if(m===null)return;var w=m.tag;if(w===3||w===4){var N=m.stateNode.containerInfo;if(N===p||N.nodeType===8&&N.parentNode===p)break;if(w===4)for(w=m.return;w!==null;){var T=w.tag;if((T===3||T===4)&&(T=w.stateNode.containerInfo,T===p||T.nodeType===8&&T.parentNode===p))return;w=w.return}for(;N!==null;){if(w=Mr(N),w===null)return;if(T=w.tag,T===5||T===6){m=f=w;continue e}N=N.parentNode}}m=m.return}Bc(function(){var $=f,V=$i(i),X=[];e:{var W=Rd.get(e);if(W!==void 0){var se=Xi,le=e;switch(e){case"keypress":if(ua(i)===0)break e;case"keydown":case"keyup":se=Up;break;case"focusin":le="focus",se=to;break;case"focusout":le="blur",se=to;break;case"beforeblur":case"afterblur":se=to;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=od;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=Tp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=Hp;break;case jd:case Cd:case Td:se=Dp;break;case Pd:se=Kp;break;case"scroll":se=jp;break;case"wheel":se=Qp;break;case"copy":case"cut":case"paste":se=Ap;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=cd}var ce=(n&4)!==0,Be=!ce&&e==="scroll",O=ce?W!==null?W+"Capture":null:W;ce=[];for(var P=$,I;P!==null;){I=P;var ee=I.stateNode;if(I.tag===5&&ee!==null&&(I=ee,O!==null&&(ee=es(P,O),ee!=null&&ce.push(vs(P,ee,I)))),Be)break;P=P.return}0<ce.length&&(W=new se(W,le,null,i,V),X.push({event:W,listeners:ce}))}}if((n&7)===0){e:{if(W=e==="mouseover"||e==="pointerover",se=e==="mouseout"||e==="pointerout",W&&i!==Mi&&(le=i.relatedTarget||i.fromElement)&&(Mr(le)||le[Gt]))break e;if((se||W)&&(W=V.window===V?V:(W=V.ownerDocument)?W.defaultView||W.parentWindow:window,se?(le=i.relatedTarget||i.toElement,se=$,le=le?Mr(le):null,le!==null&&(Be=Lr(le),le!==Be||le.tag!==5&&le.tag!==6)&&(le=null)):(se=null,le=$),se!==le)){if(ce=od,ee="onMouseLeave",O="onMouseEnter",P="mouse",(e==="pointerout"||e==="pointerover")&&(ce=cd,ee="onPointerLeave",O="onPointerEnter",P="pointer"),Be=se==null?W:xn(se),I=le==null?W:xn(le),W=new ce(ee,P+"leave",se,i,V),W.target=Be,W.relatedTarget=I,ee=null,Mr(V)===$&&(ce=new ce(O,P+"enter",le,i,V),ce.target=I,ce.relatedTarget=Be,ee=ce),Be=ee,se&&le)t:{for(ce=se,O=le,P=0,I=ce;I;I=gn(I))P++;for(I=0,ee=O;ee;ee=gn(ee))I++;for(;0<P-I;)ce=gn(ce),P--;for(;0<I-P;)O=gn(O),I--;for(;P--;){if(ce===O||O!==null&&ce===O.alternate)break t;ce=gn(ce),O=gn(O)}ce=null}else ce=null;se!==null&&Ld(X,W,se,ce,!1),le!==null&&Be!==null&&Ld(X,Be,le,ce,!0)}}e:{if(W=$?xn($):window,se=W.nodeName&&W.nodeName.toLowerCase(),se==="select"||se==="input"&&W.type==="file")var de=tf;else if(fd(W))if(yd)de=af;else{de=nf;var pe=rf}else(se=W.nodeName)&&se.toLowerCase()==="input"&&(W.type==="checkbox"||W.type==="radio")&&(de=sf);if(de&&(de=de(e,$))){gd(X,de,i,V);break e}pe&&pe(e,W,$),e==="focusout"&&(pe=W._wrapperState)&&pe.controlled&&W.type==="number"&&Di(W,"number",W.value)}switch(pe=$?xn($):window,e){case"focusin":(fd(pe)||pe.contentEditable==="true")&&(pn=pe,oo=$,gs=null);break;case"focusout":gs=oo=pn=null;break;case"mousedown":lo=!0;break;case"contextmenu":case"mouseup":case"dragend":lo=!1,Sd(X,i,V);break;case"selectionchange":if(cf)break;case"keydown":case"keyup":Sd(X,i,V)}var fe;if(no)e:{switch(e){case"compositionstart":var be="onCompositionStart";break e;case"compositionend":be="onCompositionEnd";break e;case"compositionupdate":be="onCompositionUpdate";break e}be=void 0}else hn?hd(e,i)&&(be="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(be="onCompositionStart");be&&(dd&&i.locale!=="ko"&&(hn||be!=="onCompositionStart"?be==="onCompositionEnd"&&hn&&(fe=ad()):(mr=V,Yi="value"in mr?mr.value:mr.textContent,hn=!0)),pe=xa($,be),0<pe.length&&(be=new ld(be,e,null,i,V),X.push({event:be,listeners:pe}),fe?be.data=fe:(fe=pd(i),fe!==null&&(be.data=fe)))),(fe=Jp?Yp(e,i):Xp(e,i))&&($=xa($,"onBeforeInput"),0<$.length&&(V=new ld("onBeforeInput","beforeinput",null,i,V),X.push({event:V,listeners:$}),V.data=fe))}Ad(X,n)})}function vs(e,n,i){return{instance:e,listener:n,currentTarget:i}}function xa(e,n){for(var i=n+"Capture",m=[];e!==null;){var p=e,f=p.stateNode;p.tag===5&&f!==null&&(p=f,f=es(e,i),f!=null&&m.unshift(vs(e,f,p)),f=es(e,n),f!=null&&m.push(vs(e,f,p))),e=e.return}return m}function gn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ld(e,n,i,m,p){for(var f=n._reactName,w=[];i!==null&&i!==m;){var N=i,T=N.alternate,$=N.stateNode;if(T!==null&&T===m)break;N.tag===5&&$!==null&&(N=$,p?(T=es(i,f),T!=null&&w.unshift(vs(i,T,N))):p||(T=es(i,f),T!=null&&w.push(vs(i,T,N)))),i=i.return}w.length!==0&&e.push({event:n,listeners:w})}var hf=/\r\n?/g,pf=/\u0000|\uFFFD/g;function Md(e){return(typeof e=="string"?e:""+e).replace(hf,`
`).replace(pf,"")}function va(e,n,i){if(n=Md(n),Md(e)!==n&&i)throw Error(r(425))}function ba(){}var fo=null,go=null;function yo(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var xo=typeof setTimeout=="function"?setTimeout:void 0,ff=typeof clearTimeout=="function"?clearTimeout:void 0,$d=typeof Promise=="function"?Promise:void 0,gf=typeof queueMicrotask=="function"?queueMicrotask:typeof $d<"u"?function(e){return $d.resolve(null).then(e).catch(yf)}:xo;function yf(e){setTimeout(function(){throw e})}function vo(e,n){var i=n,m=0;do{var p=i.nextSibling;if(e.removeChild(i),p&&p.nodeType===8)if(i=p.data,i==="/$"){if(m===0){e.removeChild(p),cs(n);return}m--}else i!=="$"&&i!=="$?"&&i!=="$!"||m++;i=p}while(i);cs(n)}function pr(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function qd(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(n===0)return e;n--}else i==="/$"&&n++}e=e.previousSibling}return null}var yn=Math.random().toString(36).slice(2),Ut="__reactFiber$"+yn,bs="__reactProps$"+yn,Gt="__reactContainer$"+yn,bo="__reactEvents$"+yn,xf="__reactListeners$"+yn,vf="__reactHandles$"+yn;function Mr(e){var n=e[Ut];if(n)return n;for(var i=e.parentNode;i;){if(n=i[Gt]||i[Ut]){if(i=n.alternate,n.child!==null||i!==null&&i.child!==null)for(e=qd(e);e!==null;){if(i=e[Ut])return i;e=qd(e)}return n}e=i,i=e.parentNode}return null}function ws(e){return e=e[Ut]||e[Gt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function xn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function wa(e){return e[bs]||null}var wo=[],vn=-1;function fr(e){return{current:e}}function Oe(e){0>vn||(e.current=wo[vn],wo[vn]=null,vn--)}function Pe(e,n){vn++,wo[vn]=e.current,e.current=n}var gr={},et=fr(gr),lt=fr(!1),$r=gr;function bn(e,n){var i=e.type.contextTypes;if(!i)return gr;var m=e.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===n)return m.__reactInternalMemoizedMaskedChildContext;var p={},f;for(f in i)p[f]=n[f];return m&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=p),p}function ct(e){return e=e.childContextTypes,e!=null}function _a(){Oe(lt),Oe(et)}function Bd(e,n,i){if(et.current!==gr)throw Error(r(168));Pe(et,n),Pe(lt,i)}function Ud(e,n,i){var m=e.stateNode;if(n=n.childContextTypes,typeof m.getChildContext!="function")return i;m=m.getChildContext();for(var p in m)if(!(p in n))throw Error(r(108,ue(e)||"Unknown",p));return te({},i,m)}function ka(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||gr,$r=et.current,Pe(et,e),Pe(lt,lt.current),!0}function Fd(e,n,i){var m=e.stateNode;if(!m)throw Error(r(169));i?(e=Ud(e,n,$r),m.__reactInternalMemoizedMergedChildContext=e,Oe(lt),Oe(et),Pe(et,e)):Oe(lt),Pe(lt,i)}var Jt=null,Ea=!1,_o=!1;function zd(e){Jt===null?Jt=[e]:Jt.push(e)}function bf(e){Ea=!0,zd(e)}function yr(){if(!_o&&Jt!==null){_o=!0;var e=0,n=Ce;try{var i=Jt;for(Ce=1;e<i.length;e++){var m=i[e];do m=m(!0);while(m!==null)}Jt=null,Ea=!1}catch(p){throw Jt!==null&&(Jt=Jt.slice(e+1)),Wc(zi,yr),p}finally{Ce=n,_o=!1}}return null}var wn=[],_n=0,Sa=null,Na=0,Et=[],St=0,qr=null,Yt=1,Xt="";function Br(e,n){wn[_n++]=Na,wn[_n++]=Sa,Sa=e,Na=n}function Hd(e,n,i){Et[St++]=Yt,Et[St++]=Xt,Et[St++]=qr,qr=e;var m=Yt;e=Xt;var p=32-Rt(m)-1;m&=~(1<<p),i+=1;var f=32-Rt(n)+p;if(30<f){var w=p-p%5;f=(m&(1<<w)-1).toString(32),m>>=w,p-=w,Yt=1<<32-Rt(n)+p|i<<p|m,Xt=f+e}else Yt=1<<f|i<<p|m,Xt=e}function ko(e){e.return!==null&&(Br(e,1),Hd(e,1,0))}function Eo(e){for(;e===Sa;)Sa=wn[--_n],wn[_n]=null,Na=wn[--_n],wn[_n]=null;for(;e===qr;)qr=Et[--St],Et[St]=null,Xt=Et[--St],Et[St]=null,Yt=Et[--St],Et[St]=null}var vt=null,bt=null,Ae=!1,Ot=null;function Wd(e,n){var i=Tt(5,null,null,0);i.elementType="DELETED",i.stateNode=n,i.return=e,n=e.deletions,n===null?(e.deletions=[i],e.flags|=16):n.push(i)}function Kd(e,n){switch(e.tag){case 5:var i=e.type;return n=n.nodeType!==1||i.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,vt=e,bt=pr(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,vt=e,bt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(i=qr!==null?{id:Yt,overflow:Xt}:null,e.memoizedState={dehydrated:n,treeContext:i,retryLane:1073741824},i=Tt(18,null,null,0),i.stateNode=n,i.return=e,e.child=i,vt=e,bt=null,!0):!1;default:return!1}}function So(e){return(e.mode&1)!==0&&(e.flags&128)===0}function No(e){if(Ae){var n=bt;if(n){var i=n;if(!Kd(e,n)){if(So(e))throw Error(r(418));n=pr(i.nextSibling);var m=vt;n&&Kd(e,n)?Wd(m,i):(e.flags=e.flags&-4097|2,Ae=!1,vt=e)}}else{if(So(e))throw Error(r(418));e.flags=e.flags&-4097|2,Ae=!1,vt=e}}}function Vd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vt=e}function ja(e){if(e!==vt)return!1;if(!Ae)return Vd(e),Ae=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!yo(e.type,e.memoizedProps)),n&&(n=bt)){if(So(e))throw Qd(),Error(r(418));for(;n;)Wd(e,n),n=pr(n.nextSibling)}if(Vd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(n===0){bt=pr(e.nextSibling);break e}n--}else i!=="$"&&i!=="$!"&&i!=="$?"||n++}e=e.nextSibling}bt=null}}else bt=vt?pr(e.stateNode.nextSibling):null;return!0}function Qd(){for(var e=bt;e;)e=pr(e.nextSibling)}function kn(){bt=vt=null,Ae=!1}function jo(e){Ot===null?Ot=[e]:Ot.push(e)}var wf=L.ReactCurrentBatchConfig;function _s(e,n,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(r(309));var m=i.stateNode}if(!m)throw Error(r(147,e));var p=m,f=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===f?n.ref:(n=function(w){var N=p.refs;w===null?delete N[f]:N[f]=w},n._stringRef=f,n)}if(typeof e!="string")throw Error(r(284));if(!i._owner)throw Error(r(290,e))}return e}function Ca(e,n){throw e=Object.prototype.toString.call(n),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function Gd(e){var n=e._init;return n(e._payload)}function Jd(e){function n(O,P){if(e){var I=O.deletions;I===null?(O.deletions=[P],O.flags|=16):I.push(P)}}function i(O,P){if(!e)return null;for(;P!==null;)n(O,P),P=P.sibling;return null}function m(O,P){for(O=new Map;P!==null;)P.key!==null?O.set(P.key,P):O.set(P.index,P),P=P.sibling;return O}function p(O,P){return O=Sr(O,P),O.index=0,O.sibling=null,O}function f(O,P,I){return O.index=I,e?(I=O.alternate,I!==null?(I=I.index,I<P?(O.flags|=2,P):I):(O.flags|=2,P)):(O.flags|=1048576,P)}function w(O){return e&&O.alternate===null&&(O.flags|=2),O}function N(O,P,I,ee){return P===null||P.tag!==6?(P=xl(I,O.mode,ee),P.return=O,P):(P=p(P,I),P.return=O,P)}function T(O,P,I,ee){var de=I.type;return de===Q?V(O,P,I.props.children,ee,I.key):P!==null&&(P.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===U&&Gd(de)===P.type)?(ee=p(P,I.props),ee.ref=_s(O,P,I),ee.return=O,ee):(ee=Xa(I.type,I.key,I.props,null,O.mode,ee),ee.ref=_s(O,P,I),ee.return=O,ee)}function $(O,P,I,ee){return P===null||P.tag!==4||P.stateNode.containerInfo!==I.containerInfo||P.stateNode.implementation!==I.implementation?(P=vl(I,O.mode,ee),P.return=O,P):(P=p(P,I.children||[]),P.return=O,P)}function V(O,P,I,ee,de){return P===null||P.tag!==7?(P=Qr(I,O.mode,ee,de),P.return=O,P):(P=p(P,I),P.return=O,P)}function X(O,P,I){if(typeof P=="string"&&P!==""||typeof P=="number")return P=xl(""+P,O.mode,I),P.return=O,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case M:return I=Xa(P.type,P.key,P.props,null,O.mode,I),I.ref=_s(O,null,P),I.return=O,I;case q:return P=vl(P,O.mode,I),P.return=O,P;case U:var ee=P._init;return X(O,ee(P._payload),I)}if(Yn(P)||H(P))return P=Qr(P,O.mode,I,null),P.return=O,P;Ca(O,P)}return null}function W(O,P,I,ee){var de=P!==null?P.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return de!==null?null:N(O,P,""+I,ee);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case M:return I.key===de?T(O,P,I,ee):null;case q:return I.key===de?$(O,P,I,ee):null;case U:return de=I._init,W(O,P,de(I._payload),ee)}if(Yn(I)||H(I))return de!==null?null:V(O,P,I,ee,null);Ca(O,I)}return null}function se(O,P,I,ee,de){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return O=O.get(I)||null,N(P,O,""+ee,de);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case M:return O=O.get(ee.key===null?I:ee.key)||null,T(P,O,ee,de);case q:return O=O.get(ee.key===null?I:ee.key)||null,$(P,O,ee,de);case U:var pe=ee._init;return se(O,P,I,pe(ee._payload),de)}if(Yn(ee)||H(ee))return O=O.get(I)||null,V(P,O,ee,de,null);Ca(P,ee)}return null}function le(O,P,I,ee){for(var de=null,pe=null,fe=P,be=P=0,Ge=null;fe!==null&&be<I.length;be++){fe.index>be?(Ge=fe,fe=null):Ge=fe.sibling;var je=W(O,fe,I[be],ee);if(je===null){fe===null&&(fe=Ge);break}e&&fe&&je.alternate===null&&n(O,fe),P=f(je,P,be),pe===null?de=je:pe.sibling=je,pe=je,fe=Ge}if(be===I.length)return i(O,fe),Ae&&Br(O,be),de;if(fe===null){for(;be<I.length;be++)fe=X(O,I[be],ee),fe!==null&&(P=f(fe,P,be),pe===null?de=fe:pe.sibling=fe,pe=fe);return Ae&&Br(O,be),de}for(fe=m(O,fe);be<I.length;be++)Ge=se(fe,O,be,I[be],ee),Ge!==null&&(e&&Ge.alternate!==null&&fe.delete(Ge.key===null?be:Ge.key),P=f(Ge,P,be),pe===null?de=Ge:pe.sibling=Ge,pe=Ge);return e&&fe.forEach(function(Nr){return n(O,Nr)}),Ae&&Br(O,be),de}function ce(O,P,I,ee){var de=H(I);if(typeof de!="function")throw Error(r(150));if(I=de.call(I),I==null)throw Error(r(151));for(var pe=de=null,fe=P,be=P=0,Ge=null,je=I.next();fe!==null&&!je.done;be++,je=I.next()){fe.index>be?(Ge=fe,fe=null):Ge=fe.sibling;var Nr=W(O,fe,je.value,ee);if(Nr===null){fe===null&&(fe=Ge);break}e&&fe&&Nr.alternate===null&&n(O,fe),P=f(Nr,P,be),pe===null?de=Nr:pe.sibling=Nr,pe=Nr,fe=Ge}if(je.done)return i(O,fe),Ae&&Br(O,be),de;if(fe===null){for(;!je.done;be++,je=I.next())je=X(O,je.value,ee),je!==null&&(P=f(je,P,be),pe===null?de=je:pe.sibling=je,pe=je);return Ae&&Br(O,be),de}for(fe=m(O,fe);!je.done;be++,je=I.next())je=se(fe,O,be,je.value,ee),je!==null&&(e&&je.alternate!==null&&fe.delete(je.key===null?be:je.key),P=f(je,P,be),pe===null?de=je:pe.sibling=je,pe=je);return e&&fe.forEach(function(eg){return n(O,eg)}),Ae&&Br(O,be),de}function Be(O,P,I,ee){if(typeof I=="object"&&I!==null&&I.type===Q&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case M:e:{for(var de=I.key,pe=P;pe!==null;){if(pe.key===de){if(de=I.type,de===Q){if(pe.tag===7){i(O,pe.sibling),P=p(pe,I.props.children),P.return=O,O=P;break e}}else if(pe.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===U&&Gd(de)===pe.type){i(O,pe.sibling),P=p(pe,I.props),P.ref=_s(O,pe,I),P.return=O,O=P;break e}i(O,pe);break}else n(O,pe);pe=pe.sibling}I.type===Q?(P=Qr(I.props.children,O.mode,ee,I.key),P.return=O,O=P):(ee=Xa(I.type,I.key,I.props,null,O.mode,ee),ee.ref=_s(O,P,I),ee.return=O,O=ee)}return w(O);case q:e:{for(pe=I.key;P!==null;){if(P.key===pe)if(P.tag===4&&P.stateNode.containerInfo===I.containerInfo&&P.stateNode.implementation===I.implementation){i(O,P.sibling),P=p(P,I.children||[]),P.return=O,O=P;break e}else{i(O,P);break}else n(O,P);P=P.sibling}P=vl(I,O.mode,ee),P.return=O,O=P}return w(O);case U:return pe=I._init,Be(O,P,pe(I._payload),ee)}if(Yn(I))return le(O,P,I,ee);if(H(I))return ce(O,P,I,ee);Ca(O,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,P!==null&&P.tag===6?(i(O,P.sibling),P=p(P,I),P.return=O,O=P):(i(O,P),P=xl(I,O.mode,ee),P.return=O,O=P),w(O)):i(O,P)}return Be}var En=Jd(!0),Yd=Jd(!1),Ta=fr(null),Pa=null,Sn=null,Co=null;function To(){Co=Sn=Pa=null}function Po(e){var n=Ta.current;Oe(Ta),e._currentValue=n}function Ro(e,n,i){for(;e!==null;){var m=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,m!==null&&(m.childLanes|=n)):m!==null&&(m.childLanes&n)!==n&&(m.childLanes|=n),e===i)break;e=e.return}}function Nn(e,n){Pa=e,Co=Sn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&n)!==0&&(dt=!0),e.firstContext=null)}function Nt(e){var n=e._currentValue;if(Co!==e)if(e={context:e,memoizedValue:n,next:null},Sn===null){if(Pa===null)throw Error(r(308));Sn=e,Pa.dependencies={lanes:0,firstContext:e}}else Sn=Sn.next=e;return n}var Ur=null;function Do(e){Ur===null?Ur=[e]:Ur.push(e)}function Xd(e,n,i,m){var p=n.interleaved;return p===null?(i.next=i,Do(n)):(i.next=p.next,p.next=i),n.interleaved=i,Zt(e,m)}function Zt(e,n){e.lanes|=n;var i=e.alternate;for(i!==null&&(i.lanes|=n),i=e,e=e.return;e!==null;)e.childLanes|=n,i=e.alternate,i!==null&&(i.childLanes|=n),i=e,e=e.return;return i.tag===3?i.stateNode:null}var xr=!1;function Oo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zd(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function er(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function vr(e,n,i){var m=e.updateQueue;if(m===null)return null;if(m=m.shared,(Ne&2)!==0){var p=m.pending;return p===null?n.next=n:(n.next=p.next,p.next=n),m.pending=n,Zt(e,i)}return p=m.interleaved,p===null?(n.next=n,Do(m)):(n.next=p.next,p.next=n),m.interleaved=n,Zt(e,i)}function Ra(e,n,i){if(n=n.updateQueue,n!==null&&(n=n.shared,(i&4194240)!==0)){var m=n.lanes;m&=e.pendingLanes,i|=m,n.lanes=i,Ki(e,i)}}function eu(e,n){var i=e.updateQueue,m=e.alternate;if(m!==null&&(m=m.updateQueue,i===m)){var p=null,f=null;if(i=i.firstBaseUpdate,i!==null){do{var w={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};f===null?p=f=w:f=f.next=w,i=i.next}while(i!==null);f===null?p=f=n:f=f.next=n}else p=f=n;i={baseState:m.baseState,firstBaseUpdate:p,lastBaseUpdate:f,shared:m.shared,effects:m.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=n:e.next=n,i.lastBaseUpdate=n}function Da(e,n,i,m){var p=e.updateQueue;xr=!1;var f=p.firstBaseUpdate,w=p.lastBaseUpdate,N=p.shared.pending;if(N!==null){p.shared.pending=null;var T=N,$=T.next;T.next=null,w===null?f=$:w.next=$,w=T;var V=e.alternate;V!==null&&(V=V.updateQueue,N=V.lastBaseUpdate,N!==w&&(N===null?V.firstBaseUpdate=$:N.next=$,V.lastBaseUpdate=T))}if(f!==null){var X=p.baseState;w=0,V=$=T=null,N=f;do{var W=N.lane,se=N.eventTime;if((m&W)===W){V!==null&&(V=V.next={eventTime:se,lane:0,tag:N.tag,payload:N.payload,callback:N.callback,next:null});e:{var le=e,ce=N;switch(W=n,se=i,ce.tag){case 1:if(le=ce.payload,typeof le=="function"){X=le.call(se,X,W);break e}X=le;break e;case 3:le.flags=le.flags&-65537|128;case 0:if(le=ce.payload,W=typeof le=="function"?le.call(se,X,W):le,W==null)break e;X=te({},X,W);break e;case 2:xr=!0}}N.callback!==null&&N.lane!==0&&(e.flags|=64,W=p.effects,W===null?p.effects=[N]:W.push(N))}else se={eventTime:se,lane:W,tag:N.tag,payload:N.payload,callback:N.callback,next:null},V===null?($=V=se,T=X):V=V.next=se,w|=W;if(N=N.next,N===null){if(N=p.shared.pending,N===null)break;W=N,N=W.next,W.next=null,p.lastBaseUpdate=W,p.shared.pending=null}}while(!0);if(V===null&&(T=X),p.baseState=T,p.firstBaseUpdate=$,p.lastBaseUpdate=V,n=p.shared.interleaved,n!==null){p=n;do w|=p.lane,p=p.next;while(p!==n)}else f===null&&(p.shared.lanes=0);Hr|=w,e.lanes=w,e.memoizedState=X}}function tu(e,n,i){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var m=e[n],p=m.callback;if(p!==null){if(m.callback=null,m=i,typeof p!="function")throw Error(r(191,p));p.call(m)}}}var ks={},Ft=fr(ks),Es=fr(ks),Ss=fr(ks);function Fr(e){if(e===ks)throw Error(r(174));return e}function Ao(e,n){switch(Pe(Ss,n),Pe(Es,e),Pe(Ft,ks),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:Ai(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=Ai(n,e)}Oe(Ft),Pe(Ft,n)}function jn(){Oe(Ft),Oe(Es),Oe(Ss)}function ru(e){Fr(Ss.current);var n=Fr(Ft.current),i=Ai(n,e.type);n!==i&&(Pe(Es,e),Pe(Ft,i))}function Io(e){Es.current===e&&(Oe(Ft),Oe(Es))}var Ie=fr(0);function Oa(e){for(var n=e;n!==null;){if(n.tag===13){var i=n.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Lo=[];function Mo(){for(var e=0;e<Lo.length;e++)Lo[e]._workInProgressVersionPrimary=null;Lo.length=0}var Aa=L.ReactCurrentDispatcher,$o=L.ReactCurrentBatchConfig,zr=0,Le=null,He=null,Ve=null,Ia=!1,Ns=!1,js=0,_f=0;function tt(){throw Error(r(321))}function qo(e,n){if(n===null)return!1;for(var i=0;i<n.length&&i<e.length;i++)if(!Dt(e[i],n[i]))return!1;return!0}function Bo(e,n,i,m,p,f){if(zr=f,Le=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Aa.current=e===null||e.memoizedState===null?Nf:jf,e=i(m,p),Ns){f=0;do{if(Ns=!1,js=0,25<=f)throw Error(r(301));f+=1,Ve=He=null,n.updateQueue=null,Aa.current=Cf,e=i(m,p)}while(Ns)}if(Aa.current=$a,n=He!==null&&He.next!==null,zr=0,Ve=He=Le=null,Ia=!1,n)throw Error(r(300));return e}function Uo(){var e=js!==0;return js=0,e}function zt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ve===null?Le.memoizedState=Ve=e:Ve=Ve.next=e,Ve}function jt(){if(He===null){var e=Le.alternate;e=e!==null?e.memoizedState:null}else e=He.next;var n=Ve===null?Le.memoizedState:Ve.next;if(n!==null)Ve=n,He=e;else{if(e===null)throw Error(r(310));He=e,e={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},Ve===null?Le.memoizedState=Ve=e:Ve=Ve.next=e}return Ve}function Cs(e,n){return typeof n=="function"?n(e):n}function Fo(e){var n=jt(),i=n.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var m=He,p=m.baseQueue,f=i.pending;if(f!==null){if(p!==null){var w=p.next;p.next=f.next,f.next=w}m.baseQueue=p=f,i.pending=null}if(p!==null){f=p.next,m=m.baseState;var N=w=null,T=null,$=f;do{var V=$.lane;if((zr&V)===V)T!==null&&(T=T.next={lane:0,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),m=$.hasEagerState?$.eagerState:e(m,$.action);else{var X={lane:V,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null};T===null?(N=T=X,w=m):T=T.next=X,Le.lanes|=V,Hr|=V}$=$.next}while($!==null&&$!==f);T===null?w=m:T.next=N,Dt(m,n.memoizedState)||(dt=!0),n.memoizedState=m,n.baseState=w,n.baseQueue=T,i.lastRenderedState=m}if(e=i.interleaved,e!==null){p=e;do f=p.lane,Le.lanes|=f,Hr|=f,p=p.next;while(p!==e)}else p===null&&(i.lanes=0);return[n.memoizedState,i.dispatch]}function zo(e){var n=jt(),i=n.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var m=i.dispatch,p=i.pending,f=n.memoizedState;if(p!==null){i.pending=null;var w=p=p.next;do f=e(f,w.action),w=w.next;while(w!==p);Dt(f,n.memoizedState)||(dt=!0),n.memoizedState=f,n.baseQueue===null&&(n.baseState=f),i.lastRenderedState=f}return[f,m]}function nu(){}function su(e,n){var i=Le,m=jt(),p=n(),f=!Dt(m.memoizedState,p);if(f&&(m.memoizedState=p,dt=!0),m=m.queue,Ho(ou.bind(null,i,m,e),[e]),m.getSnapshot!==n||f||Ve!==null&&Ve.memoizedState.tag&1){if(i.flags|=2048,Ts(9,iu.bind(null,i,m,p,n),void 0,null),Qe===null)throw Error(r(349));(zr&30)!==0||au(i,n,p)}return p}function au(e,n,i){e.flags|=16384,e={getSnapshot:n,value:i},n=Le.updateQueue,n===null?(n={lastEffect:null,stores:null},Le.updateQueue=n,n.stores=[e]):(i=n.stores,i===null?n.stores=[e]:i.push(e))}function iu(e,n,i,m){n.value=i,n.getSnapshot=m,lu(n)&&cu(e)}function ou(e,n,i){return i(function(){lu(n)&&cu(e)})}function lu(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!Dt(e,i)}catch{return!0}}function cu(e){var n=Zt(e,1);n!==null&&Mt(n,e,1,-1)}function du(e){var n=zt();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:e},n.queue=e,e=e.dispatch=Sf.bind(null,Le,e),[n.memoizedState,e]}function Ts(e,n,i,m){return e={tag:e,create:n,destroy:i,deps:m,next:null},n=Le.updateQueue,n===null?(n={lastEffect:null,stores:null},Le.updateQueue=n,n.lastEffect=e.next=e):(i=n.lastEffect,i===null?n.lastEffect=e.next=e:(m=i.next,i.next=e,e.next=m,n.lastEffect=e)),e}function uu(){return jt().memoizedState}function La(e,n,i,m){var p=zt();Le.flags|=e,p.memoizedState=Ts(1|n,i,void 0,m===void 0?null:m)}function Ma(e,n,i,m){var p=jt();m=m===void 0?null:m;var f=void 0;if(He!==null){var w=He.memoizedState;if(f=w.destroy,m!==null&&qo(m,w.deps)){p.memoizedState=Ts(n,i,f,m);return}}Le.flags|=e,p.memoizedState=Ts(1|n,i,f,m)}function mu(e,n){return La(8390656,8,e,n)}function Ho(e,n){return Ma(2048,8,e,n)}function hu(e,n){return Ma(4,2,e,n)}function pu(e,n){return Ma(4,4,e,n)}function fu(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function gu(e,n,i){return i=i!=null?i.concat([e]):null,Ma(4,4,fu.bind(null,n,e),i)}function Wo(){}function yu(e,n){var i=jt();n=n===void 0?null:n;var m=i.memoizedState;return m!==null&&n!==null&&qo(n,m[1])?m[0]:(i.memoizedState=[e,n],e)}function xu(e,n){var i=jt();n=n===void 0?null:n;var m=i.memoizedState;return m!==null&&n!==null&&qo(n,m[1])?m[0]:(e=e(),i.memoizedState=[e,n],e)}function vu(e,n,i){return(zr&21)===0?(e.baseState&&(e.baseState=!1,dt=!0),e.memoizedState=i):(Dt(i,n)||(i=Gc(),Le.lanes|=i,Hr|=i,e.baseState=!0),n)}function kf(e,n){var i=Ce;Ce=i!==0&&4>i?i:4,e(!0);var m=$o.transition;$o.transition={};try{e(!1),n()}finally{Ce=i,$o.transition=m}}function bu(){return jt().memoizedState}function Ef(e,n,i){var m=kr(e);if(i={lane:m,action:i,hasEagerState:!1,eagerState:null,next:null},wu(e))_u(n,i);else if(i=Xd(e,n,i,m),i!==null){var p=it();Mt(i,e,m,p),ku(i,n,m)}}function Sf(e,n,i){var m=kr(e),p={lane:m,action:i,hasEagerState:!1,eagerState:null,next:null};if(wu(e))_u(n,p);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=n.lastRenderedReducer,f!==null))try{var w=n.lastRenderedState,N=f(w,i);if(p.hasEagerState=!0,p.eagerState=N,Dt(N,w)){var T=n.interleaved;T===null?(p.next=p,Do(n)):(p.next=T.next,T.next=p),n.interleaved=p;return}}catch{}finally{}i=Xd(e,n,p,m),i!==null&&(p=it(),Mt(i,e,m,p),ku(i,n,m))}}function wu(e){var n=e.alternate;return e===Le||n!==null&&n===Le}function _u(e,n){Ns=Ia=!0;var i=e.pending;i===null?n.next=n:(n.next=i.next,i.next=n),e.pending=n}function ku(e,n,i){if((i&4194240)!==0){var m=n.lanes;m&=e.pendingLanes,i|=m,n.lanes=i,Ki(e,i)}}var $a={readContext:Nt,useCallback:tt,useContext:tt,useEffect:tt,useImperativeHandle:tt,useInsertionEffect:tt,useLayoutEffect:tt,useMemo:tt,useReducer:tt,useRef:tt,useState:tt,useDebugValue:tt,useDeferredValue:tt,useTransition:tt,useMutableSource:tt,useSyncExternalStore:tt,useId:tt,unstable_isNewReconciler:!1},Nf={readContext:Nt,useCallback:function(e,n){return zt().memoizedState=[e,n===void 0?null:n],e},useContext:Nt,useEffect:mu,useImperativeHandle:function(e,n,i){return i=i!=null?i.concat([e]):null,La(4194308,4,fu.bind(null,n,e),i)},useLayoutEffect:function(e,n){return La(4194308,4,e,n)},useInsertionEffect:function(e,n){return La(4,2,e,n)},useMemo:function(e,n){var i=zt();return n=n===void 0?null:n,e=e(),i.memoizedState=[e,n],e},useReducer:function(e,n,i){var m=zt();return n=i!==void 0?i(n):n,m.memoizedState=m.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},m.queue=e,e=e.dispatch=Ef.bind(null,Le,e),[m.memoizedState,e]},useRef:function(e){var n=zt();return e={current:e},n.memoizedState=e},useState:du,useDebugValue:Wo,useDeferredValue:function(e){return zt().memoizedState=e},useTransition:function(){var e=du(!1),n=e[0];return e=kf.bind(null,e[1]),zt().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,i){var m=Le,p=zt();if(Ae){if(i===void 0)throw Error(r(407));i=i()}else{if(i=n(),Qe===null)throw Error(r(349));(zr&30)!==0||au(m,n,i)}p.memoizedState=i;var f={value:i,getSnapshot:n};return p.queue=f,mu(ou.bind(null,m,f,e),[e]),m.flags|=2048,Ts(9,iu.bind(null,m,f,i,n),void 0,null),i},useId:function(){var e=zt(),n=Qe.identifierPrefix;if(Ae){var i=Xt,m=Yt;i=(m&~(1<<32-Rt(m)-1)).toString(32)+i,n=":"+n+"R"+i,i=js++,0<i&&(n+="H"+i.toString(32)),n+=":"}else i=_f++,n=":"+n+"r"+i.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},jf={readContext:Nt,useCallback:yu,useContext:Nt,useEffect:Ho,useImperativeHandle:gu,useInsertionEffect:hu,useLayoutEffect:pu,useMemo:xu,useReducer:Fo,useRef:uu,useState:function(){return Fo(Cs)},useDebugValue:Wo,useDeferredValue:function(e){var n=jt();return vu(n,He.memoizedState,e)},useTransition:function(){var e=Fo(Cs)[0],n=jt().memoizedState;return[e,n]},useMutableSource:nu,useSyncExternalStore:su,useId:bu,unstable_isNewReconciler:!1},Cf={readContext:Nt,useCallback:yu,useContext:Nt,useEffect:Ho,useImperativeHandle:gu,useInsertionEffect:hu,useLayoutEffect:pu,useMemo:xu,useReducer:zo,useRef:uu,useState:function(){return zo(Cs)},useDebugValue:Wo,useDeferredValue:function(e){var n=jt();return He===null?n.memoizedState=e:vu(n,He.memoizedState,e)},useTransition:function(){var e=zo(Cs)[0],n=jt().memoizedState;return[e,n]},useMutableSource:nu,useSyncExternalStore:su,useId:bu,unstable_isNewReconciler:!1};function At(e,n){if(e&&e.defaultProps){n=te({},n),e=e.defaultProps;for(var i in e)n[i]===void 0&&(n[i]=e[i]);return n}return n}function Ko(e,n,i,m){n=e.memoizedState,i=i(m,n),i=i==null?n:te({},n,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var qa={isMounted:function(e){return(e=e._reactInternals)?Lr(e)===e:!1},enqueueSetState:function(e,n,i){e=e._reactInternals;var m=it(),p=kr(e),f=er(m,p);f.payload=n,i!=null&&(f.callback=i),n=vr(e,f,p),n!==null&&(Mt(n,e,p,m),Ra(n,e,p))},enqueueReplaceState:function(e,n,i){e=e._reactInternals;var m=it(),p=kr(e),f=er(m,p);f.tag=1,f.payload=n,i!=null&&(f.callback=i),n=vr(e,f,p),n!==null&&(Mt(n,e,p,m),Ra(n,e,p))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var i=it(),m=kr(e),p=er(i,m);p.tag=2,n!=null&&(p.callback=n),n=vr(e,p,m),n!==null&&(Mt(n,e,m,i),Ra(n,e,m))}};function Eu(e,n,i,m,p,f,w){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(m,f,w):n.prototype&&n.prototype.isPureReactComponent?!fs(i,m)||!fs(p,f):!0}function Su(e,n,i){var m=!1,p=gr,f=n.contextType;return typeof f=="object"&&f!==null?f=Nt(f):(p=ct(n)?$r:et.current,m=n.contextTypes,f=(m=m!=null)?bn(e,p):gr),n=new n(i,f),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=qa,e.stateNode=n,n._reactInternals=e,m&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=p,e.__reactInternalMemoizedMaskedChildContext=f),n}function Nu(e,n,i,m){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(i,m),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(i,m),n.state!==e&&qa.enqueueReplaceState(n,n.state,null)}function Vo(e,n,i,m){var p=e.stateNode;p.props=i,p.state=e.memoizedState,p.refs={},Oo(e);var f=n.contextType;typeof f=="object"&&f!==null?p.context=Nt(f):(f=ct(n)?$r:et.current,p.context=bn(e,f)),p.state=e.memoizedState,f=n.getDerivedStateFromProps,typeof f=="function"&&(Ko(e,n,f,i),p.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(n=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),n!==p.state&&qa.enqueueReplaceState(p,p.state,null),Da(e,i,p,m),p.state=e.memoizedState),typeof p.componentDidMount=="function"&&(e.flags|=4194308)}function Cn(e,n){try{var i="",m=n;do i+=Z(m),m=m.return;while(m);var p=i}catch(f){p=`
Error generating stack: `+f.message+`
`+f.stack}return{value:e,source:n,stack:p,digest:null}}function Qo(e,n,i){return{value:e,source:null,stack:i??null,digest:n??null}}function Go(e,n){try{console.error(n.value)}catch(i){setTimeout(function(){throw i})}}var Tf=typeof WeakMap=="function"?WeakMap:Map;function ju(e,n,i){i=er(-1,i),i.tag=3,i.payload={element:null};var m=n.value;return i.callback=function(){Ka||(Ka=!0,dl=m),Go(e,n)},i}function Cu(e,n,i){i=er(-1,i),i.tag=3;var m=e.type.getDerivedStateFromError;if(typeof m=="function"){var p=n.value;i.payload=function(){return m(p)},i.callback=function(){Go(e,n)}}var f=e.stateNode;return f!==null&&typeof f.componentDidCatch=="function"&&(i.callback=function(){Go(e,n),typeof m!="function"&&(wr===null?wr=new Set([this]):wr.add(this));var w=n.stack;this.componentDidCatch(n.value,{componentStack:w!==null?w:""})}),i}function Tu(e,n,i){var m=e.pingCache;if(m===null){m=e.pingCache=new Tf;var p=new Set;m.set(n,p)}else p=m.get(n),p===void 0&&(p=new Set,m.set(n,p));p.has(i)||(p.add(i),e=zf.bind(null,e,n,i),n.then(e,e))}function Pu(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function Ru(e,n,i,m,p){return(e.mode&1)===0?(e===n?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(n=er(-1,1),n.tag=2,vr(i,n,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=p,e)}var Pf=L.ReactCurrentOwner,dt=!1;function at(e,n,i,m){n.child=e===null?Yd(n,null,i,m):En(n,e.child,i,m)}function Du(e,n,i,m,p){i=i.render;var f=n.ref;return Nn(n,p),m=Bo(e,n,i,m,f,p),i=Uo(),e!==null&&!dt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~p,tr(e,n,p)):(Ae&&i&&ko(n),n.flags|=1,at(e,n,m,p),n.child)}function Ou(e,n,i,m,p){if(e===null){var f=i.type;return typeof f=="function"&&!yl(f)&&f.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(n.tag=15,n.type=f,Au(e,n,f,m,p)):(e=Xa(i.type,null,m,n,n.mode,p),e.ref=n.ref,e.return=n,n.child=e)}if(f=e.child,(e.lanes&p)===0){var w=f.memoizedProps;if(i=i.compare,i=i!==null?i:fs,i(w,m)&&e.ref===n.ref)return tr(e,n,p)}return n.flags|=1,e=Sr(f,m),e.ref=n.ref,e.return=n,n.child=e}function Au(e,n,i,m,p){if(e!==null){var f=e.memoizedProps;if(fs(f,m)&&e.ref===n.ref)if(dt=!1,n.pendingProps=m=f,(e.lanes&p)!==0)(e.flags&131072)!==0&&(dt=!0);else return n.lanes=e.lanes,tr(e,n,p)}return Jo(e,n,i,m,p)}function Iu(e,n,i){var m=n.pendingProps,p=m.children,f=e!==null?e.memoizedState:null;if(m.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(Pn,wt),wt|=i;else{if((i&1073741824)===0)return e=f!==null?f.baseLanes|i:i,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Pe(Pn,wt),wt|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=f!==null?f.baseLanes:i,Pe(Pn,wt),wt|=m}else f!==null?(m=f.baseLanes|i,n.memoizedState=null):m=i,Pe(Pn,wt),wt|=m;return at(e,n,p,i),n.child}function Lu(e,n){var i=n.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(n.flags|=512,n.flags|=2097152)}function Jo(e,n,i,m,p){var f=ct(i)?$r:et.current;return f=bn(n,f),Nn(n,p),i=Bo(e,n,i,m,f,p),m=Uo(),e!==null&&!dt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~p,tr(e,n,p)):(Ae&&m&&ko(n),n.flags|=1,at(e,n,i,p),n.child)}function Mu(e,n,i,m,p){if(ct(i)){var f=!0;ka(n)}else f=!1;if(Nn(n,p),n.stateNode===null)Ua(e,n),Su(n,i,m),Vo(n,i,m,p),m=!0;else if(e===null){var w=n.stateNode,N=n.memoizedProps;w.props=N;var T=w.context,$=i.contextType;typeof $=="object"&&$!==null?$=Nt($):($=ct(i)?$r:et.current,$=bn(n,$));var V=i.getDerivedStateFromProps,X=typeof V=="function"||typeof w.getSnapshotBeforeUpdate=="function";X||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(N!==m||T!==$)&&Nu(n,w,m,$),xr=!1;var W=n.memoizedState;w.state=W,Da(n,m,w,p),T=n.memoizedState,N!==m||W!==T||lt.current||xr?(typeof V=="function"&&(Ko(n,i,V,m),T=n.memoizedState),(N=xr||Eu(n,i,N,m,W,T,$))?(X||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(n.flags|=4194308)):(typeof w.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=m,n.memoizedState=T),w.props=m,w.state=T,w.context=$,m=N):(typeof w.componentDidMount=="function"&&(n.flags|=4194308),m=!1)}else{w=n.stateNode,Zd(e,n),N=n.memoizedProps,$=n.type===n.elementType?N:At(n.type,N),w.props=$,X=n.pendingProps,W=w.context,T=i.contextType,typeof T=="object"&&T!==null?T=Nt(T):(T=ct(i)?$r:et.current,T=bn(n,T));var se=i.getDerivedStateFromProps;(V=typeof se=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(N!==X||W!==T)&&Nu(n,w,m,T),xr=!1,W=n.memoizedState,w.state=W,Da(n,m,w,p);var le=n.memoizedState;N!==X||W!==le||lt.current||xr?(typeof se=="function"&&(Ko(n,i,se,m),le=n.memoizedState),($=xr||Eu(n,i,$,m,W,le,T)||!1)?(V||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(m,le,T),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(m,le,T)),typeof w.componentDidUpdate=="function"&&(n.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof w.componentDidUpdate!="function"||N===e.memoizedProps&&W===e.memoizedState||(n.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===e.memoizedProps&&W===e.memoizedState||(n.flags|=1024),n.memoizedProps=m,n.memoizedState=le),w.props=m,w.state=le,w.context=T,m=$):(typeof w.componentDidUpdate!="function"||N===e.memoizedProps&&W===e.memoizedState||(n.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===e.memoizedProps&&W===e.memoizedState||(n.flags|=1024),m=!1)}return Yo(e,n,i,m,f,p)}function Yo(e,n,i,m,p,f){Lu(e,n);var w=(n.flags&128)!==0;if(!m&&!w)return p&&Fd(n,i,!1),tr(e,n,f);m=n.stateNode,Pf.current=n;var N=w&&typeof i.getDerivedStateFromError!="function"?null:m.render();return n.flags|=1,e!==null&&w?(n.child=En(n,e.child,null,f),n.child=En(n,null,N,f)):at(e,n,N,f),n.memoizedState=m.state,p&&Fd(n,i,!0),n.child}function $u(e){var n=e.stateNode;n.pendingContext?Bd(e,n.pendingContext,n.pendingContext!==n.context):n.context&&Bd(e,n.context,!1),Ao(e,n.containerInfo)}function qu(e,n,i,m,p){return kn(),jo(p),n.flags|=256,at(e,n,i,m),n.child}var Xo={dehydrated:null,treeContext:null,retryLane:0};function Zo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Bu(e,n,i){var m=n.pendingProps,p=Ie.current,f=!1,w=(n.flags&128)!==0,N;if((N=w)||(N=e!==null&&e.memoizedState===null?!1:(p&2)!==0),N?(f=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(p|=1),Pe(Ie,p&1),e===null)return No(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((n.mode&1)===0?n.lanes=1:e.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(w=m.children,e=m.fallback,f?(m=n.mode,f=n.child,w={mode:"hidden",children:w},(m&1)===0&&f!==null?(f.childLanes=0,f.pendingProps=w):f=Za(w,m,0,null),e=Qr(e,m,i,null),f.return=n,e.return=n,f.sibling=e,n.child=f,n.child.memoizedState=Zo(i),n.memoizedState=Xo,e):el(n,w));if(p=e.memoizedState,p!==null&&(N=p.dehydrated,N!==null))return Rf(e,n,w,m,N,p,i);if(f){f=m.fallback,w=n.mode,p=e.child,N=p.sibling;var T={mode:"hidden",children:m.children};return(w&1)===0&&n.child!==p?(m=n.child,m.childLanes=0,m.pendingProps=T,n.deletions=null):(m=Sr(p,T),m.subtreeFlags=p.subtreeFlags&14680064),N!==null?f=Sr(N,f):(f=Qr(f,w,i,null),f.flags|=2),f.return=n,m.return=n,m.sibling=f,n.child=m,m=f,f=n.child,w=e.child.memoizedState,w=w===null?Zo(i):{baseLanes:w.baseLanes|i,cachePool:null,transitions:w.transitions},f.memoizedState=w,f.childLanes=e.childLanes&~i,n.memoizedState=Xo,m}return f=e.child,e=f.sibling,m=Sr(f,{mode:"visible",children:m.children}),(n.mode&1)===0&&(m.lanes=i),m.return=n,m.sibling=null,e!==null&&(i=n.deletions,i===null?(n.deletions=[e],n.flags|=16):i.push(e)),n.child=m,n.memoizedState=null,m}function el(e,n){return n=Za({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function Ba(e,n,i,m){return m!==null&&jo(m),En(n,e.child,null,i),e=el(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Rf(e,n,i,m,p,f,w){if(i)return n.flags&256?(n.flags&=-257,m=Qo(Error(r(422))),Ba(e,n,w,m)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(f=m.fallback,p=n.mode,m=Za({mode:"visible",children:m.children},p,0,null),f=Qr(f,p,w,null),f.flags|=2,m.return=n,f.return=n,m.sibling=f,n.child=m,(n.mode&1)!==0&&En(n,e.child,null,w),n.child.memoizedState=Zo(w),n.memoizedState=Xo,f);if((n.mode&1)===0)return Ba(e,n,w,null);if(p.data==="$!"){if(m=p.nextSibling&&p.nextSibling.dataset,m)var N=m.dgst;return m=N,f=Error(r(419)),m=Qo(f,m,void 0),Ba(e,n,w,m)}if(N=(w&e.childLanes)!==0,dt||N){if(m=Qe,m!==null){switch(w&-w){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(m.suspendedLanes|w))!==0?0:p,p!==0&&p!==f.retryLane&&(f.retryLane=p,Zt(e,p),Mt(m,e,p,-1))}return gl(),m=Qo(Error(r(421))),Ba(e,n,w,m)}return p.data==="$?"?(n.flags|=128,n.child=e.child,n=Hf.bind(null,e),p._reactRetry=n,null):(e=f.treeContext,bt=pr(p.nextSibling),vt=n,Ae=!0,Ot=null,e!==null&&(Et[St++]=Yt,Et[St++]=Xt,Et[St++]=qr,Yt=e.id,Xt=e.overflow,qr=n),n=el(n,m.children),n.flags|=4096,n)}function Uu(e,n,i){e.lanes|=n;var m=e.alternate;m!==null&&(m.lanes|=n),Ro(e.return,n,i)}function tl(e,n,i,m,p){var f=e.memoizedState;f===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:m,tail:i,tailMode:p}:(f.isBackwards=n,f.rendering=null,f.renderingStartTime=0,f.last=m,f.tail=i,f.tailMode=p)}function Fu(e,n,i){var m=n.pendingProps,p=m.revealOrder,f=m.tail;if(at(e,n,m.children,i),m=Ie.current,(m&2)!==0)m=m&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Uu(e,i,n);else if(e.tag===19)Uu(e,i,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}m&=1}if(Pe(Ie,m),(n.mode&1)===0)n.memoizedState=null;else switch(p){case"forwards":for(i=n.child,p=null;i!==null;)e=i.alternate,e!==null&&Oa(e)===null&&(p=i),i=i.sibling;i=p,i===null?(p=n.child,n.child=null):(p=i.sibling,i.sibling=null),tl(n,!1,p,i,f);break;case"backwards":for(i=null,p=n.child,n.child=null;p!==null;){if(e=p.alternate,e!==null&&Oa(e)===null){n.child=p;break}e=p.sibling,p.sibling=i,i=p,p=e}tl(n,!0,i,null,f);break;case"together":tl(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Ua(e,n){(n.mode&1)===0&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function tr(e,n,i){if(e!==null&&(n.dependencies=e.dependencies),Hr|=n.lanes,(i&n.childLanes)===0)return null;if(e!==null&&n.child!==e.child)throw Error(r(153));if(n.child!==null){for(e=n.child,i=Sr(e,e.pendingProps),n.child=i,i.return=n;e.sibling!==null;)e=e.sibling,i=i.sibling=Sr(e,e.pendingProps),i.return=n;i.sibling=null}return n.child}function Df(e,n,i){switch(n.tag){case 3:$u(n),kn();break;case 5:ru(n);break;case 1:ct(n.type)&&ka(n);break;case 4:Ao(n,n.stateNode.containerInfo);break;case 10:var m=n.type._context,p=n.memoizedProps.value;Pe(Ta,m._currentValue),m._currentValue=p;break;case 13:if(m=n.memoizedState,m!==null)return m.dehydrated!==null?(Pe(Ie,Ie.current&1),n.flags|=128,null):(i&n.child.childLanes)!==0?Bu(e,n,i):(Pe(Ie,Ie.current&1),e=tr(e,n,i),e!==null?e.sibling:null);Pe(Ie,Ie.current&1);break;case 19:if(m=(i&n.childLanes)!==0,(e.flags&128)!==0){if(m)return Fu(e,n,i);n.flags|=128}if(p=n.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Pe(Ie,Ie.current),m)break;return null;case 22:case 23:return n.lanes=0,Iu(e,n,i)}return tr(e,n,i)}var zu,rl,Hu,Wu;zu=function(e,n){for(var i=n.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},rl=function(){},Hu=function(e,n,i,m){var p=e.memoizedProps;if(p!==m){e=n.stateNode,Fr(Ft.current);var f=null;switch(i){case"input":p=Pi(e,p),m=Pi(e,m),f=[];break;case"select":p=te({},p,{value:void 0}),m=te({},m,{value:void 0}),f=[];break;case"textarea":p=Oi(e,p),m=Oi(e,m),f=[];break;default:typeof p.onClick!="function"&&typeof m.onClick=="function"&&(e.onclick=ba)}Ii(i,m);var w;i=null;for($ in p)if(!m.hasOwnProperty($)&&p.hasOwnProperty($)&&p[$]!=null)if($==="style"){var N=p[$];for(w in N)N.hasOwnProperty(w)&&(i||(i={}),i[w]="")}else $!=="dangerouslySetInnerHTML"&&$!=="children"&&$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&$!=="autoFocus"&&(l.hasOwnProperty($)?f||(f=[]):(f=f||[]).push($,null));for($ in m){var T=m[$];if(N=p!=null?p[$]:void 0,m.hasOwnProperty($)&&T!==N&&(T!=null||N!=null))if($==="style")if(N){for(w in N)!N.hasOwnProperty(w)||T&&T.hasOwnProperty(w)||(i||(i={}),i[w]="");for(w in T)T.hasOwnProperty(w)&&N[w]!==T[w]&&(i||(i={}),i[w]=T[w])}else i||(f||(f=[]),f.push($,i)),i=T;else $==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,N=N?N.__html:void 0,T!=null&&N!==T&&(f=f||[]).push($,T)):$==="children"?typeof T!="string"&&typeof T!="number"||(f=f||[]).push($,""+T):$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&(l.hasOwnProperty($)?(T!=null&&$==="onScroll"&&De("scroll",e),f||N===T||(f=[])):(f=f||[]).push($,T))}i&&(f=f||[]).push("style",i);var $=f;(n.updateQueue=$)&&(n.flags|=4)}},Wu=function(e,n,i,m){i!==m&&(n.flags|=4)};function Ps(e,n){if(!Ae)switch(e.tailMode){case"hidden":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var m=null;i!==null;)i.alternate!==null&&(m=i),i=i.sibling;m===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:m.sibling=null}}function rt(e){var n=e.alternate!==null&&e.alternate.child===e.child,i=0,m=0;if(n)for(var p=e.child;p!==null;)i|=p.lanes|p.childLanes,m|=p.subtreeFlags&14680064,m|=p.flags&14680064,p.return=e,p=p.sibling;else for(p=e.child;p!==null;)i|=p.lanes|p.childLanes,m|=p.subtreeFlags,m|=p.flags,p.return=e,p=p.sibling;return e.subtreeFlags|=m,e.childLanes=i,n}function Of(e,n,i){var m=n.pendingProps;switch(Eo(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rt(n),null;case 1:return ct(n.type)&&_a(),rt(n),null;case 3:return m=n.stateNode,jn(),Oe(lt),Oe(et),Mo(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(e===null||e.child===null)&&(ja(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Ot!==null&&(hl(Ot),Ot=null))),rl(e,n),rt(n),null;case 5:Io(n);var p=Fr(Ss.current);if(i=n.type,e!==null&&n.stateNode!=null)Hu(e,n,i,m,p),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!m){if(n.stateNode===null)throw Error(r(166));return rt(n),null}if(e=Fr(Ft.current),ja(n)){m=n.stateNode,i=n.type;var f=n.memoizedProps;switch(m[Ut]=n,m[bs]=f,e=(n.mode&1)!==0,i){case"dialog":De("cancel",m),De("close",m);break;case"iframe":case"object":case"embed":De("load",m);break;case"video":case"audio":for(p=0;p<ys.length;p++)De(ys[p],m);break;case"source":De("error",m);break;case"img":case"image":case"link":De("error",m),De("load",m);break;case"details":De("toggle",m);break;case"input":Sc(m,f),De("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!f.multiple},De("invalid",m);break;case"textarea":Cc(m,f),De("invalid",m)}Ii(i,f),p=null;for(var w in f)if(f.hasOwnProperty(w)){var N=f[w];w==="children"?typeof N=="string"?m.textContent!==N&&(f.suppressHydrationWarning!==!0&&va(m.textContent,N,e),p=["children",N]):typeof N=="number"&&m.textContent!==""+N&&(f.suppressHydrationWarning!==!0&&va(m.textContent,N,e),p=["children",""+N]):l.hasOwnProperty(w)&&N!=null&&w==="onScroll"&&De("scroll",m)}switch(i){case"input":an(m),jc(m,f,!0);break;case"textarea":an(m),Pc(m);break;case"select":case"option":break;default:typeof f.onClick=="function"&&(m.onclick=ba)}m=p,n.updateQueue=m,m!==null&&(n.flags|=4)}else{w=p.nodeType===9?p:p.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Rc(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=w.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof m.is=="string"?e=w.createElement(i,{is:m.is}):(e=w.createElement(i),i==="select"&&(w=e,m.multiple?w.multiple=!0:m.size&&(w.size=m.size))):e=w.createElementNS(e,i),e[Ut]=n,e[bs]=m,zu(e,n,!1,!1),n.stateNode=e;e:{switch(w=Li(i,m),i){case"dialog":De("cancel",e),De("close",e),p=m;break;case"iframe":case"object":case"embed":De("load",e),p=m;break;case"video":case"audio":for(p=0;p<ys.length;p++)De(ys[p],e);p=m;break;case"source":De("error",e),p=m;break;case"img":case"image":case"link":De("error",e),De("load",e),p=m;break;case"details":De("toggle",e),p=m;break;case"input":Sc(e,m),p=Pi(e,m),De("invalid",e);break;case"option":p=m;break;case"select":e._wrapperState={wasMultiple:!!m.multiple},p=te({},m,{value:void 0}),De("invalid",e);break;case"textarea":Cc(e,m),p=Oi(e,m),De("invalid",e);break;default:p=m}Ii(i,p),N=p;for(f in N)if(N.hasOwnProperty(f)){var T=N[f];f==="style"?Ac(e,T):f==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,T!=null&&Dc(e,T)):f==="children"?typeof T=="string"?(i!=="textarea"||T!=="")&&Xn(e,T):typeof T=="number"&&Xn(e,""+T):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(l.hasOwnProperty(f)?T!=null&&f==="onScroll"&&De("scroll",e):T!=null&&D(e,f,T,w))}switch(i){case"input":an(e),jc(e,m,!1);break;case"textarea":an(e),Pc(e);break;case"option":m.value!=null&&e.setAttribute("value",""+_e(m.value));break;case"select":e.multiple=!!m.multiple,f=m.value,f!=null?ln(e,!!m.multiple,f,!1):m.defaultValue!=null&&ln(e,!!m.multiple,m.defaultValue,!0);break;default:typeof p.onClick=="function"&&(e.onclick=ba)}switch(i){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return rt(n),null;case 6:if(e&&n.stateNode!=null)Wu(e,n,e.memoizedProps,m);else{if(typeof m!="string"&&n.stateNode===null)throw Error(r(166));if(i=Fr(Ss.current),Fr(Ft.current),ja(n)){if(m=n.stateNode,i=n.memoizedProps,m[Ut]=n,(f=m.nodeValue!==i)&&(e=vt,e!==null))switch(e.tag){case 3:va(m.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&va(m.nodeValue,i,(e.mode&1)!==0)}f&&(n.flags|=4)}else m=(i.nodeType===9?i:i.ownerDocument).createTextNode(m),m[Ut]=n,n.stateNode=m}return rt(n),null;case 13:if(Oe(Ie),m=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ae&&bt!==null&&(n.mode&1)!==0&&(n.flags&128)===0)Qd(),kn(),n.flags|=98560,f=!1;else if(f=ja(n),m!==null&&m.dehydrated!==null){if(e===null){if(!f)throw Error(r(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));f[Ut]=n}else kn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;rt(n),f=!1}else Ot!==null&&(hl(Ot),Ot=null),f=!0;if(!f)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=i,n):(m=m!==null,m!==(e!==null&&e.memoizedState!==null)&&m&&(n.child.flags|=8192,(n.mode&1)!==0&&(e===null||(Ie.current&1)!==0?We===0&&(We=3):gl())),n.updateQueue!==null&&(n.flags|=4),rt(n),null);case 4:return jn(),rl(e,n),e===null&&xs(n.stateNode.containerInfo),rt(n),null;case 10:return Po(n.type._context),rt(n),null;case 17:return ct(n.type)&&_a(),rt(n),null;case 19:if(Oe(Ie),f=n.memoizedState,f===null)return rt(n),null;if(m=(n.flags&128)!==0,w=f.rendering,w===null)if(m)Ps(f,!1);else{if(We!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(w=Oa(e),w!==null){for(n.flags|=128,Ps(f,!1),m=w.updateQueue,m!==null&&(n.updateQueue=m,n.flags|=4),n.subtreeFlags=0,m=i,i=n.child;i!==null;)f=i,e=m,f.flags&=14680066,w=f.alternate,w===null?(f.childLanes=0,f.lanes=e,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=w.childLanes,f.lanes=w.lanes,f.child=w.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=w.memoizedProps,f.memoizedState=w.memoizedState,f.updateQueue=w.updateQueue,f.type=w.type,e=w.dependencies,f.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Pe(Ie,Ie.current&1|2),n.child}e=e.sibling}f.tail!==null&&qe()>Rn&&(n.flags|=128,m=!0,Ps(f,!1),n.lanes=4194304)}else{if(!m)if(e=Oa(w),e!==null){if(n.flags|=128,m=!0,i=e.updateQueue,i!==null&&(n.updateQueue=i,n.flags|=4),Ps(f,!0),f.tail===null&&f.tailMode==="hidden"&&!w.alternate&&!Ae)return rt(n),null}else 2*qe()-f.renderingStartTime>Rn&&i!==1073741824&&(n.flags|=128,m=!0,Ps(f,!1),n.lanes=4194304);f.isBackwards?(w.sibling=n.child,n.child=w):(i=f.last,i!==null?i.sibling=w:n.child=w,f.last=w)}return f.tail!==null?(n=f.tail,f.rendering=n,f.tail=n.sibling,f.renderingStartTime=qe(),n.sibling=null,i=Ie.current,Pe(Ie,m?i&1|2:i&1),n):(rt(n),null);case 22:case 23:return fl(),m=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==m&&(n.flags|=8192),m&&(n.mode&1)!==0?(wt&1073741824)!==0&&(rt(n),n.subtreeFlags&6&&(n.flags|=8192)):rt(n),null;case 24:return null;case 25:return null}throw Error(r(156,n.tag))}function Af(e,n){switch(Eo(n),n.tag){case 1:return ct(n.type)&&_a(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return jn(),Oe(lt),Oe(et),Mo(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 5:return Io(n),null;case 13:if(Oe(Ie),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(r(340));kn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Oe(Ie),null;case 4:return jn(),null;case 10:return Po(n.type._context),null;case 22:case 23:return fl(),null;case 24:return null;default:return null}}var Fa=!1,nt=!1,If=typeof WeakSet=="function"?WeakSet:Set,oe=null;function Tn(e,n){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(m){Me(e,n,m)}else i.current=null}function nl(e,n,i){try{i()}catch(m){Me(e,n,m)}}var Ku=!1;function Lf(e,n){if(fo=la,e=Ed(),io(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var m=i.getSelection&&i.getSelection();if(m&&m.rangeCount!==0){i=m.anchorNode;var p=m.anchorOffset,f=m.focusNode;m=m.focusOffset;try{i.nodeType,f.nodeType}catch{i=null;break e}var w=0,N=-1,T=-1,$=0,V=0,X=e,W=null;t:for(;;){for(var se;X!==i||p!==0&&X.nodeType!==3||(N=w+p),X!==f||m!==0&&X.nodeType!==3||(T=w+m),X.nodeType===3&&(w+=X.nodeValue.length),(se=X.firstChild)!==null;)W=X,X=se;for(;;){if(X===e)break t;if(W===i&&++$===p&&(N=w),W===f&&++V===m&&(T=w),(se=X.nextSibling)!==null)break;X=W,W=X.parentNode}X=se}i=N===-1||T===-1?null:{start:N,end:T}}else i=null}i=i||{start:0,end:0}}else i=null;for(go={focusedElem:e,selectionRange:i},la=!1,oe=n;oe!==null;)if(n=oe,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,oe=e;else for(;oe!==null;){n=oe;try{var le=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(le!==null){var ce=le.memoizedProps,Be=le.memoizedState,O=n.stateNode,P=O.getSnapshotBeforeUpdate(n.elementType===n.type?ce:At(n.type,ce),Be);O.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var I=n.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(ee){Me(n,n.return,ee)}if(e=n.sibling,e!==null){e.return=n.return,oe=e;break}oe=n.return}return le=Ku,Ku=!1,le}function Rs(e,n,i){var m=n.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var p=m=m.next;do{if((p.tag&e)===e){var f=p.destroy;p.destroy=void 0,f!==void 0&&nl(n,i,f)}p=p.next}while(p!==m)}}function za(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var m=i.create;i.destroy=m()}i=i.next}while(i!==n)}}function sl(e){var n=e.ref;if(n!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof n=="function"?n(e):n.current=e}}function Vu(e){var n=e.alternate;n!==null&&(e.alternate=null,Vu(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[Ut],delete n[bs],delete n[bo],delete n[xf],delete n[vf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Qu(e){return e.tag===5||e.tag===3||e.tag===4}function Gu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Qu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function al(e,n,i){var m=e.tag;if(m===5||m===6)e=e.stateNode,n?i.nodeType===8?i.parentNode.insertBefore(e,n):i.insertBefore(e,n):(i.nodeType===8?(n=i.parentNode,n.insertBefore(e,i)):(n=i,n.appendChild(e)),i=i._reactRootContainer,i!=null||n.onclick!==null||(n.onclick=ba));else if(m!==4&&(e=e.child,e!==null))for(al(e,n,i),e=e.sibling;e!==null;)al(e,n,i),e=e.sibling}function il(e,n,i){var m=e.tag;if(m===5||m===6)e=e.stateNode,n?i.insertBefore(e,n):i.appendChild(e);else if(m!==4&&(e=e.child,e!==null))for(il(e,n,i),e=e.sibling;e!==null;)il(e,n,i),e=e.sibling}var Xe=null,It=!1;function br(e,n,i){for(i=i.child;i!==null;)Ju(e,n,i),i=i.sibling}function Ju(e,n,i){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(ra,i)}catch{}switch(i.tag){case 5:nt||Tn(i,n);case 6:var m=Xe,p=It;Xe=null,br(e,n,i),Xe=m,It=p,Xe!==null&&(It?(e=Xe,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Xe.removeChild(i.stateNode));break;case 18:Xe!==null&&(It?(e=Xe,i=i.stateNode,e.nodeType===8?vo(e.parentNode,i):e.nodeType===1&&vo(e,i),cs(e)):vo(Xe,i.stateNode));break;case 4:m=Xe,p=It,Xe=i.stateNode.containerInfo,It=!0,br(e,n,i),Xe=m,It=p;break;case 0:case 11:case 14:case 15:if(!nt&&(m=i.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){p=m=m.next;do{var f=p,w=f.destroy;f=f.tag,w!==void 0&&((f&2)!==0||(f&4)!==0)&&nl(i,n,w),p=p.next}while(p!==m)}br(e,n,i);break;case 1:if(!nt&&(Tn(i,n),m=i.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=i.memoizedProps,m.state=i.memoizedState,m.componentWillUnmount()}catch(N){Me(i,n,N)}br(e,n,i);break;case 21:br(e,n,i);break;case 22:i.mode&1?(nt=(m=nt)||i.memoizedState!==null,br(e,n,i),nt=m):br(e,n,i);break;default:br(e,n,i)}}function Yu(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new If),n.forEach(function(m){var p=Wf.bind(null,e,m);i.has(m)||(i.add(m),m.then(p,p))})}}function Lt(e,n){var i=n.deletions;if(i!==null)for(var m=0;m<i.length;m++){var p=i[m];try{var f=e,w=n,N=w;e:for(;N!==null;){switch(N.tag){case 5:Xe=N.stateNode,It=!1;break e;case 3:Xe=N.stateNode.containerInfo,It=!0;break e;case 4:Xe=N.stateNode.containerInfo,It=!0;break e}N=N.return}if(Xe===null)throw Error(r(160));Ju(f,w,p),Xe=null,It=!1;var T=p.alternate;T!==null&&(T.return=null),p.return=null}catch($){Me(p,n,$)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Xu(n,e),n=n.sibling}function Xu(e,n){var i=e.alternate,m=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Lt(n,e),Ht(e),m&4){try{Rs(3,e,e.return),za(3,e)}catch(ce){Me(e,e.return,ce)}try{Rs(5,e,e.return)}catch(ce){Me(e,e.return,ce)}}break;case 1:Lt(n,e),Ht(e),m&512&&i!==null&&Tn(i,i.return);break;case 5:if(Lt(n,e),Ht(e),m&512&&i!==null&&Tn(i,i.return),e.flags&32){var p=e.stateNode;try{Xn(p,"")}catch(ce){Me(e,e.return,ce)}}if(m&4&&(p=e.stateNode,p!=null)){var f=e.memoizedProps,w=i!==null?i.memoizedProps:f,N=e.type,T=e.updateQueue;if(e.updateQueue=null,T!==null)try{N==="input"&&f.type==="radio"&&f.name!=null&&Nc(p,f),Li(N,w);var $=Li(N,f);for(w=0;w<T.length;w+=2){var V=T[w],X=T[w+1];V==="style"?Ac(p,X):V==="dangerouslySetInnerHTML"?Dc(p,X):V==="children"?Xn(p,X):D(p,V,X,$)}switch(N){case"input":Ri(p,f);break;case"textarea":Tc(p,f);break;case"select":var W=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!f.multiple;var se=f.value;se!=null?ln(p,!!f.multiple,se,!1):W!==!!f.multiple&&(f.defaultValue!=null?ln(p,!!f.multiple,f.defaultValue,!0):ln(p,!!f.multiple,f.multiple?[]:"",!1))}p[bs]=f}catch(ce){Me(e,e.return,ce)}}break;case 6:if(Lt(n,e),Ht(e),m&4){if(e.stateNode===null)throw Error(r(162));p=e.stateNode,f=e.memoizedProps;try{p.nodeValue=f}catch(ce){Me(e,e.return,ce)}}break;case 3:if(Lt(n,e),Ht(e),m&4&&i!==null&&i.memoizedState.isDehydrated)try{cs(n.containerInfo)}catch(ce){Me(e,e.return,ce)}break;case 4:Lt(n,e),Ht(e);break;case 13:Lt(n,e),Ht(e),p=e.child,p.flags&8192&&(f=p.memoizedState!==null,p.stateNode.isHidden=f,!f||p.alternate!==null&&p.alternate.memoizedState!==null||(cl=qe())),m&4&&Yu(e);break;case 22:if(V=i!==null&&i.memoizedState!==null,e.mode&1?(nt=($=nt)||V,Lt(n,e),nt=$):Lt(n,e),Ht(e),m&8192){if($=e.memoizedState!==null,(e.stateNode.isHidden=$)&&!V&&(e.mode&1)!==0)for(oe=e,V=e.child;V!==null;){for(X=oe=V;oe!==null;){switch(W=oe,se=W.child,W.tag){case 0:case 11:case 14:case 15:Rs(4,W,W.return);break;case 1:Tn(W,W.return);var le=W.stateNode;if(typeof le.componentWillUnmount=="function"){m=W,i=W.return;try{n=m,le.props=n.memoizedProps,le.state=n.memoizedState,le.componentWillUnmount()}catch(ce){Me(m,i,ce)}}break;case 5:Tn(W,W.return);break;case 22:if(W.memoizedState!==null){tm(X);continue}}se!==null?(se.return=W,oe=se):tm(X)}V=V.sibling}e:for(V=null,X=e;;){if(X.tag===5){if(V===null){V=X;try{p=X.stateNode,$?(f=p.style,typeof f.setProperty=="function"?f.setProperty("display","none","important"):f.display="none"):(N=X.stateNode,T=X.memoizedProps.style,w=T!=null&&T.hasOwnProperty("display")?T.display:null,N.style.display=Oc("display",w))}catch(ce){Me(e,e.return,ce)}}}else if(X.tag===6){if(V===null)try{X.stateNode.nodeValue=$?"":X.memoizedProps}catch(ce){Me(e,e.return,ce)}}else if((X.tag!==22&&X.tag!==23||X.memoizedState===null||X===e)&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===e)break e;for(;X.sibling===null;){if(X.return===null||X.return===e)break e;V===X&&(V=null),X=X.return}V===X&&(V=null),X.sibling.return=X.return,X=X.sibling}}break;case 19:Lt(n,e),Ht(e),m&4&&Yu(e);break;case 21:break;default:Lt(n,e),Ht(e)}}function Ht(e){var n=e.flags;if(n&2){try{e:{for(var i=e.return;i!==null;){if(Qu(i)){var m=i;break e}i=i.return}throw Error(r(160))}switch(m.tag){case 5:var p=m.stateNode;m.flags&32&&(Xn(p,""),m.flags&=-33);var f=Gu(e);il(e,f,p);break;case 3:case 4:var w=m.stateNode.containerInfo,N=Gu(e);al(e,N,w);break;default:throw Error(r(161))}}catch(T){Me(e,e.return,T)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Mf(e,n,i){oe=e,Zu(e)}function Zu(e,n,i){for(var m=(e.mode&1)!==0;oe!==null;){var p=oe,f=p.child;if(p.tag===22&&m){var w=p.memoizedState!==null||Fa;if(!w){var N=p.alternate,T=N!==null&&N.memoizedState!==null||nt;N=Fa;var $=nt;if(Fa=w,(nt=T)&&!$)for(oe=p;oe!==null;)w=oe,T=w.child,w.tag===22&&w.memoizedState!==null?rm(p):T!==null?(T.return=w,oe=T):rm(p);for(;f!==null;)oe=f,Zu(f),f=f.sibling;oe=p,Fa=N,nt=$}em(e)}else(p.subtreeFlags&8772)!==0&&f!==null?(f.return=p,oe=f):em(e)}}function em(e){for(;oe!==null;){var n=oe;if((n.flags&8772)!==0){var i=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:nt||za(5,n);break;case 1:var m=n.stateNode;if(n.flags&4&&!nt)if(i===null)m.componentDidMount();else{var p=n.elementType===n.type?i.memoizedProps:At(n.type,i.memoizedProps);m.componentDidUpdate(p,i.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var f=n.updateQueue;f!==null&&tu(n,f,m);break;case 3:var w=n.updateQueue;if(w!==null){if(i=null,n.child!==null)switch(n.child.tag){case 5:i=n.child.stateNode;break;case 1:i=n.child.stateNode}tu(n,w,i)}break;case 5:var N=n.stateNode;if(i===null&&n.flags&4){i=N;var T=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":T.autoFocus&&i.focus();break;case"img":T.src&&(i.src=T.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var $=n.alternate;if($!==null){var V=$.memoizedState;if(V!==null){var X=V.dehydrated;X!==null&&cs(X)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}nt||n.flags&512&&sl(n)}catch(W){Me(n,n.return,W)}}if(n===e){oe=null;break}if(i=n.sibling,i!==null){i.return=n.return,oe=i;break}oe=n.return}}function tm(e){for(;oe!==null;){var n=oe;if(n===e){oe=null;break}var i=n.sibling;if(i!==null){i.return=n.return,oe=i;break}oe=n.return}}function rm(e){for(;oe!==null;){var n=oe;try{switch(n.tag){case 0:case 11:case 15:var i=n.return;try{za(4,n)}catch(T){Me(n,i,T)}break;case 1:var m=n.stateNode;if(typeof m.componentDidMount=="function"){var p=n.return;try{m.componentDidMount()}catch(T){Me(n,p,T)}}var f=n.return;try{sl(n)}catch(T){Me(n,f,T)}break;case 5:var w=n.return;try{sl(n)}catch(T){Me(n,w,T)}}}catch(T){Me(n,n.return,T)}if(n===e){oe=null;break}var N=n.sibling;if(N!==null){N.return=n.return,oe=N;break}oe=n.return}}var $f=Math.ceil,Ha=L.ReactCurrentDispatcher,ol=L.ReactCurrentOwner,Ct=L.ReactCurrentBatchConfig,Ne=0,Qe=null,Ue=null,Ze=0,wt=0,Pn=fr(0),We=0,Ds=null,Hr=0,Wa=0,ll=0,Os=null,ut=null,cl=0,Rn=1/0,rr=null,Ka=!1,dl=null,wr=null,Va=!1,_r=null,Qa=0,As=0,ul=null,Ga=-1,Ja=0;function it(){return(Ne&6)!==0?qe():Ga!==-1?Ga:Ga=qe()}function kr(e){return(e.mode&1)===0?1:(Ne&2)!==0&&Ze!==0?Ze&-Ze:wf.transition!==null?(Ja===0&&(Ja=Gc()),Ja):(e=Ce,e!==0||(e=window.event,e=e===void 0?16:sd(e.type)),e)}function Mt(e,n,i,m){if(50<As)throw As=0,ul=null,Error(r(185));ss(e,i,m),((Ne&2)===0||e!==Qe)&&(e===Qe&&((Ne&2)===0&&(Wa|=i),We===4&&Er(e,Ze)),mt(e,m),i===1&&Ne===0&&(n.mode&1)===0&&(Rn=qe()+500,Ea&&yr()))}function mt(e,n){var i=e.callbackNode;bp(e,n);var m=aa(e,e===Qe?Ze:0);if(m===0)i!==null&&Kc(i),e.callbackNode=null,e.callbackPriority=0;else if(n=m&-m,e.callbackPriority!==n){if(i!=null&&Kc(i),n===1)e.tag===0?bf(sm.bind(null,e)):zd(sm.bind(null,e)),gf(function(){(Ne&6)===0&&yr()}),i=null;else{switch(Jc(m)){case 1:i=zi;break;case 4:i=Vc;break;case 16:i=ta;break;case 536870912:i=Qc;break;default:i=ta}i=mm(i,nm.bind(null,e))}e.callbackPriority=n,e.callbackNode=i}}function nm(e,n){if(Ga=-1,Ja=0,(Ne&6)!==0)throw Error(r(327));var i=e.callbackNode;if(Dn()&&e.callbackNode!==i)return null;var m=aa(e,e===Qe?Ze:0);if(m===0)return null;if((m&30)!==0||(m&e.expiredLanes)!==0||n)n=Ya(e,m);else{n=m;var p=Ne;Ne|=2;var f=im();(Qe!==e||Ze!==n)&&(rr=null,Rn=qe()+500,Kr(e,n));do try{Uf();break}catch(N){am(e,N)}while(!0);To(),Ha.current=f,Ne=p,Ue!==null?n=0:(Qe=null,Ze=0,n=We)}if(n!==0){if(n===2&&(p=Hi(e),p!==0&&(m=p,n=ml(e,p))),n===1)throw i=Ds,Kr(e,0),Er(e,m),mt(e,qe()),i;if(n===6)Er(e,m);else{if(p=e.current.alternate,(m&30)===0&&!qf(p)&&(n=Ya(e,m),n===2&&(f=Hi(e),f!==0&&(m=f,n=ml(e,f))),n===1))throw i=Ds,Kr(e,0),Er(e,m),mt(e,qe()),i;switch(e.finishedWork=p,e.finishedLanes=m,n){case 0:case 1:throw Error(r(345));case 2:Vr(e,ut,rr);break;case 3:if(Er(e,m),(m&130023424)===m&&(n=cl+500-qe(),10<n)){if(aa(e,0)!==0)break;if(p=e.suspendedLanes,(p&m)!==m){it(),e.pingedLanes|=e.suspendedLanes&p;break}e.timeoutHandle=xo(Vr.bind(null,e,ut,rr),n);break}Vr(e,ut,rr);break;case 4:if(Er(e,m),(m&4194240)===m)break;for(n=e.eventTimes,p=-1;0<m;){var w=31-Rt(m);f=1<<w,w=n[w],w>p&&(p=w),m&=~f}if(m=p,m=qe()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*$f(m/1960))-m,10<m){e.timeoutHandle=xo(Vr.bind(null,e,ut,rr),m);break}Vr(e,ut,rr);break;case 5:Vr(e,ut,rr);break;default:throw Error(r(329))}}}return mt(e,qe()),e.callbackNode===i?nm.bind(null,e):null}function ml(e,n){var i=Os;return e.current.memoizedState.isDehydrated&&(Kr(e,n).flags|=256),e=Ya(e,n),e!==2&&(n=ut,ut=i,n!==null&&hl(n)),e}function hl(e){ut===null?ut=e:ut.push.apply(ut,e)}function qf(e){for(var n=e;;){if(n.flags&16384){var i=n.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var m=0;m<i.length;m++){var p=i[m],f=p.getSnapshot;p=p.value;try{if(!Dt(f(),p))return!1}catch{return!1}}}if(i=n.child,n.subtreeFlags&16384&&i!==null)i.return=n,n=i;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Er(e,n){for(n&=~ll,n&=~Wa,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var i=31-Rt(n),m=1<<i;e[i]=-1,n&=~m}}function sm(e){if((Ne&6)!==0)throw Error(r(327));Dn();var n=aa(e,0);if((n&1)===0)return mt(e,qe()),null;var i=Ya(e,n);if(e.tag!==0&&i===2){var m=Hi(e);m!==0&&(n=m,i=ml(e,m))}if(i===1)throw i=Ds,Kr(e,0),Er(e,n),mt(e,qe()),i;if(i===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,Vr(e,ut,rr),mt(e,qe()),null}function pl(e,n){var i=Ne;Ne|=1;try{return e(n)}finally{Ne=i,Ne===0&&(Rn=qe()+500,Ea&&yr())}}function Wr(e){_r!==null&&_r.tag===0&&(Ne&6)===0&&Dn();var n=Ne;Ne|=1;var i=Ct.transition,m=Ce;try{if(Ct.transition=null,Ce=1,e)return e()}finally{Ce=m,Ct.transition=i,Ne=n,(Ne&6)===0&&yr()}}function fl(){wt=Pn.current,Oe(Pn)}function Kr(e,n){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,ff(i)),Ue!==null)for(i=Ue.return;i!==null;){var m=i;switch(Eo(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&_a();break;case 3:jn(),Oe(lt),Oe(et),Mo();break;case 5:Io(m);break;case 4:jn();break;case 13:Oe(Ie);break;case 19:Oe(Ie);break;case 10:Po(m.type._context);break;case 22:case 23:fl()}i=i.return}if(Qe=e,Ue=e=Sr(e.current,null),Ze=wt=n,We=0,Ds=null,ll=Wa=Hr=0,ut=Os=null,Ur!==null){for(n=0;n<Ur.length;n++)if(i=Ur[n],m=i.interleaved,m!==null){i.interleaved=null;var p=m.next,f=i.pending;if(f!==null){var w=f.next;f.next=p,m.next=w}i.pending=m}Ur=null}return e}function am(e,n){do{var i=Ue;try{if(To(),Aa.current=$a,Ia){for(var m=Le.memoizedState;m!==null;){var p=m.queue;p!==null&&(p.pending=null),m=m.next}Ia=!1}if(zr=0,Ve=He=Le=null,Ns=!1,js=0,ol.current=null,i===null||i.return===null){We=1,Ds=n,Ue=null;break}e:{var f=e,w=i.return,N=i,T=n;if(n=Ze,N.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){var $=T,V=N,X=V.tag;if((V.mode&1)===0&&(X===0||X===11||X===15)){var W=V.alternate;W?(V.updateQueue=W.updateQueue,V.memoizedState=W.memoizedState,V.lanes=W.lanes):(V.updateQueue=null,V.memoizedState=null)}var se=Pu(w);if(se!==null){se.flags&=-257,Ru(se,w,N,f,n),se.mode&1&&Tu(f,$,n),n=se,T=$;var le=n.updateQueue;if(le===null){var ce=new Set;ce.add(T),n.updateQueue=ce}else le.add(T);break e}else{if((n&1)===0){Tu(f,$,n),gl();break e}T=Error(r(426))}}else if(Ae&&N.mode&1){var Be=Pu(w);if(Be!==null){(Be.flags&65536)===0&&(Be.flags|=256),Ru(Be,w,N,f,n),jo(Cn(T,N));break e}}f=T=Cn(T,N),We!==4&&(We=2),Os===null?Os=[f]:Os.push(f),f=w;do{switch(f.tag){case 3:f.flags|=65536,n&=-n,f.lanes|=n;var O=ju(f,T,n);eu(f,O);break e;case 1:N=T;var P=f.type,I=f.stateNode;if((f.flags&128)===0&&(typeof P.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(wr===null||!wr.has(I)))){f.flags|=65536,n&=-n,f.lanes|=n;var ee=Cu(f,N,n);eu(f,ee);break e}}f=f.return}while(f!==null)}lm(i)}catch(de){n=de,Ue===i&&i!==null&&(Ue=i=i.return);continue}break}while(!0)}function im(){var e=Ha.current;return Ha.current=$a,e===null?$a:e}function gl(){(We===0||We===3||We===2)&&(We=4),Qe===null||(Hr&268435455)===0&&(Wa&268435455)===0||Er(Qe,Ze)}function Ya(e,n){var i=Ne;Ne|=2;var m=im();(Qe!==e||Ze!==n)&&(rr=null,Kr(e,n));do try{Bf();break}catch(p){am(e,p)}while(!0);if(To(),Ne=i,Ha.current=m,Ue!==null)throw Error(r(261));return Qe=null,Ze=0,We}function Bf(){for(;Ue!==null;)om(Ue)}function Uf(){for(;Ue!==null&&!up();)om(Ue)}function om(e){var n=um(e.alternate,e,wt);e.memoizedProps=e.pendingProps,n===null?lm(e):Ue=n,ol.current=null}function lm(e){var n=e;do{var i=n.alternate;if(e=n.return,(n.flags&32768)===0){if(i=Of(i,n,wt),i!==null){Ue=i;return}}else{if(i=Af(i,n),i!==null){i.flags&=32767,Ue=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{We=6,Ue=null;return}}if(n=n.sibling,n!==null){Ue=n;return}Ue=n=e}while(n!==null);We===0&&(We=5)}function Vr(e,n,i){var m=Ce,p=Ct.transition;try{Ct.transition=null,Ce=1,Ff(e,n,i,m)}finally{Ct.transition=p,Ce=m}return null}function Ff(e,n,i,m){do Dn();while(_r!==null);if((Ne&6)!==0)throw Error(r(327));i=e.finishedWork;var p=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var f=i.lanes|i.childLanes;if(wp(e,f),e===Qe&&(Ue=Qe=null,Ze=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||Va||(Va=!0,mm(ta,function(){return Dn(),null})),f=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||f){f=Ct.transition,Ct.transition=null;var w=Ce;Ce=1;var N=Ne;Ne|=4,ol.current=null,Lf(e,i),Xu(i,e),lf(go),la=!!fo,go=fo=null,e.current=i,Mf(i),mp(),Ne=N,Ce=w,Ct.transition=f}else e.current=i;if(Va&&(Va=!1,_r=e,Qa=p),f=e.pendingLanes,f===0&&(wr=null),fp(i.stateNode),mt(e,qe()),n!==null)for(m=e.onRecoverableError,i=0;i<n.length;i++)p=n[i],m(p.value,{componentStack:p.stack,digest:p.digest});if(Ka)throw Ka=!1,e=dl,dl=null,e;return(Qa&1)!==0&&e.tag!==0&&Dn(),f=e.pendingLanes,(f&1)!==0?e===ul?As++:(As=0,ul=e):As=0,yr(),null}function Dn(){if(_r!==null){var e=Jc(Qa),n=Ct.transition,i=Ce;try{if(Ct.transition=null,Ce=16>e?16:e,_r===null)var m=!1;else{if(e=_r,_r=null,Qa=0,(Ne&6)!==0)throw Error(r(331));var p=Ne;for(Ne|=4,oe=e.current;oe!==null;){var f=oe,w=f.child;if((oe.flags&16)!==0){var N=f.deletions;if(N!==null){for(var T=0;T<N.length;T++){var $=N[T];for(oe=$;oe!==null;){var V=oe;switch(V.tag){case 0:case 11:case 15:Rs(8,V,f)}var X=V.child;if(X!==null)X.return=V,oe=X;else for(;oe!==null;){V=oe;var W=V.sibling,se=V.return;if(Vu(V),V===$){oe=null;break}if(W!==null){W.return=se,oe=W;break}oe=se}}}var le=f.alternate;if(le!==null){var ce=le.child;if(ce!==null){le.child=null;do{var Be=ce.sibling;ce.sibling=null,ce=Be}while(ce!==null)}}oe=f}}if((f.subtreeFlags&2064)!==0&&w!==null)w.return=f,oe=w;else e:for(;oe!==null;){if(f=oe,(f.flags&2048)!==0)switch(f.tag){case 0:case 11:case 15:Rs(9,f,f.return)}var O=f.sibling;if(O!==null){O.return=f.return,oe=O;break e}oe=f.return}}var P=e.current;for(oe=P;oe!==null;){w=oe;var I=w.child;if((w.subtreeFlags&2064)!==0&&I!==null)I.return=w,oe=I;else e:for(w=P;oe!==null;){if(N=oe,(N.flags&2048)!==0)try{switch(N.tag){case 0:case 11:case 15:za(9,N)}}catch(de){Me(N,N.return,de)}if(N===w){oe=null;break e}var ee=N.sibling;if(ee!==null){ee.return=N.return,oe=ee;break e}oe=N.return}}if(Ne=p,yr(),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(ra,e)}catch{}m=!0}return m}finally{Ce=i,Ct.transition=n}}return!1}function cm(e,n,i){n=Cn(i,n),n=ju(e,n,1),e=vr(e,n,1),n=it(),e!==null&&(ss(e,1,n),mt(e,n))}function Me(e,n,i){if(e.tag===3)cm(e,e,i);else for(;n!==null;){if(n.tag===3){cm(n,e,i);break}else if(n.tag===1){var m=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(wr===null||!wr.has(m))){e=Cn(i,e),e=Cu(n,e,1),n=vr(n,e,1),e=it(),n!==null&&(ss(n,1,e),mt(n,e));break}}n=n.return}}function zf(e,n,i){var m=e.pingCache;m!==null&&m.delete(n),n=it(),e.pingedLanes|=e.suspendedLanes&i,Qe===e&&(Ze&i)===i&&(We===4||We===3&&(Ze&130023424)===Ze&&500>qe()-cl?Kr(e,0):ll|=i),mt(e,n)}function dm(e,n){n===0&&((e.mode&1)===0?n=1:(n=sa,sa<<=1,(sa&130023424)===0&&(sa=4194304)));var i=it();e=Zt(e,n),e!==null&&(ss(e,n,i),mt(e,i))}function Hf(e){var n=e.memoizedState,i=0;n!==null&&(i=n.retryLane),dm(e,i)}function Wf(e,n){var i=0;switch(e.tag){case 13:var m=e.stateNode,p=e.memoizedState;p!==null&&(i=p.retryLane);break;case 19:m=e.stateNode;break;default:throw Error(r(314))}m!==null&&m.delete(n),dm(e,i)}var um;um=function(e,n,i){if(e!==null)if(e.memoizedProps!==n.pendingProps||lt.current)dt=!0;else{if((e.lanes&i)===0&&(n.flags&128)===0)return dt=!1,Df(e,n,i);dt=(e.flags&131072)!==0}else dt=!1,Ae&&(n.flags&1048576)!==0&&Hd(n,Na,n.index);switch(n.lanes=0,n.tag){case 2:var m=n.type;Ua(e,n),e=n.pendingProps;var p=bn(n,et.current);Nn(n,i),p=Bo(null,n,m,e,p,i);var f=Uo();return n.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,ct(m)?(f=!0,ka(n)):f=!1,n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Oo(n),p.updater=qa,n.stateNode=p,p._reactInternals=n,Vo(n,m,e,i),n=Yo(null,n,m,!0,f,i)):(n.tag=0,Ae&&f&&ko(n),at(null,n,p,i),n=n.child),n;case 16:m=n.elementType;e:{switch(Ua(e,n),e=n.pendingProps,p=m._init,m=p(m._payload),n.type=m,p=n.tag=Vf(m),e=At(m,e),p){case 0:n=Jo(null,n,m,e,i);break e;case 1:n=Mu(null,n,m,e,i);break e;case 11:n=Du(null,n,m,e,i);break e;case 14:n=Ou(null,n,m,At(m.type,e),i);break e}throw Error(r(306,m,""))}return n;case 0:return m=n.type,p=n.pendingProps,p=n.elementType===m?p:At(m,p),Jo(e,n,m,p,i);case 1:return m=n.type,p=n.pendingProps,p=n.elementType===m?p:At(m,p),Mu(e,n,m,p,i);case 3:e:{if($u(n),e===null)throw Error(r(387));m=n.pendingProps,f=n.memoizedState,p=f.element,Zd(e,n),Da(n,m,null,i);var w=n.memoizedState;if(m=w.element,f.isDehydrated)if(f={element:m,isDehydrated:!1,cache:w.cache,pendingSuspenseBoundaries:w.pendingSuspenseBoundaries,transitions:w.transitions},n.updateQueue.baseState=f,n.memoizedState=f,n.flags&256){p=Cn(Error(r(423)),n),n=qu(e,n,m,i,p);break e}else if(m!==p){p=Cn(Error(r(424)),n),n=qu(e,n,m,i,p);break e}else for(bt=pr(n.stateNode.containerInfo.firstChild),vt=n,Ae=!0,Ot=null,i=Yd(n,null,m,i),n.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(kn(),m===p){n=tr(e,n,i);break e}at(e,n,m,i)}n=n.child}return n;case 5:return ru(n),e===null&&No(n),m=n.type,p=n.pendingProps,f=e!==null?e.memoizedProps:null,w=p.children,yo(m,p)?w=null:f!==null&&yo(m,f)&&(n.flags|=32),Lu(e,n),at(e,n,w,i),n.child;case 6:return e===null&&No(n),null;case 13:return Bu(e,n,i);case 4:return Ao(n,n.stateNode.containerInfo),m=n.pendingProps,e===null?n.child=En(n,null,m,i):at(e,n,m,i),n.child;case 11:return m=n.type,p=n.pendingProps,p=n.elementType===m?p:At(m,p),Du(e,n,m,p,i);case 7:return at(e,n,n.pendingProps,i),n.child;case 8:return at(e,n,n.pendingProps.children,i),n.child;case 12:return at(e,n,n.pendingProps.children,i),n.child;case 10:e:{if(m=n.type._context,p=n.pendingProps,f=n.memoizedProps,w=p.value,Pe(Ta,m._currentValue),m._currentValue=w,f!==null)if(Dt(f.value,w)){if(f.children===p.children&&!lt.current){n=tr(e,n,i);break e}}else for(f=n.child,f!==null&&(f.return=n);f!==null;){var N=f.dependencies;if(N!==null){w=f.child;for(var T=N.firstContext;T!==null;){if(T.context===m){if(f.tag===1){T=er(-1,i&-i),T.tag=2;var $=f.updateQueue;if($!==null){$=$.shared;var V=$.pending;V===null?T.next=T:(T.next=V.next,V.next=T),$.pending=T}}f.lanes|=i,T=f.alternate,T!==null&&(T.lanes|=i),Ro(f.return,i,n),N.lanes|=i;break}T=T.next}}else if(f.tag===10)w=f.type===n.type?null:f.child;else if(f.tag===18){if(w=f.return,w===null)throw Error(r(341));w.lanes|=i,N=w.alternate,N!==null&&(N.lanes|=i),Ro(w,i,n),w=f.sibling}else w=f.child;if(w!==null)w.return=f;else for(w=f;w!==null;){if(w===n){w=null;break}if(f=w.sibling,f!==null){f.return=w.return,w=f;break}w=w.return}f=w}at(e,n,p.children,i),n=n.child}return n;case 9:return p=n.type,m=n.pendingProps.children,Nn(n,i),p=Nt(p),m=m(p),n.flags|=1,at(e,n,m,i),n.child;case 14:return m=n.type,p=At(m,n.pendingProps),p=At(m.type,p),Ou(e,n,m,p,i);case 15:return Au(e,n,n.type,n.pendingProps,i);case 17:return m=n.type,p=n.pendingProps,p=n.elementType===m?p:At(m,p),Ua(e,n),n.tag=1,ct(m)?(e=!0,ka(n)):e=!1,Nn(n,i),Su(n,m,p),Vo(n,m,p,i),Yo(null,n,m,!0,e,i);case 19:return Fu(e,n,i);case 22:return Iu(e,n,i)}throw Error(r(156,n.tag))};function mm(e,n){return Wc(e,n)}function Kf(e,n,i,m){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tt(e,n,i,m){return new Kf(e,n,i,m)}function yl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Vf(e){if(typeof e=="function")return yl(e)?1:0;if(e!=null){if(e=e.$$typeof,e===K)return 11;if(e===z)return 14}return 2}function Sr(e,n){var i=e.alternate;return i===null?(i=Tt(e.tag,n,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=n,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,n=e.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Xa(e,n,i,m,p,f){var w=2;if(m=e,typeof e=="function")yl(e)&&(w=1);else if(typeof e=="string")w=5;else e:switch(e){case Q:return Qr(i.children,p,f,n);case me:w=8,p|=8;break;case ye:return e=Tt(12,i,n,p|2),e.elementType=ye,e.lanes=f,e;case Y:return e=Tt(13,i,n,p),e.elementType=Y,e.lanes=f,e;case B:return e=Tt(19,i,n,p),e.elementType=B,e.lanes=f,e;case re:return Za(i,p,f,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case J:w=10;break e;case ae:w=9;break e;case K:w=11;break e;case z:w=14;break e;case U:w=16,m=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return n=Tt(w,i,n,p),n.elementType=e,n.type=m,n.lanes=f,n}function Qr(e,n,i,m){return e=Tt(7,e,m,n),e.lanes=i,e}function Za(e,n,i,m){return e=Tt(22,e,m,n),e.elementType=re,e.lanes=i,e.stateNode={isHidden:!1},e}function xl(e,n,i){return e=Tt(6,e,null,n),e.lanes=i,e}function vl(e,n,i){return n=Tt(4,e.children!==null?e.children:[],e.key,n),n.lanes=i,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Qf(e,n,i,m,p){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wi(0),this.expirationTimes=Wi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wi(0),this.identifierPrefix=m,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function bl(e,n,i,m,p,f,w,N,T){return e=new Qf(e,n,i,N,T),n===1?(n=1,f===!0&&(n|=8)):n=0,f=Tt(3,null,null,n),e.current=f,f.stateNode=e,f.memoizedState={element:m,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oo(f),e}function Gf(e,n,i){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:q,key:m==null?null:""+m,children:e,containerInfo:n,implementation:i}}function hm(e){if(!e)return gr;e=e._reactInternals;e:{if(Lr(e)!==e||e.tag!==1)throw Error(r(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(ct(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(r(171))}if(e.tag===1){var i=e.type;if(ct(i))return Ud(e,i,n)}return n}function pm(e,n,i,m,p,f,w,N,T){return e=bl(i,m,!0,e,p,f,w,N,T),e.context=hm(null),i=e.current,m=it(),p=kr(i),f=er(m,p),f.callback=n??null,vr(i,f,p),e.current.lanes=p,ss(e,p,m),mt(e,m),e}function ei(e,n,i,m){var p=n.current,f=it(),w=kr(p);return i=hm(i),n.context===null?n.context=i:n.pendingContext=i,n=er(f,w),n.payload={element:e},m=m===void 0?null:m,m!==null&&(n.callback=m),e=vr(p,n,w),e!==null&&(Mt(e,p,w,f),Ra(e,p,w)),w}function ti(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function fm(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<n?i:n}}function wl(e,n){fm(e,n),(e=e.alternate)&&fm(e,n)}function Jf(){return null}var gm=typeof reportError=="function"?reportError:function(e){console.error(e)};function _l(e){this._internalRoot=e}ri.prototype.render=_l.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(r(409));ei(e,n,null,null)},ri.prototype.unmount=_l.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Wr(function(){ei(null,e,null,null)}),n[Gt]=null}};function ri(e){this._internalRoot=e}ri.prototype.unstable_scheduleHydration=function(e){if(e){var n=Zc();e={blockedOn:null,target:e,priority:n};for(var i=0;i<ur.length&&n!==0&&n<ur[i].priority;i++);ur.splice(i,0,e),i===0&&rd(e)}};function kl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ni(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ym(){}function Yf(e,n,i,m,p){if(p){if(typeof m=="function"){var f=m;m=function(){var $=ti(w);f.call($)}}var w=pm(n,m,e,0,null,!1,!1,"",ym);return e._reactRootContainer=w,e[Gt]=w.current,xs(e.nodeType===8?e.parentNode:e),Wr(),w}for(;p=e.lastChild;)e.removeChild(p);if(typeof m=="function"){var N=m;m=function(){var $=ti(T);N.call($)}}var T=bl(e,0,!1,null,null,!1,!1,"",ym);return e._reactRootContainer=T,e[Gt]=T.current,xs(e.nodeType===8?e.parentNode:e),Wr(function(){ei(n,T,i,m)}),T}function si(e,n,i,m,p){var f=i._reactRootContainer;if(f){var w=f;if(typeof p=="function"){var N=p;p=function(){var T=ti(w);N.call(T)}}ei(n,w,e,p)}else w=Yf(i,n,e,p,m);return ti(w)}Yc=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var i=ns(n.pendingLanes);i!==0&&(Ki(n,i|1),mt(n,qe()),(Ne&6)===0&&(Rn=qe()+500,yr()))}break;case 13:Wr(function(){var m=Zt(e,1);if(m!==null){var p=it();Mt(m,e,1,p)}}),wl(e,1)}},Vi=function(e){if(e.tag===13){var n=Zt(e,134217728);if(n!==null){var i=it();Mt(n,e,134217728,i)}wl(e,134217728)}},Xc=function(e){if(e.tag===13){var n=kr(e),i=Zt(e,n);if(i!==null){var m=it();Mt(i,e,n,m)}wl(e,n)}},Zc=function(){return Ce},ed=function(e,n){var i=Ce;try{return Ce=e,n()}finally{Ce=i}},qi=function(e,n,i){switch(n){case"input":if(Ri(e,i),n=i.name,i.type==="radio"&&n!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<i.length;n++){var m=i[n];if(m!==e&&m.form===e.form){var p=wa(m);if(!p)throw Error(r(90));on(m),Ri(m,p)}}}break;case"textarea":Tc(e,i);break;case"select":n=i.value,n!=null&&ln(e,!!i.multiple,n,!1)}},$c=pl,qc=Wr;var Xf={usingClientEntryPoint:!1,Events:[ws,xn,wa,Lc,Mc,pl]},Is={findFiberByHostInstance:Mr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Zf={bundleType:Is.bundleType,version:Is.version,rendererPackageName:Is.rendererPackageName,rendererConfig:Is.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=zc(e),e===null?null:e.stateNode},findFiberByHostInstance:Is.findFiberByHostInstance||Jf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ai=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ai.isDisabled&&ai.supportsFiber)try{ra=ai.inject(Zf),Bt=ai}catch{}}return ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xf,ht.createPortal=function(e,n){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kl(n))throw Error(r(200));return Gf(e,n,null,i)},ht.createRoot=function(e,n){if(!kl(e))throw Error(r(299));var i=!1,m="",p=gm;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(m=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),n=bl(e,1,!1,null,null,i,!1,m,p),e[Gt]=n.current,xs(e.nodeType===8?e.parentNode:e),new _l(n)},ht.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=zc(n),e=e===null?null:e.stateNode,e},ht.flushSync=function(e){return Wr(e)},ht.hydrate=function(e,n,i){if(!ni(n))throw Error(r(200));return si(null,e,n,!0,i)},ht.hydrateRoot=function(e,n,i){if(!kl(e))throw Error(r(405));var m=i!=null&&i.hydratedSources||null,p=!1,f="",w=gm;if(i!=null&&(i.unstable_strictMode===!0&&(p=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onRecoverableError!==void 0&&(w=i.onRecoverableError)),n=pm(n,null,e,1,i??null,p,!1,f,w),e[Gt]=n.current,xs(e),m)for(e=0;e<m.length;e++)i=m[e],p=i._getVersion,p=p(i._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[i,p]:n.mutableSourceEagerHydrationData.push(i,p);return new ri(n)},ht.render=function(e,n,i){if(!ni(n))throw Error(r(200));return si(null,e,n,!1,i)},ht.unmountComponentAtNode=function(e){if(!ni(e))throw Error(r(40));return e._reactRootContainer?(Wr(function(){si(null,null,e,!1,function(){e._reactRootContainer=null,e[Gt]=null})}),!0):!1},ht.unstable_batchedUpdates=pl,ht.unstable_renderSubtreeIntoContainer=function(e,n,i,m){if(!ni(i))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return si(e,n,i,!1,m)},ht.version="18.3.1-next-f1338f8080-20240426",ht}var km;function ig(){if(km)return Sl.exports;km=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(t){console.error(t)}}return a(),Sl.exports=ag(),Sl.exports}var Em;function og(){if(Em)return ii;Em=1;var a=ig();return ii.createRoot=a.createRoot,ii.hydrateRoot=a.hydrateRoot,ii}var lg=og();const cg=uc(lg),xe={DocumentTextIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})),RocketLaunchIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 01-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 006.16-12.12A14.98 14.98 0 009.63 2.18a14.98 14.98 0 00-2.18 6.16m5.84 2.58v-4.8m3.52 2.28l-2.24-2.24m-3.52 2.28l2.24-2.24m6.52-.72l-1.04-1.04a.75.75 0 00-1.06 0l-1.04 1.04a.75.75 0 000 1.06l1.04 1.04a.75.75 0 001.06 0l1.04-1.04a.75.75 0 000-1.06z"})),ChartPieIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6a7.5 7.5 0 107.5 7.5h-7.5V6z"}),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 10.5H21A7.5 7.5 0 0013.5 3v7.5z"})),QueueListIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"})),Cog8ToothIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-1.007 1.11-.994h2.593c.55 0 1.02.453 1.11.994l.217 1.313c.094.57.473 1.054.98 1.283l1.248.513c.518.213.941.695 1.043 1.258l.512 2.85c.102.563-.122 1.13-.58 1.486l-1.06.825c-.457.355-.758.91-.758 1.486v.512c0 .576.301 1.131.758 1.486l1.06.825c.458.356.682.923.58 1.486l-.512 2.85c-.102.563-.525 1.045-1.043 1.258l-1.248.513c-.507.229-.886.713-.98 1.283l-.217 1.313c-.09.542-.56 1.007-1.11.994h-2.593c-.55 0-1.02-.453-1.11-.994l-.217-1.313c-.094-.57-.473-1.054-.98-1.283l-1.248-.513c-.518-.213-.941-.695-1.043-1.258l-.512-2.85c-.102-.563.122-1.13.58-1.486l1.06-.825c.457-.355.758.91.758 1.486v-.512c0-.576-.301-1.131-.758-1.486l-1.06-.825c-.458-.356-.682-.923-.58-1.486l.512-2.85c.102-.563.525-1.045-1.043 1.258l1.248-.513c.507-.229.886-.713-.98-1.283l.217-1.313z"}),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})),UserCircleIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})),ChevronDownIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:a},c.createElement("path",{fillRule:"evenodd",d:"M5.22 8.22a.75.75 0 011.06 0L10 11.94l3.72-3.72a.75.75 0 111.06 1.06l-4.25 4.25a.75.75 0 01-1.06 0L5.22 9.28a.75.75 0 010-1.06z",clipRule:"evenodd"})),ChevronUpIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:a},c.createElement("path",{fillRule:"evenodd",d:"M14.77 11.78a.75.75 0 01-1.06 0L10 8.06l-3.72 3.72a.75.75 0 11-1.06-1.06l4.25-4.25a.75.75 0 011.06 0l4.25 4.25a.75.75 0 010 1.06z",clipRule:"evenodd"})),ChevronLeftIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})),XMarkIcon:({className:a="h-6 w-6"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})),MagnifyingGlassIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})),FunnelIcon:({className:a="h-4 w-4"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.572a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z"})),PencilIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})),TrashIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})),EllipsisHorizontalIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM12.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM18.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"})),ExclamationTriangleIcon:({className:a="h-6 w-6"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})),LockClosedIcon:({className:a="h-6 w-6"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"})),LockOpenIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H5.25a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25zm10.5-11.25h.008v.008h-.008V10.5z"})),ShieldCheckIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"})),ExclamationCircleIcon:({className:a="h-5 w-5"})=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))},Or={requestor:{id:"requestor",name:"Requestor",role:"Requestor",phone:"555-123-4567"},ac:{id:"ac",name:"Area Coordinator",role:"Area Coordinator"},qube:{id:"qube",name:"Qube User",role:"Qube User"},mc:{id:"mc",name:"Material Coordinator",role:"Material Coordinator"},mlc:{id:"mlc",name:"Logistics Coordinator",role:"Logistics Coordinator"},driver:{id:"driver",name:"Driver",role:"Driver"}},wh=(a,t,r)=>{let s=a;return t&&(s+=`, ${t}`),r&&(s+=`, Room ${r}`),s},Pt=[{id:"LOC001",building:"Admin Building",floor:"Ground Floor",room:"101",fullAddress:"Admin Building, Ground Floor, Room 101",contactPerson:"John Smith",contactPhone:"555-0101",deliveryInstructions:"Reception desk, sign in required",isActive:!0},{id:"LOC002",building:"Workshop A",floor:"Level 1",room:"Bay 3",fullAddress:"Workshop A, Level 1, Room Bay 3",contactPerson:"Sarah Johnson",contactPhone:"555-0102",deliveryInstructions:"Enter through loading dock, ask for supervisor",isActive:!0},{id:"LOC003",building:"Warehouse 1",floor:void 0,room:"Section A-3",fullAddress:"Warehouse 1, Room Section A-3",contactPerson:"Mike Davis",contactPhone:"555-0103",isActive:!0},{id:"LOC004",building:"Engineering Office",floor:"Level 2",room:"205",fullAddress:"Engineering Office, Level 2, Room 205",contactPerson:"Emily Chen",contactPhone:"555-0104",deliveryInstructions:"Use service elevator, card access required",isActive:!0},{id:"LOC005",building:"Maintenance Yard",floor:void 0,room:"Tool Crib",fullAddress:"Maintenance Yard, Room Tool Crib",contactPerson:"Tom Wilson",contactPhone:"555-0105",isActive:!0},{id:"LOC006",building:"Production Hall B",floor:"Ground Floor",room:"Station 12",fullAddress:"Production Hall B, Ground Floor, Room Station 12",contactPerson:"Lisa Martinez",contactPhone:"555-0106",deliveryInstructions:"Deliver during shift change (7am-8am or 3pm-4pm)",isActive:!0},{id:"LOC007",building:"Old Workshop",floor:void 0,room:void 0,fullAddress:"Old Workshop",contactPerson:void 0,contactPhone:void 0,deliveryInstructions:"No longer in use",isActive:!1}],dg=a=>{const t={id:`LOC${String(Pt.length+1).padStart(3,"0")}`,building:a.building||"",floor:a.floor,room:a.room,fullAddress:wh(a.building||"",a.floor,a.room),contactPerson:a.contactPerson,contactPhone:a.contactPhone,deliveryInstructions:a.deliveryInstructions,isActive:a.isActive!==!1};return Pt.push(t),t},Sm=(a,t)=>{const r=Pt.findIndex(s=>s.id===a);if(r!==-1)return Pt[r]={...Pt[r],...t,fullAddress:wh(t.building||Pt[r].building,t.floor!==void 0?t.floor:Pt[r].floor,t.room!==void 0?t.room:Pt[r].room)},Pt[r];throw new Error("Location not found")},ug=a=>{const t=Pt.findIndex(r=>r.id===a);t!==-1&&Pt.splice(t,1)},mg=a=>{const t=["A","B","C","D","X","Y","Z"],r=["Yard A","Yard B","Whse 1, A3","Whse 1, B7","Whse 2, D4","Stores"],s=[{jde:"PIPE-STL-10",desc:"10-inch Steel Pipe"},{jde:"VLV-GTE-10",desc:"10-inch Gate Valve"},{jde:"GSK-SPR-10",desc:"10-inch Gasket"},{jde:"WLD-ROD-7018",desc:"Welding Rod E7018"},{jde:"FLG-WN-10",desc:"10-inch Weld Neck Flange"},{jde:"BLT-STD-1",desc:"1-inch Stud Bolt Kit"},{jde:"RAG-WIP-BX",desc:"Box of Wiping Rags"},{jde:"PUMP-CNTR-5",desc:"5HP Centrifugal Pump"},{jde:"MTR-5HP-3PH",desc:"5HP 3-Phase Motor"},{jde:"CTRL-PNL-5HP",desc:"5HP Motor Control Panel"}],l=[];for(let d=0;d<a;d++){const u=s[d%s.length],h=12345+Math.floor(d/20),y=d%5===0&&d%10!==0?`PACK${String(Math.floor(d/5)).padStart(3,"0")}`:"N/A";l.push({pKey:`82267${String(1e4+d).padStart(5,"0")}`,workOrder:`WO${h}`,lineNumber:String(d%20+1).padStart(3,"0"),opsSeq:String(10*(d%4+1)),team:t[d%t.length],packNumber:y,storageLocation:r[d%r.length],jdeItemNo:u.jde,materialDescription:u.desc,workOrderQty:Math.floor(Math.random()*200)+1})}return l},sr=mg(1e3);let Rr={"8226710000":{mrfId:"MRF-1135",status:"Delivered"},"8226710002":{mrfId:"MRF-1136",status:"In Transit"},"8226710003":{mrfId:"MRF-1137",status:"Partial Pick - Open"}},gt={"8226710005":{lockedBy:"Steve",comment:"Reserved for critical path job on Friday"},"8226710006":{lockedBy:"Steve",comment:"Hold for hydrotest package"}},ne=[{id:"MRF-1240",status:"Submitted",priority:"P2",items:6,workOrders:"822671",createdDate:"07/13/2025",RequiredByTimestamp:"2025-07-14T08:00:00Z",MC_Priority_Flag:!1,DeliveryLocation:"Ops Center Trailer 1",requestorName:"Jane Doe",acPriority:3},{id:"MRF-1239",status:"Picking",priority:"P3",items:3,workOrders:"822671",createdDate:"07/13/2025",RequiredByTimestamp:"2025-07-14T10:00:00Z",MC_Priority_Flag:!1,DeliveryLocation:"Laydown Yard 7",requestorName:"Jane Doe",acPriority:null},{id:"MRF-1238",status:"In Transit",priority:"P2",items:8,workOrders:"822670",createdDate:"07/12/2025",RequiredByTimestamp:"2025-07-13T11:00:00Z",MC_Priority_Flag:!1,DeliveryLocation:"Weld Shop",requestorName:"John Smith",acPriority:null},{id:"MRF-1237",status:"Partial Pick - Closed",priority:"P4",items:1,workOrders:"844123",createdDate:"07/12/2025",RequiredByTimestamp:"2025-07-15T16:00:00Z",MC_Priority_Flag:!1,DeliveryLocation:"Unit 12 Work Area",requestorName:"Jane Doe",acPriority:null},{id:"MRF-1236",status:"Picking",priority:"P2",items:12,workOrders:"855798",createdDate:"07/12/2025",RequiredByTimestamp:"2025-07-13T09:00:00Z",MC_Priority_Flag:!1,DeliveryLocation:"Laydown Yard 7",requestorName:"Mike Jones",acPriority:null},{id:"MRF-1235",status:"In Transit",priority:"P3",items:4,workOrders:"855798",createdDate:"07/12/2025",RequiredByTimestamp:"2025-07-13T14:00:00Z",MC_Priority_Flag:!1,DeliveryLocation:"Ops Center Trailer 1",requestorName:"Jane Doe",acPriority:null},{id:"MRF-1234",status:"Submitted",priority:"P2",items:5,workOrders:"822670",createdDate:"07/10/2025",RequiredByTimestamp:"2025-07-13T16:00:00Z",MC_Priority_Flag:!1,DeliveryLocation:"Weld Shop",requestorName:"John Smith",acPriority:2},{id:"MRF-1232",status:"Submitted",priority:"P1",items:2,workOrders:"855798",createdDate:"07/12/2025",RequiredByTimestamp:"2025-07-13T08:00:00Z",MC_Priority_Flag:!0,DeliveryLocation:"Unit 12 Work Area",requestorName:"Jane Doe",acPriority:1},{id:"MRF-1198",status:"Delivered",priority:"P4",items:1,workOrders:"857330",createdDate:"07/13/2025",RequiredByTimestamp:"2025-06-13T16:00:00Z",MC_Priority_Flag:!1,DeliveryLocation:"Ops Center Trailer 1",requestorName:"Mike Jones",acPriority:null}],zs={"MRF-1240":[{pKey:"LI-001",status:"Open",qtyRequested:10,materialDescription:"10-inch Steel Pipe",itemNumber:"PIPE-STL-10",storageLocation:"Whse 1, A3",packNumber:"PACK001"},{pKey:"LI-002",status:"Open",qtyRequested:10,materialDescription:"10-inch Gate Valve",itemNumber:"VLV-GTE-10",storageLocation:"Whse 1, B7",packNumber:"PACK001"},{pKey:"LI-003",status:"Open",qtyRequested:20,materialDescription:"10-inch Gasket",itemNumber:"GSK-SPR-10",storageLocation:"Stores",packNumber:"PACK001"},{pKey:"LI-004",status:"Open",qtyRequested:50,materialDescription:"Welding Rod E7018",itemNumber:"WLD-ROD-7018",storageLocation:"Whse 2, D4",packNumber:"N/A"},{pKey:"LI-005",status:"Open",qtyRequested:5,materialDescription:"Box of Wiping Rags",itemNumber:"RAG-WIP-BX",storageLocation:"Stores",packNumber:"N/A"},{pKey:"LI-006",status:"Open",qtyRequested:2,materialDescription:"5HP Centrifugal Pump",itemNumber:"PUMP-CNTR-5",storageLocation:"Yard A",packNumber:"N/A"}],"MRF-1234":[{pKey:"LI-007",status:"Open",qtyRequested:1,materialDescription:"10-inch Weld Neck Flange",itemNumber:"FLG-WN-10",storageLocation:"Yard B",packNumber:"N/A"},{pKey:"LI-008",status:"Open",qtyRequested:8,materialDescription:"1-inch Stud Bolt Kit",itemNumber:"BLT-STD-1",storageLocation:"Stores",packNumber:"N/A"},{pKey:"LI-009",status:"Open",qtyRequested:1,materialDescription:"5HP 3-Phase Motor",itemNumber:"MTR-5HP-3PH",storageLocation:"Yard A",packNumber:"N/A"},{pKey:"LI-010",status:"Open",qtyRequested:1,materialDescription:"5HP Motor Control Panel",itemNumber:"CTRL-PNL-5HP",storageLocation:"Yard A",packNumber:"N/A"},{pKey:"LI-011",status:"Open",qtyRequested:12,materialDescription:"Welding Rod E7018",itemNumber:"WLD-ROD-7018",storageLocation:"Whse 2, D4",packNumber:"N/A"}],"MRF-1232":[{pKey:"LI-012",status:"Open",qtyRequested:4,materialDescription:"10-inch Gasket",itemNumber:"GSK-SPR-10",storageLocation:"Stores",packNumber:"N/A"},{pKey:"LI-013",status:"Open",qtyRequested:2,materialDescription:"Box of Wiping Rags",itemNumber:"RAG-WIP-BX",storageLocation:"Stores",packNumber:"N/A"}]};const hg=["Item Damaged","Quantity Mismatch","Location Empty","Wrong Item in Location","Quarantine","Other"],Nm={requestor:[{view:"wo-materials",label:"WO Materials",icon:"DocumentTextIcon"},{view:"material-requests",label:"Material Requests",icon:"RocketLaunchIcon"}],ac:[{view:"ac-scope-command",label:"My Scope Dashboard",icon:"ChartPieIcon"},{view:"wo-materials",label:"WO Materials",icon:"DocumentTextIcon"},{view:"material-requests",label:"Material Requests",icon:"RocketLaunchIcon"}],qube:[{view:"picklist",label:"Qube Pick List",icon:"QueueListIcon"},{view:"onhold",label:"On Hold",icon:"PauseCircleIcon"}],mc:[{view:"p1-approval",label:"P1 Approval Queue",icon:"FireIcon"},{view:"priority-queue",label:"Priority Queue",icon:"QueueListIcon"},{view:"workflow-diagram",label:"Workflow Diagram",icon:"DocumentTextIcon"},{view:"location-management",label:"Delivery Locations",icon:"MapPinIcon"},{view:"control-panel",label:"Control Panel",icon:"Cog8ToothIcon"},{view:"integrations",label:"Integrations",icon:"CloudIcon"}],mlc:[{view:"logistics-dispatcher",label:"Task Dispatcher",icon:"TruckIcon"},{view:"logistics-reports",label:"Reports & Analytics",icon:"ChartBarIcon"},{view:"logistics-config",label:"Configuration",icon:"Cog8ToothIcon"},{view:"material-requests",label:"Material Requests",icon:"RocketLaunchIcon"}],driver:[{view:"logistics-driver",label:"My Tasks",icon:"TruckIcon"}]},pg=({currentUser:a,onUserChange:t,currentView:r,onNavigate:s,navLinks:l})=>{const[d,u]=E.useState(!1),h=E.useRef(null);if(r==="picking")return null;E.useEffect(()=>{const g=v=>{h.current&&!h.current.contains(v.target)&&u(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[h]);const x=l[a.id]||[];return c.createElement("aside",{className:"w-64 flex-shrink-0 bg-white border-r border-gray-200 flex flex-col"},c.createElement("div",{className:"h-16 flex items-center justify-center border-b border-gray-200"},c.createElement("div",{className:"flex items-center space-x-2"},c.createElement("div",{className:"bg-red-500 p-2 rounded-lg"},c.createElement("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h6m-6 4h6m-6 4h6"}))),c.createElement("span",{className:"text-xl font-bold text-gray-800"},"Aufait UX"))),c.createElement("nav",{className:"flex-1 p-4 space-y-2"},x.map(g=>c.createElement("a",{href:"#",key:g.view,onClick:v=>{v.preventDefault(),s(g.view)},className:`flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 ${r===g.view?"bg-blue-100 text-blue-700 font-semibold":""}`},c.createElement(xe[g.icon],{className:"h-5 w-5 mr-3"}),g.label))),c.createElement("div",{ref:h,className:"p-4 border-t border-gray-200 relative"},d&&c.createElement("div",{className:"transition-all absolute bottom-full mb-2 w-full left-0 bg-white border border-gray-200 rounded-lg shadow-xl"},Object.values(Or).map(g=>c.createElement("a",{href:"#",key:g.id,onClick:v=>{v.preventDefault(),t(g),u(!1)},className:"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-100"},`Sign in as ${g.role}`))),c.createElement("button",{onClick:()=>u(!d),className:"w-full text-center px-4 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200"},"Switch User")))},fg={Requestor:["create_request","view_own_requests","edit_own_request","cancel_own_request","lock_material","unlock_own_lock"],"Area Coordinator":["create_request","view_own_requests","view_all_requests","edit_own_request","cancel_own_request","lock_material","unlock_own_lock","view_ac_dashboard","view_exception_dashboard","view_analytics","view_all_scope"],"Qube User":["view_all_requests","view_pick_list","start_picking","mark_picked","mark_short","stage_items","deliver_items","put_on_hold","resume_from_hold","split_request","unlock_any_lock","view_exception_dashboard"],"Material Coordinator":["create_request","view_own_requests","view_all_requests","edit_own_request","edit_any_request","cancel_own_request","cancel_any_request","delete_request","view_pick_list","start_picking","mark_picked","mark_short","stage_items","deliver_items","put_on_hold","resume_from_hold","approve_p1","reject_p1","force_status_change","reverse_status","lock_material","unlock_own_lock","unlock_any_lock","override_lock","split_request","merge_requests","modify_priority","modify_delivery_location","modify_required_date","view_ac_dashboard","view_exception_dashboard","view_p1_dashboard","view_analytics","view_all_scope","manage_users","manage_permissions","configure_system","view_audit_log","export_data","bulk_operations","bypass_validations","god_mode"]};function Hs(a,t){return!a||!a.role?!1:a.role==="Material Coordinator"?!0:(fg[a.role]||[]).includes(t)}function _h(a){return(a==null?void 0:a.role)==="Material Coordinator"}function gg(a,t){return a?!!(_h(a)||t.RequestedBy===a.name&&Hs(a,"cancel_own_request")||Hs(a,"cancel_any_request")):!1}function yg(){return`Material Coordinator (MC) God Mode:
• View and edit ALL requests, regardless of who created them
• Cancel or delete any request at any time
• Approve/reject P1 requests
• Force status changes and reverse statuses
• Unlock ANY material, regardless of who locked it
• Split, merge, and modify requests
• Change priorities, delivery locations, and dates
• Access all dashboards and analytics
• Manage users and system configuration
• Perform bulk operations
• Bypass all validation rules`}const xg=({user:a})=>{const[t,r]=E.useState(!1);return _h(a)?c.createElement("div",{className:"relative inline-block"},c.createElement("div",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-gradient-to-r from-purple-600 to-indigo-600 text-white text-xs font-bold rounded-full shadow-lg cursor-help",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1)},c.createElement(xe.ShieldCheckIcon,{className:"h-4 w-4"}),c.createElement("span",null,"GOD MODE")),t&&c.createElement("div",{className:"absolute z-50 left-0 top-full mt-2 w-80 bg-gray-900 text-white text-xs rounded-lg shadow-2xl p-4",style:{whiteSpace:"pre-line"}},c.createElement("div",{className:"font-bold text-sm mb-2 text-purple-300"},"🔓 Material Coordinator God Mode"),c.createElement("div",{className:"space-y-1 text-gray-300"},yg()))):null},jm="scm-hub-theme",Cm="dark";class vg{constructor(){this.currentTheme="auto",this.listeners=new Set,this.mediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.init()}init(){const t=localStorage.getItem(jm);t&&["light","dark","auto"].includes(t)?this.currentTheme=t:this.currentTheme="auto",this.applyTheme(),this.mediaQuery.addEventListener("change",()=>{this.currentTheme==="auto"&&this.applyTheme()}),console.log(`✅ Theme initialized: ${this.currentTheme} (resolved: ${this.getResolvedTheme()})`)}getTheme(){return this.currentTheme}getResolvedTheme(){return this.currentTheme==="auto"?this.mediaQuery.matches?"dark":"light":this.currentTheme}setTheme(t){this.currentTheme=t,localStorage.setItem(jm,t),this.applyTheme(),console.log(`Theme changed to: ${t} (resolved: ${this.getResolvedTheme()})`)}toggle(){const t=this.getResolvedTheme();this.setTheme(t==="light"?"dark":"light")}cycle(){const t=["light","dark","auto"],s=(t.indexOf(this.currentTheme)+1)%t.length;this.setTheme(t[s])}applyTheme(){const t=this.getResolvedTheme();t==="dark"?document.documentElement.classList.add(Cm):document.documentElement.classList.remove(Cm),this.listeners.forEach(r=>r(t)),this.updateMetaThemeColor(t)}updateMetaThemeColor(t){let r=document.querySelector('meta[name="theme-color"]');r||(r=document.createElement("meta"),r.setAttribute("name","theme-color"),document.head.appendChild(r));const s=t==="dark"?"#1f2937":"#ffffff";r.setAttribute("content",s)}subscribe(t){return this.listeners.add(t),()=>{this.listeners.delete(t)}}isDark(){return this.getResolvedTheme()==="dark"}isLight(){return this.getResolvedTheme()==="light"}}const Ls=new vg,bg=()=>{const[a,t]=E.useState(Ls.getTheme()),[r,s]=E.useState(Ls.getResolvedTheme());E.useEffect(()=>Ls.subscribe(y=>{s(y)}),[]);const l=()=>{Ls.cycle(),t(Ls.getTheme())},d=()=>{switch(a){case"light":return"☀️";case"dark":return"🌙";case"auto":return"🌓";default:return"☀️"}},u=()=>{switch(a){case"light":return"Light mode";case"dark":return"Dark mode";case"auto":return`Auto (${r})`;default:return"Theme"}};return c.createElement("button",{onClick:l,className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":`Switch theme. Currently: ${u()}`,title:`Click to cycle theme. Current: ${u()}`},[c.createElement("span",{key:"icon",className:"text-xl","aria-hidden":"true"},d()),c.createElement("span",{key:"label",className:"text-sm font-medium text-gray-700 dark:text-gray-300"},u())])},wg=({title:a,user:t,currentView:r})=>{const s=r==="picking";return c.createElement("header",{className:`h-16 bg-white border-b border-gray-200 flex items-center justify-between px-6 ${s?"hidden":""}`},c.createElement("h1",{className:"text-xl font-semibold text-gray-800"},a),c.createElement("div",{className:"flex items-center space-x-4"},c.createElement(bg,{}),c.createElement(xg,{user:t}),c.createElement("div",{className:"flex items-center space-x-3"},c.createElement(xe.UserCircleIcon,{className:"h-8 w-8 text-gray-600"}),c.createElement("div",{className:"text-sm text-left"},c.createElement("div",{className:"font-medium text-gray-800"},t.role)),c.createElement(xe.ChevronDownIcon,{className:"h-5 w-5 text-gray-400"}))))},oi={title:"Operations Hub",tagline:"Open your tools. Get work done.",quickActions:[{label:"Open MRF",icon:"clipboard-list",view:"wo-materials"},{label:"Create MRF",icon:"plus-square",view:"material-requests"},{label:"Admin",icon:"settings",view:"control-panel"},{label:"Status",icon:"activity",view:"exception-dashboard"}],apps:[{id:"mrf",name:"MRF App",tagline:"Request, pick, track. Fast.",view:"wo-materials",status:"live",icon:"clipboard-list",accent:"teal"},{id:"placeholders",name:"Placeholders",tagline:"Shared fields and templates.",view:"material-requests",status:"beta",icon:"brackets",accent:"slate"},{id:"toll",name:"Toll Task Request",tagline:"Delivery and collection tasks.",view:"logistics-dispatcher",status:"live",icon:"truck",accent:"amber"},{id:"tetra",name:"Tetra Radio Request",tagline:"Issue and track radios.",view:"picking",status:"beta",icon:"radio",accent:"violet"},{id:"fm",name:"Facility Maintenance",tagline:"Raise and monitor work orders.",view:"ac-scope-command",status:"planned",icon:"wrench",accent:"blue"},{id:"coates",name:"Coates Tooling",tagline:"Hire and return tooling.",view:"control-panel",status:"planned",icon:"tool",accent:"orange"},{id:"contacts",name:"Contacts",tagline:"People and vendors directory.",view:"exception-dashboard",status:"live",icon:"address-book",accent:"green"}]},_g=[{id:"requestor",role:"Requestor"},{id:"ac",role:"Area Coordinator"},{id:"qube",role:"Qube User"},{id:"mc",role:"Material Coordinator"}],Tm={"clipboard-list":"M9 12h6m-3-3v6m9-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z","plus-square":"M9 12h6m-3-3v6m9-6a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z",settings:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 0 0-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 0 0-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 0 0-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 0 0-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 0 0 1.066-2.573c-.94-1.543.826-3.31 2.37-2.37.94.572 2.153.098 2.572-1.065Z",activity:"M4.5 19.5l4.5-15 6 12 3-6 1.5 3",truck:"M2.25 15V5.25a.75.75 0 0 1 .75-.75h9a.75.75 0 0 1 .75.75V15m0 0H18m-5.25 0H6.75M18 15h1.003a.75.75 0 0 0 .641-.364l.641-1.068a.75.75 0 0 0 .099-.372V10.5a.75.75 0 0 0-.75-.75H15",radio:"M12 18v.008h.008V18H12Zm0 0v.008h.008V18H12Zm0-12A6 6 0 0 1 6 12m12 0a6 6 0 0 1-6 6m0-12a6 6 0 0 0-6 6m12 0a6 6 0 0 0-6 6m0-12V3m0 0 3-1.5M12 3 9 1.5",wrench:"m15.59 14.37 5.66 5.66a1.5 1.5 0 0 1-2.12 2.12l-5.66-5.66m2.12-7.78a3.75 3.75 0 1 1-5.3-5.3l3 3 3-3a3.75 3.75 0 0 1-.7 5.3Z",tool:"M14.74 9.34a4.25 4.25 0 0 0-5.09 5.34l-4.31 4.32a1.5 1.5 0 1 0 2.12 2.12l4.32-4.31a4.25 4.25 0 0 0 5.34-5.09l3.84-3.84a2.12 2.12 0 1 0-3-3l-3.84 3.84Z","address-book":"M5.25 4.5h10.5a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H5.25m0-15a.75.75 0 0 0-.75.75v13.5a.75.75 0 0 0 .75.75m0-15H4.5m0 0V6m0-1.5H3m1.5 0V3m5.25 4.5h1.5M9 9.75h3m-5.25 3h7.5a2.25 2.25 0 0 1 2.25 2.25V18",brackets:"M8.25 6.75 5.25 12l3 5.25M15.75 6.75 18.75 12l-3 5.25"},kg={live:"Live",beta:"Beta",planned:"Planned"},Eg={teal:"accent-teal",slate:"accent-slate",amber:"accent-amber",violet:"accent-violet",blue:"accent-blue",orange:"accent-orange",green:"accent-green"},Cl=a=>{const t=Tm[a]||Tm.activity;return c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24","aria-hidden":"true"},c.createElement("path",{d:t}))},Sg=({currentUser:a,onNavigate:t,onUserChange:r})=>{const[s,l]=E.useState(!1),[d,u]=E.useState(null),[h,y]=E.useState(""),[x,g]=E.useState(!1),[v,b]=E.useState(null),_=S=>{S.label==="Open MRF"?(l(!0),u(null)):t(S.view)},k=S=>{S.id==="mrf"?(l(!0),u(null)):S.id==="toll"?(g(!0),b(null)):t(S.view)},j=()=>{if(!d)return;const S=Or[d.id];if(!S){console.error("User not found:",d.id);return}try{localStorage.setItem("mrf_session_user",JSON.stringify(d))}catch(D){console.warn("Unable to persist user",D)}l(!1),r(S),t("wo-materials")},C=()=>{if(!v)return;const S=Or[v.id];if(!S){console.error("User not found:",v.id);return}try{localStorage.setItem("toll_session_user",JSON.stringify(v))}catch(D){console.warn("Unable to persist user",D)}g(!1),r(S),t("logistics-dispatcher")},A=_g.filter(S=>S.role.toLowerCase().includes(h.toLowerCase()));return c.createElement("div",{className:"operations-hub"},c.createElement("section",{className:"hero-section"},c.createElement("div",{className:"hero-content"},c.createElement("p",{className:"eyebrow"},"Operations suite"),c.createElement("h1",{className:"hero-title"},oi.title),c.createElement("p",{className:"hero-tagline"},oi.tagline),c.createElement("div",{className:"hero-actions"},c.createElement("button",{className:"cta-button",onClick:()=>l(!0)},c.createElement("span",{className:"cta-icon"},Cl("clipboard-list")),"Open MRF"),c.createElement("a",{className:"hero-link",href:"#quick-actions"},"Browse tools")))),c.createElement("section",{id:"quick-actions",className:"quick-actions-section"},c.createElement("h2",{className:"section-title"},"Quick actions"),c.createElement("div",{className:"quick-actions-grid"},oi.quickActions.map((S,D)=>c.createElement("button",{key:D,className:"quick-action-button",onClick:()=>_(S)},c.createElement("span",{className:"quick-action-icon"},Cl(S.icon)),S.label)))),c.createElement("section",{className:"apps-section"},c.createElement("div",{className:"section-header"},c.createElement("h2",{className:"section-title"},"Applications"),c.createElement("p",{className:"section-subtitle"},"Launch the app you need. Status updates are shown live.")),c.createElement("div",{className:"apps-grid"},oi.apps.map(S=>c.createElement("article",{key:S.id,className:`app-card ${Eg[S.accent]||""}`},c.createElement("div",{className:"app-header"},c.createElement("div",{className:"app-icon"},Cl(S.icon)),c.createElement("div",{className:"app-titles"},c.createElement("h3",{className:"app-name"},S.name),c.createElement("p",{className:"app-tagline"},S.tagline)),c.createElement("span",{className:`status-pill ${S.status}`},kg[S.status])),c.createElement("div",{className:"app-footer"},c.createElement("div",{className:"app-actions"},c.createElement("button",{className:"btn-primary",onClick:()=>k(S)},"Open"))))))),s&&c.createElement("div",{className:"modal-overlay",onClick:S=>S.target===S.currentTarget&&l(!1)},c.createElement("div",{className:"modal-panel"},c.createElement("header",{className:"modal-header"},c.createElement("h2",null,"Select user"),c.createElement("p",{className:"modal-subtitle"},"Choose your user context for the MRF app.")),c.createElement("div",{className:"modal-body"},c.createElement("div",{className:"modal-search"},c.createElement("input",{type:"search",placeholder:"Search users…",value:h,onChange:S=>y(S.target.value)})),c.createElement("ul",{className:"user-list"},A.map(S=>c.createElement("li",{key:S.id,className:`user-item ${(d==null?void 0:d.id)===S.id?"selected":""}`,onClick:()=>u(S)},c.createElement("div",{className:"user-info"},c.createElement("p",{className:"user-name"},S.role)))))),c.createElement("footer",{className:"modal-footer"},c.createElement("button",{className:"btn-secondary",onClick:()=>l(!1)},"Cancel"),c.createElement("button",{className:"btn-primary",disabled:!d,onClick:j},"Continue")))),x&&c.createElement("div",{className:"modal-overlay",onClick:S=>S.target===S.currentTarget&&g(!1)},c.createElement("div",{className:"modal-panel"},c.createElement("header",{className:"modal-header"},c.createElement("h2",null,"Select user"),c.createElement("p",{className:"modal-subtitle"},"Choose your user context for the Toll Task Request app.")),c.createElement("div",{className:"modal-body"},c.createElement("div",{className:"modal-search"},c.createElement("input",{type:"search",placeholder:"Search users…",value:h,onChange:S=>y(S.target.value)})),c.createElement("ul",{className:"user-list"},A.map(S=>c.createElement("li",{key:S.id,className:`user-item ${(v==null?void 0:v.id)===S.id?"selected":""}`,onClick:()=>b(S)},c.createElement("div",{className:"user-info"},c.createElement("p",{className:"user-name"},S.role)))))),c.createElement("footer",{className:"modal-footer"},c.createElement("button",{className:"btn-secondary",onClick:()=>g(!1)},"Cancel"),c.createElement("button",{className:"btn-primary",disabled:!v,onClick:C},"Continue")))))},kt=({status:a,lockInfo:t})=>{const r={Delivered:"bg-green-100 text-green-800","In Transit":"bg-blue-100 text-blue-800",Exception:"bg-red-100 text-red-800","Partial Pick - Open":"bg-orange-100 text-orange-800","Partial Pick - Closed":"bg-red-200 text-red-900",Short:"bg-red-100 text-red-800","Not Requested":"bg-gray-100 text-gray-500",Picking:"bg-yellow-100 text-yellow-800","Ready for Collection":"bg-purple-100 text-purple-800",Staged:"bg-purple-100 text-purple-800",Submitted:"bg-cyan-100 text-cyan-800","Pending Approval":"bg-yellow-100 text-yellow-800",Approved:"bg-emerald-100 text-emerald-800","On Hold":"bg-gray-300 text-gray-900",Cancelled:"bg-gray-400 text-gray-700",Open:"bg-gray-200 text-gray-700",Picked:"bg-green-200 text-green-900",Locked:"bg-gray-200 text-gray-800 font-semibold"},s={Picked:c.createElement("span",{className:"mr-1.5"},"✔️"),Exception:c.createElement("span",{className:"mr-1.5"},"⚠️"),"Partial Pick - Open":c.createElement("span",{className:"mr-1.5"},"🟠"),"Partial Pick - Closed":c.createElement("span",{className:"mr-1.5"},"🔴"),Short:c.createElement("span",{className:"mr-1.5"},"⚠️"),Staged:c.createElement("span",{className:"mr-1.5"},"✅"),"Pending Approval":c.createElement("span",{className:"mr-1.5"},"⏳"),Approved:c.createElement("span",{className:"mr-1.5"},"✔️"),"On Hold":c.createElement("span",{className:"mr-1.5"},"⏸️"),Cancelled:c.createElement("span",{className:"mr-1.5"},"❌"),Locked:c.createElement(xe.LockClosedIcon,{className:"h-4 w-4 mr-1.5"})},l=t?"Locked":a;return c.createElement("span",{className:`px-2 py-1 text-xs font-medium rounded-full inline-flex items-center ${r[l]||"bg-gray-200 text-gray-800"}`,title:t?`Locked by ${t.lockedBy}: ${t.comment}`:""},s[l],l)},Pm=({request:a,isOpen:t,onClose:r,currentUser:s})=>{if(!a)return null;const l=a.status==="Delivered",d=a.status==="Submitted";return c.createElement("div",{className:`fixed top-0 right-0 h-full bg-white shadow-2xl z-50 w-full max-w-md transition-all ${t?"transform-translate-x-0":"transform-translate-x-full"}`},c.createElement("div",{className:"p-6 border-b flex items-center justify-between"},c.createElement("div",null,c.createElement("h2",{className:"text-lg font-bold text-gray-900"},`Details for ${a.id}`),c.createElement(kt,{status:a.status})),c.createElement("button",{onClick:r,className:"text-gray-500 hover:text-gray-800"},c.createElement(xe.XMarkIcon,null))),c.createElement("div",{className:"p-4 border-b"},d&&c.createElement("div",{className:"flex items-center space-x-2"},c.createElement("button",{className:"flex items-center space-x-2 w-full justify-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},c.createElement(xe.PencilIcon,null),c.createElement("span",null,"Edit Request")),c.createElement("button",{className:"flex items-center space-x-2 w-full justify-center px-4 py-2 text-sm font-medium text-red-700 bg-red-50 border border-red-200 rounded-md hover:bg-red-100"},c.createElement(xe.TrashIcon,null),c.createElement("span",null,"Delete Request")))),c.createElement("div",{className:"p-6 overflow-y-auto h-[calc(100vh-145px)]"},c.createElement("div",{className:"space-y-6"},s.role==="Area Coordinator"&&!l&&c.createElement("div",null,c.createElement("h3",{className:"font-semibold text-gray-700 mb-2"},"AC Actions"),c.createElement("div",{className:"p-4 border rounded-lg bg-amber-50 border-amber-200"},c.createElement("label",{htmlFor:"ac-comment",className:"block text-sm font-medium text-gray-800 mb-1"},"Add Comment / Escalate"),c.createElement("textarea",{id:"ac-comment",rows:4,placeholder:"Type your comment here. Use @MC to notify Material Coordinator...",className:"w-full px-3 py-2 border rounded-md text-sm border-amber-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400"}),c.createElement("button",{onClick:()=>alert("Comment submitted! Material Coordinator has been notified."),className:"mt-2 w-full px-4 py-2 text-sm font-medium text-white bg-amber-500 border border-transparent rounded-md hover:bg-amber-600"},"Submit Comment"))),c.createElement("div",null,c.createElement("h3",{className:"font-semibold text-gray-700 mb-2"},"Delivery Details"),c.createElement("p",{className:"text-sm text-gray-600"},"Mock delivery details would appear here.")),c.createElement("div",null,c.createElement("h3",{className:"font-semibold text-gray-700 mb-2"},"Line Items"),c.createElement("p",{className:"text-sm text-gray-600"},"A list of line items for this request would appear here.")),l&&c.createElement("div",null,c.createElement("h3",{className:"font-semibold text-gray-700 mb-2"},"Delivery & POD Information"),c.createElement("div",{className:"space-y-4"},c.createElement("div",{className:"p-4 border rounded-lg bg-gray-50"},c.createElement("p",{className:"text-xs font-medium text-gray-500"},"SIGNATURE"),c.createElement("p",{className:"font-serif text-2xl text-gray-800 italic"},"Jane Doe")),c.createElement("div",{className:"p-4 border rounded-lg bg-gray-50"},c.createElement("p",{className:"text-xs font-medium text-gray-500 mb-2"},"PHOTO"),c.createElement("div",{className:"w-full h-32 bg-gray-300 rounded flex items-center justify-center text-gray-500"},"POD Photo Placeholder")))),c.createElement("div",null,c.createElement("h3",{className:"font-semibold text-gray-700 mb-2"},"History & Comments"),c.createElement("p",{className:"text-sm text-gray-600"},"A timeline of events and comments would appear here.")))))},Qs=({isOpen:a,anchorEl:t,onClose:r,children:s,className:l=""})=>{const d=E.useRef(null);if(E.useEffect(()=>{const y=x=>{d.current&&!d.current.contains(x.target)&&t&&!t.contains(x.target)&&r()};return a&&document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[a,r,t]),!a||!t)return null;const u=t.getBoundingClientRect(),h={position:"absolute",top:`${u.bottom+window.scrollY+5}px`,left:`${u.left+window.scrollX}px`};return c.createElement("div",{ref:d,style:h,onClick:y=>y.stopPropagation(),className:`bg-white border border-gray-300 rounded-lg shadow-xl z-20 ${l}`},s)},Ng=({isOpen:a,anchorEl:t,onClose:r,onApplyFilter:s,onClearFilter:l,onSort:d,columnKey:u,data:h,currentFilter:y})=>{const[x,g]=E.useState(""),v=E.useMemo(()=>{if(!u)return[];const L=new Set(h.map(M=>M[u]));return Array.from(L).sort((M,q)=>String(M).localeCompare(String(q)))},[h,u]),[b,_]=E.useState(new Set(y||v));if(E.useEffect(()=>{a&&(!y||y.size===0?_(new Set(v)):_(new Set(y)))},[a,v,y]),!a||!u)return null;const k=v.filter(L=>String(L).toLowerCase().includes(x.toLowerCase())),j=L=>{_(L?new Set(v):new Set)},C=(L,M)=>{const q=new Set(b);M?q.add(L):q.delete(L),_(q)},A=()=>{s(u,new Set(b)),r()},S=()=>{l(u),r()},D=b.size===v.length&&v.length>0;return c.createElement(Qs,{isOpen:a,anchorEl:t,onClose:r,className:"flex flex-col min-w-[250px]"},c.createElement("div",{className:"p-2 border-b"},c.createElement("button",{onClick:()=>{d(u,"asc"),r()},className:"w-full text-left px-2 py-1.5 text-sm hover:bg-gray-100 rounded"},"Sort A to Z"),c.createElement("button",{onClick:()=>{d(u,"desc"),r()},className:"w-full text-left px-2 py-1.5 text-sm hover:bg-gray-100 rounded"},"Sort Z to A")),c.createElement("div",{className:"p-2 border-b"},c.createElement("input",{type:"text",placeholder:"(Search)",value:x,onChange:L=>g(L.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm"})),c.createElement("div",{className:"p-2 border-b max-h-60 overflow-y-auto"},c.createElement("label",{className:"flex items-center space-x-2 px-2 py-1"},c.createElement("input",{type:"checkbox",checked:D,onChange:L=>j(L.target.checked)}),c.createElement("span",{className:"text-sm font-semibold"},"(Select All)")),k.map(L=>c.createElement("label",{key:L,className:"flex items-center space-x-2 px-2 py-1"},c.createElement("input",{type:"checkbox",value:L,checked:b.has(L),onChange:M=>C(L,M.target.checked)}),c.createElement("span",{className:"text-sm"},L)))),c.createElement("div",{className:"flex justify-end space-x-2 p-2 bg-gray-50"},c.createElement("button",{onClick:S,className:"px-4 py-1.5 text-sm text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-100"},"Clear"),c.createElement("button",{onClick:A,className:"px-4 py-1.5 text-sm text-white bg-blue-600 rounded-md hover:bg-blue-700"},"Apply")))},jg=({isOpen:a,anchorEl:t,onClose:r,allColumns:s,columnVisibility:l,setColumnVisibility:d})=>a?c.createElement(Qs,{isOpen:a,anchorEl:t,onClose:r,className:"p-2 min-w-[200px]"},c.createElement("p",{className:"px-2 py-1 text-xs font-semibold text-gray-500"},"Show/Hide Columns"),c.createElement("div",{className:"mt-1"},s.map(u=>c.createElement("label",{key:u.accessorKey,className:"flex items-center space-x-2 px-2 py-1.5 hover:bg-gray-100 rounded"},c.createElement("input",{type:"checkbox",checked:l[u.accessorKey]!==!1,onChange:h=>d(y=>({...y,[u.accessorKey]:h.target.checked}))}),c.createElement("span",{className:"text-sm text-gray-700"},u.header))))):null,li=20,Ar=({data:a,columns:t,uniqueId:r,enableSelection:s=!1,onSelectionChange:l=()=>{},isLoading:d=!1,onLoadMore:u=()=>{},totalDataCount:h=0,initialRowSelection:y={}})=>{const[x,g]=E.useState({key:null,direction:null}),[v,b]=E.useState({}),[_,k]=E.useState(y),[j,C]=E.useState({}),[A,S]=E.useState(null),[D,L]=E.useState(null),[M,q]=E.useState(!1),[Q,me]=E.useState(null),[ye,J]=E.useState(li),ae=E.useRef(null),K=E.useRef(null),Y=`smart-table-cols-${r}`;E.useEffect(()=>{const Z=localStorage.getItem(Y);Z&&C(JSON.parse(Z))},[Y]),E.useEffect(()=>{localStorage.setItem(Y,JSON.stringify(j))},[j,Y]),E.useEffect(()=>{l(_)},[_,l]),E.useEffect(()=>{k(y)},[y]);const B=E.useMemo(()=>(s?[{accessorKey:"selection",header:"Select"},...t]:t).filter(ie=>j[ie.accessorKey]!==!1),[t,s,j]),z=E.useMemo(()=>{let Z=[...a];return Object.keys(v).length>0&&(Z=Z.filter(ie=>Object.entries(v).every(([ue,_e])=>{const Ee=_e;return!Ee||Ee.size===0?!0:Ee.has(ie[ue])}))),Z},[a,v]),U=E.useMemo(()=>{if(!x.key)return z;const Z=[...z];return Z.sort((ie,ue)=>{const _e=ie[x.key],Ee=ue[x.key],$e=x.direction==="asc"?1:-1;return _e==null?1*$e:Ee==null?-1*$e:typeof _e=="number"&&typeof Ee=="number"?(_e-Ee)*$e:String(_e).localeCompare(String(Ee))*$e}),Z},[z,x]),re=E.useCallback(Z=>a.filter(ie=>Object.entries(v).every(([ue,_e])=>{if(ue===Z)return!0;const Ee=_e;return!Ee||Ee.size===0?!0:Ee.has(ie[ue])})),[a,v]);E.useEffect(()=>{const Z=new IntersectionObserver(ie=>{if(ie[0].isIntersecting&&!d&&u){const ue=Math.min(ye+li,U.length);ue>ye?J(ue):U.length<h&&u()}},{threshold:1});return ae.current&&u&&Z.observe(ae.current),()=>{ae.current&&Z.unobserve(ae.current)}},[d,u,U.length,h,ye]);const G=(Z,ie)=>{Z.stopPropagation(),A===ie?(S(null),L(null)):(S(ie),L(Z.currentTarget))},H=(Z,ie)=>{b(ue=>({...ue,[Z]:ie})),J(li),K.current&&(K.current.scrollTop=0)},te=Z=>{b(ie=>{const ue={...ie};return delete ue[Z],ue}),J(li),K.current&&(K.current.scrollTop=0)},R=(Z,ie)=>g({key:Z,direction:ie}),F=Z=>{const ie={};Z&&U.forEach(ue=>{ue.isDisabled||(ie[ue[r]]=!0)}),k(ie)},ve=U.length>0&&U.every(Z=>Z.isDisabled||_[Z[r]]),we=u?U.slice(0,ye):U;return c.createElement(c.Fragment,null,c.createElement(Ng,{isOpen:!!A,anchorEl:D,onClose:()=>S(null),onApplyFilter:H,onClearFilter:te,onSort:R,columnKey:A,data:A?re(A):[],currentFilter:v[A]}),c.createElement(jg,{isOpen:M,anchorEl:Q,onClose:()=>q(!1),allColumns:t.filter(Z=>Z.accessorKey!=="actions"),columnVisibility:j,setColumnVisibility:C}),c.createElement("div",{className:"bg-white rounded-xl border border-gray-200"},c.createElement("div",{className:"p-4 border-b flex items-center justify-between"},c.createElement("p",{className:"text-sm text-gray-500"},`Showing ${we.length} of ${U.length} records.`),c.createElement("div",{className:"flex items-center space-x-2"},c.createElement("button",{onClick:Z=>{q(!0),me(Z.currentTarget)},className:"px-3 py-1.5 text-sm text-gray-600 border bg-white rounded-md hover:bg-gray-50"},"Columns▾"))),c.createElement("div",{ref:K,className:"overflow-auto"},c.createElement("table",{className:"min-w-full divide-y divide-gray-200 text-sm"},c.createElement("thead",{className:"bg-gray-50 sticky top-0 z-10"},c.createElement("tr",null,B.map(Z=>{if(Z.accessorKey==="selection")return c.createElement("th",{key:"selection",className:"px-4 py-3 w-12"},c.createElement("input",{type:"checkbox",checked:ve,onChange:ue=>F(ue.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}));const ie=v[Z.accessorKey]&&v[Z.accessorKey].size>0;return c.createElement("th",{key:Z.accessorKey,className:"px-4 py-3 text-left font-medium text-gray-500 uppercase tracking-wider group"},c.createElement("div",{className:"flex items-center space-x-1"},c.createElement("span",null,Z.header),Z.enableFiltering!==!1&&c.createElement("button",{onClick:ue=>G(ue,Z.accessorKey),className:`transition-opacity text-gray-400 hover:text-gray-700 opacity-0 group-hover:opacity-100 focus:opacity-100 ${ie?"text-blue-600 opacity-100":""}`},ie?c.createElement(xe.FunnelIcon,{}):c.createElement(xe.ChevronDownIcon,{className:"h-4 w-4"}))))}))),c.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},we.map(Z=>{const ie={key:Z[r],className:`${_[Z[r]]?"bg-blue-50":""} ${Z.onClick?"hover:bg-gray-50 cursor-pointer":""}`,onClick:Z.onClick?()=>Z.onClick(Z):void 0};return c.createElement("tr",ie,...B.map(ue=>{if(ue.accessorKey==="selection")return c.createElement("td",{key:"selection-cell",className:"px-4 py-4"},c.createElement("input",{type:"checkbox",checked:!!_[Z[r]],onChange:Ee=>{const $e=Z[r];k(an=>{const on={...an};return Ee.target.checked?on[$e]=!0:delete on[$e],on})},disabled:Z.isDisabled,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 disabled:bg-gray-200 disabled:cursor-not-allowed"}));const _e=Z[ue.accessorKey];return c.createElement("td",{key:ue.accessorKey,className:"px-4 py-4 text-gray-600 whitespace-nowrap"},ue.cell?ue.cell({row:Z,value:_e}):_e)}))})))),u&&(d||ye<U.length)&&c.createElement("div",{ref:ae,className:"p-4 text-center text-gray-500"},"Loading more items...")))},Ni=({message:a,onClose:t,type:r="success"})=>{E.useEffect(()=>{const d=setTimeout(t,5e3);return()=>clearTimeout(d)},[t]);const l={success:{borderColor:"border-green-500",icon:"✅"},error:{borderColor:"border-red-500",icon:"🔥"}}[r];return c.createElement("div",{className:"fixed top-6 right-6 z-50"},c.createElement("div",{className:`bg-white border-l-4 ${l.borderColor} rounded-lg shadow-lg p-4 flex items-center`},c.createElement("span",{className:"text-2xl mr-3"},l.icon),c.createElement("p",{className:"text-gray-700"},a),c.createElement("button",{onClick:t,className:"ml-4 text-gray-400 hover:text-gray-600"},c.createElement(xe.XMarkIcon,{className:"h-5 w-5"}))))},Cg=({selectedCount:a,onReview:t,selectedItems:r})=>{const[s,l]=E.useState(!1);if(a===0)return null;const d=r.slice(0,10).map(u=>({pKey:u.pKey,jde:u.jdeItemNo,desc:u.materialDescription}));return c.createElement("div",{className:"fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-4xl z-30 px-4"},c.createElement("div",{className:"bg-gray-800 text-white rounded-t-lg shadow-2xl flex flex-col"},c.createElement("div",{className:"p-4 flex items-center justify-between"},c.createElement("div",{className:"flex items-center"},c.createElement("p",{className:"font-bold text-lg"},`${a} Line${a>1?"s":""} Selected`),c.createElement("button",{onClick:()=>l(!s),className:"text-gray-400 hover:text-white ml-3 p-1 rounded-full hover:bg-gray-700","aria-label":"Toggle selection summary"},c.createElement(s?xe.ChevronDownIcon:xe.ChevronUpIcon,{}))),c.createElement("button",{onClick:t,className:"px-5 py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold text-white text-sm"},"Review & Add Details →")),s&&c.createElement("div",{className:"bg-gray-700 p-4 border-t border-gray-600 max-h-40 overflow-y-auto"},c.createElement("p",{className:"text-xs text-gray-300 font-semibold mb-2"},"QUICK SUMMARY:"),c.createElement("ul",{className:"space-y-1 text-gray-400 text-xs font-mono"},d.map(u=>c.createElement("li",{key:u.pKey,className:"truncate"},`${u.jde} - ${u.desc}`)),a>10&&c.createElement("li",{},`...and ${a-10} more`)))))},Tg={requireP1Approval:!0};function Pg(a){return Tg[a]===!0}const Rg=a=>{const t=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(", "),r=a.querySelectorAll(t),s=r[0],l=r[r.length-1],d=u=>{u.key==="Tab"&&(u.shiftKey?document.activeElement===s&&(u.preventDefault(),l==null||l.focus()):document.activeElement===l&&(u.preventDefault(),s==null||s.focus()))};return a.addEventListener("keydown",d),s==null||s.focus(),()=>{a.removeEventListener("keydown",d)}},Dg=a=>{const t=r=>{r.key==="Escape"&&(r.preventDefault(),a())};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},Og={modal:(a,t)=>({role:"dialog","aria-modal":"true","aria-hidden":!a,"aria-labelledby":t}),button:(a,t,r)=>({"aria-label":a,...t!==void 0&&{"aria-pressed":t},...r!==void 0&&{"aria-expanded":r}}),checkbox:(a,t)=>({role:"checkbox","aria-label":a,"aria-checked":t}),tab:(a,t,r)=>({role:"tab","aria-label":a,"aria-selected":t,"aria-controls":r,tabIndex:t?0:-1}),tabPanel:a=>({role:"tabpanel","aria-labelledby":a,tabIndex:0}),list:()=>({role:"list"}),listItem:(a,t)=>({role:"listitem","aria-setsize":t,"aria-posinset":a+1}),alert:a=>({role:"alert","aria-live":a==="error"?"assertive":"polite"})};let Ag=0;const Ig=(a="id")=>`${a}-${Date.now()}-${++Ag}`,Lg=()=>{const a=document.createElement("a");return a.href="#main-content",a.textContent="Skip to main content",a.className="sr-only sr-only-focusable",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.zIndex="9999",a.addEventListener("click",t=>{t.preventDefault();const r=document.getElementById("main-content");r==null||r.focus(),r==null||r.scrollIntoView()}),a},Mg=()=>{const a=document.createElement("style");a.textContent=`
        /* Focus visible styles for keyboard navigation */
        *:focus-visible {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }
        
        /* Screen reader only class */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        /* Screen reader only, but visible when focused */
        .sr-only-focusable:focus {
            position: static;
            width: auto;
            height: auto;
            padding: 0.5rem 1rem;
            margin: 0;
            overflow: visible;
            clip: auto;
            white-space: normal;
            background: #3b82f6;
            color: white;
        }
    `,document.head.appendChild(a)},$g=()=>{Mg();const a=Lg();document.body.insertBefore(a,document.body.firstChild);const t=document.createElement("div");t.id="aria-live-region",t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",document.body.appendChild(t),console.log("✅ Accessibility features initialized")},qg=({isOpen:a,onClose:t,title:r,children:s})=>{const l=E.useRef(null),d=E.useRef(Ig("modal-title")).current;return E.useEffect(()=>{if(!a||!l.current)return;const u=Rg(l.current),h=Dg(t);return()=>{u(),h()}},[a,t]),a?c.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4",onClick:t,role:"presentation"},c.createElement("div",{ref:l,className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:u=>u.stopPropagation(),...Og.modal(a,d)},c.createElement("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"},c.createElement("h3",{id:d,className:"text-lg font-bold text-gray-900"},r),c.createElement("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 focus:outline-none","aria-label":"Close modal",type:"button"},"×")),c.createElement("div",{className:"px-6 py-4"},s))):null},ci=({isOpen:a,onCancel:t,onConfirm:r,title:s,children:l,confirmText:d="Confirm"})=>{if(!a)return null;const u=d.toLowerCase().includes("delete")||d.toLowerCase().includes("unselect");return c.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center"},c.createElement("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4"},c.createElement("h3",{className:"text-lg font-bold text-gray-900"},s),c.createElement("div",{className:"mt-2 text-sm text-gray-600"},l),c.createElement("div",{className:"mt-6 flex justify-end space-x-3"},c.createElement("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},"Cancel"),c.createElement("button",{onClick:r,className:`px-4 py-2 text-sm font-medium text-white border border-transparent rounded-md ${u?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"}`},d))))},Bg=({isOpen:a,onClose:t,onSubmit:r,selectedItems:s,currentUser:l})=>{const d=[{name:"DeliverTo",label:"Deliver To",type:"select",required:!0,options_key:"DeliveryLocations"},{name:"RecipientName",label:"Recipient Name",type:"text",required:!0,default:"currentUser.name"},{name:"ContactNumber",label:"Contact Number",type:"text",required:!0,default:"currentUser.phone"},{name:"Priority",label:"Priority",type:"select",required:!0,options_key:"RequestPriorities"},{name:"Comments",label:"Comments / Special Instructions",type:"textarea",required:!1}],u={DeliveryLocations:["Ops Center Trailer 1","Laydown Yard 7","Unit 12 Work Area","Weld Shop"],RequestPriorities:["P4 - Routine","P3 - Urgent","P2 - High","P1 - Shutdown Critical"]},[h,y]=E.useState({}),[x,g]=E.useState({});E.useEffect(()=>{if(a){const j={};d.forEach(C=>{C.default==="currentUser.name"?j[C.name]=l.name:C.default==="currentUser.phone"?j[C.name]=l.phone:j[C.name]=""}),y(j),g({})}},[a,l]);const v=(j,C)=>{if(y(A=>({...A,[j]:C})),x[j]){const A={...x};delete A[j],g(A)}},b=()=>{const j={};return d.forEach(C=>{C.required&&!h[C.name]&&(j[C.name]=`${C.label} is required.`)}),g(j),Object.keys(j).length===0},_=()=>{b()&&r(h)};if(!a)return null;const k={className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex items-center justify-center p-4",onClick:t};return c.createElement("div",k,c.createElement("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-3xl flex flex-col max-h-[90vh]",onClick:j=>j.stopPropagation()},c.createElement("div",{className:"p-5 border-b"},c.createElement("h2",{className:"text-xl font-bold text-gray-800"},"New Material Request")),c.createElement("div",{className:"flex-1 overflow-y-auto p-6 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6"},c.createElement("div",{className:"md:col-span-1"},c.createElement("h3",{className:"text-lg font-semibold text-gray-700 mb-3"},"1. Review Your Materials"),c.createElement("div",{className:"border rounded-lg p-3 bg-gray-50 max-h-80 overflow-y-auto"},s.map(j=>c.createElement("div",{key:j.pKey,className:"text-sm border-b last:border-b-0 py-2"},c.createElement("p",{className:"font-semibold text-gray-800"},j.materialDescription),c.createElement("p",{className:"text-gray-500"},`${j.jdeItemNo}  |  WO Qty: ${j.workOrderQty}`))))),c.createElement("div",{className:"md:col-span-1"},c.createElement("h3",{className:"text-lg font-semibold text-gray-700 mb-3"},"2. Provide Delivery Details"),c.createElement("div",{className:"space-y-4"},d.map(j=>{var S;const C=x[j.name],A={id:j.name,name:j.name,className:`w-full px-3 py-2 border rounded-md text-sm focus:ring-2 focus:border-blue-500 ${C?"border-red-500 focus:ring-red-300":"border-gray-300 focus:ring-blue-300"}`,value:h[j.name]||"",onChange:D=>v(j.name,D.target.value)};return c.createElement("div",{key:j.name},c.createElement("label",{htmlFor:j.name,className:"block text-sm font-medium text-gray-700 mb-1"},j.label,j.required&&c.createElement("span",{className:"text-red-500"}," *")),j.type==="select"?c.createElement("select",A,c.createElement("option",{value:""},`Select ${j.label}...`),(u[j.options_key]||[]).map(D=>c.createElement("option",{key:D,value:D},D))):j.type==="textarea"?c.createElement("textarea",{...A,rows:3}):c.createElement("input",{...A,type:"text"}),C&&c.createElement("p",{className:"text-xs text-red-600 mt-1"},C),j.name==="Priority"&&((S=h.Priority)==null?void 0:S.includes("P1"))&&Pg("requireP1Approval")&&c.createElement("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800"},c.createElement("p",{className:"font-semibold"},"🔥 P1 requests require Material Coordinator approval"),c.createElement("p",{className:"mt-1"},"Your request will go to the MC approval queue before the warehouse can begin picking.")))})))),c.createElement("div",{className:"p-5 border-t bg-gray-50 flex justify-end space-x-3 rounded-b-lg"},c.createElement("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},"Cancel"),c.createElement("button",{onClick:_,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700"},"Submit Request"))))},Ug=({isOpen:a,onClose:t,item:r,onSubmit:s})=>{const[l,d]=E.useState("");if(E.useEffect(()=>{a&&d("")},[a]),!a)return null;const u={className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex items-center justify-center p-4",onClick:t};return c.createElement("div",u,c.createElement("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-md",onClick:h=>h.stopPropagation()},c.createElement("div",{className:"p-5 border-b"},c.createElement("h2",{className:"text-xl font-bold text-gray-800"},"Lock Material")),c.createElement("div",{className:"p-6 space-y-4"},c.createElement("div",{className:"p-3 bg-gray-50 border rounded-md"},c.createElement("p",{className:"text-sm font-semibold text-gray-800"},r.materialDescription),c.createElement("p",{className:"text-xs text-gray-500"},r.jdeItemNo)),c.createElement("div",null,c.createElement("label",{htmlFor:"lock-comment",className:"block text-sm font-medium text-gray-700 mb-1"},"Reason / Comment *"),c.createElement("textarea",{id:"lock-comment",rows:3,placeholder:"e.g., Reserved for critical path job on Friday",className:"w-full px-3 py-2 border rounded-md text-sm border-gray-300 focus:ring-2 focus:ring-blue-300",value:l,onChange:h=>d(h.target.value)}))),c.createElement("div",{className:"p-5 border-t bg-gray-50 flex justify-end space-x-3 rounded-b-lg"},c.createElement("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},"Cancel"),c.createElement("button",{onClick:()=>s(l),className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50",disabled:!l},"Lock Material"))))},Fg=({isOpen:a,onClose:t,mockMaterialLocks:r,masterGridData:s})=>{if(!a)return null;const l=Object.entries(r).map(([u,h])=>({...s.find(x=>x.pKey===u),...h})),d={className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex items-center justify-center p-4",onClick:t};return c.createElement("div",d,c.createElement("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-2xl",onClick:u=>u.stopPropagation()},c.createElement("div",{className:"p-5 border-b"},c.createElement("h2",{className:"text-xl font-bold text-gray-800"},"Currently Locked Materials")),c.createElement("div",{className:"p-6 max-h-[60vh] overflow-y-auto"},c.createElement("ul",{className:"divide-y divide-gray-200"},l.map(u=>c.createElement("li",{key:u.pKey,className:"py-3"},c.createElement("p",{className:"text-sm font-semibold text-gray-800"},u.materialDescription),c.createElement("p",{className:"text-xs text-gray-500 font-mono"},`${u.jdeItemNo} | WO: ${u.workOrder}`),c.createElement("p",{className:"text-sm text-gray-600 mt-1 italic"},`"${u.comment}"`),c.createElement("p",{className:"text-xs text-gray-500 mt-1"},`Locked by: ${u.lockedBy}`))))),c.createElement("div",{className:"p-5 border-t bg-gray-50 flex justify-end rounded-b-lg"},c.createElement("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},"Close"))))},zg=({content:a,children:t,position:r="top",delay:s=200})=>{const[l,d]=E.useState(!1),[u,h]=E.useState(null),y=E.useRef(null),x=()=>{const _=setTimeout(()=>{d(!0)},s);h(_)},g=()=>{u&&(clearTimeout(u),h(null)),d(!1)},v={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},b={top:"top-full left-1/2 -translate-x-1/2 border-l-transparent border-r-transparent border-b-transparent border-t-gray-900",bottom:"bottom-full left-1/2 -translate-x-1/2 border-l-transparent border-r-transparent border-t-transparent border-b-gray-900",left:"left-full top-1/2 -translate-y-1/2 border-t-transparent border-b-transparent border-r-transparent border-l-gray-900",right:"right-full top-1/2 -translate-y-1/2 border-t-transparent border-b-transparent border-l-transparent border-r-gray-900"};return c.createElement("div",{className:"relative inline-flex",onMouseEnter:x,onMouseLeave:g},t,l&&c.createElement("div",{ref:y,className:`absolute z-50 px-3 py-2 text-sm text-white bg-gray-900 rounded-lg shadow-lg whitespace-nowrap ${v[r]}`,style:{pointerEvents:"none"}},a,c.createElement("div",{className:`absolute w-0 h-0 border-4 ${b[r]}`})))},kh=({content:a})=>c.createElement(zg,{content:a,position:"top"},c.createElement("span",{className:"inline-flex items-center justify-center w-4 h-4 ml-1 text-xs text-gray-500 border border-gray-400 rounded-full cursor-help hover:bg-gray-100"},"i"));let wi=[{taskId:"TOLL-2025-001",status:"delivered",mrfId:"MRF-2025-007",itemNumber:"MAT-789",materialDescription:"Steel Beam 10m",quantity:2,pickupLocation:"Toll Warehouse - Brisbane",deliveryLocation:"Site 1 - Unit 15",estimatedPickup:"2025-01-08T09:00:00Z",estimatedDelivery:"2025-01-08T14:00:00Z",actualPickup:"2025-01-08T09:15:00Z",actualDelivery:"2025-01-08T13:45:00Z",driverName:"John Smith",vehicleRego:"ABC-123",trackingNotes:"Delivered successfully",createdAt:"2025-01-08T08:00:00Z",updatedAt:"2025-01-08T13:45:00Z"}];const Eh={"MAT-789":{itemNumber:"MAT-789",available:!0,quantityOnHand:10,location:"Toll Warehouse - Brisbane",estimatedLeadTimeDays:1},"MAT-790":{itemNumber:"MAT-790",available:!0,quantityOnHand:5,location:"Toll Warehouse - Gold Coast",estimatedLeadTimeDays:2},"MAT-791":{itemNumber:"MAT-791",available:!1,quantityOnHand:0,location:"Toll Warehouse - Brisbane",estimatedLeadTimeDays:7}},Sh=async a=>{await new Promise(r=>setTimeout(r,500));const t=Eh[a];return t?(console.log(`✅ Toll Availability: ${a} - ${t.available?"Available":"Not Available"} (${t.quantityOnHand} on hand)`),t):(console.log(`❌ Toll Availability: ${a} - Not found in Toll catalog`),null)},Hg=async a=>{await new Promise(y=>setTimeout(y,800));const t=`TOLL-${new Date().getFullYear()}-${String(wi.length+1).padStart(3,"0")}`,r=new Date,s=Eh[a.itemNumber],l=(s==null?void 0:s.estimatedLeadTimeDays)||3,d=new Date(r.getTime()+l*24*60*60*1e3),u=new Date(d.getTime()+14400*1e3),h={taskId:t,status:"pending",mrfId:a.mrfId,itemNumber:a.itemNumber,materialDescription:a.materialDescription,quantity:a.quantity,pickupLocation:a.pickupLocation,deliveryLocation:a.deliveryLocation,estimatedPickup:d.toISOString(),estimatedDelivery:u.toISOString(),createdAt:r.toISOString(),updatedAt:r.toISOString()};return wi.push(h),console.log(`✅ Created Toll task ${t} for MRF ${a.mrfId}`),console.log(`   Estimated pickup: ${d.toLocaleString()}`),console.log(`   Estimated delivery: ${u.toLocaleString()}`),Wg(t),h},Tl=(a,t,r)=>{const s=wi.find(l=>l.taskId===a);s&&(s.status=t,s.updatedAt=new Date().toISOString(),r&&Object.assign(s,r),console.log(`🔄 Toll task ${a} updated to status: ${t}`))},Wg=a=>{wi.find(r=>r.taskId===a)&&(setTimeout(()=>{Tl(a,"accepted",{driverName:"Driver "+Math.floor(Math.random()*100),vehicleRego:`VEH-${Math.floor(Math.random()*1e3)}`,trackingNotes:"Driver assigned, preparing for pickup"})},5e3),setTimeout(()=>{Tl(a,"in_transit",{actualPickup:new Date().toISOString(),trackingNotes:"Materials picked up, en route to delivery location"})},15e3),setTimeout(()=>{Tl(a,"delivered",{actualDelivery:new Date().toISOString(),trackingNotes:"Delivered successfully"})},3e4))},Kg=async a=>{try{const t=await Sh(a);return t&&console.log(`ℹ️ Toll Integration: ${a} ${t.available?"is available":"is not available"} at ${t.location}`),t}catch(t){return console.error("❌ Toll Integration: Failed to check availability",t),null}},Vg=async(a,t,r,s="standard")=>{try{const l=await Sh(t.jdeItemNo);if(!l)return console.warn(`⚠️ Toll Integration: Material ${t.jdeItemNo} not found in Toll catalog`),null;if(!l.available)return console.warn(`⚠️ Toll Integration: Material ${t.jdeItemNo} not currently available at Toll`),null;if(l.quantityOnHand<t.workOrderQty)return console.warn(`⚠️ Toll Integration: Insufficient quantity at Toll. Required: ${t.workOrderQty}, Available: ${l.quantityOnHand}`),null;const d={mrfId:a,itemNumber:t.jdeItemNo,materialDescription:t.materialDescription,quantity:t.workOrderQty,pickupLocation:l.location,deliveryLocation:r,priority:s},u=await Hg(d);return console.log(`✅ Toll Integration: Order created - Task ${u.taskId} for MRF ${a}`),u}catch(l){return console.error("❌ Toll Integration: Failed to create order",l),null}},Qg=a=>["TOLL","EXTERNAL","VENDOR","OFFSITE"].some(r=>a.storageLocation.toUpperCase().includes(r));let Gl=[];const ji=async(a,t,r,s,l)=>{const d={id:`NOTIF-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,type:a,recipient:t,subject:r,message:s,status:"pending",mrfId:l};return Gl.unshift(d),setTimeout(()=>{const u=Gl.find(h=>h.id===d.id);u&&(Math.random()>.05?(u.status="sent",u.sentAt=new Date().toISOString()):(u.status="failed",u.error="Simulated delivery failure"))},1e3),d},Rm=a=>[...Gl],Gg=async a=>{await ji({type:"submitted",recipients:[a.RequestedBy,"mc@company.com","qube@company.com"],title:`📝 New Material Request - ${a.id}`,message:`Material request submitted with ${a.items} items (${a.priority}). Required by: ${new Date(a.RequiredByTimestamp).toLocaleString()}`,data:{requestId:a.id,priority:a.priority,items:a.items,requiredBy:a.RequiredByTimestamp,deliveryLocation:a.DeliveryLocation},priority:a.priority==="P1"?"high":"normal"}),console.log(`✉️ Notification sent: Request ${a.id} submitted`)},Jg=async a=>{await ji({type:"p1_created",recipients:["mc@company.com"],title:`🚨 P1 Approval Required - ${a.id}`,message:`Critical P1 request needs immediate approval. ${a.items} items required by ${new Date(a.RequiredByTimestamp).toLocaleString()}`,data:{requestId:a.id,priority:"P1",items:a.items,requiredBy:a.RequiredByTimestamp,deliveryLocation:a.DeliveryLocation,requestedBy:a.RequestedBy},priority:"high"}),console.log(`✉️ Notification sent: P1 approval needed for ${a.id}`)},Yg=({openDetailPanel:a,currentUser:t})=>{const[r,s]=E.useState({}),[l,d]=E.useState(!1),[u,h]=E.useState({show:!1,message:""}),[y,x]=E.useState(""),[g,v]=E.useState(sr),[b,_]=E.useState(!1),[k,j]=E.useState(null),C=E.useCallback(()=>{const J=y.toLowerCase(),ae=sr.filter(K=>K.workOrder.toLowerCase().includes(J)||K.jdeItemNo.toLowerCase().includes(J)||K.materialDescription.toLowerCase().includes(J));v(ae),s({})},[y]),A=E.useCallback(J=>{const ae={...J};Object.entries(J).forEach(([K,Y])=>{const B=sr.find(z=>z.pKey===K);if(B&&B.packNumber&&B.packNumber!=="N/A"){const z=sr.filter(U=>U.packNumber===B.packNumber&&U.packNumber!=="N/A");Y?(z.forEach(U=>{ae[U.pKey]=!0}),z.length>1&&h({show:!0,message:`📦 Selected ${z.length} items from Pack ${B.packNumber}`})):z.filter(re=>ae[re.pKey]).length===z.length&&(confirm(`This will deselect all ${z.length} items from Pack ${B.packNumber}. Continue?`)?z.forEach(re=>{ae[re.pKey]=!1}):ae[K]=!0)}}),s(ae)},[sr]),S=J=>{const ae=Object.keys(r),K=[],Y=["Submitted","Picking","Staged","In Transit","Partial Pick - Open","Partial Pick - Closed","On Hold"];if(ae.forEach(H=>{const te=Rr[H];if(te){const R=ne.find(F=>F.id===te.mrfId);if(R&&Y.includes(R.status)){const F=sr.find(ve=>ve.pKey===H);K.push(`${(F==null?void 0:F.materialDescription)||H} (already in ${te.mrfId})`)}}}),K.length>0){h({show:!0,message:`❌ Cannot create request - the following materials are already requested:

${K.join(`
`)}`});return}const B=`MRF-${Math.floor(1200+Math.random()*100)}`;ae.forEach(H=>{Rr[H]={mrfId:B,status:"Submitted"},gt[H]={lockedBy:`System (${B})`,comment:`Auto-locked by request ${B}`}});const z=sr.filter(H=>r[H.pKey]),U=[...new Set(z.map(H=>H.workOrder))].join(", "),re=J.Priority==="P1",G={id:B,status:re?"Pending Approval":"Submitted",priority:J.Priority||"P4",items:ae.length,workOrders:U,createdDate:new Date().toLocaleDateString("en-US"),RequiredByTimestamp:new Date(Date.now()+1440*60*1e3).toISOString(),RequiredByTime:J.RequiredTime||void 0,RequestedBy:t.name,MC_Priority_Flag:J.Priority==="P1",DeliveryLocation:J.DeliverTo||"Unknown",requestorName:t.name,acPriority:null,statusHistory:[{status:"Submitted",timestamp:new Date().toISOString(),changedBy:t.name,reason:"Request created"}]};ne.unshift(G),re?Jg(G).catch(H=>console.error("Notification failed:",H)):Gg(G).catch(H=>console.error("Notification failed:",H)),zs[B]=z.map((H,te)=>({pKey:`LI-${B}-${te}`,status:"Open",qtyRequested:H.workOrderQty,materialDescription:H.materialDescription,itemNumber:H.jdeItemNo,storageLocation:H.storageLocation,packNumber:H.packNumber})),s({}),d(!1),h({show:!0,message:`Success! Your request ${B} has been submitted.`})},D=J=>{k&&(gt[k.pKey]={lockedBy:t.name,comment:J},_(!1),j(null),h({show:!0,message:"Material locked successfully."}))},L=J=>{delete gt[J],h({show:!0,message:"Material unlocked."}),v(ae=>[...ae])},M=async J=>{h({show:!0,message:`Checking Toll availability for ${J.jdeItemNo}...`});const ae=await Kg(J.jdeItemNo);if(!ae){h({show:!0,message:`❌ Material ${J.jdeItemNo} not found in Toll catalog`});return}if(!ae.available){h({show:!0,message:`⚠️ Material ${J.jdeItemNo} not currently available at Toll (lead time: ${ae.estimatedLeadTimeDays} days)`});return}if(ae.quantityOnHand<J.workOrderQty){h({show:!0,message:`⚠️ Insufficient quantity at Toll. Required: ${J.workOrderQty}, Available: ${ae.quantityOnHand}`});return}const K=`MRF-TOLL-${Date.now()}`,B=await Vg(K,J,"Site 1","standard");h(B?{show:!0,message:`✅ Toll order created: ${B.taskId}. ETA: ${new Date(B.estimatedDelivery).toLocaleDateString()}`}:{show:!0,message:"❌ Failed to create Toll order"})},q=({row:J})=>{const[ae,K]=E.useState(!1),[Y,B]=E.useState(null),z=R=>{R.stopPropagation(),B(R.currentTarget),K(!0)},U=()=>{B(null),K(!1)},re=!!gt[J.pKey],G=re&&gt[J.pKey].lockedBy===t.name,H=!!Rr[J.pKey],te=Qg(J)&&!H;return t.role!=="Area Coordinator"||H?null:c.createElement(c.Fragment,null,c.createElement("button",{onClick:z,className:"p-1 rounded-full hover:bg-gray-200 text-gray-500"},c.createElement(xe.EllipsisHorizontalIcon,{})),c.createElement(Qs,{isOpen:ae,anchorEl:Y,onClose:U,className:"p-1"},c.createElement("div",{className:"flex flex-col"},[G?c.createElement("button",{key:"unlock",onClick:()=>{L(J.pKey),U()},className:"flex items-center space-x-2 w-full text-left px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-100 rounded"},c.createElement(xe.LockOpenIcon,{}),c.createElement("span",null,"Unlock Material")):re?null:c.createElement("button",{key:"lock",onClick:()=>{j(J),_(!0),U()},className:"flex items-center space-x-2 w-full text-left px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-100 rounded"},c.createElement(xe.LockClosedIcon,{className:"h-5 w-5"}),c.createElement("span",null,"Lock Material")),te&&c.createElement("button",{key:"toll",onClick:()=>{M(J),U()},className:"flex items-center space-x-2 w-full text-left px-3 py-1.5 text-sm text-purple-700 hover:bg-purple-50 rounded"},c.createElement("span",{className:"text-lg"},"🚚"),c.createElement("span",null,"Order from Toll LTR"))])))},Q=E.useMemo(()=>sr.filter(J=>r[J.pKey]),[r]),me=E.useMemo(()=>[{accessorKey:"mrfStatus",header:"MRF Status",enableFiltering:!1,cell:({row:J})=>{const ae=Rr[J.pKey],K=gt[J.pKey],Y=ae?ae.status:"Not Requested";return c.createElement("div",{className:"flex flex-col"},c.createElement(kt,{status:Y,lockInfo:K}),ae&&c.createElement("a",{href:"#",onClick:B=>{B.preventDefault(),B.stopPropagation(),a(ne.find(z=>z.id===ae.mrfId))},className:"text-blue-600 font-semibold hover:underline mt-1 text-xs"},`(${ae.mrfId})`))}},{accessorKey:"workOrder",header:"Work Order"},{accessorKey:"lineNumber",header:"Line #"},{accessorKey:"opsSeq",header:"Ops Seq"},{accessorKey:"team",header:"Team"},{accessorKey:"packNumber",header:"Pack #"},{accessorKey:"storageLocation",header:"Location"},{accessorKey:"jdeItemNo",header:"JDE Item No"},{accessorKey:"materialDescription",header:"Description",cell:({row:J})=>{const ae=J.packNumber&&J.packNumber!=="N/A";return c.createElement("div",{className:"flex items-center gap-2"},c.createElement("span",null,J.materialDescription),ae&&c.createElement("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",title:`Pack ${J.packNumber}`},"📦",J.packNumber))}},{accessorKey:"workOrderQty",header:"WO Qty"},{accessorKey:"actions",header:"",cell:({row:J})=>c.createElement(q,{row:J})}],[a,t.role]),ye=E.useMemo(()=>g.map(J=>({...J,isDisabled:!!Rr[J.pKey]||!!gt[J.pKey]})),[g]);return c.createElement("div",{className:"space-y-6"},c.createElement("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded"},c.createElement("div",{className:"flex items-start"},c.createElement("div",{className:"flex-shrink-0"},c.createElement("span",{className:"text-2xl"},"📋")),c.createElement("div",{className:"ml-3 flex-1"},c.createElement("div",{className:"flex items-center gap-2"},c.createElement("h3",{className:"text-sm font-medium text-blue-800"},"Work Order Materials"),c.createElement(kh,{content:"MRF = Material Request Form. Select materials from your work orders to request them from the warehouse."})),c.createElement("div",{className:"mt-2 text-sm text-blue-700"},c.createElement("p",null,"Select materials needed for your work orders. Each work order line represents a specific task requiring materials."),c.createElement("p",{className:"mt-1 text-xs text-blue-600"},"💡 Tip: Materials in packs will auto-select all items when you select one."))))),u.show&&c.createElement(Ni,{message:u.message,onClose:()=>h({show:!1,message:""})}),c.createElement(Bg,{isOpen:l,onClose:()=>d(!1),onSubmit:S,selectedItems:Q,currentUser:t}),k&&c.createElement(Ug,{isOpen:b,onClose:()=>{_(!1),j(null)},item:k,onSubmit:D}),c.createElement("div",{className:"bg-white p-4 rounded-xl border border-gray-200"},c.createElement("div",{className:"flex items-center justify-between"},c.createElement("div",{className:"flex items-center space-x-2 w-full max-w-lg relative"},c.createElement("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"},c.createElement(xe.MagnifyingGlassIcon,{})),c.createElement("input",{type:"text",placeholder:"Search by Work Order, JDE No, or Description...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:y,onChange:J=>x(J.target.value),onKeyPress:J=>J.key==="Enter"&&C()}),c.createElement("button",{onClick:C,className:"px-6 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 font-semibold"},"Search")),Q.length>0&&c.createElement("div",{className:"px-6 py-2 text-green-700 bg-green-100 rounded-lg font-semibold flex-shrink-0"},`${Q.length} item${Q.length>1?"s":""} ready`))),c.createElement(Ar,{data:ye,columns:me,uniqueId:"pKey",enableSelection:!0,onSelectionChange:A,onLoadMore:()=>{},totalDataCount:g.length,initialRowSelection:r}),c.createElement(Cg,{selectedCount:Q.length,onReview:()=>d(!0),selectedItems:Q}))},Xg=({data:a,size:t=100,strokeWidth:r=10})=>{const s=(t-r)/2,l=2*Math.PI*s;let d=0;return c.createElement("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,className:"-rotate-90"},a.map((u,h)=>{if(!u.total||u.total<=0)return null;const y=Math.max(u.value,0),x=Math.min(y/u.total,1),g=`${x*l} ${l}`,v=c.createElement("circle",{key:h,cx:t/2,cy:t/2,r:s,stroke:u.color,strokeWidth:r,fill:"none",strokeDasharray:g,strokeDashoffset:-d});return d+=x*l,v}))},Zg={baseDeliveryMinutes:60,priorityMultipliers:{P1:.5,P2:.75,P3:1,P4:1.5},queueDelayMinutes:15,processingMinutes:20};function e0(a,t=Zg){const r=a.currentTime||new Date;let s=t.processingMinutes;a.queuePosition>0&&(s+=(a.queuePosition-1)*t.queueDelayMinutes);const l=t.baseDeliveryMinutes*t.priorityMultipliers[a.priority];switch(s+=l,a.status){case"Submitted":case"Pending Approval":break;case"Approved":s*=.9;break;case"Picking":s=Math.max(15,s*.3);break;case"Staged":s=Math.max(10,s*.2);break;case"In Transit":s=Math.max(5,s*.1);break;case"Delivered":case"Closed":case"Cancelled":return new Date(r.getTime()+1e3)}return new Date(r.getTime()+s*60*1e3)}function t0(a,t=new Date){const r=a.getTime()-t.getTime(),s=Math.round(r/(1e3*60));if(s<=0)return"Overdue";if(s<60)return`${s}m`;const l=Math.floor(s/60),d=s%60;if(l<24)return d>0?`${l}h ${d}m`:`${l}h`;const u=Math.floor(l/24),h=l%24;return h>0?`${u}d ${h}h`:`${u}d`}function r0(a,t=new Date){return a.getTime()<=t.getTime()}function n0(a,t=new Date){const r=a.getTime()-t.getTime(),s=Math.round(r/(1e3*60));return s<=0?"text-red-600 bg-red-50 border-red-200":s<30?"text-orange-600 bg-orange-50 border-orange-200":s<60?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-green-600 bg-green-50 border-green-200"}function s0(a,t=new Date){const r=a.getTime()-t.getTime(),s=Math.round(r/(1e3*60));return s<=0?"⚠️":s<30?"🚨":s<60?"⏰":"✅"}function a0(a){const t={priority:a.priority,queuePosition:a.queuePosition||1,status:a.status,requestedBy:a.requestedBy},r=e0(t),s=t0(r),l=r0(r),d=n0(r),u=s0(r);return{eta:r,formatted:s,isOverdue:l,statusClass:d,statusIcon:u}}const Nh=({request:a,showIcon:t=!0,className:r=""})=>{const s=a0(a);return c.createElement("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${s.statusClass} ${r}`,title:`ETA: ${s.eta.toLocaleString()}`},[t&&c.createElement("span",{key:"icon",className:"mr-1"},s.statusIcon),c.createElement("span",{key:"text"},s.formatted)])},i0=({isOpen:a,onClose:t,onConfirm:r,requestId:s})=>{const[l,d]=E.useState("choice"),[u,h]=E.useState(void 0),[y,x]=E.useState(""),[g,v]=E.useState(""),[b,_]=E.useState([]);if(!a)return null;const k=()=>{d("choice"),h(void 0),x(""),v(""),_([])},j=()=>{r({rating:u,feedback:y,hasIssue:!1}),k()},C=()=>{r({hasIssue:!0,issueDescription:g,issuePhotos:b}),k()},A=()=>{const D=`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='150'%3E%3Crect fill='%23ddd' width='200' height='150'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%23666' font-family='Arial' font-size='14'%3EPhoto ${b.length+1}%3C/text%3E%3C/svg%3E`;_([...b,D])},S=D=>{_(b.filter((L,M)=>M!==D))};return l==="choice"?c.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:D=>{D.target===D.currentTarget&&t()}},c.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6"},[c.createElement("div",{key:"header",className:"flex items-center justify-between mb-6"},[c.createElement("div",{key:"title",className:"flex items-center gap-3"},[c.createElement("span",{key:"icon",className:"text-3xl"},"📦"),c.createElement("h2",{key:"text",className:"text-xl font-semibold text-gray-800"},"Delivery Received?")]),c.createElement("button",{key:"close",onClick:t,className:"text-gray-400 hover:text-gray-600"},xe.close)]),c.createElement("div",{key:"content",className:"mb-6"},[c.createElement("p",{key:"desc",className:"text-gray-600 mb-6"},`Request ${s} shows as delivered. Please confirm you've received the materials.`),c.createElement("div",{key:"buttons",className:"space-y-3"},[c.createElement("button",{key:"confirm",onClick:()=>d("confirm"),className:"w-full px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium flex items-center justify-center gap-2"},[c.createElement("span",{key:"icon"},"✅"),c.createElement("span",{key:"text"},"Yes, Confirm Delivery")]),c.createElement("button",{key:"issue",onClick:()=>d("issue"),className:"w-full px-4 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium flex items-center justify-center gap-2"},[c.createElement("span",{key:"icon"},"⚠️"),c.createElement("span",{key:"text"},"Report an Issue")])])])])):l==="confirm"?c.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:D=>{D.target===D.currentTarget&&(k(),t())}},c.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6"},[c.createElement("div",{key:"header",className:"flex items-center justify-between mb-6"},[c.createElement("h2",{key:"title",className:"text-xl font-semibold text-gray-800"},"Confirm Delivery"),c.createElement("button",{key:"close",onClick:()=>{k(),t()},className:"text-gray-400 hover:text-gray-600"},xe.close)]),c.createElement("div",{key:"content",className:"space-y-6 mb-6"},[c.createElement("div",{key:"rating"},[c.createElement("label",{key:"label",className:"block text-sm font-medium text-gray-700 mb-2"},"Rate your experience (optional)"),c.createElement("div",{key:"stars",className:"flex gap-2"},[1,2,3,4,5].map(D=>c.createElement("button",{key:D,onClick:()=>h(D),className:`text-3xl ${u&&D<=u?"text-yellow-400":"text-gray-300"} hover:text-yellow-400 transition-colors`},"⭐")))]),c.createElement("div",{key:"feedback"},[c.createElement("label",{key:"label",className:"block text-sm font-medium text-gray-700 mb-2"},"Additional feedback (optional)"),c.createElement("textarea",{key:"input",value:y,onChange:D=>x(D.target.value),placeholder:"Any comments about the delivery or materials?",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 resize-none",rows:3})])]),c.createElement("div",{key:"actions",className:"flex gap-3"},[c.createElement("button",{key:"back",onClick:()=>d("choice"),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"},"Back"),c.createElement("button",{key:"confirm",onClick:j,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium"},"Confirm Delivery")])])):l==="issue"?c.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:D=>{D.target===D.currentTarget&&(k(),t())}},c.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6 max-h-[90vh] overflow-y-auto"},[c.createElement("div",{key:"header",className:"flex items-center justify-between mb-6 sticky top-0 bg-white pb-2"},[c.createElement("h2",{key:"title",className:"text-xl font-semibold text-gray-800"},"Report Issue"),c.createElement("button",{key:"close",onClick:()=>{k(),t()},className:"text-gray-400 hover:text-gray-600"},xe.close)]),c.createElement("div",{key:"content",className:"space-y-6 mb-6"},[c.createElement("div",{key:"description"},[c.createElement("label",{key:"label",className:"block text-sm font-medium text-gray-700 mb-2"},"Describe the issue *"),c.createElement("textarea",{key:"input",value:g,onChange:D=>v(D.target.value),placeholder:"e.g., Missing items, damaged materials, wrong quantities...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 resize-none",rows:4})]),c.createElement("div",{key:"photos"},[c.createElement("label",{key:"label",className:"block text-sm font-medium text-gray-700 mb-2"},"Photos (optional)"),c.createElement("button",{key:"add-btn",onClick:A,className:"w-full px-4 py-3 border-2 border-dashed border-gray-300 rounded-lg hover:border-orange-500 hover:bg-orange-50 transition-colors flex items-center justify-center gap-2 text-gray-600"},[c.createElement("span",{key:"icon",className:"text-xl"},"📷"),c.createElement("span",{key:"text"},"Add Photo")]),b.length>0&&c.createElement("div",{key:"grid",className:"mt-3 grid grid-cols-3 gap-2"},b.map((D,L)=>c.createElement("div",{key:L,className:"relative group"},[c.createElement("img",{key:"img",src:D,alt:`Issue photo ${L+1}`,className:"w-full h-24 object-cover rounded border border-gray-300"}),c.createElement("button",{key:"remove",onClick:()=>S(L),className:"absolute top-1 right-1 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},"×")])))])]),c.createElement("div",{key:"actions",className:"flex gap-3 sticky bottom-0 bg-white pt-2"},[c.createElement("button",{key:"back",onClick:()=>d("choice"),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"},"Back"),c.createElement("button",{key:"submit",onClick:C,disabled:!g.trim(),className:`flex-1 px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 font-medium ${g.trim()?"":"opacity-50 cursor-not-allowed"}`},"Submit Issue")])])):null},Dm={Submitted:1,Picking:2,Staged:3,"In Transit":4,Delivered:5,"Partial Pick - Open":2.5,"Partial Pick - Closed":2.7,"On Hold":0,Cancelled:0,Short:0};function yt(a,t,r,s){const l=a||[],d=l.length>0?l[l.length-1].status:"Submitted",u=Dm[t]<Dm[d],h={status:t,timestamp:new Date().toISOString(),changedBy:r,reason:s,isBackwards:u};return[...l,h]}const o0=({openDetailPanel:a})=>{const[t,r]=E.useState(0),[s,l]=E.useState({isOpen:!1,request:null});E.useEffect(()=>{const k=setInterval(()=>{r(j=>j+1)},2e3);return()=>clearInterval(k)},[]);const d=(k,j)=>{const C={name:"Requestor"};if(j.hasIssue)k.status="On Hold",k.onHoldInfo={putOnHoldBy:C.name,putOnHoldAt:new Date().toISOString(),reason:`Issue reported: ${j.issueDescription}`,expectedResumeDate:void 0},yt(k,"On Hold",C.name,`Issue reported: ${j.issueDescription}`),alert(`Issue reported for request ${k.id}. Material Coordinator has been notified.`);else{k.status="Delivered",k.deliveryConfirmation={confirmedAt:new Date().toISOString(),confirmedBy:C.name,rating:j.rating,feedback:j.feedback},yt(k,"Delivered",C.name,"Delivery confirmed by requestor");const A=j.rating?`Thank you for confirming delivery and rating ${j.rating}⭐!`:"Thank you for confirming delivery!";alert(A)}l({isOpen:!1,request:null}),r(A=>A+1)},u=[{label:"Submitted",value:6,color:"#0891b2"},{label:"Picking",value:3,color:"#f59e0b"},{label:"Ready for Collection",value:2,color:"#8b5cf6"},{label:"In Transit",value:7,color:"#3b82f6"}],h=u.reduce((k,j)=>k+j.value,0),y=u.map(k=>({...k,total:h})),x=E.useMemo(()=>ne.find(k=>k.id==="MRF-1232")||null,[t]),g=E.useMemo(()=>ne.find(k=>k.id==="MRF-1234")||null,[t]),v=k=>{if(!k){console.warn("Attempted to open details for a request that no longer exists in the queue.");return}a(k)},b=E.useMemo(()=>[{accessorKey:"id",header:"Request ID",cell:({value:k})=>c.createElement("span",{className:"font-mono font-semibold text-blue-600"},k)},{accessorKey:"status",header:"Status",cell:({value:k})=>c.createElement(kt,{status:k})},{accessorKey:"priority",header:"Priority",cell:({value:k})=>c.createElement("span",{className:`px-2 py-0.5 text-xs font-bold ${k==="P1"?"text-red-700 bg-red-100":"text-gray-600 bg-gray-100"} rounded-full`},k)},{accessorKey:"items",header:"# of Items"},{accessorKey:"workOrders",header:"Work Order(s)",cell:({value:k})=>c.createElement("span",{className:"font-mono"},k)},{accessorKey:"createdDate",header:"Created Date"},{accessorKey:"eta",header:"ETA",enableFiltering:!1,cell:({row:k})=>k.status==="Delivered"||k.status==="Closed"||k.status==="Cancelled"?c.createElement("span",{className:"text-gray-400 text-sm"},"—"):c.createElement(Nh,{request:{priority:k.priority,status:k.status,queuePosition:k.MC_Queue_Position||1,requestedBy:k.RequestedBy}})},{accessorKey:"actions",header:"Actions",enableFiltering:!1,cell:({row:k})=>k.status==="Delivered"?k.deliveryConfirmation?c.createElement("div",{className:"flex gap-2"},[c.createElement("span",{key:"confirmed",className:"px-3 py-1.5 text-sm font-semibold text-green-700 bg-green-50 rounded-md flex items-center gap-1"},[c.createElement("span",{key:"icon"},"✅"),c.createElement("span",{key:"text"},"Confirmed")]),c.createElement("button",{key:"pod",onClick:j=>{j.stopPropagation(),a(k)},className:"px-3 py-1.5 text-sm font-semibold text-blue-700 bg-blue-50 rounded-md hover:bg-blue-100"},"📄 POD")]):c.createElement("div",{className:"flex gap-2"},[c.createElement("button",{key:"confirm",onClick:j=>{j.stopPropagation(),l({isOpen:!0,request:k})},className:"px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 animate-pulse"},"✅ Confirm"),c.createElement("button",{key:"pod",onClick:j=>{j.stopPropagation(),a(k)},className:"px-3 py-1.5 text-sm font-semibold text-blue-700 bg-blue-50 rounded-md hover:bg-blue-100"},"📄 POD")]):c.createElement("button",{onClick:j=>{j.stopPropagation(),a(k)},className:"px-3 py-1.5 text-sm font-semibold text-gray-600 bg-white border rounded-md hover:bg-gray-100"},"View")}],[a]),_=E.useMemo(()=>ne.map(k=>({...k,onClick:a})),[a,t]);return c.createElement("div",{className:"space-y-6"},c.createElement("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 rounded"},c.createElement("div",{className:"flex items-start"},c.createElement("div",{className:"flex-shrink-0"},c.createElement("span",{className:"text-2xl"},"📦")),c.createElement("div",{className:"ml-3 flex-1"},c.createElement("div",{className:"flex items-center gap-2"},c.createElement("h3",{className:"text-sm font-medium text-green-800"},"My Material Requests"),c.createElement(kh,{content:"Track all your material requests from submission to delivery. Click any row for details."})),c.createElement("p",{className:"mt-1 text-sm text-green-700"},"Monitor the status of your requested materials. Warehouse is working to fulfill your requests in priority order.")))),c.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},c.createElement("div",{className:"bg-white p-5 rounded-xl border border-gray-200"},c.createElement("h3",{className:"text-base font-semibold text-gray-800 mb-4"},"My Request Status"),c.createElement("div",{className:"flex items-center space-x-6"},c.createElement("div",{className:"relative"},c.createElement(Xg,{data:y,size:120,strokeWidth:12}),c.createElement("div",{className:"absolute inset-0 flex flex-col items-center justify-center"},c.createElement("span",{className:"text-3xl font-bold text-gray-800"},h),c.createElement("span",{className:"text-xs text-gray-500"},"Active"))),c.createElement("div",{className:"flex-1 space-y-2"},y.map(k=>c.createElement("div",{key:k.label,className:"flex items-center justify-between cursor-pointer group"},c.createElement("div",{className:"flex items-center"},c.createElement("span",{className:"h-3 w-3 rounded-full mr-2",style:{backgroundColor:k.color}}),c.createElement("span",{className:"text-sm text-gray-600 group-hover:text-blue-600"},k.label)),c.createElement("span",{className:"text-sm font-semibold text-gray-800"},k.value))),c.createElement("a",{href:"#",className:"block text-sm text-amber-600 hover:underline pt-2 font-semibold"},"⚠️ You have 1 request with an exception")))),c.createElement("div",{className:"bg-white p-5 rounded-xl border border-gray-200"},c.createElement("h3",{className:"text-base font-semibold text-gray-800 mb-4"},"Live Pick Queue"),c.createElement("div",{className:"space-y-3"},c.createElement("p",{className:"text-sm text-gray-600"},c.createElement("strong",null,"3 of Your Requests")," are in the Qube Queue"),c.createElement("div",{className:"p-3 bg-gray-50 rounded-lg border"},c.createElement("p",{className:"text-xs text-gray-500"},"Now Picking:"),c.createElement("p",{className:"font-semibold text-gray-800"},c.createElement("a",{href:"#",onClick:k=>{k.preventDefault(),v(x)},className:`text-blue-600 hover:underline ${x?"":"pointer-events-none text-gray-400 hover:no-underline"}`,"aria-disabled":x?void 0:!0},x?x.id:"No active pick"),x&&c.createElement("span",{className:"ml-2 px-2 py-0.5 text-xs font-bold text-red-700 bg-red-100 rounded-full"},"P1"))),c.createElement("div",{className:"p-3 bg-gray-50 rounded-lg border"},c.createElement("p",{className:"text-xs text-gray-500"},"Next Up:"),c.createElement("p",{className:"font-semibold text-gray-800"},c.createElement("a",{href:"#",onClick:k=>{k.preventDefault(),v(g)},className:`text-blue-600 hover:underline ${g?"":"pointer-events-none text-gray-400 hover:no-underline"}`,"aria-disabled":g?void 0:!0},g?g.id:"Queue updating"),g&&c.createElement("span",{className:"ml-2 px-2 py-0.5 text-xs font-semibold text-gray-600 bg-gray-200 rounded-full"},"P2")))))),c.createElement(Ar,{data:_,columns:b,uniqueId:"id"}),s.request&&c.createElement(i0,{isOpen:s.isOpen,onClose:()=>l({isOpen:!1,request:null}),onConfirm:k=>d(s.request,k),requestId:s.request.id}))},l0=({isOpen:a,request:t,onClose:r,onConfirm:s,currentUserName:l})=>{const[d,u]=E.useState(""),[h,y]=E.useState(""),[x,g]=E.useState(""),v=()=>{if(!d.trim()){alert("Please provide a reason for putting this request on hold.");return}s(d,h||void 0,x||void 0),u(""),y(""),g("")},b=()=>{u(""),y(""),g(""),r()};return a?c.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:_=>{_.target===_.currentTarget&&b()}},c.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6"},c.createElement("div",{className:"mb-4"},c.createElement("h2",{className:"text-xl font-bold text-gray-900"},`Put ${t.id} On Hold`),c.createElement("p",{className:"text-sm text-gray-500 mt-1"},"This request will be paused until resumed.")),c.createElement("div",{className:"space-y-4"},c.createElement("div",{className:"bg-gray-50 p-3 rounded text-sm"},c.createElement("p",null,c.createElement("strong",null,"Priority: "),t.priority),c.createElement("p",null,c.createElement("strong",null,"Delivery: "),t.DeliveryLocation),c.createElement("p",null,c.createElement("strong",null,"Items: "),t.items)),c.createElement("div",null,c.createElement("label",{htmlFor:"holdReason",className:"block text-sm font-medium text-gray-700 mb-1"},"Reason *"),c.createElement("select",{id:"holdReason",value:d,onChange:_=>u(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},c.createElement("option",{value:""},"-- Select Reason --"),c.createElement("option",{value:"Awaiting Material"},"Awaiting Material"),c.createElement("option",{value:"Requestor Not Available"},"Requestor Not Available"),c.createElement("option",{value:"Delivery Location Blocked"},"Delivery Location Blocked"),c.createElement("option",{value:"Work Order On Hold"},"Work Order On Hold"),c.createElement("option",{value:"Resource Unavailable"},"Resource Unavailable"),c.createElement("option",{value:"Other"},"Other"))),c.createElement("div",null,c.createElement("label",{htmlFor:"resumeDate",className:"block text-sm font-medium text-gray-700 mb-1"},"Expected Resume Date (Optional)"),c.createElement("input",{type:"date",id:"resumeDate",value:h,onChange:_=>y(_.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),c.createElement("div",null,c.createElement("label",{htmlFor:"holdNotes",className:"block text-sm font-medium text-gray-700 mb-1"},"Additional Notes (Optional)"),c.createElement("textarea",{id:"holdNotes",value:x,onChange:_=>g(_.target.value),rows:3,placeholder:"Any additional information...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),c.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3 text-sm text-yellow-800"},c.createElement("p",null,"⚠️ This will pause all work on this request. Materials will remain locked."))),c.createElement("div",{className:"flex justify-end gap-3 mt-6"},c.createElement("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},"Cancel"),c.createElement("button",{onClick:v,className:"px-4 py-2 text-sm font-medium text-white bg-yellow-600 rounded-md hover:bg-yellow-700"},"Put On Hold")))):null},c0=({isOpen:a,request:t,onClose:r,onConfirm:s,currentUserName:l})=>{const[d,u]=E.useState(""),[h,y]=E.useState(""),[x,g]=E.useState(""),v=()=>{if(!d.trim()){alert("Please provide a reason for cancelling this request.");return}if(x.toUpperCase()!=="CANCEL"){alert("Please type CANCEL to confirm.");return}s(d,h||void 0),u(""),y(""),g("")},b=()=>{u(""),y(""),g(""),r()};return a?c.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:_=>{_.target===_.currentTarget&&b()}},c.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6"},c.createElement("div",{className:"mb-4"},c.createElement("h2",{className:"text-xl font-bold text-red-900"},`Cancel ${t.id}?`),c.createElement("p",{className:"text-sm text-gray-500 mt-1"},"This action cannot be undone.")),c.createElement("div",{className:"space-y-4"},c.createElement("div",{className:"bg-gray-50 p-3 rounded text-sm"},c.createElement("p",null,c.createElement("strong",null,"Priority: "),t.priority),c.createElement("p",null,c.createElement("strong",null,"Delivery: "),t.DeliveryLocation),c.createElement("p",null,c.createElement("strong",null,"Items: "),t.items),c.createElement("p",null,c.createElement("strong",null,"Status: "),t.status)),c.createElement("div",null,c.createElement("label",{htmlFor:"cancelReason",className:"block text-sm font-medium text-gray-700 mb-1"},"Cancellation Reason *"),c.createElement("select",{id:"cancelReason",value:d,onChange:_=>u(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"},c.createElement("option",{value:""},"-- Select Reason --"),c.createElement("option",{value:"Work Order Cancelled"},"Work Order Cancelled"),c.createElement("option",{value:"No Longer Required"},"No Longer Required"),c.createElement("option",{value:"Duplicate Request"},"Duplicate Request"),c.createElement("option",{value:"Wrong Materials Requested"},"Wrong Materials Requested"),c.createElement("option",{value:"Requestor Request"},"Requestor Request"),c.createElement("option",{value:"Project Scope Change"},"Project Scope Change"),c.createElement("option",{value:"Other"},"Other"))),c.createElement("div",null,c.createElement("label",{htmlFor:"cancelNotes",className:"block text-sm font-medium text-gray-700 mb-1"},"Additional Notes (Optional)"),c.createElement("textarea",{id:"cancelNotes",value:h,onChange:_=>y(_.target.value),rows:2,placeholder:"Any additional information...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"})),c.createElement("div",null,c.createElement("label",{htmlFor:"confirmCancel",className:"block text-sm font-medium text-gray-700 mb-1"},"Type CANCEL to confirm *"),c.createElement("input",{type:"text",id:"confirmCancel",value:x,onChange:_=>g(_.target.value),placeholder:"CANCEL",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 font-mono"})),c.createElement("div",{className:"bg-red-50 border border-red-200 rounded p-3 text-sm text-red-800 space-y-1"},c.createElement("p",{className:"font-semibold"},"⚠️ Cancelling this request will:"),c.createElement("ul",{className:"list-disc ml-5 mt-1 space-y-0.5"},c.createElement("li",null,"Stop all work immediately"),c.createElement("li",null,"Auto-unlock all associated materials"),c.createElement("li",null,"Permanently mark the request as Cancelled"),c.createElement("li",null,"Cannot be undone")))),c.createElement("div",{className:"flex justify-end gap-3 mt-6"},c.createElement("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},"Keep Request"),c.createElement("button",{onClick:v,disabled:x.toUpperCase()!=="CANCEL"||!d,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed"},"Cancel Request")))):null},d0=({isOpen:a,request:t,onClose:r,onConfirm:s,currentUserName:l})=>{const d=zs[t.id]||[],[u,h]=E.useState([]),[y,x]=E.useState([]),[g,v]=E.useState(""),b=(A,S)=>{S==="A"?u.includes(A)?h(u.filter(D=>D!==A)):(h([...u,A]),x(y.filter(D=>D!==A))):y.includes(A)?x(y.filter(D=>D!==A)):(x([...y,A]),h(u.filter(D=>D!==A)))},_=()=>{if(u.length===0||y.length===0){alert("Both splits must have at least one item.");return}if(!g.trim()){alert("Please provide a reason for splitting this request.");return}if(u.length+y.length!==d.length){alert("All items must be assigned to a split.");return}s({splitA:u,splitB:y},g),k()},k=()=>{h([]),x([]),v("")},j=()=>{k(),r()};if(!a)return null;const C=d.filter(A=>!u.includes(A.pKey)&&!y.includes(A.pKey));return c.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:A=>{A.target===A.currentTarget&&j()}},c.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 p-6 max-h-[90vh] overflow-y-auto"},c.createElement("div",{className:"mb-4 border-b pb-4"},c.createElement("h2",{className:"text-xl font-bold text-gray-900"},`Split ${t.id}`),c.createElement("p",{className:"text-sm text-gray-500 mt-1"},`Divide this request into two separate MRFs. Total items: ${d.length}`)),c.createElement("div",{className:"mb-6"},c.createElement("label",{htmlFor:"splitReason",className:"block text-sm font-medium text-gray-700 mb-2"},"Reason for Split *"),c.createElement("select",{id:"splitReason",value:g,onChange:A=>v(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},c.createElement("option",{value:""},"-- Select Reason --"),c.createElement("option",{value:"Partial materials available"},"Partial materials available"),c.createElement("option",{value:"Urgent items need priority"},"Urgent items need priority"),c.createElement("option",{value:"Different delivery locations"},"Different delivery locations"),c.createElement("option",{value:"Split between teams"},"Split between teams"),c.createElement("option",{value:"Capacity constraints"},"Capacity constraints"),c.createElement("option",{value:"Other"},"Other"))),c.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},c.createElement("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4"},c.createElement("h3",{className:"font-semibold text-gray-700 mb-3 text-center"},`Unassigned (${C.length})`),c.createElement("div",{className:"space-y-2"},C.map(A=>c.createElement("div",{key:A.pKey,className:"p-3 bg-gray-50 rounded border border-gray-200 text-sm"},c.createElement("p",{className:"font-medium text-gray-900"},A.materialDescription),c.createElement("p",{className:"text-xs text-gray-500 mt-1"},`Qty: ${A.qtyRequested}`),c.createElement("div",{className:"flex gap-2 mt-2"},c.createElement("button",{onClick:()=>b(A.pKey,"A"),className:"flex-1 px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600"},"→ Split A"),c.createElement("button",{onClick:()=>b(A.pKey,"B"),className:"flex-1 px-2 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600"},"→ Split B")))),C.length===0&&c.createElement("p",{className:"text-center text-gray-400 text-sm py-8"},"All items assigned"))),c.createElement("div",{className:"border-2 border-blue-300 rounded-lg p-4 bg-blue-50"},c.createElement("h3",{className:"font-semibold text-blue-700 mb-3 text-center"},`Split A (${u.length})`),c.createElement("div",{className:"space-y-2"},d.filter(A=>u.includes(A.pKey)).map(A=>c.createElement("div",{key:A.pKey,className:"p-3 bg-white rounded border border-blue-200 text-sm"},c.createElement("p",{className:"font-medium text-gray-900"},A.materialDescription),c.createElement("p",{className:"text-xs text-gray-500 mt-1"},`Qty: ${A.qtyRequested}`),c.createElement("button",{onClick:()=>b(A.pKey,"A"),className:"mt-2 w-full px-2 py-1 text-xs bg-gray-200 text-gray-700 rounded hover:bg-gray-300"},"← Remove"))),u.length===0&&c.createElement("p",{className:"text-center text-blue-400 text-sm py-8"},"Drag items here"))),c.createElement("div",{className:"border-2 border-green-300 rounded-lg p-4 bg-green-50"},c.createElement("h3",{className:"font-semibold text-green-700 mb-3 text-center"},`Split B (${y.length})`),c.createElement("div",{className:"space-y-2"},d.filter(A=>y.includes(A.pKey)).map(A=>c.createElement("div",{key:A.pKey,className:"p-3 bg-white rounded border border-green-200 text-sm"},c.createElement("p",{className:"font-medium text-gray-900"},A.materialDescription),c.createElement("p",{className:"text-xs text-gray-500 mt-1"},`Qty: ${A.qtyRequested}`),c.createElement("button",{onClick:()=>b(A.pKey,"B"),className:"mt-2 w-full px-2 py-1 text-xs bg-gray-200 text-gray-700 rounded hover:bg-gray-300"},"← Remove"))),y.length===0&&c.createElement("p",{className:"text-center text-green-400 text-sm py-8"},"Drag items here")))),c.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3 text-sm text-yellow-800 mb-4"},c.createElement("p",{className:"font-semibold"},"⚠️ Important:"),c.createElement("ul",{className:"list-disc ml-5 mt-1 space-y-1"},c.createElement("li",null,`Original ${t.id} will be cancelled`),c.createElement("li",null,"Two new MRFs will be created"),c.createElement("li",null,"This action cannot be undone"),c.createElement("li",null,"Materials will be re-locked to new MRFs"))),c.createElement("div",{className:"flex justify-between items-center"},c.createElement("div",{className:"text-sm text-gray-500"},`${u.length+y.length} of ${d.length} items assigned`),c.createElement("div",{className:"flex gap-3"},c.createElement("button",{onClick:j,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},"Cancel"),c.createElement("button",{onClick:_,disabled:u.length===0||y.length===0||C.length>0||!g,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed"},"Split Request")))))};function Jl(a,t){{const r=[];Object.entries(Rr).forEach(([s,l])=>{l.mrfId===a&&r.push(s)}),r.forEach(s=>{gt[s]&&delete gt[s],Rr[s]&&(Rr[s].status=t)}),console.log(`Auto-unlocked ${r.length} materials for MRF ${a} (status: ${t})`)}}const u0=({navigate:a,currentUser:t})=>{const[r,s]=E.useState([]),[l,d]=E.useState(0),[u,h]=E.useState({isOpen:!1,request:null}),[y,x]=E.useState({isOpen:!1,request:null}),[g,v]=E.useState({isOpen:!1,request:null}),b=t||Or.qube;E.useEffect(()=>{const M=ne.filter(q=>q.status==="Submitted"||q.status==="Picking");M.sort((q,Q)=>q.MC_Priority_Flag&&!Q.MC_Priority_Flag?-1:!q.MC_Priority_Flag&&Q.MC_Priority_Flag?1:q.MC_Queue_Position!==void 0&&Q.MC_Queue_Position!==void 0?q.MC_Queue_Position-Q.MC_Queue_Position:q.MC_Queue_Position!==void 0?-1:Q.MC_Queue_Position!==void 0?1:q.acPriority&&!Q.acPriority?-1:!q.acPriority&&Q.acPriority?1:q.acPriority&&Q.acPriority?q.acPriority-Q.acPriority:new Date(q.RequiredByTimestamp).getTime()-new Date(Q.RequiredByTimestamp).getTime()),s(M)},[l]),E.useEffect(()=>{const M=setInterval(()=>{d(q=>q+1)},2e3);return()=>clearInterval(M)},[]);const _=M=>{if(M.status==="Submitted"){const q=ne.findIndex(Q=>Q.id===M.id);q!==-1&&(ne[q].status="Picking")}a("picking",{request:M})},k=(M,q,Q)=>{if(!u.request)return;const me=ne.findIndex(ye=>ye.id===u.request.id);me!==-1&&(ne[me].status="On Hold",ne[me].onHoldInfo={putOnHoldBy:"Qube User",putOnHoldAt:new Date().toISOString(),reason:M,expectedResumeDate:q},ne[me].statusHistory=yt(ne[me].statusHistory,"On Hold","Qube User",`${M}${Q?` - ${Q}`:""}`),console.log(`✋ Request ${u.request.id} put On Hold: ${M}`)),h({isOpen:!1,request:null})},j=(M,q)=>{if(!y.request)return;const Q=ne.findIndex(me=>me.id===y.request.id);Q!==-1&&(ne[Q].status="Cancelled",ne[Q].statusHistory=yt(ne[Q].statusHistory,"Cancelled","Qube User",`${M}${q?` - ${q}`:""}`),Jl(y.request.id,"Cancelled"),console.log(`❌ Request ${y.request.id} cancelled: ${M}`)),x({isOpen:!1,request:null})},C=(M,q)=>{if(!g.request)return;const Q=g.request,me=ne.findIndex(ye=>ye.id===Q.id);if(me!==-1){const ye=`${Q.id}-A`,J=`${Q.id}-B`;ne[me].status="Cancelled",ne[me].statusHistory=yt(ne[me].statusHistory,"Cancelled","Qube User",`Split into ${ye} and ${J}: ${q}`),Jl(Q.id,"Cancelled");const ae={...Q,id:ye,status:"Submitted",items:M.splitA.length,createdDate:new Date().toLocaleDateString("en-US"),statusHistory:[{status:"Submitted",timestamp:new Date().toISOString(),changedBy:"Qube User",reason:`Split from ${Q.id} (Split A)`}]},K={...Q,id:J,status:"Submitted",items:M.splitB.length,createdDate:new Date().toLocaleDateString("en-US"),statusHistory:[{status:"Submitted",timestamp:new Date().toISOString(),changedBy:"Qube User",reason:`Split from ${Q.id} (Split B)`}]};ne.unshift(ae,K),console.log(`✂️ Split ${Q.id} into ${ye} (${M.splitA.length} items) and ${J} (${M.splitB.length} items)`),console.log(`Reason: ${q}`)}v({isOpen:!1,request:null})},A=M=>{const q=window.open("","_blank");q==null||q.document.write(`
            <html>
                <head><title>Pick Slip - ${M.id}</title>
                <style>
                    body { font-family: sans-serif; padding: 20px; } h1 { border-bottom: 2px solid black; padding-bottom: 10px; }
                    .details { margin: 20px 0; } .details p { margin: 5px 0; }
                    .details strong { display: inline-block; width: 150px; }
                </style>
                </head><body>
                    <h1>Pick Slip: ${M.id}</h1>
                    <div class="details">
                        <p><strong>Priority:</strong> ${M.MC_Priority_Flag?"P1 - CRITICAL":M.priority}</p>
                        <p><strong>Status:</strong> ${M.status}</p>
                        <p><strong># of Items:</strong> ${M.items}</p>
                        <p><strong>Required Time:</strong> ${new Date(M.RequiredByTimestamp).toLocaleString()}</p>
                        <p><strong>Delivery Location:</strong> ${M.DeliveryLocation}</p>
                        <p><strong>Work Order(s):</strong> ${M.workOrders}</p>
                    </div>
                    <h2>Line Items</h2>
                    <p><em>Line item details would be listed here based on the items in the request...</em></p>
                </body></html>
        `),q==null||q.document.close(),q==null||q.focus(),q==null||q.print()},S=({row:M})=>{const[q,Q]=E.useState(!1),[me,ye]=E.useState(null),J=H=>{H.stopPropagation(),ye(H.currentTarget),Q(!0)},ae=()=>{ye(null),Q(!1)},K=H=>{H.stopPropagation(),A(M),ae()},Y=H=>{H.stopPropagation(),v({isOpen:!0,request:M}),ae()},B=H=>{H.stopPropagation(),h({isOpen:!0,request:M}),ae()},z=H=>{H.stopPropagation(),x({isOpen:!0,request:M}),ae()},U=Hs(b,"split_request"),re=Hs(b,"put_on_hold"),G=gg(b,M);return c.createElement(c.Fragment,null,c.createElement("button",{onClick:J,className:"p-1 rounded-full hover:bg-gray-200 text-gray-500"},c.createElement(xe.EllipsisHorizontalIcon,{})),c.createElement(Qs,{isOpen:q,anchorEl:me,onClose:ae,className:"p-1"},c.createElement("button",{onClick:K,className:"w-full text-left px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-100 rounded"},"Print Pick Slip"),U&&c.createElement("button",{onClick:Y,className:"w-full text-left px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-100 rounded"},"Split Request"),re&&c.createElement("button",{onClick:B,className:"w-full text-left px-3 py-1.5 text-sm text-yellow-700 hover:bg-yellow-50 rounded"},"⏸️ Put On Hold"),G&&c.createElement("button",{onClick:z,className:"w-full text-left px-3 py-1.5 text-sm text-red-700 hover:bg-red-50 rounded"},"❌ Cancel Request")))},D=E.useMemo(()=>[{accessorKey:"priority",header:"Priority",cell:({row:M})=>M.MC_Priority_Flag?c.createElement("span",{className:"text-base px-2 py-1 font-bold bg-red-100 text-red-700 rounded-md"},"🚩 P1"):c.createElement("span",{className:"px-2 py-0.5 text-xs font-bold text-gray-600 bg-gray-100 rounded-full"},M.priority)},{accessorKey:"id",header:"Request ID",cell:({value:M})=>c.createElement("span",{className:"font-mono font-semibold text-blue-600"},M)},{accessorKey:"status",header:"Status",cell:({value:M})=>c.createElement(kt,{status:M})},{accessorKey:"items",header:"# of Items"},{accessorKey:"RequiredByTimestamp",header:"Required Time",cell:({value:M})=>c.createElement("span",null,new Date(M).toLocaleString())},{accessorKey:"eta",header:"ETA",enableFiltering:!1,cell:({row:M})=>M.status==="Delivered"||M.status==="Closed"||M.status==="Cancelled"?c.createElement("span",{className:"text-gray-400 text-sm"},"—"):c.createElement(Nh,{request:{priority:M.priority,status:M.status,queuePosition:M.MC_Queue_Position||1,requestedBy:M.RequestedBy}})},{accessorKey:"DeliveryLocation",header:"Delivery Location"},{accessorKey:"workOrders",header:"Work Order(s)"},{accessorKey:"actions",header:"",enableFiltering:!1,cell:({row:M})=>c.createElement(S,{row:M})}],[]),L=E.useMemo(()=>r.map(M=>({...M,onClick:()=>_(M)})),[r]);return c.createElement("div",null,c.createElement(Ar,{data:L,columns:D,uniqueId:"id"}),u.request&&c.createElement(l0,{isOpen:u.isOpen,request:u.request,onClose:()=>h({isOpen:!1,request:null}),onConfirm:k,currentUserName:"Qube User"}),y.request&&c.createElement(c0,{isOpen:y.isOpen,request:y.request,onClose:()=>x({isOpen:!1,request:null}),onConfirm:j,currentUserName:"Qube User"}),g.request&&c.createElement(d0,{isOpen:g.isOpen,request:g.request,onClose:()=>v({isOpen:!1,request:null}),onConfirm:C,currentUserName:"Qube User"}))};var Pl={exports:{}},Ms={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Om;function m0(){if(Om)return Ms;Om=1;var a=mc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function u(h,y,x){var g,v={},b=null,_=null;x!==void 0&&(b=""+x),y.key!==void 0&&(b=""+y.key),y.ref!==void 0&&(_=y.ref);for(g in y)s.call(y,g)&&!d.hasOwnProperty(g)&&(v[g]=y[g]);if(h&&h.defaultProps)for(g in y=h.defaultProps,y)v[g]===void 0&&(v[g]=y[g]);return{$$typeof:t,type:h,key:b,ref:_,props:v,_owner:l.current}}return Ms.Fragment=r,Ms.jsx=u,Ms.jsxs=u,Ms}var Am;function h0(){return Am||(Am=1,Pl.exports=m0()),Pl.exports}var o=h0();const p0=({isOpen:a,onClose:t,onSubmit:r,requestId:s})=>{const[l,d]=E.useState(1),[u,h]=E.useState([]),[y,x]=E.useState(""),[g,v]=E.useState(""),[b,_]=E.useState(""),[k,j]=E.useState(""),[C,A]=E.useState(),[S,D]=E.useState(!1),L=E.useRef(null),M=E.useRef(null);E.useEffect(()=>{a&&!C&&"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(U=>{A({latitude:U.coords.latitude,longitude:U.coords.longitude})},U=>{console.warn("GPS not available:",U)})},[a]),E.useEffect(()=>{const U=L.current;if(U&&l===2){const re=U.getContext("2d");re&&(re.strokeStyle="#000",re.lineWidth=2,re.lineCap="round",re.lineJoin="round")}},[l]);const q=U=>{const re=U.target.files;re&&Array.from(re).forEach(G=>{if(u.length>=5){alert("Maximum 5 photos allowed");return}const H=new FileReader;H.onloadend=()=>{const te=H.result,R=new Image;R.onload=()=>{const F=document.createElement("canvas"),ve=800,we=600;let Z=R.width,ie=R.height;Z>ie?Z>ve&&(ie*=ve/Z,Z=ve):ie>we&&(Z*=we/ie,ie=we),F.width=Z,F.height=ie;const ue=F.getContext("2d");if(ue){ue.drawImage(R,0,0,Z,ie);const _e=F.toDataURL("image/jpeg",.7);h(Ee=>[...Ee,_e])}},R.src=te},H.readAsDataURL(G)})},Q=U=>{h(re=>re.filter((G,H)=>H!==U))},me=U=>{const re=L.current;if(!re)return;D(!0);const G=re.getBoundingClientRect(),H=re.getContext("2d");if(!H)return;let te,R;"touches"in U?(te=U.touches[0].clientX-G.left,R=U.touches[0].clientY-G.top):(te=U.clientX-G.left,R=U.clientY-G.top),H.beginPath(),H.moveTo(te,R)},ye=U=>{if(!S)return;const re=L.current;if(!re)return;const G=re.getBoundingClientRect(),H=re.getContext("2d");if(!H)return;let te,R;"touches"in U?(te=U.touches[0].clientX-G.left,R=U.touches[0].clientY-G.top):(te=U.clientX-G.left,R=U.clientY-G.top),H.lineTo(te,R),H.stroke()},J=()=>{if(S){D(!1);const U=L.current;U&&x(U.toDataURL("image/png"))}},ae=()=>{const U=L.current;if(U){const re=U.getContext("2d");re&&(re.clearRect(0,0,U.width,U.height),x(""))}},K=()=>{if(l===1&&u.length===0){alert("Please capture at least one photo");return}if(l===2&&!y){alert("Please provide a signature");return}l<3&&d(U=>U+1)},Y=()=>{l>1&&d(U=>U-1)},B=()=>{if(!g.trim()){alert("Please enter recipient name");return}const U={photos:u,signature:y,recipientName:g.trim(),recipientTitle:b.trim()||void 0,gpsCoordinates:C,notes:k.trim()||void 0,timestamp:new Date().toISOString()};r(U),h([]),x(""),v(""),_(""),j(""),A(void 0),d(1)},z=()=>{h([]),x(""),v(""),_(""),j(""),A(void 0),d(1),t()};return a?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:["Proof of Delivery - ",s]}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Step ",l," of 3: ",l===1?"Photos":l===2?"Signature":"Details"]})]}),o.jsx("button",{onClick:z,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:o.jsx(xe.XMarkIcon,{className:"h-6 w-6"})})]}),o.jsx("div",{className:"mt-4 flex space-x-2",children:[1,2,3].map(U=>o.jsx("div",{className:`flex-1 h-2 rounded-full ${U<=l?"bg-blue-600":"bg-gray-200"}`},U))})]}),o.jsxs("div",{className:"px-6 py-6",children:[l===1&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Delivery Photos (",u.length,"/5)"]}),o.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Take photos of the delivered materials and delivery location"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[u.map((U,re)=>o.jsxs("div",{className:"relative group",children:[o.jsx("img",{src:U,alt:`Delivery ${re+1}`,className:"w-full h-32 object-cover rounded-lg border-2 border-gray-200"}),o.jsx("button",{onClick:()=>Q(re),className:"absolute top-2 right-2 bg-red-600 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:o.jsx(xe.TrashIcon,{className:"h-4 w-4"})})]},re)),u.length<5&&o.jsxs("label",{className:"flex flex-col items-center justify-center h-32 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[o.jsx(xe.CameraIcon,{className:"h-8 w-8 text-gray-400 mb-2"}),o.jsx("span",{className:"text-sm text-gray-500",children:"Add Photo"}),o.jsx("input",{ref:M,type:"file",accept:"image/*",capture:"environment",multiple:!0,onChange:q,className:"hidden"})]})]})]}),C&&o.jsxs("div",{className:"flex items-center text-sm text-gray-600 bg-green-50 p-3 rounded-lg",children:[o.jsx(xe.MapPinIcon,{className:"h-5 w-5 text-green-600 mr-2"}),o.jsxs("span",{children:["Location captured: ",C.latitude.toFixed(6),", ",C.longitude.toFixed(6)]})]})]}),l===2&&o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recipient Signature"}),o.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Please have the recipient sign below"}),o.jsx("div",{className:"border-2 border-gray-300 rounded-lg bg-white",children:o.jsx("canvas",{ref:L,width:600,height:300,onMouseDown:me,onMouseMove:ye,onMouseUp:J,onMouseLeave:J,onTouchStart:me,onTouchMove:ye,onTouchEnd:J,className:"w-full h-64 touch-none cursor-crosshair",style:{touchAction:"none"}})}),o.jsx("button",{onClick:ae,className:"mt-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Clear Signature"})]})}),l===3&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Recipient Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:g,onChange:U=>v(U.target.value),placeholder:"Full name",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recipient Title / Role"}),o.jsx("input",{type:"text",value:b,onChange:U=>_(U.target.value),placeholder:"e.g., Site Supervisor, Engineer",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Notes"}),o.jsx("textarea",{value:k,onChange:U=>j(U.target.value),placeholder:"Any additional notes about the delivery...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[o.jsx("h5",{className:"font-medium text-gray-900",children:"Delivery Summary"}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(xe.CameraIcon,{className:"h-4 w-4 mr-2"}),u.length," photo(s) captured"]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(xe.PencilIcon,{className:"h-4 w-4 mr-2"}),"Signature obtained"]}),C&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(xe.MapPinIcon,{className:"h-4 w-4 mr-2"}),"GPS location recorded"]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(xe.ClockIcon,{className:"h-4 w-4 mr-2"}),new Date().toLocaleString()]})]})]})]})]}),o.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-between",children:[o.jsx("button",{onClick:z,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),o.jsxs("div",{className:"flex space-x-3",children:[l>1&&o.jsx("button",{onClick:Y,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Back"}),l<3?o.jsx("button",{onClick:K,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Next"}):o.jsx("button",{onClick:B,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Complete Delivery"})]})]})]})}):null},jh=()=>navigator.onLine,f0=async()=>{if(!("serviceWorker"in navigator))return!1;try{const a=await navigator.serviceWorker.getRegistration();return(a==null?void 0:a.active)!==void 0}catch{return!1}};let Yl=[];const g0=(a,t,r)=>{const s={id:`OFFLINE-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,type:a,endpoint:t,data:r,timestamp:new Date().toISOString()};Yl.push(s);try{localStorage.setItem("scmhub_offline_queue",JSON.stringify(Yl))}catch(l){console.error("Failed to save offline queue:",l)}return s.id},y0=()=>({isOnline:jh(),serviceWorkerActive:!1,queuedOperations:Yl.length,cacheAvailable:"caches"in window});f0().then(a=>{y0()});let tn=[];const vi=a=>{const t={id:`AUDIT-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),...a};tn.unshift(t),tn.length>1e4&&(tn=tn.slice(0,1e4)),console.log("[AUDIT]",t)},x0=a=>{let t=[...tn];a!=null&&a.userId&&(t=t.filter(s=>s.userId===a.userId)),a!=null&&a.action&&(t=t.filter(s=>s.action===a.action)),a!=null&&a.entityType&&(t=t.filter(s=>s.entityType===a.entityType)),a!=null&&a.entityId&&(t=t.filter(s=>s.entityId===a.entityId)),a!=null&&a.startDate&&(t=t.filter(s=>s.timestamp>=a.startDate)),a!=null&&a.endDate&&(t=t.filter(s=>s.timestamp<=a.endDate));const r=(a==null?void 0:a.limit)||100;return t.slice(0,r)},v0=a=>{const t=["ID","Timestamp","User","Action","Entity Type","Entity ID","Details"],r=a.map(l=>[l.id,l.timestamp,l.userName,l.action,l.entityType,l.entityId,JSON.stringify(l.details)]);return[t.join(","),...r.map(l=>l.map(d=>`"${d}"`).join(","))].join(`
`)},b0=()=>{const a=["status_change","priority_change","create_request","approval","manual_override"],t=[{id:"mc",name:"Corey"},{id:"ac",name:"Steve"},{id:"qube",name:"JJ"},{id:"requestor",name:"Jane Doe"}];for(let r=0;r<50;r++){const s=t[Math.floor(Math.random()*t.length)],l=a[Math.floor(Math.random()*a.length)],d=`MRF-${1200+Math.floor(Math.random()*50)}`,u={userId:s.id,userName:s.name,action:l,entityType:"material_request",entityId:d,details:{before:l==="status_change"?"Submitted":"P3",after:l==="status_change"?"Picking":"P2",reason:"Updated per coordinator request"}},h=new Date(Date.now()-Math.random()*7*24*60*60*1e3).toISOString();tn.push({id:`AUDIT-SEED-${r}`,timestamp:h,...u})}tn.sort((r,s)=>new Date(s.timestamp).getTime()-new Date(r.timestamp).getTime())};b0();const w0=({params:a,navigate:t})=>{const[r,s]=E.useState([]),[l,d]=E.useState({}),[u,h]=E.useState(null),[y,x]=E.useState(null),[g,v]=E.useState(!1);if(E.useEffect(()=>{(!a||!a.request)&&t("picklist")},[a,t]),!a||!a.request)return c.createElement("div",{className:"p-8 text-center"},c.createElement("p",null,"Redirecting to pick list..."));const{request:b}=a;E.useEffect(()=>{s(JSON.parse(JSON.stringify(zs[b.id]||[])))},[b.id]);const _=(L,M,q={})=>{const Q=Array.isArray(L)?L:[L],me=r.map(J=>Q.includes(J.pKey)?{...J,status:M,...q}:J),ye=zs[b.id];ye&&Q.forEach(J=>{const ae=ye.find(K=>K.pKey===J);ae&&(ae.status=M)}),s(me)},k=()=>{_(r.map(L=>L.pKey),"Picked"),h(null)},j=()=>{const L=ne.findIndex(M=>M.id===b.id);L>-1&&(ne[L].status="Ready for Collection"),h(null),t("picklist")},C=({row:L})=>{const[M,q]=E.useState(!1),[Q,me]=E.useState(null),ye=ae=>{ae.stopPropagation(),me(ae.currentTarget),q(!0)},J=()=>q(!1);return c.createElement(c.Fragment,null,c.createElement("button",{onClick:ye},c.createElement(xe.EllipsisHorizontalIcon,{})),c.createElement(Qs,{isOpen:M,anchorEl:Q,onClose:J,className:"p-1"},c.createElement("button",{onClick:()=>{_(L.pKey,"Picked"),J()},className:"w-full text-left px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-100 rounded"},"Mark as Picked"),c.createElement("button",{onClick:()=>{h("partialPick"),x(L),J()},className:"w-full text-left px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-100 rounded"},"Log Partial Pick"),c.createElement("button",{onClick:()=>{h("flagShort"),x(L),J()},className:"w-full text-left px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-100 rounded"},"Mark as Short")))},A=E.useMemo(()=>[{accessorKey:"status",header:"Status",cell:({value:L})=>c.createElement(kt,{status:L})},{accessorKey:"qtyRequested",header:"Qty"},{accessorKey:"materialDescription",header:"Material Description"},{accessorKey:"itemNumber",header:"Item Number"},{accessorKey:"storageLocation",header:"Storage Location"},{accessorKey:"packNumber",header:"Pack #"},{accessorKey:"actions",header:"Actions",cell:({row:L})=>c.createElement(C,{row:L})}],[r]),S=r.every(L=>L.status!=="Open"),D=()=>{if(u==="markAllConfirm")return c.createElement(ci,{isOpen:!0,title:"Mark All as Picked",confirmText:"Yes, Mark All",onCancel:()=>h(null),onConfirm:k},`Are you sure you want to mark all ${r.length} items as picked?`);if(u==="stageCompleteConfirm"){const L=r.filter(q=>q.status==="Picked").length,M=r.filter(q=>q.status==="Short").length;return c.createElement(ci,{isOpen:!0,title:`Complete Request ${b.id}?`,confirmText:"Confirm Stage Complete",onCancel:()=>h(null),onConfirm:j},c.createElement("div",{className:"space-y-2"},c.createElement("p",null,`Items Picked: ${L}`),c.createElement("p",null,`Items Short: ${M}`),c.createElement("p",{className:"mt-4 text-sm text-gray-500"},"This action cannot be undone and will send a delivery task to the LTR system.")))}return u==="flagShort"&&y?c.createElement(ci,{isOpen:!0,title:"Mark Item as Short",onCancel:()=>h(null),onConfirm:()=>{_(y.pKey,"Short"),h(null)},confirmText:"Mark as Short"},c.createElement("div",{className:"space-y-4"},c.createElement("p",null,`Item: ${y.materialDescription}`),c.createElement("div",null,c.createElement("label",{htmlFor:"shortReason",className:"block text-sm font-medium text-gray-700"},"Short Reason"),c.createElement("select",{id:"shortReason",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"},hg.map(L=>c.createElement("option",{key:L},L)))),c.createElement("div",null,c.createElement("label",{htmlFor:"exceptionComment",className:"block text-sm font-medium text-gray-700"},"Comment (Optional)"),c.createElement("textarea",{id:"exceptionComment",rows:3,className:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})),c.createElement("div",null,c.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Photo (Optional)"),c.createElement("button",{className:"mt-1 w-full flex justify-center py-2 px-4 border border-dashed border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"},"Upload Photo")))):u==="partialPick"&&y?c.createElement(ci,{isOpen:!0,title:"Log Partial Pick",onCancel:()=>h(null),onConfirm:()=>{_(y.pKey,"Short",{comment:"Partial Pick"}),h(null)},confirmText:"Log Partial Pick"},c.createElement("div",{className:"space-y-4"},c.createElement("p",null,`Item: ${y.materialDescription}`),c.createElement("p",null,`Requested Quantity: ${y.qtyRequested}`),c.createElement("div",null,c.createElement("label",{htmlFor:"qtyPicked",className:"block text-sm font-medium text-gray-700"},"Quantity Picked"),c.createElement("input",{type:"number",id:"qtyPicked",className:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})),c.createElement("p",{className:"text-xs text-gray-500"},"The remaining quantity will be put on a new back-ordered request line."))):null};return!b||r.length===0?c.createElement("div",null,"Loading request..."):c.createElement("div",{className:"space-y-4"},D(),c.createElement("div",{className:"bg-white p-4 rounded-xl border border-gray-200 flex items-center justify-between"},c.createElement("div",null,c.createElement("h2",{className:"text-lg font-bold text-gray-800"},`Picking Request: ${b.id}`),c.createElement("p",{className:"text-sm text-gray-500"},`Deliver To: ${b.DeliveryLocation}`)),c.createElement("button",{onClick:()=>t("picklist"),className:"flex items-center space-x-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},c.createElement(xe.ChevronLeftIcon,null),c.createElement("span",null,"Back to Pick List"))),c.createElement("div",{className:"bg-white p-4 rounded-xl border border-gray-200 flex items-center space-x-2"},c.createElement("button",{onClick:()=>h("markAllConfirm"),className:"px-4 py-2 text-sm font-semibold text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200"},"✅ Mark All as Picked"),c.createElement("button",{className:"px-4 py-2 text-sm font-semibold text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200"},"⬇️ Bulk Update Status")),c.createElement(Ar,{data:r,columns:A,uniqueId:"pKey",enableSelection:!0,onSelectionChange:d}),S&&c.createElement("div",{className:"space-y-2"},c.createElement("button",{onClick:()=>h("stageCompleteConfirm"),className:"w-full py-4 text-lg font-bold text-white bg-blue-600 rounded-lg hover:bg-blue-700 shadow-lg"},"📦 Stage Complete"),c.createElement("button",{onClick:()=>v(!0),className:"w-full py-4 text-lg font-bold text-white bg-green-600 rounded-lg hover:bg-green-700 shadow-lg"},"✅ Capture POD & Mark Delivered")),c.createElement(p0,{isOpen:g,onClose:()=>v(!1),requestId:b.id,onSubmit:async L=>{try{jh()?(console.log("📸 Uploading POD photos to photoService..."),vi({userId:"qube",userName:Or.qube.name,action:"pod_captured",entityType:"material_request",entityId:b.id,details:{photoCount:L.photos.length,hasSignature:!!L.signature,gps:L.gpsCoordinates,recipientName:L.recipientName}}),await ji({type:"delivered",recipients:[b.RequestedBy,"mc@company.com"],title:`📦 Materials Delivered - ${b.id}`,message:"Your material request has been delivered and POD captured.",data:{requestId:b.id,podData:{recipientName:L.recipientName,timestamp:L.timestamp,photoCount:L.photos.length}},priority:b.priority==="P1"?"high":"normal"}),console.log("✅ POD uploaded and notifications sent")):(console.log("📴 Offline - queueing POD for sync"),g0("create","/pod/upload",{requestId:b.id,data:L}),alert("⚠️ Offline mode: POD will be uploaded when connection is restored"));const q=ne.findIndex(Q=>Q.id===b.id);q!==-1&&(ne[q].pod={...L,capturedBy:Or.qube.name},ne[q].status="Delivered",ne[q].statusHistory||(ne[q].statusHistory=[]),ne[q].statusHistory.push({status:"Delivered",timestamp:new Date().toISOString(),changedBy:Or.qube.name,reason:"POD captured and delivery confirmed"}),console.log("✅ POD captured and request marked as Delivered:",b.id)),v(!1),t("picklist")}catch(M){console.error("❌ Error submitting POD:",M),alert("Error submitting POD. Please try again.")}}}))},_0=({isOpen:a,request:t,onClose:r,onConfirm:s,currentUserName:l})=>{const[d,u]=E.useState(""),h=()=>{s(d||void 0),u("")},y=()=>{u(""),r()};if(!a)return null;const x=t.onHoldInfo;return c.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:g=>{g.target===g.currentTarget&&y()}},c.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6"},c.createElement("div",{className:"mb-4"},c.createElement("h2",{className:"text-xl font-bold text-green-900"},`Resume ${t.id}?`),c.createElement("p",{className:"text-sm text-gray-500 mt-1"},"Work will continue on this request.")),c.createElement("div",{className:"space-y-4"},c.createElement("div",{className:"bg-gray-50 p-3 rounded text-sm"},c.createElement("p",null,c.createElement("strong",null,"Priority: "),t.priority),c.createElement("p",null,c.createElement("strong",null,"Delivery: "),t.DeliveryLocation),c.createElement("p",null,c.createElement("strong",null,"Items: "),t.items)),x&&c.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3 text-sm"},c.createElement("p",{className:"font-semibold text-yellow-900 mb-1"},"Currently On Hold:"),c.createElement("p",{className:"text-yellow-800"},c.createElement("strong",null,"Reason: "),x.reason),c.createElement("p",{className:"text-yellow-800"},c.createElement("strong",null,"Put on hold by: "),x.putOnHoldBy),c.createElement("p",{className:"text-yellow-800"},c.createElement("strong",null,"Date: "),new Date(x.putOnHoldAt).toLocaleString()),x.expectedResumeDate&&c.createElement("p",{className:"text-yellow-800"},c.createElement("strong",null,"Expected resume: "),new Date(x.expectedResumeDate).toLocaleDateString())),c.createElement("div",null,c.createElement("label",{htmlFor:"resumeNotes",className:"block text-sm font-medium text-gray-700 mb-1"},"Resume Notes (Optional)"),c.createElement("textarea",{id:"resumeNotes",value:d,onChange:g=>u(g.target.value),rows:2,placeholder:"Why is this being resumed? Any updates?",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})),c.createElement("div",{className:"bg-green-50 border border-green-200 rounded p-3 text-sm text-green-800"},c.createElement("p",null,'✅ Request will return to "Submitted" status and work can continue.'))),c.createElement("div",{className:"flex justify-end gap-3 mt-6"},c.createElement("button",{onClick:y,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},"Cancel"),c.createElement("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700"},"▶️ Resume Request"))))},k0=({navigate:a})=>{const[t,r]=E.useState([]),[s,l]=E.useState({isOpen:!1,request:null}),[d,u]=E.useState(0);E.useEffect(()=>{const v=ne.filter(b=>b.status==="On Hold");v.sort((b,_)=>{var k,j,C,A;return(k=b.onHoldInfo)!=null&&k.expectedResumeDate&&((j=_.onHoldInfo)!=null&&j.expectedResumeDate)?new Date(b.onHoldInfo.expectedResumeDate).getTime()-new Date(_.onHoldInfo.expectedResumeDate).getTime():(C=b.onHoldInfo)!=null&&C.expectedResumeDate?-1:(A=_.onHoldInfo)!=null&&A.expectedResumeDate?1:b.MC_Priority_Flag&&!_.MC_Priority_Flag?-1:!b.MC_Priority_Flag&&_.MC_Priority_Flag?1:0}),r(v)},[d]),E.useEffect(()=>{const v=setInterval(()=>{u(b=>b+1)},3e3);return()=>clearInterval(v)},[]);const h=v=>{if(!s.request)return;const b=ne.findIndex(_=>_.id===s.request.id);b!==-1&&(ne[b].status="Submitted",ne[b].statusHistory=yt(ne[b].statusHistory,"Submitted","Qube User",`Resumed from On Hold${v?`: ${v}`:""}`),delete ne[b].onHoldInfo,console.log(`▶️ Request ${s.request.id} resumed from On Hold`)),l({isOpen:!1,request:null})},y=v=>{l({isOpen:!0,request:v})},x=E.useMemo(()=>[{accessorKey:"priority",header:"Priority",cell:({row:v})=>v.MC_Priority_Flag?c.createElement("span",{className:"px-2 py-0.5 text-xs font-bold text-white bg-red-600 rounded-full"},"P1 🔥"):c.createElement("span",{className:"px-2 py-0.5 text-xs font-bold text-gray-600 bg-gray-100 rounded-full"},v.priority)},{accessorKey:"id",header:"Request ID",cell:({value:v})=>c.createElement("span",{className:"font-mono font-semibold text-blue-600"},v)},{accessorKey:"status",header:"Status",cell:({value:v})=>c.createElement(kt,{status:v})},{accessorKey:"onHoldInfo",header:"Hold Reason",cell:({row:v})=>{var b;return c.createElement("span",{className:"text-sm"},((b=v.onHoldInfo)==null?void 0:b.reason)||"N/A")}},{accessorKey:"onHoldInfo.putOnHoldAt",header:"On Hold Since",cell:({row:v})=>c.createElement("span",{className:"text-sm"},v.onHoldInfo?new Date(v.onHoldInfo.putOnHoldAt).toLocaleDateString():"N/A")},{accessorKey:"onHoldInfo.expectedResumeDate",header:"Expected Resume",cell:({row:v})=>{var b;return(b=v.onHoldInfo)!=null&&b.expectedResumeDate?c.createElement("span",{className:"text-sm font-medium text-green-700"},new Date(v.onHoldInfo.expectedResumeDate).toLocaleDateString()):c.createElement("span",{className:"text-sm text-gray-400"},"Not specified")}},{accessorKey:"items",header:"# Items"},{accessorKey:"DeliveryLocation",header:"Delivery Location"},{accessorKey:"workOrders",header:"Work Order(s)"}],[]),g=E.useMemo(()=>t.map(v=>({...v,onClick:()=>y(v)})),[t]);return c.createElement("div",{className:"space-y-4"},c.createElement("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4"},c.createElement("div",{className:"flex"},c.createElement("div",{className:"flex-shrink-0"},c.createElement("span",{className:"text-2xl"},"⏸️")),c.createElement("div",{className:"ml-3"},c.createElement("h3",{className:"text-sm font-medium text-yellow-800"},"On Hold Requests"),c.createElement("div",{className:"mt-2 text-sm text-yellow-700"},c.createElement("p",null,`${t.length} request(s) currently on hold. Click a row to resume.`))))),c.createElement(Ar,{data:g,columns:x,uniqueId:"id"}),s.request&&c.createElement(_0,{isOpen:s.isOpen,request:s.request,onClose:()=>l({isOpen:!1,request:null}),onConfirm:h,currentUserName:"Qube User"}))},Rl=({title:a,value:t,icon:r,children:s,onClick:l,color:d="blue"})=>{const u={blue:"bg-blue-100 text-blue-600",amber:"bg-amber-100 text-amber-600",red:"bg-red-100 text-red-600",green:"bg-green-100 text-green-600",gray:"bg-gray-100 text-gray-600"},h=`bg-white p-5 rounded-xl border border-gray-200 flex items-start justify-between ${l?"cursor-pointer hover:shadow-md hover:border-blue-300":""}`;return c.createElement("div",{className:h,onClick:l},c.createElement("div",null,c.createElement("p",{className:"text-sm font-medium text-gray-500"},a),t&&c.createElement("p",{className:"text-2xl font-bold text-gray-800 mt-1"},t),s),r&&c.createElement("div",{className:`${u[d]} p-3 rounded-full`},r))},E0=({requests:a,setRequests:t,openDetailPanel:r})=>{const[s,l]=E.useState(null),[d,u]=E.useState(null),h=(b,_)=>{l(_),b.dataTransfer.effectAllowed="move",b.dataTransfer.setData("text/plain",_.id),b.currentTarget.classList.add("dragging")},y=(b,_)=>{b.preventDefault(),_.id!==(s==null?void 0:s.id)&&u(_)},x=b=>{u(null)},g=(b,_)=>{if(b.preventDefault(),s&&s.id!==_.id){const k=a.findIndex(S=>S.id===s.id),j=a.findIndex(S=>S.id===_.id),C=[...a],[A]=C.splice(k,1);C.splice(j,0,A),t(C.map((S,D)=>({...S,acPriority:D+1})))}l(null),u(null)},v=b=>{b.currentTarget.classList.remove("dragging"),l(null),u(null)};return c.createElement("div",{className:"space-y-2"},a.map(b=>{const _=(d==null?void 0:d.id)===b.id,k={key:b.id,draggable:!0,onDragStart:j=>h(j,b),onDragOver:j=>y(j,b),onDragLeave:x,onDrop:j=>g(j,b),onDragEnd:v,onClick:()=>r(b),className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg cursor-grab hover:bg-gray-50 hover:shadow-sm"};return c.createElement("div",{key:b.id},_&&s&&a.findIndex(j=>j.id===s.id)>a.findIndex(j=>j.id===b.id)&&c.createElement("div",{className:"drop-indicator"}),c.createElement("div",k,c.createElement("div",{className:"flex items-center space-x-4"},c.createElement("div",{className:"text-gray-400 font-bold text-lg"},b.acPriority),c.createElement("div",null,c.createElement("p",{className:"font-semibold text-blue-600"},b.id),c.createElement("p",{className:"text-sm text-gray-500"},`To: ${b.DeliveryLocation} | Items: ${b.items}`))),c.createElement("div",null,c.createElement("span",{className:`px-2 py-0.5 text-xs font-bold ${b.priority==="P1"?"text-red-700 bg-red-100":"text-gray-600 bg-gray-100"} rounded-full`},b.priority))),_&&s&&a.findIndex(j=>j.id===s.id)<a.findIndex(j=>j.id===b.id)&&c.createElement("div",{className:"drop-indicator"}))}))},S0=({openDetailPanel:a})=>{const[t,r]=E.useState("priorityQueue"),[s,l]=E.useState(!1),[d,u]=E.useState([]);E.useEffect(()=>{const g=ne.filter(v=>v.status==="Submitted").sort((v,b)=>(v.acPriority||999)-(b.acPriority||999));u(g)},[]);const h=g=>{u(g),g.forEach(v=>{const b=ne.find(_=>_.id===v.id);b&&(b.acPriority=v.acPriority)})},y=E.useMemo(()=>[{accessorKey:"id",header:"Request ID",cell:({value:g})=>c.createElement("span",{className:"font-mono font-semibold text-blue-600"},g)},{accessorKey:"status",header:"Status",cell:({value:g})=>c.createElement(kt,{status:g})},{accessorKey:"priority",header:"Priority",cell:({value:g})=>c.createElement("span",{className:`px-2 py-0.5 text-xs font-bold ${g==="P1"?"text-red-700 bg-red-100":"text-gray-600 bg-gray-100"} rounded-full`},g)},{accessorKey:"items",header:"# of Items"},{accessorKey:"workOrders",header:"Work Order(s)",cell:({value:g})=>c.createElement("span",{className:"font-mono"},g)},{accessorKey:"createdDate",header:"Created Date"}],[]),x=E.useMemo(()=>ne.map(g=>({...g,onClick:a})),[a]);return c.createElement("div",{className:"space-y-6"},c.createElement(Fg,{isOpen:s,onClose:()=>l(!1),mockMaterialLocks:gt,masterGridData:sr}),c.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6"},c.createElement(Rl,{title:"⚠️ My Scope's Partial Picks",value:ne.filter(g=>g.status==="Partial Pick - Open"||g.status==="Partial Pick - Closed").length,icon:c.createElement(xe.ExclamationTriangleIcon,{}),color:"amber",onClick:()=>alert("Navigate to pre-filtered list of exceptions.")}),c.createElement(Rl,{title:"... My Scope's Queue Position",icon:c.createElement(xe.QueueListIcon,{className:"h-6 w-6"}),color:"blue"},c.createElement("div",{className:"mt-2 text-xs space-y-1 text-gray-600"},c.createElement("p",null,c.createElement("strong",{className:"font-bold text-gray-800"},"8 requests")," in the Qube queue."),c.createElement("p",null,c.createElement("strong",{className:"font-bold text-gray-800"},"Highest Priority Item: "),"MRF-1232 at position #2."),c.createElement("p",null,c.createElement("strong",{className:"font-bold text-gray-800"},"Next Item to be Picked: "),"MRF-1235 at position #7."))),c.createElement(Rl,{title:"🔒 Locked Materials",value:Object.keys(gt).length,icon:c.createElement(xe.LockClosedIcon,{}),color:"gray",onClick:()=>l(!0)})),c.createElement("div",{className:"bg-white rounded-xl border border-gray-200"},c.createElement("div",{className:"border-b px-4"},c.createElement("nav",{className:"-mb-px flex space-x-6"},c.createElement("button",{onClick:()=>r("priorityQueue"),className:`py-3 px-1 border-b-2 font-semibold text-sm ${t==="priorityQueue"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},"🚀 AC Priority Queue"),c.createElement("button",{onClick:()=>r("allRequests"),className:`py-3 px-1 border-b-2 font-semibold text-sm ${t==="allRequests"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},"All Scope Requests"))),c.createElement("div",{className:"p-4"},t==="priorityQueue"?c.createElement(E0,{requests:d,setRequests:h,openDetailPanel:a}):c.createElement(Ar,{data:x,columns:y,uniqueId:"id"}))))},Dl=()=>{const a=new Date;a.toISOString().split("T")[0];const t=["Submitted","Picking","Partial Pick - Open","Staged","In Transit"],r=ne.filter(_=>t.includes(_.status)).length,s=ne.filter(_=>_.status==="Submitted").length,l=ne.filter(_=>_.status==="Delivered"&&_.createdDate===new Date().toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})).length,d=4.2,u=ne.filter(_=>["Partial Pick - Open","Partial Pick - Closed","Delivered"].includes(_.status)).length,h=ne.filter(_=>_.status.includes("Partial Pick")).length,y=u>0?h/u*100:0,g=ne.filter(_=>_.priority==="P1").length,v=12.5,b=ne.filter(_=>_.status==="Delivered"||_.status==="Cancelled"?!1:new Date(_.RequiredByTimestamp)<a).length;return{timestamp:a.toISOString(),requestBacklog:s,avgFulfillmentTime:d,shortPickRate:y,p1RequestCount:g,p1AvgApprovalTime:v,activeRequests:r,completedToday:l,overdueRequests:b}},N0=(a=7)=>{const t=[],r=new Date;for(let s=a-1;s>=0;s--){const l=new Date(r);l.setDate(l.getDate()-s),t.push({timestamp:l.toISOString(),requestBacklog:3+Math.floor(Math.random()*5),avgFulfillmentTime:3.5+Math.random()*2,shortPickRate:8+Math.random()*7,p1RequestCount:Math.floor(Math.random()*3),p1AvgApprovalTime:10+Math.random()*10,activeRequests:5+Math.floor(Math.random()*10),completedToday:Math.floor(Math.random()*8),overdueRequests:Math.floor(Math.random()*3)})}return t},ft={requestBacklog:{warning:10,critical:20},avgFulfillmentTime:{warning:6,critical:12},shortPickRate:{warning:15,critical:25},p1AvgApprovalTime:{warning:30,critical:60},overdueRequests:{warning:5,critical:10}},$s=(a,t)=>{const r=ft[a];return r?t>=r.critical?"critical":t>=r.warning?"warning":"ok":"ok"},Gr=({title:a,value:t,unit:r,trend:s,alert:l,subtitle:d})=>{const u={ok:"border-green-200 bg-green-50",warning:"border-yellow-200 bg-yellow-50",critical:"border-red-200 bg-red-50"},h={ok:"text-green-700",warning:"text-yellow-700",critical:"text-red-700"};return o.jsxs("div",{className:`bg-white rounded-lg border-2 p-6 ${l?u[l]:"border-gray-200"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-600",children:a}),l&&l!=="ok"&&o.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${l==="critical"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:l==="critical"?"🔴 Critical":"⚠️ Warning"})]}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:`text-3xl font-bold ${l?h[l]:"text-gray-900"}`,children:t}),r&&o.jsx("span",{className:"ml-2 text-sm text-gray-500",children:r})]}),d&&o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:d}),s&&o.jsxs("div",{className:"mt-2 flex items-center",children:[s==="up"&&o.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),s==="down"&&o.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M14.707 10.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 12.586V5a1 1 0 012 0v7.586l2.293-2.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})]})},j0=()=>{const[a,t]=E.useState(Dl()),[r,s]=E.useState(!0),[l]=E.useState(N0(7));E.useEffect(()=>{if(!r)return;const u=setInterval(()=>{t(Dl())},3e4);return()=>clearInterval(u)},[r]);const d=()=>{t(Dl())};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"System Health Monitoring"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Real-time metrics and performance indicators"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[o.jsx("input",{type:"checkbox",checked:r,onChange:u=>s(u.target.checked),className:"rounded border-gray-300"}),"Auto-refresh (30s)"]}),o.jsxs("button",{onClick:d,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]})]}),o.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",new Date(a.timestamp).toLocaleTimeString()]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsx(Gr,{title:"Active Requests",value:a.activeRequests,subtitle:"Currently in system"}),o.jsx(Gr,{title:"Request Backlog",value:a.requestBacklog,subtitle:"Awaiting pickup",alert:$s("requestBacklog",a.requestBacklog)}),o.jsx(Gr,{title:"Completed Today",value:a.completedToday,subtitle:"Delivered requests",trend:"up"}),o.jsx(Gr,{title:"Overdue Requests",value:a.overdueRequests,subtitle:"Past required date",alert:$s("overdueRequests",a.overdueRequests)})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Performance Metrics"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx(Gr,{title:"Avg Fulfillment Time",value:a.avgFulfillmentTime.toFixed(1),unit:"hours",alert:$s("avgFulfillmentTime",a.avgFulfillmentTime),subtitle:`Target: < ${ft.avgFulfillmentTime.warning}hrs`}),o.jsx(Gr,{title:"Short Pick Rate",value:a.shortPickRate.toFixed(1),unit:"%",alert:$s("shortPickRate",a.shortPickRate),subtitle:`Target: < ${ft.shortPickRate.warning}%`}),o.jsx(Gr,{title:"P1 Avg Approval Time",value:a.p1AvgApprovalTime.toFixed(1),unit:"min",alert:$s("p1AvgApprovalTime",a.p1AvgApprovalTime),subtitle:`Target: < ${ft.p1AvgApprovalTime.warning}min`})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"P1 Priority Tracking"}),o.jsxs("span",{className:`px-3 py-1 text-sm font-semibold rounded-full ${a.p1RequestCount===0?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:[a.p1RequestCount," Active P1 Requests"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border border-orange-200",children:[o.jsx("div",{className:"text-sm font-medium text-orange-700 mb-1",children:"P1 Request Count"}),o.jsx("div",{className:"text-2xl font-bold text-orange-900",children:a.p1RequestCount}),o.jsx("div",{className:"text-xs text-orange-600 mt-1",children:"Requires MC approval"})]}),o.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[o.jsx("div",{className:"text-sm font-medium text-blue-700 mb-1",children:"Avg Approval Time"}),o.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:[a.p1AvgApprovalTime.toFixed(1)," min"]}),o.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"From submission to approval"})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Alert Thresholds"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[o.jsx("span",{className:"text-sm text-gray-700",children:"Request Backlog"}),o.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[o.jsxs("span",{className:"text-yellow-600",children:["⚠️ Warning: ",ft.requestBacklog.warning,"+"]}),o.jsxs("span",{className:"text-red-600",children:["🔴 Critical: ",ft.requestBacklog.critical,"+"]})]})]}),o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[o.jsx("span",{className:"text-sm text-gray-700",children:"Avg Fulfillment Time"}),o.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[o.jsxs("span",{className:"text-yellow-600",children:["⚠️ Warning: ",ft.avgFulfillmentTime.warning,"+ hrs"]}),o.jsxs("span",{className:"text-red-600",children:["🔴 Critical: ",ft.avgFulfillmentTime.critical,"+ hrs"]})]})]}),o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[o.jsx("span",{className:"text-sm text-gray-700",children:"Short Pick Rate"}),o.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[o.jsxs("span",{className:"text-yellow-600",children:["⚠️ Warning: ",ft.shortPickRate.warning,"%+"]}),o.jsxs("span",{className:"text-red-600",children:["🔴 Critical: ",ft.shortPickRate.critical,"%+"]})]})]}),o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[o.jsx("span",{className:"text-sm text-gray-700",children:"P1 Approval Time"}),o.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[o.jsxs("span",{className:"text-yellow-600",children:["⚠️ Warning: ",ft.p1AvgApprovalTime.warning,"+ min"]}),o.jsxs("span",{className:"text-red-600",children:["🔴 Critical: ",ft.p1AvgApprovalTime.critical,"+ min"]})]})]}),o.jsxs("div",{className:"flex items-center justify-between py-2",children:[o.jsx("span",{className:"text-sm text-gray-700",children:"Overdue Requests"}),o.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[o.jsxs("span",{className:"text-yellow-600",children:["⚠️ Warning: ",ft.overdueRequests.warning,"+"]}),o.jsxs("span",{className:"text-red-600",children:["🔴 Critical: ",ft.overdueRequests.critical,"+"]})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"7-Day Trend"}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Historical data (last 7 days)"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),o.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Backlog"}),o.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Fulfillment"}),o.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Short Pick %"}),o.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Completed"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((u,h)=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:new Date(u.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),o.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:u.requestBacklog}),o.jsxs("td",{className:"px-4 py-2 text-sm text-gray-900",children:[u.avgFulfillmentTime.toFixed(1),"h"]}),o.jsxs("td",{className:"px-4 py-2 text-sm text-gray-900",children:[u.shortPickRate.toFixed(1),"%"]}),o.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:u.completedToday})]},h))})]})})]})]})]})},Ol={status_change:"Status Change",priority_change:"Priority Change",manual_override:"Manual Override",material_unlock:"Material Unlock",approval:"Approval",rejection:"Rejection",cancel:"Cancel",on_hold:"Put On Hold",resume:"Resume",short_pick:"Short Pick",material_lock:"Material Lock",create_request:"Create Request",edit_request:"Edit Request",delete_request:"Delete Request",permission_change:"Permission Change",system_config:"System Config"},Im={status_change:"bg-blue-100 text-blue-800",priority_change:"bg-orange-100 text-orange-800",manual_override:"bg-red-100 text-red-800",material_unlock:"bg-purple-100 text-purple-800",approval:"bg-green-100 text-green-800",rejection:"bg-red-100 text-red-800",cancel:"bg-gray-100 text-gray-800",on_hold:"bg-yellow-100 text-yellow-800",resume:"bg-green-100 text-green-800",short_pick:"bg-orange-100 text-orange-800",material_lock:"bg-purple-100 text-purple-800",create_request:"bg-blue-100 text-blue-800",edit_request:"bg-blue-100 text-blue-800",delete_request:"bg-red-100 text-red-800",permission_change:"bg-purple-100 text-purple-800",system_config:"bg-gray-100 text-gray-800"},C0=()=>{const[a,t]=E.useState({userId:"",action:"",entityId:"",startDate:"",endDate:"",limit:100}),[r,s]=E.useState(null),l=E.useMemo(()=>{const y={limit:a.limit};return a.userId&&(y.userId=a.userId),a.action&&(y.action=a.action),a.entityId&&(y.entityId=a.entityId),a.startDate&&(y.startDate=a.startDate),a.endDate&&(y.endDate=a.endDate),x0(y)},[a]),d=()=>{const y=v0(l),x=new Blob([y],{type:"text/csv"}),g=URL.createObjectURL(x),v=document.createElement("a");v.href=g,v.download=`audit-log-${new Date().toISOString().split("T")[0]}.csv`,v.click(),URL.revokeObjectURL(g)},u=y=>new Date(y).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),h=y=>y.before&&y.after?`${y.before} → ${y.after}`:y.reason?y.reason:JSON.stringify(y);return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Audit Trail"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Complete log of all system actions and changes"})]}),o.jsxs("button",{onClick:d,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[o.jsx("h2",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Filters"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"User"}),o.jsx("input",{type:"text",placeholder:"User ID",value:a.userId,onChange:y=>t({...a,userId:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Action"}),o.jsxs("select",{value:a.action,onChange:y=>t({...a,action:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[o.jsx("option",{value:"",children:"All Actions"}),Object.entries(Ol).map(([y,x])=>o.jsx("option",{value:y,children:x},y))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Entity ID"}),o.jsx("input",{type:"text",placeholder:"e.g., MRF-1234",value:a.entityId,onChange:y=>t({...a,entityId:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Date"}),o.jsx("input",{type:"date",value:a.startDate,onChange:y=>t({...a,startDate:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Date"}),o.jsx("input",{type:"date",value:a.endDate,onChange:y=>t({...a,endDate:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Limit"}),o.jsxs("select",{value:a.limit,onChange:y=>t({...a,limit:Number(y.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[o.jsx("option",{value:50,children:"50"}),o.jsx("option",{value:100,children:"100"}),o.jsx("option",{value:250,children:"250"}),o.jsx("option",{value:500,children:"500"})]})]})]}),o.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",l.length," entries"]}),o.jsx("button",{onClick:()=>t({userId:"",action:"",entityId:"",startDate:"",endDate:"",limit:100}),className:"text-sm text-blue-600 hover:text-blue-700",children:"Clear Filters"})]})]}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Entity"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Details"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(y=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:u(y.timestamp)}),o.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.userName}),o.jsx("div",{className:"text-xs text-gray-500",children:y.userId})]}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:o.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Im[y.action]||"bg-gray-100 text-gray-800"}`,children:Ol[y.action]||y.action})}),o.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[o.jsx("div",{className:"text-sm text-gray-900",children:y.entityId}),o.jsx("div",{className:"text-xs text-gray-500",children:y.entityType})]}),o.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 max-w-md truncate",children:h(y.details)}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:o.jsx("button",{onClick:()=>s(y),className:"text-blue-600 hover:text-blue-700",children:"View"})})]},y.id))})]}),l.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),o.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"No audit entries found"})]})]})}),r&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Audit Entry Details"}),o.jsx("button",{onClick:()=>s(null),className:"text-gray-400 hover:text-gray-500",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ID"}),o.jsx("p",{className:"text-sm text-gray-900",children:r.id})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Timestamp"}),o.jsx("p",{className:"text-sm text-gray-900",children:u(r.timestamp)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-500",children:"User"}),o.jsxs("p",{className:"text-sm text-gray-900",children:[r.userName," (",r.userId,")"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Action"}),o.jsx("p",{className:"text-sm",children:o.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Im[r.action]}`,children:Ol[r.action]||r.action})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Entity"}),o.jsxs("p",{className:"text-sm text-gray-900",children:[r.entityType," - ",r.entityId]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Details"}),o.jsx("pre",{className:"mt-1 text-xs bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto",children:JSON.stringify(r.details,null,2)})]})]}),o.jsx("div",{className:"mt-6 flex justify-end",children:o.jsx("button",{onClick:()=>s(null),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})})]})})})]})},T0=a=>{let t=[...ne];a!=null&&a.status&&a.status.length>0&&(t=t.filter(l=>a.status.includes(l.status))),a!=null&&a.priority&&a.priority.length>0&&(t=t.filter(l=>a.priority.includes(l.priority))),a!=null&&a.requestor&&a.requestor.length>0&&(t=t.filter(l=>a.requestor.includes(l.requestorName)));const r={};t.forEach(l=>{r[l.status]=(r[l.status]||0)+1});const s=t.length;return Object.entries(r).map(([l,d])=>({status:l,count:d,percentage:s>0?d/s*100:0})).sort((l,d)=>d.count-l.count)},P0=a=>{let t=ne.filter(r=>r.status==="Delivered");return a!=null&&a.startDate&&(t=t.filter(r=>r.createdDate>=a.startDate)),a!=null&&a.endDate&&(t=t.filter(r=>r.createdDate<=a.endDate)),a!=null&&a.priority&&a.priority.length>0&&(t=t.filter(r=>a.priority.includes(r.priority))),t.map(r=>{const s=new Date(r.createdDate),l=new Date(s);l.setHours(l.getHours()+(Math.random()*8+2));const d=(l.getTime()-s.getTime())/(1e3*60*60);return{requestId:r.id,priority:r.priority,submittedDate:r.createdDate,deliveredDate:l.toISOString(),hoursToFulfill:d,requestor:r.requestorName}}).sort((r,s)=>s.hoursToFulfill-r.hoursToFulfill)},R0=a=>{let t=ne.filter(r=>r.status.includes("Partial Pick")||r.status==="Delivered");return a!=null&&a.startDate&&(t=t.filter(r=>r.createdDate>=a.startDate)),a!=null&&a.endDate&&(t=t.filter(r=>r.createdDate<=a.endDate)),a!=null&&a.priority&&a.priority.length>0&&(t=t.filter(r=>a.priority.includes(r.priority))),t.map(r=>{const s=zs[r.id]||[],l=s.length,d=s.filter(h=>h.status==="Short").length,u=l>0?d/l*100:0;return{requestId:r.id,itemsRequested:l,itemsShorted:d,shortPercentage:u,status:r.status,requestor:r.requestorName,createdDate:r.createdDate}}).filter(r=>r.itemsShorted>0).sort((r,s)=>s.shortPercentage-r.shortPercentage)},D0=a=>{let t=[...ne];a!=null&&a.startDate&&(t=t.filter(s=>s.createdDate>=a.startDate)),a!=null&&a.endDate&&(t=t.filter(s=>s.createdDate<=a.endDate));const r={};return t.forEach(s=>{r[s.requestorName]||(r[s.requestorName]=[]),r[s.requestorName].push(s)}),Object.entries(r).map(([s,l])=>{const d=l.length,u=l.filter(b=>b.priority==="P1").length,h=l.filter(b=>b.priority==="P2").length,y=l.filter(b=>b.priority==="P3").length,x=l.filter(b=>b.priority==="P4").length,g=l.reduce((b,_)=>b+_.items,0),v=d>0?g/d:0;return{requestorName:s,totalRequests:d,p1Requests:u,p2Requests:h,p3Requests:y,p4Requests:x,avgItemsPerRequest:v,totalItems:g}}).sort((s,l)=>l.totalRequests-s.totalRequests)},Ch=(a,t)=>{if(a.length===0){console.warn("No data to export");return}const r=Object.keys(a[0]),s=a.map(y=>r.map(x=>{const g=y[x];return typeof g=="string"&&(g.includes(",")||g.includes('"'))?`"${g.replace(/"/g,'""')}"`:g})),l=[r.join(","),...s.map(y=>y.join(","))].join(`
`),d=new Blob([l],{type:"text/csv"}),u=URL.createObjectURL(d),h=document.createElement("a");h.href=u,h.download=`${t}-${new Date().toISOString().split("T")[0]}.csv`,h.click(),URL.revokeObjectURL(u)},O0=(a,t)=>{Ch(a,t)},A0=()=>{const[a,t]=E.useState("status"),[r,s]=E.useState({startDate:"",endDate:"",status:[],priority:[],requestor:[]}),l=E.useMemo(()=>T0(r),[r]),d=E.useMemo(()=>P0(r),[r]),u=E.useMemo(()=>R0(r),[r]),h=E.useMemo(()=>D0(r),[r]),y=g=>{let v=[],b="";switch(a){case"status":v=l,b="requests-by-status";break;case"fulfillment":v=d,b="time-to-fulfill";break;case"shortPick":v=u,b="short-pick-analysis";break;case"requestorActivity":v=h,b="requestor-activity";break}g==="csv"?Ch(v,b):O0(v,b)},x=[{id:"status",label:"Requests by Status",icon:"📊"},{id:"fulfillment",label:"Time to Fulfill",icon:"⏱️"},{id:"shortPick",label:"Short Pick Analysis",icon:"⚠️"},{id:"requestorActivity",label:"Requestor Activity",icon:"👥"}];return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Comprehensive Reports"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Generate insights and export data for analysis"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:()=>y("csv"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]}),o.jsxs("button",{onClick:()=>y("excel"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Excel"]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"border-b border-gray-200",children:o.jsx("nav",{className:"flex -mb-px",children:x.map(g=>o.jsxs("button",{onClick:()=>t(g.id),className:`flex-1 py-4 px-6 text-sm font-medium border-b-2 transition-colors ${a===g.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[o.jsx("span",{className:"mr-2",children:g.icon}),g.label]},g.id))})}),o.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Date"}),o.jsx("input",{type:"date",value:r.startDate,onChange:g=>s({...r,startDate:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Date"}),o.jsx("input",{type:"date",value:r.endDate,onChange:g=>s({...r,endDate:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Priority"}),o.jsxs("select",{multiple:!0,value:r.priority,onChange:g=>s({...r,priority:Array.from(g.target.selectedOptions,v=>v.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[o.jsx("option",{value:"P1",children:"P1"}),o.jsx("option",{value:"P2",children:"P2"}),o.jsx("option",{value:"P3",children:"P3"}),o.jsx("option",{value:"P4",children:"P4"})]})]}),o.jsx("div",{className:"flex items-end",children:o.jsx("button",{onClick:()=>s({startDate:"",endDate:"",status:[],priority:[],requestor:[]}),className:"w-full px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm",children:"Clear Filters"})})]})}),o.jsxs("div",{className:"p-6",children:[a==="status"&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Requests by Status"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Count"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Percentage"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Visual"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(g=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g.status}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.count}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.percentage.toFixed(1),"%"]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${g.percentage}%`}})})})]},g.status))})]})})]}),a==="fulfillment"&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Time to Fulfill Analysis"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Request ID"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Priority"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Requestor"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Submitted"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hours to Fulfill"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(g=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g.requestId}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${g.priority==="P1"?"bg-red-100 text-red-800":g.priority==="P2"?"bg-orange-100 text-orange-800":g.priority==="P3"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:g.priority})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.requestor}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.submittedDate}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.hoursToFulfill.toFixed(1),"h"]})]},g.requestId))})]})})]}),a==="shortPick"&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Short Pick Analysis"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Request ID"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Requestor"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Items Requested"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Items Shorted"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Short %"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(g=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g.requestId}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.requestor}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.itemsRequested}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 font-semibold",children:g.itemsShorted}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[g.shortPercentage.toFixed(1),"%"]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.status})]},g.requestId))})]})})]}),a==="requestorActivity"&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Requestor Activity Report"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Requestor"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Requests"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"P1"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"P2"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"P3"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"P4"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Items"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Avg Items/Request"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(g=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g.requestorName}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.totalRequests}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.p1Requests}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.p2Requests}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.p3Requests}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.p4Requests}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.totalItems}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.avgItemsPerRequest.toFixed(1)})]},g.requestorName))})]})})]})]})]})]})},Th=({targetTime:a})=>{const[t,r]=E.useState(""),[s,l]=E.useState(!1);return E.useEffect(()=>{const d=()=>{const h=new Date().getTime(),x=new Date(a).getTime()-h;if(x<0){l(!0);const g=Math.abs(x),v=Math.floor(g/(1e3*60*60)),b=Math.floor(g%(1e3*60*60)/(1e3*60));r(`${v}h ${b}m OVERDUE`)}else{l(!1);const g=Math.floor(x/(1e3*60*60)),v=Math.floor(x%(1e3*60*60)/(1e3*60));r(`${g}h ${v}m`)}};d();const u=setInterval(d,6e4);return()=>clearInterval(u)},[a]),o.jsx("span",{className:`font-mono font-semibold ${s?"text-red-600":"text-gray-900"}`,children:t})},I0=({request:a,onApprove:t,onReject:r})=>{const s=a.status==="Submitted",l=new Date(a.createdDate),d=Math.floor((new Date().getTime()-l.getTime())/(1e3*60)),u=d>30?"critical":d>15?"warning":"ok";return o.jsxs("div",{className:`bg-white rounded-lg border-2 p-4 ${u==="critical"?"border-red-500 bg-red-50":u==="warning"?"border-yellow-500 bg-yellow-50":"border-orange-300"}`,children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900",children:a.id}),o.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"P1 - URGENT"}),u==="critical"&&o.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-600 text-white animate-pulse",children:"🔴 CRITICAL"})]}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.requestorName})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-xs text-gray-500",children:"Required By"}),o.jsx(Th,{targetTime:a.RequiredByTimestamp})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-500",children:"Items:"}),o.jsx("span",{className:"ml-2 font-semibold",children:a.items})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-500",children:"Work Orders:"}),o.jsx("span",{className:"ml-2 font-semibold",children:a.workOrders})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-500",children:"Location:"}),o.jsx("span",{className:"ml-2 font-semibold",children:a.DeliveryLocation})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-500",children:"Status:"}),o.jsx("span",{className:"ml-2 font-semibold",children:a.status})]})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-3",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Submitted ",d," minutes ago"]}),s&&o.jsxs("div",{className:"flex gap-2 pt-3 border-t border-gray-200",children:[o.jsx("button",{onClick:()=>t(a.id),className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold text-sm",children:"✓ Approve"}),o.jsx("button",{onClick:()=>r(a.id),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold text-sm",children:"✕ Reject"})]})]})},L0=()=>{const[a,t]=E.useState(!0),[r,s]=E.useState(new Date),l=ne.filter(g=>g.priority==="P1"),d=l.filter(g=>g.status==="Submitted"),u=l.filter(g=>["Picking","Staged","In Transit"].includes(g.status)),h=l.filter(g=>g.status==="Delivered");E.useEffect(()=>{if(!a)return;const g=setInterval(()=>{s(new Date)},3e4);return()=>clearInterval(g)},[a]);const y=g=>{console.log(`Approving P1 request: ${g}`),alert(`P1 Request ${g} approved! Warehouse can now begin picking.`)},x=g=>{const v=prompt("Enter rejection reason:");v&&(console.log(`Rejecting P1 request: ${g}, Reason: ${v}`),alert(`P1 Request ${g} rejected.`))};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"P1 Priority Dashboard"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Real-time tracking of urgent P1 requests requiring MC approval"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[o.jsx("input",{type:"checkbox",checked:a,onChange:g=>t(g.target.checked),className:"rounded border-gray-300"}),"Auto-refresh (30s)"]}),o.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",r.toLocaleTimeString()]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"bg-orange-50 rounded-lg border-2 border-orange-200 p-4",children:[o.jsx("div",{className:"text-sm font-medium text-orange-700 mb-1",children:"Total P1 Requests"}),o.jsx("div",{className:"text-3xl font-bold text-orange-900",children:l.length})]}),o.jsxs("div",{className:`rounded-lg border-2 p-4 ${d.length>0?"bg-red-50 border-red-300":"bg-green-50 border-green-200"}`,children:[o.jsx("div",{className:`text-sm font-medium mb-1 ${d.length>0?"text-red-700":"text-green-700"}`,children:"Pending Approval"}),o.jsx("div",{className:`text-3xl font-bold ${d.length>0?"text-red-900":"text-green-900"}`,children:d.length}),d.length>0&&o.jsx("div",{className:"text-xs text-red-600 mt-1 font-semibold",children:"⚠️ Action Required"})]}),o.jsxs("div",{className:"bg-blue-50 rounded-lg border-2 border-blue-200 p-4",children:[o.jsx("div",{className:"text-sm font-medium text-blue-700 mb-1",children:"In Progress"}),o.jsx("div",{className:"text-3xl font-bold text-blue-900",children:u.length})]}),o.jsxs("div",{className:"bg-green-50 rounded-lg border-2 border-green-200 p-4",children:[o.jsx("div",{className:"text-sm font-medium text-green-700 mb-1",children:"Completed Today"}),o.jsx("div",{className:"text-3xl font-bold text-green-900",children:h.length})]})]}),d.length>0&&o.jsxs("div",{className:"bg-red-50 rounded-lg border-2 border-red-300 p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx("div",{className:"w-3 h-3 bg-red-600 rounded-full animate-pulse"}),o.jsxs("h2",{className:"text-lg font-semibold text-red-900",children:["MC Approval Required (",d.length,")"]})]}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:d.map(g=>o.jsx(I0,{request:g,onApprove:y,onReject:x},g.id))})]}),d.length===0&&o.jsxs("div",{className:"bg-green-50 rounded-lg border-2 border-green-300 p-6 text-center",children:[o.jsx("svg",{className:"mx-auto h-12 w-12 text-green-600 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-1",children:"All Clear!"}),o.jsx("p",{className:"text-sm text-green-700",children:"No P1 requests pending approval"})]}),u.length>0&&o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:["P1 Requests In Progress (",u.length,")"]}),o.jsx("div",{className:"space-y-3",children:u.map(g=>o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"font-semibold text-gray-900",children:g.id}),o.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:g.status})]}),o.jsxs("div",{className:"text-sm text-gray-600",children:[g.requestorName," • ",g.items," items • ",g.DeliveryLocation]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Required By"}),o.jsx(Th,{targetTime:g.RequiredByTimestamp})]})]},g.id))})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Escalation Guidelines"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg border border-green-200",children:[o.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx("span",{className:"text-white text-xs font-bold",children:"OK"})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-semibold text-green-900",children:"0-15 minutes"}),o.jsx("div",{className:"text-sm text-green-700",children:"Normal response time - No action needed"})]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[o.jsx("div",{className:"w-6 h-6 bg-yellow-500 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx("span",{className:"text-white text-xs font-bold",children:"⚠️"})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-semibold text-yellow-900",children:"15-30 minutes"}),o.jsx("div",{className:"text-sm text-yellow-700",children:"Warning - Prioritize approval review"})]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 rounded-lg border border-red-200",children:[o.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center flex-shrink-0 animate-pulse",children:o.jsx("span",{className:"text-white text-xs font-bold",children:"🔴"})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-semibold text-red-900",children:"30+ minutes"}),o.jsx("div",{className:"text-sm text-red-700",children:"Critical - Immediate MC attention required, escalate to supervisor"})]})]})]})]})]})},M0=()=>{const[a,t]=E.useState(new Date);E.useEffect(()=>{const x=setInterval(()=>{t(new Date)},1e3);return()=>clearInterval(x)},[]);const r=ne.filter(x=>!["Delivered","Cancelled"].includes(x.status)),s=r.filter(x=>x.priority==="P1"),l=r.filter(x=>x.status==="Submitted"),d=r.filter(x=>x.status==="Picking"),u=r.filter(x=>x.status==="In Transit"),h={Submitted:r.filter(x=>x.status==="Submitted").length,Picking:r.filter(x=>x.status==="Picking").length,Staged:r.filter(x=>x.status==="Staged").length,"In Transit":r.filter(x=>x.status==="In Transit").length,"On Hold":r.filter(x=>x.status==="On Hold").length},y=x=>{switch(x){case"Submitted":return"bg-yellow-500";case"Picking":return"bg-blue-500";case"Staged":return"bg-purple-500";case"In Transit":return"bg-green-500";case"On Hold":return"bg-red-500";default:return"bg-gray-500"}};return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 p-8",children:[o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h1",{className:"text-5xl font-bold text-white",children:"Material Request Queue"}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-4xl font-bold text-white",children:a.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}),o.jsx("div",{className:"text-lg text-gray-300",children:a.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})})]})]}),o.jsx("div",{className:"h-2 bg-blue-500 rounded-full"})]}),o.jsxs("div",{className:"grid grid-cols-5 gap-6 mb-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl p-6 shadow-2xl",children:[o.jsx("div",{className:"text-blue-200 text-lg mb-2",children:"Active Requests"}),o.jsx("div",{className:"text-6xl font-bold text-white",children:r.length})]}),o.jsxs("div",{className:"bg-gradient-to-br from-red-600 to-red-700 rounded-2xl p-6 shadow-2xl",children:[o.jsx("div",{className:"text-red-200 text-lg mb-2",children:"🔴 P1 Urgent"}),o.jsx("div",{className:"text-6xl font-bold text-white",children:s.length})]}),o.jsxs("div",{className:"bg-gradient-to-br from-yellow-600 to-yellow-700 rounded-2xl p-6 shadow-2xl",children:[o.jsx("div",{className:"text-yellow-200 text-lg mb-2",children:"Queue"}),o.jsx("div",{className:"text-6xl font-bold text-white",children:l.length})]}),o.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 rounded-2xl p-6 shadow-2xl",children:[o.jsx("div",{className:"text-purple-200 text-lg mb-2",children:"Picking"}),o.jsx("div",{className:"text-6xl font-bold text-white",children:d.length})]}),o.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 rounded-2xl p-6 shadow-2xl",children:[o.jsx("div",{className:"text-green-200 text-lg mb-2",children:"In Transit"}),o.jsx("div",{className:"text-6xl font-bold text-white",children:u.length})]})]}),s.length>0&&o.jsxs("div",{className:"bg-red-600 rounded-2xl p-6 mb-8 shadow-2xl animate-pulse",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"🔴 PRIORITY 1 ALERTS"}),o.jsx("p",{className:"text-red-100 text-xl",children:"Urgent requests requiring immediate attention"})]}),o.jsx("div",{className:"text-7xl font-bold text-white",children:s.length})]}),o.jsx("div",{className:"mt-4 space-y-2",children:s.slice(0,3).map(x=>o.jsxs("div",{className:"bg-red-700 rounded-lg p-4 flex items-center justify-between",children:[o.jsxs("div",{className:"text-white",children:[o.jsx("span",{className:"font-bold text-2xl",children:x.id}),o.jsx("span",{className:"ml-4 text-xl",children:x.requestorName})]}),o.jsxs("div",{className:"text-right text-white",children:[o.jsx("div",{className:"text-sm text-red-200",children:"Required By"}),o.jsx("div",{className:"text-xl font-semibold",children:new Date(x.RequiredByTimestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]})]},x.id))})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[o.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 shadow-2xl",children:[o.jsx("h2",{className:"text-3xl font-bold text-white mb-6",children:"Current Queue"}),o.jsxs("div",{className:"space-y-4",children:[l.slice(0,5).map((x,g)=>o.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"text-4xl font-bold text-gray-500",children:["#",g+1]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-2xl font-bold text-white",children:x.id}),o.jsx("div",{className:"text-gray-300 text-lg",children:x.requestorName})]})]}),o.jsx("div",{className:"text-right",children:o.jsx("span",{className:`px-4 py-2 rounded-full text-lg font-semibold ${x.priority==="P1"?"bg-red-500 text-white":x.priority==="P2"?"bg-orange-500 text-white":x.priority==="P3"?"bg-yellow-500 text-white":"bg-green-500 text-white"}`,children:x.priority})})]},x.id)),l.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-6xl mb-4",children:"✓"}),o.jsx("div",{className:"text-2xl text-gray-400",children:"Queue is clear!"})]})]})]}),o.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 shadow-2xl",children:[o.jsx("h2",{className:"text-3xl font-bold text-white mb-6",children:"Status Distribution"}),o.jsx("div",{className:"space-y-4",children:Object.entries(h).map(([x,g])=>o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:`w-6 h-6 rounded-full ${y(x)}`}),o.jsx("div",{className:"text-2xl font-semibold text-white",children:x})]}),o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsx("div",{className:"text-4xl font-bold text-white",children:g}),o.jsx("div",{className:"w-64 bg-gray-700 rounded-full h-4",children:o.jsx("div",{className:`h-4 rounded-full ${y(x)}`,style:{width:`${r.length>0?g/r.length*100:0}%`}})})]})]},x))})]})]}),o.jsx("div",{className:"mt-8 text-center",children:o.jsxs("div",{className:"inline-flex items-center gap-2 bg-gray-800 rounded-full px-6 py-3",children:[o.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),o.jsx("span",{className:"text-gray-300 text-lg",children:"Live - Auto-refreshing every 30 seconds"})]})})]})},$0=()=>{const[a,t]=E.useState(""),[r,s]=E.useState(""),[l,d]=E.useState(""),[u,h]=E.useState(""),[y,x]=E.useState(""),g=()=>{if(!a||!r||!u){alert("Please fill in all fields");return}const k=ne.find(j=>j.id===a);k&&(vi({userId:"mc",userName:"Corey (MC)",action:"manual_override",entityType:"material_request",entityId:a,details:{type:"status_override",before:k.status,after:r,reason:u}}),alert(`✅ Status manually overridden!
${a}: ${k.status} → ${r}

This action has been logged in the audit trail.`),t(""),s(""),h(""))},v=()=>{if(!a||!l||!u){alert("Please fill in all fields");return}const k=ne.find(j=>j.id===a);k&&(vi({userId:"mc",userName:"Corey (MC)",action:"manual_override",entityType:"material_request",entityId:a,details:{type:"priority_override",before:k.priority,after:l,reason:u}}),alert(`✅ Priority manually overridden!
${a}: ${k.priority} → ${l}

This action has been logged in the audit trail.`),t(""),d(""),h(""))},b=()=>{if(!y){alert("Please enter a pKey");return}const k=gt[y];vi({userId:"mc",userName:"Corey (MC)",action:"material_unlock",entityType:"material",entityId:y,details:{previousLock:k||"Not locked",unlockedBy:"MC",reason:"Manual unlock via God Mode"}}),k?(delete gt[y],alert(`✅ Material ${y} has been unlocked!

Previously locked by: ${k.lockedBy}
Reason: ${k.comment}

This action has been logged in the audit trail.`)):alert(`⚠️ Material ${y} was not locked.

Unlock action has been logged in the audit trail anyway.`),x("")},_=Object.entries(gt);return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-red-50 border-2 border-red-300 rounded-lg p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("span",{className:"text-3xl",children:"⚡"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-red-900",children:"MC God Mode"}),o.jsx("p",{className:"text-sm text-red-700",children:"Full control override capabilities - All actions are logged in audit trail"})]})]}),o.jsxs("div",{className:"bg-white border border-red-200 rounded-lg p-4 mt-4",children:[o.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"⚠️ Warning"}),o.jsx("p",{className:"text-sm text-red-700",children:"These are powerful administrative functions that bypass normal workflow rules. Use with extreme caution. Every action is permanently logged and auditable."})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"🔄 Manual Status Override"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Force a request to any status, bypassing workflow validation"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Request"}),o.jsxs("select",{value:a,onChange:k=>t(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[o.jsx("option",{value:"",children:"-- Select a request --"}),ne.map(k=>o.jsxs("option",{value:k.id,children:[k.id," - ",k.status," (",k.priority,")"]},k.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Status"}),o.jsxs("select",{value:r,onChange:k=>s(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[o.jsx("option",{value:"",children:"-- Select new status --"}),o.jsx("option",{value:"Submitted",children:"Submitted"}),o.jsx("option",{value:"Picking",children:"Picking"}),o.jsx("option",{value:"Staged",children:"Staged"}),o.jsx("option",{value:"In Transit",children:"In Transit"}),o.jsx("option",{value:"Delivered",children:"Delivered"}),o.jsx("option",{value:"On Hold",children:"On Hold"}),o.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Override Reason *"}),o.jsx("textarea",{value:u,onChange:k=>h(k.target.value),placeholder:"Explain why this manual override is necessary...",className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:3})]}),o.jsx("button",{onClick:g,className:"w-full px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold",children:"⚡ Override Status"})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"🎯 Manual Priority Override"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Change request priority regardless of AC settings"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Request"}),o.jsxs("select",{value:a,onChange:k=>t(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[o.jsx("option",{value:"",children:"-- Select a request --"}),ne.map(k=>o.jsxs("option",{value:k.id,children:[k.id," - ",k.priority," - ",k.requestorName]},k.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Priority"}),o.jsxs("select",{value:l,onChange:k=>d(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[o.jsx("option",{value:"",children:"-- Select new priority --"}),o.jsx("option",{value:"P1",children:"P1 - Urgent (requires MC approval)"}),o.jsx("option",{value:"P2",children:"P2 - High"}),o.jsx("option",{value:"P3",children:"P3 - Normal"}),o.jsx("option",{value:"P4",children:"P4 - Low"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Override Reason *"}),o.jsx("textarea",{value:u,onChange:k=>h(k.target.value),placeholder:"Explain why this priority change is necessary...",className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:3})]}),o.jsx("button",{onClick:v,className:"w-full px-4 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors font-semibold",children:"⚡ Override Priority"})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"🔓 Manual Material Unlock"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Force unlock materials that are locked by Area Coordinators"}),_.length>0&&o.jsxs("div",{className:"mb-4 bg-yellow-50 rounded-lg border border-yellow-200 p-4",children:[o.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"Currently Locked Materials"}),o.jsx("div",{className:"space-y-2",children:_.map(([k,j])=>o.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border border-yellow-300",children:[o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"font-mono font-semibold",children:k}),o.jsxs("span",{className:"ml-2 text-gray-600",children:["Locked by: ",j.lockedBy]}),o.jsx("div",{className:"text-xs text-gray-500 mt-1",children:j.comment})]}),o.jsx("button",{onClick:()=>x(k),className:"px-3 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700",children:"Select"})]},k))})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Material pKey"}),o.jsx("input",{type:"text",value:y,onChange:k=>x(k.target.value),placeholder:"e.g., 8226710005",className:"w-full px-3 py-2 border border-gray-300 rounded-md font-mono"})]}),o.jsx("button",{onClick:b,className:"w-full px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-semibold",children:"🔓 Force Unlock Material"})]})]}),o.jsxs("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-blue-900 mb-2",children:"📋 All Actions Are Logged"}),o.jsx("p",{className:"text-sm text-blue-700 mb-4",children:"Every God Mode action is permanently recorded in the audit trail with:"}),o.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside",children:[o.jsx("li",{children:"Timestamp of the action"}),o.jsx("li",{children:"User who performed the action"}),o.jsx("li",{children:"Before and after values"}),o.jsx("li",{children:"Reason for the override"}),o.jsx("li",{children:"Full context and details"})]}),o.jsx("button",{onClick:()=>window.alert("Navigate to Audit Trail tab to view all logged actions"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"View Audit Trail →"})]})]})},Lm={maxItemsPerRequest:50,maxConcurrentRequestsPerUser:10,p1RequiresApproval:!0,autoAssignPriority:!0,enableNotifications:!0,enableAuditLog:!0,sessionTimeoutMinutes:60,backlogWarningThreshold:10,backlogCriticalThreshold:20},q0=()=>{const[a,t]=E.useState(Lm),[r,s]=E.useState(!1),l=(h,y)=>{t(x=>({...x,[h]:y})),s(!0)},d=()=>{console.log("Saving configuration:",a),alert("✅ Configuration saved successfully!"),s(!1)},u=()=>{confirm("Reset all settings to defaults?")&&(t(Lm),s(!1))};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"System Configuration"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Configure system limits, features, and behavior"})]}),r&&o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Reset"}),o.jsxs("button",{onClick:d,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Changes"]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"📦 Request Limits"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Items Per Request"}),o.jsx("input",{type:"number",value:a.maxItemsPerRequest,onChange:h=>l("maxItemsPerRequest",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md",min:1,max:100}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum number of items allowed in a single material request"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Concurrent Requests Per User"}),o.jsx("input",{type:"number",value:a.maxConcurrentRequestsPerUser,onChange:h=>l("maxConcurrentRequestsPerUser",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md",min:1,max:50}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum number of active requests a single user can have"})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"⚙️ Workflow Settings"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"P1 Requires MC Approval"}),o.jsx("div",{className:"text-sm text-gray-500",children:"P1 requests must be approved before picking"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:a.p1RequiresApproval,onChange:h=>l("p1RequiresApproval",h.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Auto-Assign Priority"}),o.jsx("div",{className:"text-sm text-gray-500",children:"Automatically assign priority based on required date"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:a.autoAssignPriority,onChange:h=>l("autoAssignPriority",h.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"🔧 System Features"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Enable Notifications"}),o.jsx("div",{className:"text-sm text-gray-500",children:"Send email/SMS notifications for status changes"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:a.enableNotifications,onChange:h=>l("enableNotifications",h.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Enable Audit Logging"}),o.jsx("div",{className:"text-sm text-gray-500",children:"Log all system actions to audit trail"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:a.enableAuditLog,onChange:h=>l("enableAuditLog",h.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"🔒 Security Settings"}),o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session Timeout (minutes)"}),o.jsx("input",{type:"number",value:a.sessionTimeoutMinutes,onChange:h=>l("sessionTimeoutMinutes",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md",min:5,max:480}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Automatically log out inactive users after this time"})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"⚠️ Alert Thresholds"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Backlog Warning Threshold"}),o.jsx("input",{type:"number",value:a.backlogWarningThreshold,onChange:h=>l("backlogWarningThreshold",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md",min:1,max:50}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Show warning when backlog exceeds this many requests"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Backlog Critical Threshold"}),o.jsx("input",{type:"number",value:a.backlogCriticalThreshold,onChange:h=>l("backlogCriticalThreshold",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md",min:1,max:100}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Show critical alert when backlog exceeds this many requests"})]})]})]}),o.jsxs("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-blue-900 mb-4",children:"📋 Current Configuration"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-blue-600 font-medium",children:"Max Items Per Request"}),o.jsx("div",{className:"text-blue-900 font-semibold",children:a.maxItemsPerRequest})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-blue-600 font-medium",children:"Max Concurrent Requests"}),o.jsx("div",{className:"text-blue-900 font-semibold",children:a.maxConcurrentRequestsPerUser})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-blue-600 font-medium",children:"P1 Approval"}),o.jsx("div",{className:"text-blue-900 font-semibold",children:a.p1RequiresApproval?"Required":"Not Required"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-blue-600 font-medium",children:"Session Timeout"}),o.jsxs("div",{className:"text-blue-900 font-semibold",children:[a.sessionTimeoutMinutes," min"]})]})]})]})]})},B0=()=>{const[a,t]=E.useState("System Health"),r=[{id:"health",label:"System Health",icon:"❤️",component:j0},{id:"p1",label:"P1 Dashboard",icon:"🔴",component:L0},{id:"reports",label:"Reports",icon:"📊",component:A0},{id:"audit",label:"Audit Trail",icon:"📋",component:C0},{id:"godmode",label:"MC God Mode",icon:"⚡",component:$0},{id:"config",label:"System Config",icon:"⚙️",component:q0},{id:"wall",label:"Wall Display",icon:"📺",component:M0}],l=(r.find(d=>d.label===a)||r[0]).component;return o.jsxs("div",{className:"flex h-full bg-white rounded-xl border border-gray-200 overflow-hidden",children:[o.jsxs("div",{className:"w-64 border-r border-gray-200 p-4 flex-shrink-0",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"MC Control Panel"}),o.jsx("nav",{className:"space-y-1",children:r.map(d=>o.jsxs("button",{onClick:()=>t(d.label),className:`w-full text-left px-3 py-2 text-sm rounded-md transition-colors flex items-center gap-2 ${a===d.label?"bg-blue-100 text-blue-700 font-semibold":"text-gray-600 hover:bg-gray-100"}`,children:[o.jsx("span",{children:d.icon}),o.jsx("span",{children:d.label})]},d.id))}),o.jsxs("div",{className:"mt-8 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[o.jsx("div",{className:"text-xs font-semibold text-blue-900 mb-1",children:"Quick Stats"}),o.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[o.jsx("div",{children:"Active Requests: 15"}),o.jsx("div",{children:"P1 Pending: 2"}),o.jsx("div",{children:"System Status: ✓ Healthy"})]})]})]}),o.jsx("div",{className:"flex-1 p-8 overflow-y-auto",children:o.jsx(l,{})})]})},U0=()=>c.createElement("div",{className:"p-8 border-4 border-dashed border-gray-200 rounded-lg bg-white h-full"},c.createElement("div",{className:"text-center"},c.createElement("h1",{className:"text-2xl font-bold text-gray-800"},"Partial Picks Dashboard"),c.createElement("p",{className:"mt-2 text-gray-500"},"This dashboard will display all material requests with exceptions, allowing for quick review and resolution.")));let Ws=[],hc=[],pc=null,bi=!1;const F0=async()=>{if(bi)throw new Error("Sync already in progress");const a=`SYNC-${Date.now()}`,t=Date.now();bi=!0;try{const r={id:a,timestamp:new Date().toISOString(),status:"in_progress",recordsProcessed:0,recordsAdded:0,recordsUpdated:0,recordsConflict:0,errors:[],duration:0};if(Ws.unshift(r),await new Promise(s=>setTimeout(s,2e3)),r.status="success",r.recordsProcessed=Math.floor(Math.random()*100)+50,r.recordsAdded=Math.floor(Math.random()*10),r.recordsUpdated=Math.floor(Math.random()*20),r.recordsConflict=Math.floor(Math.random()*3),r.duration=Date.now()-t,pc=r.timestamp,r.recordsConflict>0)for(let s=0;s<r.recordsConflict;s++)hc.push({pKey:`822671${String(1e4+s).padStart(5,"0")}`,field:"storageLocation",sharePointValue:"Whse 1, C5",systemValue:"Whse 1, A3",detectedAt:new Date().toISOString(),resolved:!1});return r}catch(r){const s={id:a,timestamp:new Date().toISOString(),status:"failed",recordsProcessed:0,recordsAdded:0,recordsUpdated:0,recordsConflict:0,errors:[r instanceof Error?r.message:"Unknown error"],duration:Date.now()-t};return Ws.unshift(s),s}finally{bi=!1}},Mm=(a=20)=>Ws.slice(0,a),Al=a=>hc.filter(t=>t.resolved===a),z0=(a,t,r)=>{const s=hc.find(l=>l.pKey===a&&l.field===t&&!l.resolved);s&&(s.resolved=!0,s.resolution=r)},$m=()=>pc,H0=()=>bi,W0=()=>{const a=Date.now();for(let t=0;t<5;t++)Ws.push({id:`SYNC-INIT-${t}`,timestamp:new Date(a-t*36e5).toISOString(),status:t===0?"success":t===2?"failed":"success",recordsProcessed:Math.floor(Math.random()*100)+50,recordsAdded:Math.floor(Math.random()*10),recordsUpdated:Math.floor(Math.random()*20),recordsConflict:t===1?2:0,errors:t===2?["SharePoint connection timeout"]:[],duration:Math.floor(Math.random()*5e3)+1e3});pc=Ws[0].timestamp};W0();let Gs=[],Ci=[],K0="connected";const V0=a=>{const t=Gs.find(s=>s.id===a);if(!t||t.status!=="pending")return;const r=Ci.find(s=>s.status==="available");if(r){t.status="assigned",t.driver=r.name,t.vehicle=r.vehicle,t.assignedAt=new Date().toISOString();const s=Math.floor(Math.random()*30)+30;t.estimatedDeliveryTime=new Date(Date.now()+s*6e4).toISOString(),r.status="busy",r.currentTask=a,setTimeout(()=>{Q0(a)},s*1e3)}},Q0=a=>{const t=Gs.find(s=>s.id===a);if(!t||t.status!=="assigned")return;Math.random()>.1?(t.status="delivered",t.deliveredAt=new Date().toISOString(),t.actualDeliveryTime=new Date().toISOString()):(t.status="failed",t.failureReason="Access denied at delivery location");const r=Ci.find(s=>s.currentTask===a);r&&(r.status="available",r.currentTask=void 0)},G0=async a=>{const t=Gs.find(r=>r.id===a);if(!t)throw new Error("Task not found");if(t.status!=="failed")throw new Error("Can only retry failed tasks");if(t.retryCount>=t.maxRetries)throw new Error("Maximum retry attempts reached");t.retryCount++,t.status="pending",t.failureReason=void 0,setTimeout(()=>{V0(a)},2e3)},qm=a=>[...Gs],J0=a=>Ci,Y0=()=>K0,X0=()=>{Ci=[{id:"DRV-001",name:"Mike Johnson",vehicle:"Truck-A12",status:"available",currentLocation:"Warehouse 1"},{id:"DRV-002",name:"Sarah Williams",vehicle:"Van-B05",status:"available",currentLocation:"Warehouse 2"},{id:"DRV-003",name:"Tom Chen",vehicle:"Truck-C21",status:"busy",currentTask:"LTR-SAMPLE-001",currentLocation:"In Transit"}];const a=Date.now();Gs=[{id:"LTR-SAMPLE-001",mrfId:"MRF-1238",status:"in_transit",driver:"Tom Chen",vehicle:"Truck-C21",pickupLocation:"Warehouse 1",deliveryLocation:"Weld Shop",priority:"P2",items:8,createdAt:new Date(a-36e5).toISOString(),assignedAt:new Date(a-3e6).toISOString(),estimatedDeliveryTime:new Date(a+6e5).toISOString(),retryCount:0,maxRetries:3},{id:"LTR-SAMPLE-002",mrfId:"MRF-1235",status:"delivered",driver:"Mike Johnson",vehicle:"Truck-A12",pickupLocation:"Warehouse 2",deliveryLocation:"Ops Center Trailer 1",priority:"P3",items:4,createdAt:new Date(a-72e5).toISOString(),assignedAt:new Date(a-66e5).toISOString(),deliveredAt:new Date(a-36e5).toISOString(),estimatedDeliveryTime:new Date(a-38e5).toISOString(),actualDeliveryTime:new Date(a-36e5).toISOString(),retryCount:0,maxRetries:3}]};X0();const Z0=(a,t)=>{if(a.length===0){console.warn("No data to export");return}const r=Object.keys(a[0]),s=[r.join(","),...a.map(h=>r.map(y=>{let x=h[y];return typeof x=="object"&&x!==null&&(x=JSON.stringify(x)),x==null&&(x=""),x=String(x).replace(/"/g,'""'),(x.includes(",")||x.includes(`
`)||x.includes('"'))&&(x=`"${x}"`),x}).join(","))].join(`
`),l=new Blob([s],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),u=URL.createObjectURL(l);d.setAttribute("href",u),d.setAttribute("download",`${t}.csv`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(u)},ey=(a,t)=>{if(a.length===0){console.warn("No data to export");return}const r=Object.keys(a[0]),s=[r.join("	"),...a.map(h=>r.map(y=>{let x=h[y];return typeof x=="object"&&x!==null&&(x=JSON.stringify(x)),x==null&&(x=""),String(x)}).join("	"))].join(`
`),l=new Blob([s],{type:"text/tab-separated-values;charset=utf-8;"}),d=document.createElement("a"),u=URL.createObjectURL(l);d.setAttribute("href",u),d.setAttribute("download",`${t}.xls`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(u)},ty=(a,t="excel")=>{const r=a.map(l=>({"Request ID":l.id,Status:l.status,Priority:l.priority,Items:l.items,"Work Orders":l.workOrders,"Created Date":l.createdDate,"Required By":new Date(l.RequiredByTimestamp).toLocaleString(),"Requested By":l.requestorName,"Delivery Location":l.DeliveryLocation,"MC Priority Flag":l.MC_Priority_Flag?"Yes":"No","AC Priority":l.acPriority||"N/A"})),s=`material-requests-${new Date().toISOString().split("T")[0]}`;t==="csv"?Z0(r,s):ey(r,s)},ry=(a,t)=>{const r=JSON.stringify(a,null,2),s=new Blob([r],{type:"application/json;charset=utf-8;"}),l=document.createElement("a"),d=URL.createObjectURL(s);l.setAttribute("href",d),l.setAttribute("download",`${t}.json`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(d)},Bm=()=>{const[a,t]=E.useState(Rm()),[r,s]=E.useState("all"),[l,d]=E.useState("user@toll.com"),[u,h]=E.useState(!1),[y,x]=E.useState(""),g=r==="all"?a:a.filter(_=>_.status===r),v=async()=>{try{await ji("email",l,"Test Notification","This is a test notification from SCM Hub.",void 0),x("Test notification sent successfully!"),h(!0),t(Rm())}catch{x("Failed to send notification"),h(!0)}},b={total:a.length,pending:a.filter(_=>_.status==="pending").length,sent:a.filter(_=>_.status==="sent").length,failed:a.filter(_=>_.status==="failed").length};return c.createElement("div",{className:"space-y-6"},u&&c.createElement(Ni,{message:y,type:y.includes("success")?"success":"error",onClose:()=>h(!1)}),c.createElement("div",{className:"grid grid-cols-4 gap-4"},c.createElement("div",{className:"bg-blue-50 p-4 rounded-lg"},c.createElement("div",{className:"text-2xl font-bold text-blue-700"},b.total),c.createElement("div",{className:"text-sm text-blue-600"},"Total Notifications")),c.createElement("div",{className:"bg-yellow-50 p-4 rounded-lg"},c.createElement("div",{className:"text-2xl font-bold text-yellow-700"},b.pending),c.createElement("div",{className:"text-sm text-yellow-600"},"Pending")),c.createElement("div",{className:"bg-green-50 p-4 rounded-lg"},c.createElement("div",{className:"text-2xl font-bold text-green-700"},b.sent),c.createElement("div",{className:"text-sm text-green-600"},"Sent")),c.createElement("div",{className:"bg-red-50 p-4 rounded-lg"},c.createElement("div",{className:"text-2xl font-bold text-red-700"},b.failed),c.createElement("div",{className:"text-sm text-red-600"},"Failed"))),c.createElement("div",{className:"bg-white p-4 rounded-lg border border-gray-200"},c.createElement("h3",{className:"text-lg font-semibold mb-3"},"Test Notification"),c.createElement("div",{className:"flex gap-3"},c.createElement("input",{type:"email",value:l,onChange:_=>d(_.target.value),placeholder:"Recipient email",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md"}),c.createElement("button",{onClick:v,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},"Send Test"))),c.createElement("div",{className:"flex gap-2"},["all","pending","sent","failed"].map(_=>c.createElement("button",{key:_,onClick:()=>s(_),className:`px-4 py-2 rounded-md ${r===_?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`},_.charAt(0).toUpperCase()+_.slice(1)))),c.createElement("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden"},c.createElement("div",{className:"overflow-x-auto"},c.createElement("table",{className:"min-w-full divide-y divide-gray-200"},c.createElement("thead",{className:"bg-gray-50"},c.createElement("tr",null,["Type","Recipient","Subject","Status","MRF ID","Sent At"].map(_=>c.createElement("th",{key:_,className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},_)))),c.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},g.slice(0,20).map(_=>c.createElement("tr",{key:_.id},c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm"},c.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${_.type==="email"?"bg-blue-100 text-blue-800":_.type==="sms"?"bg-green-100 text-green-800":_.type==="teams"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`},_.type.toUpperCase())),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},_.recipient),c.createElement("td",{className:"px-6 py-4 text-sm text-gray-900"},_.subject||"-"),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},c.createElement(kt,{status:_.status})),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},_.mrfId||"-"),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},_.sentAt?new Date(_.sentAt).toLocaleString():"Pending"))))))))},ny=()=>{const[a,t]=E.useState(Mm()),[r,s]=E.useState(Al(!1)),[l,d]=E.useState(!1),[u,h]=E.useState(!1),[y,x]=E.useState(""),g=async()=>{d(!0);try{const b=await F0();x(`Sync completed! Processed ${b.recordsProcessed} records.`),h(!0),t(Mm()),s(Al(!1))}catch(b){x("Sync failed: "+b.message),h(!0)}finally{d(!1)}},v=(b,_,k)=>{z0(b,_,k),s(Al(!1)),x("Conflict resolved successfully"),h(!0)};return c.createElement("div",{className:"space-y-6"},u&&c.createElement(Ni,{message:y,type:y.includes("success")||y.includes("completed")?"success":"error",onClose:()=>h(!1)}),c.createElement("div",{className:"bg-white p-6 rounded-lg border border-gray-200"},c.createElement("div",{className:"flex justify-between items-center mb-4"},c.createElement("div",null,c.createElement("h3",{className:"text-lg font-semibold"},"SharePoint Data Sync"),c.createElement("p",{className:"text-sm text-gray-500"},"Last sync: "+($m()?new Date($m()).toLocaleString():"Never"))),c.createElement("button",{onClick:g,disabled:l||H0(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"},l?"Syncing...":"Manual Sync")),r.length>0&&c.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4"},c.createElement("div",{className:"flex items-center"},c.createElement("span",{className:"text-yellow-800 font-medium"},`⚠️ ${r.length} unresolved conflict(s) detected`)))),c.createElement("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden"},c.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},c.createElement("h3",{className:"text-lg font-semibold"},"Sync History")),c.createElement("div",{className:"overflow-x-auto"},c.createElement("table",{className:"min-w-full divide-y divide-gray-200"},c.createElement("thead",{className:"bg-gray-50"},c.createElement("tr",null,["Time","Status","Records","Added","Updated","Conflicts","Duration"].map(b=>c.createElement("th",{key:b,className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},b)))),c.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},a.map(b=>c.createElement("tr",{key:b.id},c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},new Date(b.timestamp).toLocaleString()),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},c.createElement(kt,{status:b.status})),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},b.recordsProcessed),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},b.recordsAdded),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},b.recordsUpdated),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},b.recordsConflict>0?c.createElement("span",{className:"text-yellow-600 font-medium"},b.recordsConflict):b.recordsConflict),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},`${(b.duration/1e3).toFixed(1)}s`))))))),r.length>0&&c.createElement("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden"},c.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},c.createElement("h3",{className:"text-lg font-semibold"},"Data Conflicts")),c.createElement("div",{className:"overflow-x-auto"},c.createElement("table",{className:"min-w-full divide-y divide-gray-200"},c.createElement("thead",{className:"bg-gray-50"},c.createElement("tr",null,["pKey","Field","SharePoint Value","System Value","Actions"].map(b=>c.createElement("th",{key:b,className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},b)))),c.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},r.map(b=>c.createElement("tr",{key:`${b.pKey}-${b.field}`},c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900"},b.pKey),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},b.field),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},String(b.sharePointValue)),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},String(b.systemValue)),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm space-x-2"},c.createElement("button",{onClick:()=>v(b.pKey,b.field,"use_sharepoint"),className:"px-3 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700"},"Use SharePoint"),c.createElement("button",{onClick:()=>v(b.pKey,b.field,"use_system"),className:"px-3 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700"},"Use System")))))))))},sy=()=>{const[a,t]=E.useState(qm()),[r,s]=E.useState(J0()),[l]=E.useState(Y0()),d=async u=>{try{await G0(u),t(qm())}catch(h){alert(h.message)}};return c.createElement("div",{className:"space-y-6"},c.createElement("div",{className:"bg-white p-4 rounded-lg border border-gray-200"},c.createElement("div",{className:"flex items-center justify-between"},c.createElement("h3",{className:"text-lg font-semibold"},"LTR System Status"),c.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${l==="connected"?"bg-green-100 text-green-800":l==="disconnected"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`},l.toUpperCase()))),c.createElement("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden"},c.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},c.createElement("h3",{className:"text-lg font-semibold"},"Delivery Tasks")),c.createElement("div",{className:"overflow-x-auto"},c.createElement("table",{className:"min-w-full divide-y divide-gray-200"},c.createElement("thead",{className:"bg-gray-50"},c.createElement("tr",null,["Task ID","MRF","Status","Driver","From","To","Priority","ETA","Actions"].map(u=>c.createElement("th",{key:u,className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},u)))),c.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},a.map(u=>c.createElement("tr",{key:u.id},c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900"},u.id.slice(0,15)+"..."),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},u.mrfId),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},c.createElement(kt,{status:u.status.replace("_"," ")})),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},u.driver||"-"),c.createElement("td",{className:"px-6 py-4 text-sm text-gray-900"},u.pickupLocation),c.createElement("td",{className:"px-6 py-4 text-sm text-gray-900"},u.deliveryLocation),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},c.createElement(kt,{status:u.priority})),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},u.estimatedDeliveryTime?new Date(u.estimatedDeliveryTime).toLocaleTimeString():"-"),c.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm"},u.status==="failed"&&u.retryCount<u.maxRetries&&c.createElement("button",{onClick:()=>d(u.id),className:"px-3 py-1 bg-orange-600 text-white rounded text-xs hover:bg-orange-700"},"Retry")))))))),c.createElement("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden"},c.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},c.createElement("h3",{className:"text-lg font-semibold"},"Drivers")),c.createElement("div",{className:"grid grid-cols-3 gap-4 p-6"},r.map(u=>c.createElement("div",{key:u.id,className:"border border-gray-200 rounded-lg p-4"},c.createElement("div",{className:"flex justify-between items-start mb-2"},c.createElement("div",{className:"font-semibold"},u.name),c.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${u.status==="available"?"bg-green-100 text-green-800":u.status==="busy"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`},u.status)),c.createElement("div",{className:"text-sm text-gray-600"},`Vehicle: ${u.vehicle}`),c.createElement("div",{className:"text-sm text-gray-600"},`Location: ${u.currentLocation||"Unknown"}`))))))},ay=()=>{const[a,t]=E.useState(!1),r=s=>{s==="json"?ry(ne,"material-requests"):ty(ne,s),t(!0)};return c.createElement("div",{className:"space-y-6"},a&&c.createElement(Ni,{message:"Export started! Check your downloads.",type:"success",onClose:()=>t(!1)}),c.createElement("div",{className:"bg-white p-6 rounded-lg border border-gray-200"},c.createElement("h3",{className:"text-lg font-semibold mb-4"},"Export Material Requests"),c.createElement("p",{className:"text-sm text-gray-600 mb-4"},"Export all material request data in your preferred format."),c.createElement("div",{className:"flex gap-3"},c.createElement("button",{onClick:()=>r("excel"),className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2"},c.createElement("span",null,"📊"),"Export to Excel"),c.createElement("button",{onClick:()=>r("csv"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2"},c.createElement("span",null,"📄"),"Export to CSV"),c.createElement("button",{onClick:()=>r("json"),className:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center gap-2"},c.createElement("span",null,"{}"),"Export to JSON"))))},iy=()=>{var l;const[a,t]=E.useState("notifications"),r=[{id:"notifications",label:"Notifications",component:Bm},{id:"sharepoint",label:"SharePoint Sync",component:ny},{id:"ltr",label:"LTR Delivery",component:sy},{id:"export",label:"Data Export",component:ay}],s=((l=r.find(d=>d.id===a))==null?void 0:l.component)||Bm;return c.createElement("div",{className:"h-full flex flex-col"},c.createElement("div",{className:"border-b border-gray-200 mb-6"},c.createElement("nav",{className:"flex space-x-8"},r.map(d=>c.createElement("button",{key:d.id,onClick:()=>t(d.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${a===d.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},d.label)))),c.createElement("div",{className:"flex-1 overflow-auto"},c.createElement(s,null)))},oy=({isOpen:a,request:t,onClose:r,onApprove:s,onReject:l,currentUserName:d})=>{const[u,h]=E.useState(null),[y,x]=E.useState(""),[g,v]=E.useState(""),b=()=>{if(u==="approve")s(y||void 0);else if(u==="reject"){if(!g.trim()){alert("Please provide a reason for rejecting this P1 request.");return}l(g)}_()},_=()=>{h(null),x(""),v("")},k=()=>{_(),r()};return a?c.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:j=>{j.target===j.currentTarget&&k()}},c.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 p-6"},c.createElement("div",{className:"mb-4 border-b pb-4"},c.createElement("div",{className:"flex items-center gap-2"},c.createElement("span",{className:"text-3xl"},"🔥"),c.createElement("div",null,c.createElement("h2",{className:"text-xl font-bold text-red-900"},"P1 Approval Required"),c.createElement("p",{className:"text-sm text-gray-500 mt-1"},`Review ${t.id} before warehouse can begin picking`)))),c.createElement("div",{className:"bg-red-50 border-l-4 border-red-600 p-4 mb-6"},c.createElement("h3",{className:"font-semibold text-red-900 mb-2"},"Priority 1 Request Details"),c.createElement("div",{className:"grid grid-cols-2 gap-4 text-sm"},c.createElement("div",null,c.createElement("p",{className:"text-gray-600"},"Request ID:"),c.createElement("p",{className:"font-mono font-semibold text-gray-900"},t.id)),c.createElement("div",null,c.createElement("p",{className:"text-gray-600"},"Requestor:"),c.createElement("p",{className:"font-semibold text-gray-900"},t.requestorName)),c.createElement("div",null,c.createElement("p",{className:"text-gray-600"},"# of Items:"),c.createElement("p",{className:"font-semibold text-gray-900"},t.items)),c.createElement("div",null,c.createElement("p",{className:"text-gray-600"},"Work Orders:"),c.createElement("p",{className:"font-semibold text-gray-900"},t.workOrders)),c.createElement("div",null,c.createElement("p",{className:"text-gray-600"},"Delivery Location:"),c.createElement("p",{className:"font-semibold text-gray-900"},t.DeliveryLocation)),c.createElement("div",null,c.createElement("p",{className:"text-gray-600"},"Required By:"),c.createElement("p",{className:"font-semibold text-red-700"},new Date(t.RequiredByTimestamp).toLocaleString())))),!u&&c.createElement("div",{className:"mb-6"},c.createElement("p",{className:"text-sm font-medium text-gray-700 mb-3"},"Review this P1 request and take action:"),c.createElement("div",{className:"grid grid-cols-2 gap-4"},c.createElement("button",{onClick:()=>h("approve"),className:"p-4 border-2 border-green-300 rounded-lg hover:bg-green-50 transition-colors"},c.createElement("div",{className:"text-center"},c.createElement("span",{className:"text-3xl block mb-2"},"✅"),c.createElement("span",{className:"font-semibold text-green-700"},"Approve Request"),c.createElement("p",{className:"text-xs text-gray-600 mt-1"},"Warehouse can start picking immediately"))),c.createElement("button",{onClick:()=>h("reject"),className:"p-4 border-2 border-red-300 rounded-lg hover:bg-red-50 transition-colors"},c.createElement("div",{className:"text-center"},c.createElement("span",{className:"text-3xl block mb-2"},"❌"),c.createElement("span",{className:"font-semibold text-red-700"},"Reject Request"),c.createElement("p",{className:"text-xs text-gray-600 mt-1"},"Request will be cancelled with reason"))))),u==="approve"&&c.createElement("div",{className:"mb-6 space-y-4"},c.createElement("div",{className:"bg-green-50 border border-green-200 rounded p-3"},c.createElement("p",{className:"text-sm font-semibold text-green-900"},"✅ Approving P1 Request"),c.createElement("p",{className:"text-xs text-green-700 mt-1"},"This request will be released to the warehouse pick queue immediately.")),c.createElement("div",null,c.createElement("label",{htmlFor:"approvalNotes",className:"block text-sm font-medium text-gray-700 mb-1"},"Approval Notes (Optional)"),c.createElement("textarea",{id:"approvalNotes",value:y,onChange:j=>x(j.target.value),rows:3,placeholder:"Any special instructions or notes for the warehouse...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})),c.createElement("button",{onClick:()=>h(null),className:"text-sm text-gray-600 hover:text-gray-800"},"← Back to selection")),u==="reject"&&c.createElement("div",{className:"mb-6 space-y-4"},c.createElement("div",{className:"bg-red-50 border border-red-200 rounded p-3"},c.createElement("p",{className:"text-sm font-semibold text-red-900"},"❌ Rejecting P1 Request"),c.createElement("p",{className:"text-xs text-red-700 mt-1"},"This request will be cancelled. The requestor will be notified.")),c.createElement("div",null,c.createElement("label",{htmlFor:"rejectReason",className:"block text-sm font-medium text-gray-700 mb-1"},"Rejection Reason *"),c.createElement("select",{id:"rejectReason",value:g,onChange:j=>v(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"},c.createElement("option",{value:""},"-- Select Reason --"),c.createElement("option",{value:"Not critical path"},"Not critical path"),c.createElement("option",{value:"Can wait until P2"},"Can wait until P2"),c.createElement("option",{value:"Insufficient justification"},"Insufficient justification"),c.createElement("option",{value:"Materials not available"},"Materials not available"),c.createElement("option",{value:"Incorrect priority assignment"},"Incorrect priority assignment"),c.createElement("option",{value:"Other"},"Other"))),c.createElement("button",{onClick:()=>h(null),className:"text-sm text-gray-600 hover:text-gray-800"},"← Back to selection")),c.createElement("div",{className:"flex justify-end gap-3 border-t pt-4"},c.createElement("button",{onClick:k,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},"Close"),u&&c.createElement("button",{onClick:b,disabled:u==="reject"&&!g,className:`px-6 py-2 text-sm font-medium text-white rounded-md disabled:bg-gray-300 disabled:cursor-not-allowed ${u==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`},u==="approve"?"✅ Approve":"❌ Reject")))):null},ly=({navigate:a})=>{const[t,r]=E.useState([]),[s,l]=E.useState({isOpen:!1,request:null}),[d,u]=E.useState(0);E.useEffect(()=>{const b=ne.filter(_=>_.status==="Pending Approval");b.sort((_,k)=>new Date(_.RequiredByTimestamp).getTime()-new Date(k.RequiredByTimestamp).getTime()),r(b)},[d]),E.useEffect(()=>{const b=setInterval(()=>{u(_=>_+1)},3e3);return()=>clearInterval(b)},[]);const h=b=>{if(!s.request)return;const _=ne.findIndex(k=>k.id===s.request.id);_!==-1&&(ne[_].status="Approved",ne[_].approvalInfo={approvedBy:"Material Coordinator",approvedAt:new Date().toISOString(),notes:b},ne[_].statusHistory=yt(ne[_].statusHistory,"Approved","Material Coordinator",b?`Approved: ${b}`:"P1 request approved"),setTimeout(()=>{const k=ne.findIndex(j=>j.id===s.request.id);k!==-1&&ne[k].status==="Approved"&&(ne[k].status="Submitted",ne[k].statusHistory=yt(ne[k].statusHistory,"Submitted","System","Auto-submitted after P1 approval"))},100),console.log(`✅ P1 Request ${s.request.id} approved by MC`)),l({isOpen:!1,request:null})},y=b=>{if(!s.request)return;const _=ne.findIndex(k=>k.id===s.request.id);_!==-1&&(ne[_].status="Cancelled",ne[_].approvalInfo={rejectedBy:"Material Coordinator",rejectedAt:new Date().toISOString(),notes:b},ne[_].statusHistory=yt(ne[_].statusHistory,"Cancelled","Material Coordinator",`P1 rejected: ${b}`),Jl(s.request.id,"Cancelled"),console.log(`❌ P1 Request ${s.request.id} rejected by MC: ${b}`)),l({isOpen:!1,request:null})},x=b=>{l({isOpen:!0,request:b})},g=E.useMemo(()=>[{accessorKey:"id",header:"Request ID",cell:({value:b})=>c.createElement("span",{className:"font-mono font-semibold text-red-600"},b)},{accessorKey:"status",header:"Status",cell:({value:b})=>c.createElement(kt,{status:b})},{accessorKey:"requestorName",header:"Requestor",cell:({value:b})=>c.createElement("span",{className:"font-medium"},b)},{accessorKey:"items",header:"# Items"},{accessorKey:"workOrders",header:"Work Order(s)"},{accessorKey:"RequiredByTimestamp",header:"Required By",cell:({value:b})=>{const _=new Date(b),k=new Date,C=(_.getTime()-k.getTime())/(1e3*60*60)<4;return c.createElement("span",{className:C?"font-semibold text-red-700":""},_.toLocaleString())}},{accessorKey:"createdDate",header:"Submitted",cell:({value:b})=>c.createElement("span",{className:"text-sm"},b)},{accessorKey:"DeliveryLocation",header:"Delivery Location"}],[]),v=E.useMemo(()=>t.map(b=>({...b,onClick:()=>x(b)})),[t]);return c.createElement("div",{className:"space-y-4"},c.createElement("div",{className:"bg-red-50 border-l-4 border-red-600 p-4"},c.createElement("div",{className:"flex items-start"},c.createElement("div",{className:"flex-shrink-0"},c.createElement("span",{className:"text-3xl"},"🔥")),c.createElement("div",{className:"ml-3 flex-1"},c.createElement("h3",{className:"text-sm font-medium text-red-800"},"P1 Approval Queue"),c.createElement("div",{className:"mt-2 text-sm text-red-700"},c.createElement("p",null,`${t.length} Priority 1 request(s) awaiting your approval before warehouse can begin picking.`),t.length>0&&c.createElement("p",{className:"mt-1 font-semibold"},"Click any row to review and approve/reject."))))),t.length>0?c.createElement(Ar,{data:v,columns:g,uniqueId:"id"}):c.createElement("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center"},c.createElement("span",{className:"text-6xl block mb-4"},"✅"),c.createElement("h3",{className:"text-lg font-semibold text-gray-700"},"No Pending P1 Approvals"),c.createElement("p",{className:"text-gray-500 mt-2"},"All P1 requests have been reviewed.")),s.request&&c.createElement(oy,{isOpen:s.isOpen,request:s.request,onClose:()=>l({isOpen:!1,request:null}),onApprove:h,onReject:y,currentUserName:"Material Coordinator"}))},cy=({navigate:a,currentUser:t})=>{const[r,s]=E.useState([]),[l,d]=E.useState(null),[u,h]=E.useState(null),[y,x]=E.useState(!1),[g,v]=E.useState(new Set),[b,_]=E.useState(!1),k=Hs(t,"god_mode");E.useEffect(()=>{const K=ne.filter(Y=>Y.status==="Submitted"||Y.status==="Picking");K.sort((Y,B)=>{if(Y.MC_Priority_Flag&&!B.MC_Priority_Flag)return-1;if(!Y.MC_Priority_Flag&&B.MC_Priority_Flag)return 1;if(Y.MC_Queue_Position!==void 0&&B.MC_Queue_Position!==void 0)return Y.MC_Queue_Position-B.MC_Queue_Position;if(Y.MC_Queue_Position!==void 0)return-1;if(B.MC_Queue_Position!==void 0)return 1;const z={P1:1,P2:2,P3:3,P4:4},U=z[Y.priority]||5,re=z[B.priority]||5;return U!==re?U-re:new Date(Y.RequiredByTimestamp).getTime()-new Date(B.RequiredByTimestamp).getTime()}),s(K)},[]);const j=E.useCallback((K,Y)=>{k&&(d(Y),K.dataTransfer.effectAllowed="move")},[k]),C=E.useCallback((K,Y)=>{K.preventDefault(),k&&h(Y)},[k]),A=E.useCallback(()=>{h(null)},[]),S=E.useCallback((K,Y)=>{if(K.preventDefault(),!l||!k)return;const B=r.findIndex(re=>re.id===l.id);if(B===Y){d(null),h(null);return}const z=[...r],[U]=z.splice(B,1);z.splice(Y,0,U),z.forEach((re,G)=>{re.MC_Queue_Position=G+1}),s(z),d(null),h(null),x(!0)},[l,r,k]),D=E.useCallback(K=>{if(!k)return;const Y=r.map(B=>{if(B.id===K.id){const z=!B.MC_Priority_Flag;return yt(B,B.status,t.name,z?"MC Priority Flag ADDED":"MC Priority Flag REMOVED"),{...B,MC_Priority_Flag:z}}return B});Y.sort((B,z)=>B.MC_Priority_Flag&&!z.MC_Priority_Flag?-1:!B.MC_Priority_Flag&&z.MC_Priority_Flag?1:B.MC_Queue_Position!==void 0&&z.MC_Queue_Position!==void 0?B.MC_Queue_Position-z.MC_Queue_Position:0),s(Y),x(!0)},[r,t,k]),L=E.useCallback(()=>{r.forEach(K=>{const Y=ne.find(B=>B.id===K.id);Y&&(Y.MC_Queue_Position=K.MC_Queue_Position,Y.MC_Priority_Flag=K.MC_Priority_Flag,K.statusHistory&&(Y.statusHistory=K.statusHistory))}),x(!1),alert("✅ Queue order saved successfully!")},[r]),M=E.useCallback(()=>{if(!confirm("Reset queue to default priority order? This will remove all MC overrides."))return;const K=r.map(Y=>({...Y,MC_Queue_Position:void 0,MC_Priority_Flag:!1}));K.sort((Y,B)=>{const z={P1:1,P2:2,P3:3,P4:4},U=z[Y.priority]||5,re=z[B.priority]||5;return U!==re?U-re:new Date(Y.RequiredByTimestamp).getTime()-new Date(B.RequiredByTimestamp).getTime()}),s(K),x(!0)},[r]),q=E.useCallback(K=>{const Y=new Set(g);Y.has(K)?Y.delete(K):Y.add(K),v(Y),_(Y.size>0)},[g]),Q=E.useCallback(()=>{g.size===r.length?(v(new Set),_(!1)):(v(new Set(r.map(K=>K.id))),_(!0))},[r,g]),me=E.useCallback(()=>{if(g.size===0)return;const K=r.map(Y=>g.has(Y.id)&&!Y.MC_Priority_Flag?(yt(Y,Y.status,t.name,"MC Priority Flag ADDED (bulk)"),{...Y,MC_Priority_Flag:!0}):Y);s(K),x(!0),v(new Set),_(!1),alert(`✅ Added MC Priority flag to ${g.size} request(s)`)},[g,r,t]),ye=E.useCallback(()=>{if(g.size===0)return;const K=r.map(Y=>g.has(Y.id)&&Y.MC_Priority_Flag?(yt(Y,Y.status,t.name,"MC Priority Flag REMOVED (bulk)"),{...Y,MC_Priority_Flag:!1}):Y);s(K),x(!0),v(new Set),_(!1),alert(`✅ Removed MC Priority flag from ${g.size} request(s)`)},[g,r,t]),J=E.useCallback(()=>{if(g.size===0)return;const K=r.filter(z=>g.has(z.id)),Y=r.filter(z=>!g.has(z.id)),B=[...K,...Y];B.forEach((z,U)=>{z.MC_Queue_Position=U+1,g.has(z.id)&&yt(z,z.status,t.name,"Moved to top of queue (bulk)")}),s(B),x(!0),v(new Set),_(!1),alert(`✅ Moved ${K.length} request(s) to top of queue`)},[g,r,t]),ae=E.useCallback(()=>{if(g.size===0)return;const K=r.filter(z=>!g.has(z.id)),Y=r.filter(z=>g.has(z.id)),B=[...K,...Y];B.forEach((z,U)=>{z.MC_Queue_Position=U+1,g.has(z.id)&&yt(z,z.status,t.name,"Moved to bottom of queue (bulk)")}),s(B),x(!0),v(new Set),_(!1),alert(`✅ Moved ${Y.length} request(s) to bottom of queue`)},[g,r,t]);return k?c.createElement("div",{className:"space-y-4"},c.createElement("div",{className:"bg-blue-50 border-l-4 border-blue-600 p-4"},c.createElement("div",{className:"flex items-start"},c.createElement("div",{className:"flex-shrink-0"},c.createElement(xe.QueueListIcon,{className:"h-6 w-6 text-blue-600"})),c.createElement("div",{className:"ml-3 flex-1"},c.createElement("h3",{className:"text-sm font-medium text-blue-800"},"Priority Queue Management"),c.createElement("div",{className:"mt-2 text-sm text-blue-700"},c.createElement("p",null,"🔄 Drag and drop to reorder the warehouse pick queue"),c.createElement("p",null,"🚩 Click the flag icon to mark as MC Priority (moves to top)"),c.createElement("p",null,"💾 Changes are saved automatically to the system"))))),c.createElement("div",{className:"flex justify-between items-center"},c.createElement("div",{className:"flex items-center gap-4"},c.createElement("div",{className:"text-sm text-gray-600"},c.createElement("span",{className:"font-semibold"},r.length)," requests in active queue"),r.length>0&&c.createElement("label",{className:"flex items-center gap-2 text-sm text-gray-700 cursor-pointer"},c.createElement("input",{type:"checkbox",checked:g.size===r.length&&r.length>0,onChange:Q,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),"Select All")),c.createElement("div",{className:"flex gap-2"},y&&c.createElement("button",{onClick:L,className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 flex items-center gap-2"},c.createElement("span",null,"💾"),"Save Changes"),c.createElement("button",{onClick:M,className:"px-4 py-2 bg-gray-600 text-white text-sm font-medium rounded-md hover:bg-gray-700"},"Reset Queue"))),b&&c.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},c.createElement("div",{className:"flex items-center justify-between"},c.createElement("div",{className:"text-sm font-medium text-blue-900"},c.createElement("span",{className:"font-bold"},g.size)," request(s) selected"),c.createElement("div",{className:"flex flex-wrap gap-2"},[c.createElement("button",{key:"add-priority",onClick:me,className:"px-3 py-1.5 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 flex items-center gap-1"},c.createElement("span",null,"🚩"),"Add MC Priority"),c.createElement("button",{key:"remove-priority",onClick:ye,className:"px-3 py-1.5 bg-gray-600 text-white text-sm font-medium rounded-md hover:bg-gray-700"},"Remove Priority"),c.createElement("button",{key:"move-top",onClick:J,className:"px-3 py-1.5 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 flex items-center gap-1"},c.createElement("span",null,"⬆️"),"Move to Top"),c.createElement("button",{key:"move-bottom",onClick:ae,className:"px-3 py-1.5 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 flex items-center gap-1"},c.createElement("span",null,"⬇️"),"Move to Bottom"),c.createElement("button",{key:"deselect",onClick:()=>{v(new Set),_(!1)},className:"px-3 py-1.5 bg-white text-gray-700 text-sm font-medium rounded-md border border-gray-300 hover:bg-gray-50"},"Deselect All")]))),c.createElement("div",{className:"bg-white rounded-lg shadow"},r.length===0?c.createElement("div",{className:"p-8 text-center text-gray-500"},c.createElement("p",null,"No active requests in queue")):c.createElement("div",{className:"divide-y divide-gray-200"},r.map((K,Y)=>c.createElement("div",{key:K.id,draggable:!0,onDragStart:B=>j(B,K),onDragOver:B=>C(B,Y),onDragLeave:A,onDrop:B=>S(B,Y),className:`p-4 flex items-center gap-4 cursor-move hover:bg-gray-50 transition-colors ${u===Y?"border-t-4 border-blue-500":""} ${(l==null?void 0:l.id)===K.id?"opacity-50":""} ${g.has(K.id)?"bg-blue-50":""}`},c.createElement("input",{type:"checkbox",checked:g.has(K.id),onChange:()=>q(K.id),onClick:B=>B.stopPropagation(),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 flex-shrink-0"}),c.createElement("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center font-bold text-lg text-gray-700"},Y+1),c.createElement("div",{className:"flex-shrink-0 text-gray-400"},c.createElement(xe.EllipsisHorizontalIcon,{className:"h-6 w-6 rotate-90"})),c.createElement("div",{className:"flex-1 min-w-0"},c.createElement("div",{className:"flex items-center gap-2 mb-1"},c.createElement("span",{className:"font-mono font-semibold text-blue-600"},K.id),c.createElement(kt,{status:K.status}),K.MC_Priority_Flag&&c.createElement("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 text-xs font-bold rounded-full"},"🚩 MC PRIORITY")),c.createElement("div",{className:"text-sm text-gray-600"},c.createElement("span",null,`${K.items} items • ${K.priority} • Required: ${new Date(K.RequiredByTimestamp).toLocaleString()}`)),K.DeliveryLocation&&c.createElement("div",{className:"text-xs text-gray-500 mt-1"},`📍 ${K.DeliveryLocation}`)),c.createElement("button",{onClick:()=>D(K),className:`flex-shrink-0 p-2 rounded-full transition-colors ${K.MC_Priority_Flag?"bg-red-100 text-red-600 hover:bg-red-200":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:K.MC_Priority_Flag?"Remove MC Priority Flag":"Add MC Priority Flag"},c.createElement("span",{className:"text-xl"},"🚩")),c.createElement("button",{onClick:()=>a("picking",{request:K}),className:"flex-shrink-0 px-3 py-1.5 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700"},"View"))))),y&&c.createElement("div",{className:"bg-yellow-50 border-l-4 border-yellow-600 p-4"},c.createElement("div",{className:"flex items-start"},c.createElement("div",{className:"flex-shrink-0"},c.createElement(xe.ExclamationTriangleIcon,{className:"h-5 w-5 text-yellow-600"})),c.createElement("div",{className:"ml-3"},c.createElement("p",{className:"text-sm text-yellow-800 font-medium"},'⚠️ You have unsaved changes. Click "Save Changes" to apply them to the warehouse queue.'))))):c.createElement("div",{className:"p-6"},c.createElement("div",{className:"bg-red-50 border-l-4 border-red-600 p-4"},c.createElement("div",{className:"flex items-start"},c.createElement("div",{className:"flex-shrink-0"},c.createElement("span",{className:"text-3xl"},"🔒")),c.createElement("div",{className:"ml-3"},c.createElement("h3",{className:"text-sm font-medium text-red-800"},"Access Denied"),c.createElement("p",{className:"mt-2 text-sm text-red-700"},"Only Material Coordinators (MC) can manage the priority queue.")))))},Um={Submitted:["Pending Approval","Picking","On Hold","Cancelled"],"Pending Approval":["Approved","Submitted","Cancelled"],Approved:["Picking","On Hold","Cancelled"],Picking:["Partial Pick - Open","Staged","On Hold","Cancelled"],"Partial Pick - Open":["Partial Pick - Closed","Staged","Picking","On Hold","Cancelled"],"Partial Pick - Closed":["Staged","Picking","On Hold","Cancelled"],Staged:["In Transit","Delivered","Picking","Cancelled"],"In Transit":["Delivered","On Hold","Cancelled"],Delivered:[],"On Hold":["Submitted","Picking","Staged","Cancelled"],Cancelled:[]};function dy(a,t){const r={"Submitted->Pending Approval":"P1 request requires MC approval","Submitted->Picking":"Warehouse starts picking items","Submitted->On Hold":"Request put on hold before picking","Submitted->Cancelled":"Request cancelled before picking started","Pending Approval->Approved":"MC approved P1 request","Pending Approval->Submitted":"MC rejected, returned to queue","Pending Approval->Cancelled":"Request cancelled during approval","Approved->Picking":"Warehouse starts picking approved request","Picking->Partial Pick - Open":"Some items could not be picked (short)","Picking->Staged":"All items picked successfully","Picking->On Hold":"Picking paused due to issue","Partial Pick - Open->Partial Pick - Closed":"Partial pick issue resolved","Partial Pick - Open->Staged":"Proceeding with partial fulfillment","Partial Pick - Closed->Staged":"Partial pick ready for staging","Staged->In Transit":"Delivery in progress","Staged->Delivered":"Direct handoff to requestor","In Transit->Delivered":"Delivery completed successfully","On Hold->Submitted":"Resumed to pick queue","On Hold->Picking":"Resumed picking","On Hold->Cancelled":"Cancelled while on hold","Cancelled->":"Terminal state","Delivered->":"Terminal state"},s=`${a}->${t}`;return r[s]||`Transition from ${a} to ${t}`}const uy=()=>{const a=Object.keys(Um);return c.createElement("div",{className:"space-y-6 p-6"},c.createElement("div",{className:"bg-blue-50 border-l-4 border-blue-600 p-4"},c.createElement("div",{className:"flex items-start"},c.createElement("div",{className:"flex-shrink-0"},c.createElement(xe.DocumentTextIcon,{className:"h-6 w-6 text-blue-600"})),c.createElement("div",{className:"ml-3"},c.createElement("h3",{className:"text-lg font-medium text-blue-800"},"Material Request Workflow"),c.createElement("p",{className:"mt-2 text-sm text-blue-700"},"This diagram shows all valid status transitions in the system. MC god mode can override restrictions.")))),c.createElement("div",{className:"bg-white rounded-lg shadow p-4"},c.createElement("h4",{className:"font-semibold text-gray-800 mb-3"},"Legend"),c.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm"},c.createElement("div",{className:"flex items-center gap-2"},c.createElement("div",{className:"w-4 h-4 bg-green-200 border-2 border-green-600 rounded"}),c.createElement("span",null,"Normal Status")),c.createElement("div",{className:"flex items-center gap-2"},c.createElement("div",{className:"w-4 h-4 bg-yellow-200 border-2 border-yellow-600 rounded"}),c.createElement("span",null,"Hold/Review")),c.createElement("div",{className:"flex items-center gap-2"},c.createElement("div",{className:"w-4 h-4 bg-blue-200 border-2 border-blue-600 rounded"}),c.createElement("span",null,"In Progress")),c.createElement("div",{className:"flex items-center gap-2"},c.createElement("div",{className:"w-4 h-4 bg-gray-300 border-2 border-gray-600 rounded"}),c.createElement("span",null,"Terminal")))),c.createElement("div",{className:"bg-white rounded-lg shadow p-6"},c.createElement("h4",{className:"font-semibold text-gray-800 mb-4"},"Status Transitions"),c.createElement("div",{className:"space-y-6"},a.map(t=>{const r=Um[t],s=l=>l==="Cancelled"?"bg-red-200 border-red-600 text-red-800":l==="Delivered"?"bg-gray-300 border-gray-600 text-gray-800":l==="On Hold"||l==="Pending Approval"?"bg-yellow-200 border-yellow-600 text-yellow-800":l==="Picking"||l==="In Transit"?"bg-blue-200 border-blue-600 text-blue-800":"bg-green-200 border-green-600 text-green-800";return c.createElement("div",{key:t,className:"border-l-4 border-gray-300 pl-4"},c.createElement("div",{className:`inline-block px-4 py-2 rounded-lg border-2 font-semibold text-sm mb-3 ${s(t)}`},t),r.length>0?c.createElement("div",{className:"ml-8 space-y-2"},c.createElement("p",{className:"text-xs text-gray-500 font-semibold mb-2"},"CAN TRANSITION TO:"),r.map(l=>c.createElement("div",{key:l,className:"flex items-start gap-2 text-sm"},c.createElement("span",{className:"text-gray-400 mt-1"},"→"),c.createElement("div",null,c.createElement("span",{className:`inline-block px-3 py-1 rounded-md border font-medium text-xs ${s(l)}`},l),c.createElement("p",{className:"text-xs text-gray-600 mt-1"},dy(t,l)))))):c.createElement("p",{className:"ml-8 text-sm text-gray-500 italic"},"🔒 Terminal state - no forward transitions (MC can override)"))}))),c.createElement("div",{className:"bg-purple-50 border-l-4 border-purple-600 p-4"},c.createElement("div",{className:"flex items-start"},c.createElement("div",{className:"flex-shrink-0"},c.createElement(xe.ShieldCheckIcon,{className:"h-6 w-6 text-purple-600"})),c.createElement("div",{className:"ml-3"},c.createElement("h4",{className:"text-sm font-medium text-purple-800"},"Material Coordinator (MC) God Mode"),c.createElement("p",{className:"mt-2 text-sm text-purple-700"},"MCs can override any status transition, including backwards moves and transitions from terminal states. All overrides are logged in the audit trail.")))))},my=({navigate:a})=>{const[t,r]=E.useState(Pt),[s,l]=E.useState(""),[d,u]=E.useState(!1),[h,y]=E.useState(null),[x,g]=E.useState({building:"",floor:"",room:"",contactPerson:"",contactPhone:"",deliveryInstructions:"",isActive:!0}),v=E.useMemo(()=>{if(!s)return t;const S=s.toLowerCase();return t.filter(D=>{var L,M,q;return D.building.toLowerCase().includes(S)||((L=D.floor)==null?void 0:L.toLowerCase().includes(S))||((M=D.room)==null?void 0:M.toLowerCase().includes(S))||((q=D.contactPerson)==null?void 0:q.toLowerCase().includes(S))||D.fullAddress.toLowerCase().includes(S)})},[t,s]),b=S=>{S?(y(S),g(S)):(y(null),g({building:"",floor:"",room:"",contactPerson:"",contactPhone:"",deliveryInstructions:"",isActive:!0})),u(!0)},_=()=>{u(!1),y(null),g({building:"",floor:"",room:"",contactPerson:"",contactPhone:"",deliveryInstructions:"",isActive:!0})},k=()=>{if(!x.building){alert("Building is required");return}if(h){const S=Sm(h.id,x);r(D=>D.map(L=>L.id===h.id?S:L))}else{const S=dg(x);r(D=>[...D,S])}_()},j=S=>{window.confirm(`Are you sure you want to delete "${S.fullAddress}"?`)&&(ug(S.id),r(D=>D.filter(L=>L.id!==S.id)))},C=S=>{const D=Sm(S.id,{isActive:!S.isActive});r(L=>L.map(M=>M.id===S.id?D:M))},A=[{accessorKey:"building",header:"Building",cell:({row:S,value:D})=>o.jsx("div",{className:"font-medium text-gray-900",children:D})},{accessorKey:"floor",header:"Floor",cell:({value:S})=>S||"-"},{accessorKey:"room",header:"Room",cell:({value:S})=>S||"-"},{accessorKey:"contactPerson",header:"Contact",cell:({value:S})=>S||"-"},{accessorKey:"contactPhone",header:"Phone",cell:({value:S})=>S||"-"},{accessorKey:"isActive",header:"Status",cell:({value:S})=>o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${S?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:S?"Active":"Inactive"})},{accessorKey:"actions",header:"Actions",enableFiltering:!1,cell:({row:S})=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>b(S),className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:o.jsx(xe.PencilIcon,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>C(S),className:"p-2 text-gray-600 hover:bg-gray-50 rounded",title:S.isActive?"Deactivate":"Activate",children:S.isActive?o.jsx(xe.CheckCircleIcon,{className:"h-4 w-4 text-green-600"}):o.jsx(xe.XCircleIcon,{className:"h-4 w-4 text-gray-400"})}),o.jsx("button",{onClick:()=>j(S),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:o.jsx(xe.TrashIcon,{className:"h-4 w-4"})})]})}];return o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Delivery Locations"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage delivery locations for material requests"})]}),o.jsxs("button",{onClick:()=>b(),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(xe.PlusIcon,{className:"h-5 w-5 mr-2"}),"Add Location"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 bg-blue-100 rounded-md p-3",children:o.jsx(xe.BuildingIcon,{className:"h-6 w-6 text-blue-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Locations"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:t.length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 bg-green-100 rounded-md p-3",children:o.jsx(xe.CheckCircleIcon,{className:"h-6 w-6 text-green-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Active"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:t.filter(S=>S.isActive).length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 bg-gray-100 rounded-md p-3",children:o.jsx(xe.XCircleIcon,{className:"h-6 w-6 text-gray-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Inactive"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:t.filter(S=>!S.isActive).length})]})]})})]}),o.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(xe.SearchIcon,{className:"h-5 w-5 text-gray-400"})}),o.jsx("input",{type:"text",placeholder:"Search locations by building, floor, room, or contact...",value:s,onChange:S=>l(S.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow",children:o.jsx(Ar,{data:v,columns:A,uniqueId:"id"})}),d&&o.jsx(qg,{isOpen:d,onClose:_,title:h?"Edit Location":"Add New Location",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Building ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:x.building||"",onChange:S=>g({...x,building:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Admin Building, Workshop A"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Floor"}),o.jsx("input",{type:"text",value:x.floor||"",onChange:S=>g({...x,floor:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Ground, Level 2"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Room"}),o.jsx("input",{type:"text",value:x.room||"",onChange:S=>g({...x,room:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 201, Storeroom B"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),o.jsx("input",{type:"text",value:x.contactPerson||"",onChange:S=>g({...x,contactPerson:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Phone"}),o.jsx("input",{type:"tel",value:x.contactPhone||"",onChange:S=>g({...x,contactPhone:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Phone number"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Instructions"}),o.jsx("textarea",{value:x.deliveryInstructions||"",onChange:S=>g({...x,deliveryInstructions:S.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Special instructions for delivery..."})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",id:"isActive",checked:x.isActive!==!1,onChange:S=>g({...x,isActive:S.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),o.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Active (available for selection in requests)"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[o.jsx("button",{onClick:_,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),o.jsxs("button",{onClick:k,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[h?"Update":"Add"," Location"]})]})]})})]})};class hy{constructor(){this.shortcuts=new Map,this.handler=null,this.disabled=!1}register(t){const r=this.generateKey(t);this.shortcuts.set(r,t)}unregister(t,r){const s=this.generateKeyFromParams(t,r);this.shortcuts.delete(s)}generateKey(t){return this.generateKeyFromParams(t.key,{ctrl:t.ctrl,alt:t.alt,shift:t.shift,meta:t.meta})}generateKeyFromParams(t,r){const s=[];return r!=null&&r.ctrl&&s.push("ctrl"),r!=null&&r.alt&&s.push("alt"),r!=null&&r.shift&&s.push("shift"),r!=null&&r.meta&&s.push("meta"),s.push(t.toLowerCase()),s.join("+")}matchesShortcut(t,r){return!(t.key.toLowerCase()!==r.key.toLowerCase()||r.ctrl&&!t.ctrlKey&&!t.metaKey||!r.ctrl&&(t.ctrlKey||t.metaKey)||r.alt&&!t.altKey||!r.alt&&t.altKey||r.shift&&!t.shiftKey||!r.shift&&t.shiftKey)}init(){this.handler||(this.handler=t=>{if(this.disabled)return;const r=t.target;if(!((r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.isContentEditable)&&(!["k","?"].includes(t.key.toLowerCase())||t.key.toLowerCase()==="k"&&!t.ctrlKey&&!t.metaKey))){for(const s of this.shortcuts.values())if(this.matchesShortcut(t,s)){t.preventDefault(),s.action();break}}},document.addEventListener("keydown",this.handler),console.log("✅ Keyboard shortcuts initialized"))}cleanup(){this.handler&&(document.removeEventListener("keydown",this.handler),this.handler=null)}disable(){this.disabled=!0}enable(){this.disabled=!1}getAll(){return Array.from(this.shortcuts.values())}getByCategory(t){return this.getAll().filter(r=>r.category===t)}}const ir=new hy,py=a=>{const t=navigator.platform.toUpperCase().indexOf("MAC")>=0,r=[];return a.ctrl&&r.push(t?"⌘":"Ctrl"),a.alt&&r.push(t?"⌥":"Alt"),a.shift&&r.push(t?"⇧":"Shift"),a.meta&&r.push("⌘"),r.push(a.key.toUpperCase()),r.join(t?"":"+")},fy=a=>{a.onQuickSearch&&ir.register({key:"k",ctrl:!0,description:"Open quick search",category:"search",action:a.onQuickSearch}),a.onNewRequest&&ir.register({key:"n",ctrl:!0,description:"Create new request",category:"actions",action:a.onNewRequest}),a.onShowHelp&&ir.register({key:"?",shift:!0,description:"Show keyboard shortcuts",category:"help",action:a.onShowHelp}),ir.init()},Fm=({isOpen:a,onClose:t})=>{if(!a)return null;ir.getAll();const r={search:ir.getByCategory("search"),actions:ir.getByCategory("actions"),navigation:ir.getByCategory("navigation"),help:ir.getByCategory("help")},s={search:"🔍 Search",actions:"⚡ Actions",navigation:"🧭 Navigation",help:"❓ Help"};return c.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,role:"dialog","aria-modal":"true","aria-labelledby":"shortcuts-modal-title"},c.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",onClick:l=>l.stopPropagation()},[c.createElement("div",{key:"header",className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},[c.createElement("h2",{key:"title",id:"shortcuts-modal-title",className:"text-xl font-bold text-gray-900"},"⌨️ Keyboard Shortcuts"),c.createElement("button",{key:"close",onClick:t,className:"text-gray-400 hover:text-gray-600 focus:outline-none text-2xl","aria-label":"Close shortcuts help"},"×")]),c.createElement("div",{key:"content",className:"px-6 py-4 overflow-y-auto flex-1"},[c.createElement("p",{key:"intro",className:"text-sm text-gray-600 mb-6"},"Use these keyboard shortcuts to navigate quickly and boost your productivity."),...Object.entries(r).map(([l,d])=>d.length===0?null:c.createElement("div",{key:l,className:"mb-6 last:mb-0"},[c.createElement("h3",{key:"category-title",className:"text-lg font-semibold text-gray-800 mb-3"},s[l]),c.createElement("div",{key:"shortcuts-list",className:"space-y-2"},d.map((u,h)=>c.createElement("div",{key:h,className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[c.createElement("span",{key:"description",className:"text-sm text-gray-700"},u.description),c.createElement("kbd",{key:"shortcut",className:"px-3 py-1 bg-white border border-gray-300 rounded shadow-sm text-sm font-mono font-semibold text-gray-800"},py(u))])))])).filter(Boolean)]),c.createElement("div",{key:"footer",className:"px-6 py-4 border-t border-gray-200 bg-gray-50"},c.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},[c.createElement("span",{key:"tip-icon",className:"text-lg"},"💡"),c.createElement("span",{key:"tip-text"},"Tip: Press ? anytime to see this help again")]))]))},gy="modulepreload",yy=function(a){return"/SCM-Hub-V4/"+a},zm={},Gn=function(t,r,s){let l=Promise.resolve();if(r&&r.length>0){let u=function(x){return Promise.all(x.map(g=>Promise.resolve(g).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),y=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));l=u(r.map(x=>{if(x=yy(x),x in zm)return;zm[x]=!0;const g=x.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${v}`))return;const b=document.createElement("link");if(b.rel=g?"stylesheet":gy,g||(b.as="script"),b.crossOrigin="",b.href=x,y&&b.setAttribute("nonce",y),document.head.appendChild(b),g)return new Promise((_,k)=>{b.addEventListener("load",_),b.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${x}`)))})}))}function d(u){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=u,window.dispatchEvent(h),!h.defaultPrevented)throw u}return l.then(u=>{for(const h of u||[])h.status==="rejected"&&d(h.reason);return t().catch(d)})},xy=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...r)=>Gn(async()=>{const{default:s}=await Promise.resolve().then(()=>Jn);return{default:s}},void 0).then(({default:s})=>s(...r)):t=fetch,(...r)=>t(...r)};class fc extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class Hm extends fc{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Wm extends fc{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Km extends fc{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Xl;(function(a){a.Any="any",a.ApNortheast1="ap-northeast-1",a.ApNortheast2="ap-northeast-2",a.ApSouth1="ap-south-1",a.ApSoutheast1="ap-southeast-1",a.ApSoutheast2="ap-southeast-2",a.CaCentral1="ca-central-1",a.EuCentral1="eu-central-1",a.EuWest1="eu-west-1",a.EuWest2="eu-west-2",a.EuWest3="eu-west-3",a.SaEast1="sa-east-1",a.UsEast1="us-east-1",a.UsWest1="us-west-1",a.UsWest2="us-west-2"})(Xl||(Xl={}));var vy=function(a,t,r,s){function l(d){return d instanceof r?d:new r(function(u){u(d)})}return new(r||(r=Promise))(function(d,u){function h(g){try{x(s.next(g))}catch(v){u(v)}}function y(g){try{x(s.throw(g))}catch(v){u(v)}}function x(g){g.done?d(g.value):l(g.value).then(h,y)}x((s=s.apply(a,t||[])).next())})};class by{constructor(t,{headers:r={},customFetch:s,region:l=Xl.Any}={}){this.url=t,this.headers=r,this.region=l,this.fetch=xy(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return vy(this,arguments,void 0,function*(r,s={}){var l;try{const{headers:d,method:u,body:h,signal:y}=s;let x={},{region:g}=s;g||(g=this.region);const v=new URL(`${this.url}/${r}`);g&&g!=="any"&&(x["x-region"]=g,v.searchParams.set("forceFunctionRegion",g));let b;h&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)&&(typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",b=h):typeof h=="string"?(x["Content-Type"]="text/plain",b=h):typeof FormData<"u"&&h instanceof FormData?b=h:(x["Content-Type"]="application/json",b=JSON.stringify(h)));const _=yield this.fetch(v.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),d),body:b,signal:y}).catch(A=>{throw A.name==="AbortError"?A:new Hm(A)}),k=_.headers.get("x-relay-error");if(k&&k==="true")throw new Wm(_);if(!_.ok)throw new Km(_);let j=((l=_.headers.get("Content-Type"))!==null&&l!==void 0?l:"text/plain").split(";")[0].trim(),C;return j==="application/json"?C=yield _.json():j==="application/octet-stream"?C=yield _.blob():j==="text/event-stream"?C=_:j==="multipart/form-data"?C=yield _.formData():C=yield _.text(),{data:C,error:null,response:_}}catch(d){return d instanceof Error&&d.name==="AbortError"?{data:null,error:new Hm(d)}:{data:null,error:d,response:d instanceof Km||d instanceof Wm?d.context:void 0}}})}}var Je={},On={},An={},In={},Ln={},Mn={},wy=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Qn=wy();const _y=Qn.fetch,Ph=Qn.fetch.bind(Qn),Rh=Qn.Headers,ky=Qn.Request,Ey=Qn.Response,Jn=Object.freeze(Object.defineProperty({__proto__:null,Headers:Rh,Request:ky,Response:Ey,default:Ph,fetch:_y},Symbol.toStringTag,{value:"Module"})),Sy=tg(Jn);var di={},Vm;function Dh(){if(Vm)return di;Vm=1,Object.defineProperty(di,"__esModule",{value:!0});class a extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return di.default=a,di}var Qm;function Oh(){if(Qm)return Mn;Qm=1;var a=Mn&&Mn.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Mn,"__esModule",{value:!0});const t=a(Sy),r=a(Dh());class s{constructor(d){var u,h;this.shouldThrowOnError=!1,this.method=d.method,this.url=d.url,this.headers=new Headers(d.headers),this.schema=d.schema,this.body=d.body,this.shouldThrowOnError=(u=d.shouldThrowOnError)!==null&&u!==void 0?u:!1,this.signal=d.signal,this.isMaybeSingle=(h=d.isMaybeSingle)!==null&&h!==void 0?h:!1,d.fetch?this.fetch=d.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(d,u){return this.headers=new Headers(this.headers),this.headers.set(d,u),this}then(d,u){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let y=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async x=>{var g,v,b,_;let k=null,j=null,C=null,A=x.status,S=x.statusText;if(x.ok){if(this.method!=="HEAD"){const q=await x.text();q===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((g=this.headers.get("Accept"))===null||g===void 0)&&g.includes("application/vnd.pgrst.plan+text"))?j=q:j=JSON.parse(q))}const L=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),M=(b=x.headers.get("content-range"))===null||b===void 0?void 0:b.split("/");L&&M&&M.length>1&&(C=parseInt(M[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(j)&&(j.length>1?(k={code:"PGRST116",details:`Results contain ${j.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},j=null,C=null,A=406,S="Not Acceptable"):j.length===1?j=j[0]:j=null)}else{const L=await x.text();try{k=JSON.parse(L),Array.isArray(k)&&x.status===404&&(j=[],k=null,A=200,S="OK")}catch{x.status===404&&L===""?(A=204,S="No Content"):k={message:L}}if(k&&this.isMaybeSingle&&(!((_=k==null?void 0:k.details)===null||_===void 0)&&_.includes("0 rows"))&&(k=null,A=200,S="OK"),k&&this.shouldThrowOnError)throw new r.default(k)}return{error:k,data:j,count:C,status:A,statusText:S}});return this.shouldThrowOnError||(y=y.catch(x=>{var g,v,b;return{error:{message:`${(g=x==null?void 0:x.name)!==null&&g!==void 0?g:"FetchError"}: ${x==null?void 0:x.message}`,details:`${(v=x==null?void 0:x.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(b=x==null?void 0:x.code)!==null&&b!==void 0?b:""}`},data:null,count:null,status:0,statusText:""}})),y.then(d,u)}returns(){return this}overrideTypes(){return this}}return Mn.default=s,Mn}var Gm;function Ah(){if(Gm)return Ln;Gm=1;var a=Ln&&Ln.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ln,"__esModule",{value:!0});const t=a(Oh());class r extends t.default{select(l){let d=!1;const u=(l??"*").split("").map(h=>/\s/.test(h)&&!d?"":(h==='"'&&(d=!d),h)).join("");return this.url.searchParams.set("select",u),this.headers.append("Prefer","return=representation"),this}order(l,{ascending:d=!0,nullsFirst:u,foreignTable:h,referencedTable:y=h}={}){const x=y?`${y}.order`:"order",g=this.url.searchParams.get(x);return this.url.searchParams.set(x,`${g?`${g},`:""}${l}.${d?"asc":"desc"}${u===void 0?"":u?".nullsfirst":".nullslast"}`),this}limit(l,{foreignTable:d,referencedTable:u=d}={}){const h=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(h,`${l}`),this}range(l,d,{foreignTable:u,referencedTable:h=u}={}){const y=typeof h>"u"?"offset":`${h}.offset`,x=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(y,`${l}`),this.url.searchParams.set(x,`${d-l+1}`),this}abortSignal(l){return this.signal=l,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:l=!1,verbose:d=!1,settings:u=!1,buffers:h=!1,wal:y=!1,format:x="text"}={}){var g;const v=[l?"analyze":null,d?"verbose":null,u?"settings":null,h?"buffers":null,y?"wal":null].filter(Boolean).join("|"),b=(g=this.headers.get("Accept"))!==null&&g!==void 0?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${x}; for="${b}"; options=${v};`),x==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(l){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${l}`),this}}return Ln.default=r,Ln}var Jm;function gc(){if(Jm)return In;Jm=1;var a=In&&In.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(In,"__esModule",{value:!0});const t=a(Ah());class r extends t.default{eq(l,d){return this.url.searchParams.append(l,`eq.${d}`),this}neq(l,d){return this.url.searchParams.append(l,`neq.${d}`),this}gt(l,d){return this.url.searchParams.append(l,`gt.${d}`),this}gte(l,d){return this.url.searchParams.append(l,`gte.${d}`),this}lt(l,d){return this.url.searchParams.append(l,`lt.${d}`),this}lte(l,d){return this.url.searchParams.append(l,`lte.${d}`),this}like(l,d){return this.url.searchParams.append(l,`like.${d}`),this}likeAllOf(l,d){return this.url.searchParams.append(l,`like(all).{${d.join(",")}}`),this}likeAnyOf(l,d){return this.url.searchParams.append(l,`like(any).{${d.join(",")}}`),this}ilike(l,d){return this.url.searchParams.append(l,`ilike.${d}`),this}ilikeAllOf(l,d){return this.url.searchParams.append(l,`ilike(all).{${d.join(",")}}`),this}ilikeAnyOf(l,d){return this.url.searchParams.append(l,`ilike(any).{${d.join(",")}}`),this}is(l,d){return this.url.searchParams.append(l,`is.${d}`),this}in(l,d){const u=Array.from(new Set(d)).map(h=>typeof h=="string"&&new RegExp("[,()]").test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(l,`in.(${u})`),this}contains(l,d){return typeof d=="string"?this.url.searchParams.append(l,`cs.${d}`):Array.isArray(d)?this.url.searchParams.append(l,`cs.{${d.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(d)}`),this}containedBy(l,d){return typeof d=="string"?this.url.searchParams.append(l,`cd.${d}`):Array.isArray(d)?this.url.searchParams.append(l,`cd.{${d.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(d)}`),this}rangeGt(l,d){return this.url.searchParams.append(l,`sr.${d}`),this}rangeGte(l,d){return this.url.searchParams.append(l,`nxl.${d}`),this}rangeLt(l,d){return this.url.searchParams.append(l,`sl.${d}`),this}rangeLte(l,d){return this.url.searchParams.append(l,`nxr.${d}`),this}rangeAdjacent(l,d){return this.url.searchParams.append(l,`adj.${d}`),this}overlaps(l,d){return typeof d=="string"?this.url.searchParams.append(l,`ov.${d}`):this.url.searchParams.append(l,`ov.{${d.join(",")}}`),this}textSearch(l,d,{config:u,type:h}={}){let y="";h==="plain"?y="pl":h==="phrase"?y="ph":h==="websearch"&&(y="w");const x=u===void 0?"":`(${u})`;return this.url.searchParams.append(l,`${y}fts${x}.${d}`),this}match(l){return Object.entries(l).forEach(([d,u])=>{this.url.searchParams.append(d,`eq.${u}`)}),this}not(l,d,u){return this.url.searchParams.append(l,`not.${d}.${u}`),this}or(l,{foreignTable:d,referencedTable:u=d}={}){const h=u?`${u}.or`:"or";return this.url.searchParams.append(h,`(${l})`),this}filter(l,d,u){return this.url.searchParams.append(l,`${d}.${u}`),this}}return In.default=r,In}var Ym;function Ih(){if(Ym)return An;Ym=1;var a=An&&An.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(An,"__esModule",{value:!0});const t=a(gc());class r{constructor(l,{headers:d={},schema:u,fetch:h}){this.url=l,this.headers=new Headers(d),this.schema=u,this.fetch=h}select(l,d){const{head:u=!1,count:h}=d??{},y=u?"HEAD":"GET";let x=!1;const g=(l??"*").split("").map(v=>/\s/.test(v)&&!x?"":(v==='"'&&(x=!x),v)).join("");return this.url.searchParams.set("select",g),h&&this.headers.append("Prefer",`count=${h}`),new t.default({method:y,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(l,{count:d,defaultToNull:u=!0}={}){var h;const y="POST";if(d&&this.headers.append("Prefer",`count=${d}`),u||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const x=l.reduce((g,v)=>g.concat(Object.keys(v)),[]);if(x.length>0){const g=[...new Set(x)].map(v=>`"${v}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:y,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}upsert(l,{onConflict:d,ignoreDuplicates:u=!1,count:h,defaultToNull:y=!0}={}){var x;const g="POST";if(this.headers.append("Prefer",`resolution=${u?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),h&&this.headers.append("Prefer",`count=${h}`),y||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const v=l.reduce((b,_)=>b.concat(Object.keys(_)),[]);if(v.length>0){const b=[...new Set(v)].map(_=>`"${_}"`);this.url.searchParams.set("columns",b.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(x=this.fetch)!==null&&x!==void 0?x:fetch})}update(l,{count:d}={}){var u;const h="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new t.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}delete({count:l}={}){var d;const u="DELETE";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return An.default=r,An}var Xm;function Ny(){if(Xm)return On;Xm=1;var a=On&&On.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(On,"__esModule",{value:!0});const t=a(Ih()),r=a(gc());class s{constructor(d,{headers:u={},schema:h,fetch:y}={}){this.url=d,this.headers=new Headers(u),this.schemaName=h,this.fetch=y}from(d){const u=new URL(`${this.url}/${d}`);return new t.default(u,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new s(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,u={},{head:h=!1,get:y=!1,count:x}={}){var g;let v;const b=new URL(`${this.url}/rpc/${d}`);let _;h||y?(v=h?"HEAD":"GET",Object.entries(u).filter(([j,C])=>C!==void 0).map(([j,C])=>[j,Array.isArray(C)?`{${C.join(",")}}`:`${C}`]).forEach(([j,C])=>{b.searchParams.append(j,C)})):(v="POST",_=u);const k=new Headers(this.headers);return x&&k.set("Prefer",`count=${x}`),new r.default({method:v,url:b,headers:k,schema:this.schemaName,body:_,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}}return On.default=s,On}var Zm;function jy(){if(Zm)return Je;Zm=1;var a=Je&&Je.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Je,"__esModule",{value:!0}),Je.PostgrestError=Je.PostgrestBuilder=Je.PostgrestTransformBuilder=Je.PostgrestFilterBuilder=Je.PostgrestQueryBuilder=Je.PostgrestClient=void 0;const t=a(Ny());Je.PostgrestClient=t.default;const r=a(Ih());Je.PostgrestQueryBuilder=r.default;const s=a(gc());Je.PostgrestFilterBuilder=s.default;const l=a(Ah());Je.PostgrestTransformBuilder=l.default;const d=a(Oh());Je.PostgrestBuilder=d.default;const u=a(Dh());return Je.PostgrestError=u.default,Je.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:l.default,PostgrestBuilder:d.default,PostgrestError:u.default},Je}var Cy=jy();const Ty=uc(Cy),{PostgrestClient:Py,PostgrestQueryBuilder:Gb,PostgrestFilterBuilder:Jb,PostgrestTransformBuilder:Yb,PostgrestBuilder:Xb,PostgrestError:Zb}=Ty;class Ry{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,l=parseInt(s.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Dy="2.74.0",Oy=`realtime-js/${Dy}`,Ay="1.0.0",Zl=1e4,Iy=1e3,Ly=100;var Bs;(function(a){a[a.connecting=0]="connecting",a[a.open=1]="open",a[a.closing=2]="closing",a[a.closed=3]="closed"})(Bs||(Bs={}));var Ke;(function(a){a.closed="closed",a.errored="errored",a.joined="joined",a.joining="joining",a.leaving="leaving"})(Ke||(Ke={}));var qt;(function(a){a.close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token"})(qt||(qt={}));var ec;(function(a){a.websocket="websocket"})(ec||(ec={}));var Zr;(function(a){a.Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed"})(Zr||(Zr={}));class My{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),s=new TextDecoder;return this._decodeBroadcast(t,r,s)}_decodeBroadcast(t,r,s){const l=r.getUint8(1),d=r.getUint8(2);let u=this.HEADER_LENGTH+2;const h=s.decode(t.slice(u,u+l));u=u+l;const y=s.decode(t.slice(u,u+d));u=u+d;const x=JSON.parse(s.decode(t.slice(u,t.byteLength)));return{ref:null,topic:h,event:y,payload:x}}}class Lh{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Re;(function(a){a.abstime="abstime",a.bool="bool",a.date="date",a.daterange="daterange",a.float4="float4",a.float8="float8",a.int2="int2",a.int4="int4",a.int4range="int4range",a.int8="int8",a.int8range="int8range",a.json="json",a.jsonb="jsonb",a.money="money",a.numeric="numeric",a.oid="oid",a.reltime="reltime",a.text="text",a.time="time",a.timestamp="timestamp",a.timestamptz="timestamptz",a.timetz="timetz",a.tsrange="tsrange",a.tstzrange="tstzrange"})(Re||(Re={}));const eh=(a,t,r={})=>{var s;const l=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((d,u)=>(d[u]=$y(u,a,t,l),d),{}):{}},$y=(a,t,r,s)=>{const l=t.find(h=>h.name===a),d=l==null?void 0:l.type,u=r[a];return d&&!s.includes(d)?Mh(d,u):tc(u)},Mh=(a,t)=>{if(a.charAt(0)==="_"){const r=a.slice(1,a.length);return Fy(t,r)}switch(a){case Re.bool:return qy(t);case Re.float4:case Re.float8:case Re.int2:case Re.int4:case Re.int8:case Re.numeric:case Re.oid:return By(t);case Re.json:case Re.jsonb:return Uy(t);case Re.timestamp:return zy(t);case Re.abstime:case Re.date:case Re.daterange:case Re.int4range:case Re.int8range:case Re.money:case Re.reltime:case Re.text:case Re.time:case Re.timestamptz:case Re.timetz:case Re.tsrange:case Re.tstzrange:return tc(t);default:return tc(t)}},tc=a=>a,qy=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},By=a=>{if(typeof a=="string"){const t=parseFloat(a);if(!Number.isNaN(t))return t}return a},Uy=a=>{if(typeof a=="string")try{return JSON.parse(a)}catch(t){return console.log(`JSON parse error: ${t}`),a}return a},Fy=(a,t)=>{if(typeof a!="string")return a;const r=a.length-1,s=a[r];if(a[0]==="{"&&s==="}"){let d;const u=a.slice(1,r);try{d=JSON.parse("["+u+"]")}catch{d=u?u.split(","):[]}return d.map(h=>Mh(t,h))}return a},zy=a=>typeof a=="string"?a.replace(" ","T"):a,$h=a=>{let t=a;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Il{constructor(t,r,s={},l=Zl){this.channel=t,this.event=r,this.payload=s,this.timeout=l,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var th;(function(a){a.SYNC="sync",a.JOIN="join",a.LEAVE="leave"})(th||(th={}));class Us{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},l=>{const{onJoin:d,onLeave:u,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Us.syncState(this.state,l,d,u),this.pendingDiffs.forEach(y=>{this.state=Us.syncDiff(this.state,y,d,u)}),this.pendingDiffs=[],h()}),this.channel._on(s.diff,{},l=>{const{onJoin:d,onLeave:u,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(l):(this.state=Us.syncDiff(this.state,l,d,u),h())}),this.onJoin((l,d,u)=>{this.channel._trigger("presence",{event:"join",key:l,currentPresences:d,newPresences:u})}),this.onLeave((l,d,u)=>{this.channel._trigger("presence",{event:"leave",key:l,currentPresences:d,leftPresences:u})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,l){const d=this.cloneDeep(t),u=this.transformState(r),h={},y={};return this.map(d,(x,g)=>{u[x]||(y[x]=g)}),this.map(u,(x,g)=>{const v=d[x];if(v){const b=g.map(C=>C.presence_ref),_=v.map(C=>C.presence_ref),k=g.filter(C=>_.indexOf(C.presence_ref)<0),j=v.filter(C=>b.indexOf(C.presence_ref)<0);k.length>0&&(h[x]=k),j.length>0&&(y[x]=j)}else h[x]=g}),this.syncDiff(d,{joins:h,leaves:y},s,l)}static syncDiff(t,r,s,l){const{joins:d,leaves:u}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),l||(l=()=>{}),this.map(d,(h,y)=>{var x;const g=(x=t[h])!==null&&x!==void 0?x:[];if(t[h]=this.cloneDeep(y),g.length>0){const v=t[h].map(_=>_.presence_ref),b=g.filter(_=>v.indexOf(_.presence_ref)<0);t[h].unshift(...b)}s(h,g,y)}),this.map(u,(h,y)=>{let x=t[h];if(!x)return;const g=y.map(v=>v.presence_ref);x=x.filter(v=>g.indexOf(v.presence_ref)<0),t[h]=x,l(h,x,y),x.length===0&&delete t[h]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const l=t[s];return"metas"in l?r[s]=l.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):r[s]=l,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var rh;(function(a){a.ALL="*",a.INSERT="INSERT",a.UPDATE="UPDATE",a.DELETE="DELETE"})(rh||(rh={}));var Fs;(function(a){a.BROADCAST="broadcast",a.PRESENCE="presence",a.POSTGRES_CHANGES="postgres_changes",a.SYSTEM="system"})(Fs||(Fs={}));var ar;(function(a){a.SUBSCRIBED="SUBSCRIBED",a.TIMED_OUT="TIMED_OUT",a.CLOSED="CLOSED",a.CHANNEL_ERROR="CHANNEL_ERROR"})(ar||(ar={}));class yc{constructor(t,r={config:{}},s){var l,d;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=Ke.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Il(this,qt.join,this.params,this.timeout),this.rejoinTimer=new Lh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ke.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(u=>u.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ke.closed,this.socket._remove(this)}),this._onError(u=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,u),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",u=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,u),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this._on(qt.reply,{},(u,h)=>{this._trigger(this._replyEventName(h),u)}),this.presence=new Us(this),this.broadcastEndpointURL=$h(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(l=this.params.config)===null||l===void 0?void 0:l.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,l,d;if(this.socket.isConnected()||this.socket.connect(),this.state==Ke.closed){const{config:{broadcast:u,presence:h,private:y}}=this.params,x=(l=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(_=>_.filter))!==null&&l!==void 0?l:[],g=!!this.bindings[Fs.PRESENCE]&&this.bindings[Fs.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,v={},b={broadcast:u,presence:Object.assign(Object.assign({},h),{enabled:g}),postgres_changes:x,private:y};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(_=>t==null?void 0:t(ar.CHANNEL_ERROR,_)),this._onClose(()=>t==null?void 0:t(ar.CLOSED)),this.updateJoinPayload(Object.assign({config:b},v)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var k;if(this.socket.setAuth(),_===void 0){t==null||t(ar.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,C=(k=j==null?void 0:j.length)!==null&&k!==void 0?k:0,A=[];for(let S=0;S<C;S++){const D=j[S],{filter:{event:L,schema:M,table:q,filter:Q}}=D,me=_&&_[S];if(me&&me.event===L&&me.schema===M&&me.table===q&&me.filter===Q)A.push(Object.assign(Object.assign({},D),{id:me.id}));else{this.unsubscribe(),this.state=Ke.errored,t==null||t(ar.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,t&&t(ar.SUBSCRIBED);return}}).receive("error",_=>{this.state=Ke.errored,t==null||t(ar.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ar.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===Ke.joined&&t===Fs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,s)}async send(t,r={}){var s,l;if(!this._canPush()&&t.type==="broadcast"){const{event:d,payload:u}=t,y={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:u,private:this.private}]})};try{const x=await this._fetchWithTimeout(this.broadcastEndpointURL,y,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((l=x.body)===null||l===void 0?void 0:l.cancel()),x.ok?"ok":"error"}catch(x){return x.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var u,h,y;const x=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((y=(h=(u=this.params)===null||u===void 0?void 0:u.config)===null||h===void 0?void 0:h.broadcast)===null||y===void 0)&&y.ack)&&d("ok"),x.receive("ok",()=>d("ok")),x.receive("error",()=>d("error")),x.receive("timeout",()=>d("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ke.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(qt.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(l=>{s=new Il(this,qt.leave,{},t),s.receive("ok",()=>{r(),l("ok")}).receive("timeout",()=>{r(),l("timed out")}).receive("error",()=>{l("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ke.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const l=new AbortController,d=setTimeout(()=>l.abort(),s),u=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:l.signal}));return clearTimeout(d),u}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let l=new Il(this,t,r,s);return this._canPush()?l.send():this._addToPushBuffer(l),l}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Ly){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var l,d;const u=t.toLocaleLowerCase(),{close:h,error:y,leave:x,join:g}=qt;if(s&&[h,y,x,g].indexOf(u)>=0&&s!==this._joinRef())return;let b=this._onMessage(u,r,s);if(r&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(u)?(l=this.bindings.postgres_changes)===null||l===void 0||l.filter(_=>{var k,j,C;return((k=_.filter)===null||k===void 0?void 0:k.event)==="*"||((C=(j=_.filter)===null||j===void 0?void 0:j.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===u}).map(_=>_.callback(b,s)):(d=this.bindings[u])===null||d===void 0||d.filter(_=>{var k,j,C,A,S,D;if(["broadcast","presence","postgres_changes"].includes(u))if("id"in _){const L=_.id,M=(k=_.filter)===null||k===void 0?void 0:k.event;return L&&((j=r.ids)===null||j===void 0?void 0:j.includes(L))&&(M==="*"||(M==null?void 0:M.toLocaleLowerCase())===((C=r.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))}else{const L=(S=(A=_==null?void 0:_.filter)===null||A===void 0?void 0:A.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return L==="*"||L===((D=r==null?void 0:r.event)===null||D===void 0?void 0:D.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===u}).map(_=>{if(typeof b=="object"&&"ids"in b){const k=b.data,{schema:j,table:C,commit_timestamp:A,type:S,errors:D}=k;b=Object.assign(Object.assign({},{schema:j,table:C,commit_timestamp:A,eventType:S,new:{},old:{},errors:D}),this._getPayloadRecords(k))}_.callback(b,s)})}_isClosed(){return this.state===Ke.closed}_isJoined(){return this.state===Ke.joined}_isJoining(){return this.state===Ke.joining}_isLeaving(){return this.state===Ke.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const l=t.toLocaleLowerCase(),d={type:l,filter:r,callback:s};return this.bindings[l]?this.bindings[l].push(d):this.bindings[l]=[d],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(l=>{var d;return!(((d=l.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===s&&yc.isEqual(l.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(qt.close,{},t)}_onError(t){this._on(qt.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ke.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=eh(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=eh(t.columns,t.old_record)),r}}const Ll=()=>{},ui={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Hy=[1e3,2e3,5e3,1e4],Wy=1e4,Ky=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Vy{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Zl,this.transport=null,this.heartbeatIntervalMs=ui.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ll,this.ref=0,this.reconnectTimer=null,this.logger=Ll,this.conn=null,this.sendBuffer=[],this.serializer=new My,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=l=>{let d;return l?d=l:typeof fetch>"u"?d=(...u)=>Gn(async()=>{const{default:h}=await Promise.resolve().then(()=>Jn);return{default:h}},void 0).then(({default:h})=>h(...u)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):d=fetch,(...u)=>d(...u)},!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${ec.websocket}`,this.httpEndpoint=$h(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Ry.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ay}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Bs.connecting:return Zr.Connecting;case Bs.open:return Zr.Open;case Bs.closing:return Zr.Closing;default:return Zr.Closed}}isConnected(){return this.connectionState()===Zr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,l=this.getChannels().find(d=>d.topic===s);if(l)return l;{const d=new yc(`realtime:${t}`,r,this);return this.channels.push(d),d}}push(t){const{topic:r,event:s,payload:l,ref:d}=t,u=()=>{this.encode(t,h=>{var y;(y=this.conn)===null||y===void 0||y.send(h)})};this.log("push",`${r} ${s} (${d})`,l),this.isConnected()?u():this.sendBuffer.push(u)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Iy,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},ui.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(x){this.log("error","error in heartbeat callback",x)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:l,payload:d,ref:u}=r,h=u?`(${u})`:"",y=d.status||"";this.log("receive",`${y} ${s} ${l} ${h}`.trim(),d),this.channels.filter(x=>x._isMember(s)).forEach(x=>x._trigger(l,d,u)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(qt.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",l=new URLSearchParams(r);return`${t}${s}${l}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([Ky],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const l={access_token:r,version:Oy};r&&s.updateJoinPayload(l),s.joinedOnce&&s._isJoined()&&s._push(qt.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(l){this.log("error",`error in ${t} callback`,l)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Lh(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ui.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,l,d,u,h,y,x,g;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:Zl,this.heartbeatIntervalMs=(l=t==null?void 0:t.heartbeatIntervalMs)!==null&&l!==void 0?l:ui.HEARTBEAT_INTERVAL,this.worker=(d=t==null?void 0:t.worker)!==null&&d!==void 0?d:!1,this.accessToken=(u=t==null?void 0:t.accessToken)!==null&&u!==void 0?u:null,this.heartbeatCallback=(h=t==null?void 0:t.heartbeatCallback)!==null&&h!==void 0?h:Ll,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(y=t==null?void 0:t.reconnectAfterMs)!==null&&y!==void 0?y:(v=>Hy[v-1]||Wy),this.encode=(x=t==null?void 0:t.encode)!==null&&x!==void 0?x:((v,b)=>b(JSON.stringify(v))),this.decode=(g=t==null?void 0:t.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class xc extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ze(a){return typeof a=="object"&&a!==null&&"__isStorageError"in a}class Qy extends xc{constructor(t,r,s){super(t),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class rc extends xc{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Gy=function(a,t,r,s){function l(d){return d instanceof r?d:new r(function(u){u(d)})}return new(r||(r=Promise))(function(d,u){function h(g){try{x(s.next(g))}catch(v){u(v)}}function y(g){try{x(s.throw(g))}catch(v){u(v)}}function x(g){g.done?d(g.value):l(g.value).then(h,y)}x((s=s.apply(a,t||[])).next())})};const qh=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...r)=>Gn(async()=>{const{default:s}=await Promise.resolve().then(()=>Jn);return{default:s}},void 0).then(({default:s})=>s(...r)):t=fetch,(...r)=>t(...r)},Jy=()=>Gy(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Gn(()=>Promise.resolve().then(()=>Jn),void 0)).Response:Response}),nc=a=>{if(Array.isArray(a))return a.map(r=>nc(r));if(typeof a=="function"||a!==Object(a))return a;const t={};return Object.entries(a).forEach(([r,s])=>{const l=r.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));t[l]=nc(s)}),t},Yy=a=>{if(typeof a!="object"||a===null)return!1;const t=Object.getPrototypeOf(a);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)};var sn=function(a,t,r,s){function l(d){return d instanceof r?d:new r(function(u){u(d)})}return new(r||(r=Promise))(function(d,u){function h(g){try{x(s.next(g))}catch(v){u(v)}}function y(g){try{x(s.throw(g))}catch(v){u(v)}}function x(g){g.done?d(g.value):l(g.value).then(h,y)}x((s=s.apply(a,t||[])).next())})};const Ml=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),Xy=(a,t,r)=>sn(void 0,void 0,void 0,function*(){const s=yield Jy();a instanceof s&&!(r!=null&&r.noResolveJson)?a.json().then(l=>{const d=a.status||500,u=(l==null?void 0:l.statusCode)||d+"";t(new Qy(Ml(l),d,u))}).catch(l=>{t(new rc(Ml(l),l))}):t(new rc(Ml(a),a))}),Zy=(a,t,r,s)=>{const l={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"||!s?l:(Yy(s)?(l.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),l.body=JSON.stringify(s)):l.body=s,t!=null&&t.duplex&&(l.duplex=t.duplex),Object.assign(Object.assign({},l),r))};function Js(a,t,r,s,l,d){return sn(this,void 0,void 0,function*(){return new Promise((u,h)=>{a(r,Zy(t,s,l,d)).then(y=>{if(!y.ok)throw y;return s!=null&&s.noResolveJson?y:y.json()}).then(y=>u(y)).catch(y=>Xy(y,h,s))})})}function _i(a,t,r,s){return sn(this,void 0,void 0,function*(){return Js(a,"GET",t,r,s)})}function Wt(a,t,r,s,l){return sn(this,void 0,void 0,function*(){return Js(a,"POST",t,s,l,r)})}function sc(a,t,r,s,l){return sn(this,void 0,void 0,function*(){return Js(a,"PUT",t,s,l,r)})}function ex(a,t,r,s){return sn(this,void 0,void 0,function*(){return Js(a,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function Bh(a,t,r,s,l){return sn(this,void 0,void 0,function*(){return Js(a,"DELETE",t,s,l,r)})}var tx=function(a,t,r,s){function l(d){return d instanceof r?d:new r(function(u){u(d)})}return new(r||(r=Promise))(function(d,u){function h(g){try{x(s.next(g))}catch(v){u(v)}}function y(g){try{x(s.throw(g))}catch(v){u(v)}}function x(g){g.done?d(g.value):l(g.value).then(h,y)}x((s=s.apply(a,t||[])).next())})};class rx{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return tx(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ze(t))return{data:null,error:t};throw t}})}}var nx=function(a,t,r,s){function l(d){return d instanceof r?d:new r(function(u){u(d)})}return new(r||(r=Promise))(function(d,u){function h(g){try{x(s.next(g))}catch(v){u(v)}}function y(g){try{x(s.throw(g))}catch(v){u(v)}}function x(g){g.done?d(g.value):l(g.value).then(h,y)}x((s=s.apply(a,t||[])).next())})};class sx{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}asStream(){return new rx(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.execute().then(t,r)}execute(){return nx(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ze(t))return{data:null,error:t};throw t}})}}var pt=function(a,t,r,s){function l(d){return d instanceof r?d:new r(function(u){u(d)})}return new(r||(r=Promise))(function(d,u){function h(g){try{x(s.next(g))}catch(v){u(v)}}function y(g){try{x(s.throw(g))}catch(v){u(v)}}function x(g){g.done?d(g.value):l(g.value).then(h,y)}x((s=s.apply(a,t||[])).next())})};const ax={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},nh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ix{constructor(t,r={},s,l){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=s,this.fetch=qh(l)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,s,l){return pt(this,void 0,void 0,function*(){try{let d;const u=Object.assign(Object.assign({},nh),l);let h=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(u.upsert)});const y=u.metadata;typeof Blob<"u"&&s instanceof Blob?(d=new FormData,d.append("cacheControl",u.cacheControl),y&&d.append("metadata",this.encodeMetadata(y)),d.append("",s)):typeof FormData<"u"&&s instanceof FormData?(d=s,d.append("cacheControl",u.cacheControl),y&&d.append("metadata",this.encodeMetadata(y))):(d=s,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType,y&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(y)))),l!=null&&l.headers&&(h=Object.assign(Object.assign({},h),l.headers));const x=this._removeEmptyFolders(r),g=this._getFinalPath(x),v=yield(t=="PUT"?sc:Wt)(this.fetch,`${this.url}/object/${g}`,d,Object.assign({headers:h},u!=null&&u.duplex?{duplex:u.duplex}:{}));return{data:{path:x,id:v.Id,fullPath:v.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(ze(d))return{data:null,error:d};throw d}})}upload(t,r,s){return pt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,s)})}uploadToSignedUrl(t,r,s,l){return pt(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),h=new URL(this.url+`/object/upload/sign/${u}`);h.searchParams.set("token",r);try{let y;const x=Object.assign({upsert:nh.upsert},l),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(x.upsert)});typeof Blob<"u"&&s instanceof Blob?(y=new FormData,y.append("cacheControl",x.cacheControl),y.append("",s)):typeof FormData<"u"&&s instanceof FormData?(y=s,y.append("cacheControl",x.cacheControl)):(y=s,g["cache-control"]=`max-age=${x.cacheControl}`,g["content-type"]=x.contentType);const v=yield sc(this.fetch,h.toString(),y,{headers:g});return{data:{path:d,fullPath:v.Key},error:null}}catch(y){if(this.shouldThrowOnError)throw y;if(ze(y))return{data:null,error:y};throw y}})}createSignedUploadUrl(t,r){return pt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const l=Object.assign({},this.headers);r!=null&&r.upsert&&(l["x-upsert"]="true");const d=yield Wt(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:l}),u=new URL(this.url+d.url),h=u.searchParams.get("token");if(!h)throw new xc("No token returned by API");return{data:{signedUrl:u.toString(),path:t,token:h},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ze(s))return{data:null,error:s};throw s}})}update(t,r,s){return pt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,s)})}move(t,r,s){return pt(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}copy(t,r,s){return pt(this,void 0,void 0,function*(){try{return{data:{path:(yield Wt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}createSignedUrl(t,r,s){return pt(this,void 0,void 0,function*(){try{let l=this._getFinalPath(t),d=yield Wt(this.fetch,`${this.url}/object/sign/${l}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const u=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${u}`)},{data:d,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}createSignedUrls(t,r,s){return pt(this,void 0,void 0,function*(){try{const l=yield Wt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),d=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:l.map(u=>Object.assign(Object.assign({},u),{signedUrl:u.signedURL?encodeURI(`${this.url}${u.signedURL}${d}`):null})),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}download(t,r){const l=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),u=d?`?${d}`:"",h=this._getFinalPath(t),y=()=>_i(this.fetch,`${this.url}/${l}/${h}${u}`,{headers:this.headers,noResolveJson:!0});return new sx(y,this.shouldThrowOnError)}info(t){return pt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const s=yield _i(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:nc(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ze(s))return{data:null,error:s};throw s}})}exists(t){return pt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield ex(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ze(s)&&s instanceof rc){const l=s.originalError;if([400,404].includes(l==null?void 0:l.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,r){const s=this._getFinalPath(t),l=[],d=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";d!==""&&l.push(d);const h=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",y=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});y!==""&&l.push(y);let x=l.join("&");return x!==""&&(x=`?${x}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${s}${x}`)}}}remove(t){return pt(this,void 0,void 0,function*(){try{return{data:yield Bh(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}list(t,r,s){return pt(this,void 0,void 0,function*(){try{const l=Object.assign(Object.assign(Object.assign({},ax),r),{prefix:t||""});return{data:yield Wt(this.fetch,`${this.url}/object/list/${this.bucketId}`,l,{headers:this.headers},s),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}listV2(t,r){return pt(this,void 0,void 0,function*(){try{const s=Object.assign({},t);return{data:yield Wt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ze(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const ox="2.74.0",lx={"X-Client-Info":`storage-js/${ox}`};var $n=function(a,t,r,s){function l(d){return d instanceof r?d:new r(function(u){u(d)})}return new(r||(r=Promise))(function(d,u){function h(g){try{x(s.next(g))}catch(v){u(v)}}function y(g){try{x(s.throw(g))}catch(v){u(v)}}function x(g){g.done?d(g.value):l(g.value).then(h,y)}x((s=s.apply(a,t||[])).next())})};class cx{constructor(t,r={},s,l){this.shouldThrowOnError=!1;const d=new URL(t);l!=null&&l.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},lx),r),this.fetch=qh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return $n(this,void 0,void 0,function*(){try{return{data:yield _i(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ze(t))return{data:null,error:t};throw t}})}getBucket(t){return $n(this,void 0,void 0,function*(){try{return{data:yield _i(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}createBucket(t){return $n(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield Wt(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}updateBucket(t,r){return $n(this,void 0,void 0,function*(){try{return{data:yield sc(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ze(s))return{data:null,error:s};throw s}})}emptyBucket(t){return $n(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}deleteBucket(t){return $n(this,void 0,void 0,function*(){try{return{data:yield Bh(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}}class dx extends cx{constructor(t,r={},s,l){super(t,r,s,l)}from(t){return new ix(this.url,this.headers,t,this.fetch)}}const ux="2.74.0";let qs="";typeof Deno<"u"?qs="deno":typeof document<"u"?qs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?qs="react-native":qs="node";const mx={"X-Client-Info":`supabase-js-${qs}/${ux}`},hx={headers:mx},px={schema:"public"},fx={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},gx={};var yx=function(a,t,r,s){function l(d){return d instanceof r?d:new r(function(u){u(d)})}return new(r||(r=Promise))(function(d,u){function h(g){try{x(s.next(g))}catch(v){u(v)}}function y(g){try{x(s.throw(g))}catch(v){u(v)}}function x(g){g.done?d(g.value):l(g.value).then(h,y)}x((s=s.apply(a,t||[])).next())})};const xx=a=>{let t;return a?t=a:typeof fetch>"u"?t=Ph:t=fetch,(...r)=>t(...r)},vx=()=>typeof Headers>"u"?Rh:Headers,bx=(a,t,r)=>{const s=xx(r),l=vx();return(d,u)=>yx(void 0,void 0,void 0,function*(){var h;const y=(h=yield t())!==null&&h!==void 0?h:a;let x=new l(u==null?void 0:u.headers);return x.has("apikey")||x.set("apikey",a),x.has("Authorization")||x.set("Authorization",`Bearer ${y}`),s(d,Object.assign(Object.assign({},u),{headers:x}))})};var wx=function(a,t,r,s){function l(d){return d instanceof r?d:new r(function(u){u(d)})}return new(r||(r=Promise))(function(d,u){function h(g){try{x(s.next(g))}catch(v){u(v)}}function y(g){try{x(s.throw(g))}catch(v){u(v)}}function x(g){g.done?d(g.value):l(g.value).then(h,y)}x((s=s.apply(a,t||[])).next())})};function _x(a){return a.endsWith("/")?a:a+"/"}function kx(a,t){var r,s;const{db:l,auth:d,realtime:u,global:h}=a,{db:y,auth:x,realtime:g,global:v}=t,b={db:Object.assign(Object.assign({},y),l),auth:Object.assign(Object.assign({},x),d),realtime:Object.assign(Object.assign({},g),u),storage:{},global:Object.assign(Object.assign(Object.assign({},v),h),{headers:Object.assign(Object.assign({},(r=v==null?void 0:v.headers)!==null&&r!==void 0?r:{}),(s=h==null?void 0:h.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>wx(this,void 0,void 0,function*(){return""})};return a.accessToken?b.accessToken=a.accessToken:delete b.accessToken,b}function Ex(a){const t=a==null?void 0:a.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(_x(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Uh="2.74.0",Hn=30*1e3,ac=3,$l=ac*Hn,Sx="http://localhost:9999",Nx="supabase.auth.token",jx={"X-Client-Info":`gotrue-js/${Uh}`},ic="X-Supabase-Api-Version",Fh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Cx=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Tx=600*1e3;class Ks extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function ge(a){return typeof a=="object"&&a!==null&&"__isAuthError"in a}class Px extends Ks{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function Rx(a){return ge(a)&&a.name==="AuthApiError"}class en extends Ks{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ir extends Ks{constructor(t,r,s,l){super(t,s,l),this.name=r,this.status=s}}class Pr extends Ir{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Dx(a){return ge(a)&&a.name==="AuthSessionMissingError"}class qn extends Ir{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class mi extends Ir{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class hi extends Ir{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ox(a){return ge(a)&&a.name==="AuthImplicitGrantRedirectError"}class sh extends Ir{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class oc extends Ir{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function ql(a){return ge(a)&&a.name==="AuthRetryableFetchError"}class ah extends Ir{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class lc extends Ir{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ih=` 	
\r=`.split(""),Ax=(()=>{const a=new Array(128);for(let t=0;t<a.length;t+=1)a[t]=-1;for(let t=0;t<ih.length;t+=1)a[ih[t].charCodeAt(0)]=-2;for(let t=0;t<ki.length;t+=1)a[ki[t].charCodeAt(0)]=t;return a})();function oh(a,t,r){if(a!==null)for(t.queue=t.queue<<8|a,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(ki[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(ki[s]),t.queuedBits-=6}}function zh(a,t,r){const s=Ax[a];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(a)}"`)}}function lh(a){const t=[],r=u=>{t.push(String.fromCodePoint(u))},s={utf8seq:0,codepoint:0},l={queue:0,queuedBits:0},d=u=>{Mx(u,s,r)};for(let u=0;u<a.length;u+=1)zh(a.charCodeAt(u),l,d);return t.join("")}function Ix(a,t){if(a<=127){t(a);return}else if(a<=2047){t(192|a>>6),t(128|a&63);return}else if(a<=65535){t(224|a>>12),t(128|a>>6&63),t(128|a&63);return}else if(a<=1114111){t(240|a>>18),t(128|a>>12&63),t(128|a>>6&63),t(128|a&63);return}throw new Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}function Lx(a,t){for(let r=0;r<a.length;r+=1){let s=a.charCodeAt(r);if(s>55295&&s<=56319){const l=(s-55296)*1024&65535;s=(a.charCodeAt(r+1)-56320&65535|l)+65536,r+=1}Ix(s,t)}}function Mx(a,t,r){if(t.utf8seq===0){if(a<=127){r(a);return}for(let s=1;s<6;s+=1)if((a>>7-s&1)===0){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=a&31;else if(t.utf8seq===3)t.codepoint=a&15;else if(t.utf8seq===4)t.codepoint=a&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(a<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|a&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Kn(a){const t=[],r={queue:0,queuedBits:0},s=l=>{t.push(l)};for(let l=0;l<a.length;l+=1)zh(a.charCodeAt(l),r,s);return new Uint8Array(t)}function $x(a){const t=[];return Lx(a,r=>t.push(r)),new Uint8Array(t)}function rn(a){const t=[],r={queue:0,queuedBits:0},s=l=>{t.push(l)};return a.forEach(l=>oh(l,r,s)),oh(null,r,s),t.join("")}function qx(a){return Math.round(Date.now()/1e3)+a}function Bx(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){const t=Math.random()*16|0;return(a=="x"?t:t&3|8).toString(16)})}const _t=()=>typeof window<"u"&&typeof document<"u",Jr={tested:!1,writable:!1},Hh=()=>{if(!_t())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Jr.tested)return Jr.writable;const a=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(a,a),globalThis.localStorage.removeItem(a),Jr.tested=!0,Jr.writable=!0}catch{Jr.tested=!0,Jr.writable=!1}return Jr.writable};function Ux(a){const t={},r=new URL(a);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((l,d)=>{t[d]=l})}catch{}return r.searchParams.forEach((s,l)=>{t[l]=s}),t}const Wh=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...r)=>Gn(async()=>{const{default:s}=await Promise.resolve().then(()=>Jn);return{default:s}},void 0).then(({default:s})=>s(...r)):t=fetch,(...r)=>t(...r)},Fx=a=>typeof a=="object"&&a!==null&&"status"in a&&"ok"in a&&"json"in a&&typeof a.json=="function",Wn=async(a,t,r)=>{await a.setItem(t,JSON.stringify(r))},Yr=async(a,t)=>{const r=await a.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},jr=async(a,t)=>{await a.removeItem(t)};class Ti{constructor(){this.promise=new Ti.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Ti.promiseConstructor=Promise;function Bl(a){const t=a.split(".");if(t.length!==3)throw new lc("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!Cx.test(t[s]))throw new lc("JWT not in base64url format");return{header:JSON.parse(lh(t[0])),payload:JSON.parse(lh(t[1])),signature:Kn(t[2]),raw:{header:t[0],payload:t[1]}}}async function zx(a){return await new Promise(t=>{setTimeout(()=>t(null),a)})}function Hx(a,t){return new Promise((s,l)=>{(async()=>{for(let d=0;d<1/0;d++)try{const u=await a(d);if(!t(d,null,u)){s(u);return}}catch(u){if(!t(d,u)){l(u);return}}})()})}function Wx(a){return("0"+a.toString(16)).substr(-2)}function Kx(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let l="";for(let d=0;d<56;d++)l+=r.charAt(Math.floor(Math.random()*s));return l}return crypto.getRandomValues(t),Array.from(t,Wx).join("")}async function Vx(a){const r=new TextEncoder().encode(a),s=await crypto.subtle.digest("SHA-256",r),l=new Uint8Array(s);return Array.from(l).map(d=>String.fromCharCode(d)).join("")}async function Qx(a){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a;const r=await Vx(a);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Bn(a,t,r=!1){const s=Kx();let l=s;r&&(l+="/PASSWORD_RECOVERY"),await Wn(a,`${t}-code-verifier`,l);const d=await Qx(s);return[d,s===d?"plain":"s256"]}const Gx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Jx(a){const t=a.headers.get(ic);if(!t||!t.match(Gx))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Yx(a){if(!a)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(a<=t)throw new Error("JWT has expired")}function Xx(a){switch(a){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Zx=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Un(a){if(!Zx.test(a))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ul(){const a={};return new Proxy(a,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ch(a){return JSON.parse(JSON.stringify(a))}var ev=function(a,t){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&t.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)t.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};const Xr=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),tv=[502,503,504];async function dh(a){var t;if(!Fx(a))throw new oc(Xr(a),0);if(tv.includes(a.status))throw new oc(Xr(a),a.status);let r;try{r=await a.json()}catch(d){throw new en(Xr(d),d)}let s;const l=Jx(a);if(l&&l.getTime()>=Fh["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new ah(Xr(r),a.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new Pr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((d,u)=>d&&typeof u=="string",!0))throw new ah(Xr(r),a.status,r.weak_password.reasons);throw new Px(Xr(r),a.status||500,s)}const rv=(a,t,r,s)=>{const l={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"?l:(l.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),l.body=JSON.stringify(s),Object.assign(Object.assign({},l),r))};async function ke(a,t,r,s){var l;const d=Object.assign({},s==null?void 0:s.headers);d[ic]||(d[ic]=Fh["2024-01-01"].name),s!=null&&s.jwt&&(d.Authorization=`Bearer ${s.jwt}`);const u=(l=s==null?void 0:s.query)!==null&&l!==void 0?l:{};s!=null&&s.redirectTo&&(u.redirect_to=s.redirectTo);const h=Object.keys(u).length?"?"+new URLSearchParams(u).toString():"",y=await nv(a,t,r+h,{headers:d,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(y):{data:Object.assign({},y),error:null}}async function nv(a,t,r,s,l,d){const u=rv(t,s,l,d);let h;try{h=await a(r,Object.assign({},u))}catch(y){throw console.error(y),new oc(Xr(y),0)}if(h.ok||await dh(h),s!=null&&s.noResolveJson)return h;try{return await h.json()}catch(y){await dh(y)}}function $t(a){var t;let r=null;iv(a)&&(r=Object.assign({},a),a.expires_at||(r.expires_at=qx(a.expires_in)));const s=(t=a.user)!==null&&t!==void 0?t:a;return{data:{session:r,user:s},error:null}}function uh(a){const t=$t(a);return!t.error&&a.weak_password&&typeof a.weak_password=="object"&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.message&&typeof a.weak_password.message=="string"&&a.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=a.weak_password),t}function Dr(a){var t;return{data:{user:(t=a.user)!==null&&t!==void 0?t:a},error:null}}function sv(a){return{data:a,error:null}}function av(a){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:l,verification_type:d}=a,u=ev(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:t,email_otp:r,hashed_token:s,redirect_to:l,verification_type:d},y=Object.assign({},u);return{data:{properties:h,user:y},error:null}}function mh(a){return a}function iv(a){return a.access_token&&a.refresh_token&&a.expires_in}const Fl=["global","local","others"];var ov=function(a,t){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&t.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)t.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class lv{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=Wh(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Fl[0]){if(Fl.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fl.join(", ")}`);try{return await ke(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ge(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await ke(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Dr})}catch(s){if(ge(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=ov(t,["options"]),l=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(l.new_email=s==null?void 0:s.newEmail,delete l.newEmail),await ke(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:l,headers:this.headers,xform:av,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ge(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ke(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Dr})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,l,d,u,h,y;try{const x={nextPage:null,lastPage:0,total:0},g=await ke(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(d=(l=t==null?void 0:t.perPage)===null||l===void 0?void 0:l.toString())!==null&&d!==void 0?d:""},xform:mh});if(g.error)throw g.error;const v=await g.json(),b=(u=g.headers.get("x-total-count"))!==null&&u!==void 0?u:0,_=(y=(h=g.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&y!==void 0?y:[];return _.length>0&&(_.forEach(k=>{const j=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(k.split(";")[1].split("=")[1]);x[`${C}Page`]=j}),x.total=parseInt(b)),{data:Object.assign(Object.assign({},v),x),error:null}}catch(x){if(ge(x))return{data:{users:[]},error:x};throw x}}async getUserById(t){Un(t);try{return await ke(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Dr})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Un(t);try{return await ke(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Dr})}catch(s){if(ge(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){Un(t);try{return await ke(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Dr})}catch(s){if(ge(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){Un(t.userId);try{const{data:r,error:s}=await ke(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:l=>({data:{factors:l},error:null})});return{data:r,error:s}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Un(t.userId),Un(t.id);try{return{data:await ke(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,l,d,u,h,y;try{const x={nextPage:null,lastPage:0,total:0},g=await ke(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(d=(l=t==null?void 0:t.perPage)===null||l===void 0?void 0:l.toString())!==null&&d!==void 0?d:""},xform:mh});if(g.error)throw g.error;const v=await g.json(),b=(u=g.headers.get("x-total-count"))!==null&&u!==void 0?u:0,_=(y=(h=g.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&y!==void 0?y:[];return _.length>0&&(_.forEach(k=>{const j=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(k.split(";")[1].split("=")[1]);x[`${C}Page`]=j}),x.total=parseInt(b)),{data:Object.assign(Object.assign({},v),x),error:null}}catch(x){if(ge(x))return{data:{clients:[]},error:x};throw x}}async _createOAuthClient(t){try{return await ke(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await ke(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await ke(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await ke(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}}function hh(a={}){return{getItem:t=>a[t]||null,setItem:(t,r)=>{a[t]=r},removeItem:t=>{delete a[t]}}}const Fn={debug:!!(globalThis&&Hh()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Kh extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class cv extends Kh{}async function dv(a,t,r){Fn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",a,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),Fn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",a)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(a,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async l=>{if(l){Fn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",a,l.name);try{return await r()}finally{Fn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",a,l.name)}}else{if(t===0)throw Fn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",a),new cv(`Acquiring an exclusive Navigator LockManager lock "${a}" immediately failed`);if(Fn.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function uv(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Vh(a){if(!/^0x[a-fA-F0-9]{40}$/.test(a))throw new Error(`@supabase/auth-js: Address "${a}" is invalid.`);return a.toLowerCase()}function mv(a){return parseInt(a,16)}function hv(a){const t=new TextEncoder().encode(a);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function pv(a){var t;const{chainId:r,domain:s,expirationTime:l,issuedAt:d=new Date,nonce:u,notBefore:h,requestId:y,resources:x,scheme:g,uri:v,version:b}=a;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(u&&u.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${u}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(b!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${b}`);if(!((t=a.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${a.statement}`)}const _=Vh(a.address),k=g?`${g}://${s}`:s,j=a.statement?`${a.statement}
`:"",C=`${k} wants you to sign in with your Ethereum account:
${_}

${j}`;let A=`URI: ${v}
Version: ${b}
Chain ID: ${r}${u?`
Nonce: ${u}`:""}
Issued At: ${d.toISOString()}`;if(l&&(A+=`
Expiration Time: ${l.toISOString()}`),h&&(A+=`
Not Before: ${h.toISOString()}`),y&&(A+=`
Request ID: ${y}`),x){let S=`
Resources:`;for(const D of x){if(!D||typeof D!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${D}`);S+=`
- ${D}`}A+=S}return`${C}
${A}`}class Fe extends Error{constructor({message:t,code:r,cause:s,name:l}){var d;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(d=l??(s instanceof Error?s.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=r}}class Ei extends Fe{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function fv({error:a,options:t}){var r,s,l;const{publicKey:d}=t;if(!d)throw Error("options was missing required publicKey property");if(a.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Fe({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if(a.name==="ConstraintError"){if(((r=d.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Fe({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:a});if(t.mediation==="conditional"&&((s=d.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Fe({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:a});if(((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Fe({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:a})}else{if(a.name==="InvalidStateError")return new Fe({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:a});if(a.name==="NotAllowedError")return new Fe({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});if(a.name==="NotSupportedError")return d.pubKeyCredParams.filter(h=>h.type==="public-key").length===0?new Fe({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:a}):new Fe({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:a});if(a.name==="SecurityError"){const u=window.location.hostname;if(Gh(u)){if(d.rp.id!==u)return new Fe({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else return new Fe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a})}else if(a.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new Fe({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:a})}else if(a.name==="UnknownError")return new Fe({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a})}return new Fe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}function gv({error:a,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(a.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Fe({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else{if(a.name==="NotAllowedError")return new Fe({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});if(a.name==="SecurityError"){const s=window.location.hostname;if(Gh(s)){if(r.rpId!==s)return new Fe({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else return new Fe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a})}else if(a.name==="UnknownError")return new Fe({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a})}return new Fe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}var Qh=function(a,t){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&t.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)t.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class yv{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const xv=new yv;function vv(a){if(!a)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(a);const{challenge:t,user:r,excludeCredentials:s}=a,l=Qh(a,["challenge","user","excludeCredentials"]),d=Kn(t).buffer,u=Object.assign(Object.assign({},r),{id:Kn(r.id).buffer}),h=Object.assign(Object.assign({},l),{challenge:d,user:u});if(s&&s.length>0){h.excludeCredentials=new Array(s.length);for(let y=0;y<s.length;y++){const x=s[y];h.excludeCredentials[y]=Object.assign(Object.assign({},x),{id:Kn(x.id).buffer,type:x.type||"public-key",transports:x.transports})}}return h}function bv(a){if(!a)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(a);const{challenge:t,allowCredentials:r}=a,s=Qh(a,["challenge","allowCredentials"]),l=Kn(t).buffer,d=Object.assign(Object.assign({},s),{challenge:l});if(r&&r.length>0){d.allowCredentials=new Array(r.length);for(let u=0;u<r.length;u++){const h=r[u];d.allowCredentials[u]=Object.assign(Object.assign({},h),{id:Kn(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return d}function wv(a){var t;if("toJSON"in a&&typeof a.toJSON=="function")return a.toJSON();const r=a;return{id:a.id,rawId:a.id,response:{attestationObject:rn(new Uint8Array(a.response.attestationObject)),clientDataJSON:rn(new Uint8Array(a.response.clientDataJSON))},type:"public-key",clientExtensionResults:a.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function _v(a){var t;if("toJSON"in a&&typeof a.toJSON=="function")return a.toJSON();const r=a,s=a.getClientExtensionResults(),l=a.response;return{id:a.id,rawId:a.id,response:{authenticatorData:rn(new Uint8Array(l.authenticatorData)),clientDataJSON:rn(new Uint8Array(l.clientDataJSON)),signature:rn(new Uint8Array(l.signature)),userHandle:l.userHandle?rn(new Uint8Array(l.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Gh(a){return a==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}function ph(){var a,t;return!!(_t()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((a=navigator==null?void 0:navigator.credentials)===null||a===void 0?void 0:a.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function kv(a){try{const t=await navigator.credentials.create(a);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ei("Browser returned unexpected credential type",t)}:{data:null,error:new Ei("Empty credential response",t)}}catch(t){return{data:null,error:fv({error:t,options:a})}}}async function Ev(a){try{const t=await navigator.credentials.get(a);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ei("Browser returned unexpected credential type",t)}:{data:null,error:new Ei("Empty credential response",t)}}catch(t){return{data:null,error:gv({error:t,options:a})}}}const Sv={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Nv={userVerification:"preferred",hints:["security-key"]};function Si(...a){const t=l=>l!==null&&typeof l=="object"&&!Array.isArray(l),r=l=>l instanceof ArrayBuffer||ArrayBuffer.isView(l),s={};for(const l of a)if(l)for(const d in l){const u=l[d];if(u!==void 0)if(Array.isArray(u))s[d]=u;else if(r(u))s[d]=u;else if(t(u)){const h=s[d];t(h)?s[d]=Si(h,u):s[d]=Si(u)}else s[d]=u}return s}function jv(a,t){return Si(Sv,a,t||{})}function Cv(a,t){return Si(Nv,a,t||{})}class Tv{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:l},d){try{const{data:u,error:h}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!u)return{data:null,error:h};const y=l??xv.createNewAbortSignal();if(u.webauthn.type==="create"){const{user:x}=u.webauthn.credential_options.publicKey;x.name||(x.name=`${x.id}:${s}`),x.displayName||(x.displayName=x.name)}switch(u.webauthn.type){case"create":{const x=jv(u.webauthn.credential_options.publicKey,d==null?void 0:d.create),{data:g,error:v}=await kv({publicKey:x,signal:y});return g?{data:{factorId:t,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:g}},error:null}:{data:null,error:v}}case"request":{const x=Cv(u.webauthn.credential_options.publicKey,d==null?void 0:d.request),{data:g,error:v}=await Ev(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:x,signal:y}));return g?{data:{factorId:t,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:g}},error:null}:{data:null,error:v}}}}catch(u){return ge(u)?{data:null,error:u}:{data:null,error:new en("Unexpected error in challenge",u)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:l}},d){if(!r)return{data:null,error:new Ks("rpId is required for WebAuthn authentication")};try{if(!ph())return{data:null,error:new en("Browser does not support WebAuthn",null)};const{data:u,error:h}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:l},{request:d});if(!u)return{data:null,error:h};const{webauthn:y}=u;return this._verify({factorId:t,challengeId:u.challengeId,webauthn:{type:y.type,rpId:r,rpOrigins:s,credential_response:y.credential_response}})}catch(u){return ge(u)?{data:null,error:u}:{data:null,error:new en("Unexpected error in authenticate",u)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:l},d){if(!r)return{data:null,error:new Ks("rpId is required for WebAuthn registration")};try{if(!ph())return{data:null,error:new en("Browser does not support WebAuthn",null)};const{data:u,error:h}=await this._enroll({friendlyName:t});if(!u)return await this.client.mfa.listFactors().then(g=>{var v;return(v=g.data)===null||v===void 0?void 0:v.all.find(b=>b.factor_type==="webauthn"&&b.friendly_name===t&&b.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g==null?void 0:g.id}):void 0),{data:null,error:h};const{data:y,error:x}=await this._challenge({factorId:u.id,friendlyName:u.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:l},{create:d});return y?this._verify({factorId:u.id,challengeId:y.challengeId,webauthn:{rpId:r,rpOrigins:s,type:y.webauthn.type,credential_response:y.webauthn.credential_response}}):{data:null,error:x}}catch(u){return ge(u)?{data:null,error:u}:{data:null,error:new en("Unexpected error in register",u)}}}}uv();const Pv={url:Sx,storageKey:Nx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:jx,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function fh(a,t,r){return await r()}const zn={};class Vs{get jwks(){var t,r;return(r=(t=zn[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){zn[this.storageKey]=Object.assign(Object.assign({},zn[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=zn[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){zn[this.storageKey]=Object.assign(Object.assign({},zn[this.storageKey]),{cachedAt:t})}constructor(t){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Vs.nextInstanceID,Vs.nextInstanceID+=1,this.instanceID>0&&_t()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const l=Object.assign(Object.assign({},Pv),t);if(this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.persistSession=l.persistSession,this.storageKey=l.storageKey,this.autoRefreshToken=l.autoRefreshToken,this.admin=new lv({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=Wh(l.fetch),this.lock=l.lock||fh,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,l.lock?this.lock=l.lock:_t()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=dv:this.lock=fh,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Tv(this)},this.persistSession?(l.storage?this.storage=l.storage:Hh()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hh(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=hh(this.memoryStorage)),_t()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(d){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",d)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async d=>{this._debug("received broadcast notification from other tab or client",d),await this._notifyAllSubscribers(d.data.event,d.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Uh}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=Ux(window.location.href);let s="none";if(this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce"),_t()&&this.detectSessionInUrl&&s!=="none"){const{data:l,error:d}=await this._getSessionFromURL(r,s);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Ox(d)){const y=(t=d.details)===null||t===void 0?void 0:t.code;if(y==="identity_already_exists"||y==="identity_not_found"||y==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:u,redirectType:h}=l;return this._debug("#_initialize()","detected session in URL",u,"redirect type",h),await this._saveSession(u),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",u):await this._notifyAllSubscribers("SIGNED_IN",u)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ge(r)?{error:r}:{error:new en("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,l;try{const d=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(l=t==null?void 0:t.options)===null||l===void 0?void 0:l.captchaToken}},xform:$t}),{data:u,error:h}=d;if(h||!u)return{data:{user:null,session:null},error:h};const y=u.session,x=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",y)),{data:{user:x,session:y},error:null}}catch(d){if(ge(d))return{data:{user:null,session:null},error:d};throw d}}async signUp(t){var r,s,l;try{let d;if("email"in t){const{email:g,password:v,options:b}=t;let _=null,k=null;this.flowType==="pkce"&&([_,k]=await Bn(this.storage,this.storageKey)),d=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b==null?void 0:b.emailRedirectTo,body:{email:g,password:v,data:(r=b==null?void 0:b.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken},code_challenge:_,code_challenge_method:k},xform:$t})}else if("phone"in t){const{phone:g,password:v,options:b}=t;d=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:v,data:(s=b==null?void 0:b.data)!==null&&s!==void 0?s:{},channel:(l=b==null?void 0:b.channel)!==null&&l!==void 0?l:"sms",gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken}},xform:$t})}else throw new mi("You must provide either an email or phone number and a password");const{data:u,error:h}=d;if(h||!u)return{data:{user:null,session:null},error:h};const y=u.session,x=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",y)),{data:{user:x,session:y},error:null}}catch(d){if(ge(d))return{data:{user:null,session:null},error:d};throw d}}async signInWithPassword(t){try{let r;if("email"in t){const{email:d,password:u,options:h}=t;r=await ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:u,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:uh})}else if("phone"in t){const{phone:d,password:u,options:h}=t;r=await ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:u,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:uh})}else throw new mi("You must provide either an email or phone number and a password");const{data:s,error:l}=r;return l?{data:{user:null,session:null},error:l}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new qn}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:l})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,s,l,d;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:(d=t.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,l,d,u,h,y,x,g,v,b;let _,k;if("message"in t)_=t.message,k=t.signature;else{const{chain:j,wallet:C,statement:A,options:S}=t;let D;if(_t())if(typeof C=="object")D=C;else{const ye=window;if("ethereum"in ye&&typeof ye.ethereum=="object"&&"request"in ye.ethereum&&typeof ye.ethereum.request=="function")D=ye.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!(S!=null&&S.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");D=C}const L=new URL((r=S==null?void 0:S.url)!==null&&r!==void 0?r:window.location.href),M=await D.request({method:"eth_requestAccounts"}).then(ye=>ye).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!M||M.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const q=Vh(M[0]);let Q=(s=S==null?void 0:S.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!Q){const ye=await D.request({method:"eth_chainId"});Q=mv(ye)}const me={domain:L.host,address:q,statement:A,uri:L.href,version:"1",chainId:Q,nonce:(l=S==null?void 0:S.signInWithEthereum)===null||l===void 0?void 0:l.nonce,issuedAt:(u=(d=S==null?void 0:S.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&u!==void 0?u:new Date,expirationTime:(h=S==null?void 0:S.signInWithEthereum)===null||h===void 0?void 0:h.expirationTime,notBefore:(y=S==null?void 0:S.signInWithEthereum)===null||y===void 0?void 0:y.notBefore,requestId:(x=S==null?void 0:S.signInWithEthereum)===null||x===void 0?void 0:x.requestId,resources:(g=S==null?void 0:S.signInWithEthereum)===null||g===void 0?void 0:g.resources};_=pv(me),k=await D.request({method:"personal_sign",params:[hv(_),q]})}try{const{data:j,error:C}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:k},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:$t});if(C)throw C;return!j||!j.session||!j.user?{data:{user:null,session:null},error:new qn}:(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),{data:Object.assign({},j),error:C})}catch(j){if(ge(j))return{data:{user:null,session:null},error:j};throw j}}async signInWithSolana(t){var r,s,l,d,u,h,y,x,g,v,b,_;let k,j;if("message"in t)k=t.message,j=t.signature;else{const{chain:C,wallet:A,statement:S,options:D}=t;let L;if(_t())if(typeof A=="object")L=A;else{const q=window;if("solana"in q&&typeof q.solana=="object"&&("signIn"in q.solana&&typeof q.solana.signIn=="function"||"signMessage"in q.solana&&typeof q.solana.signMessage=="function"))L=q.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!(D!=null&&D.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");L=A}const M=new URL((r=D==null?void 0:D.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in L&&L.signIn){const q=await L.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},D==null?void 0:D.signInWithSolana),{version:"1",domain:M.host,uri:M.href}),S?{statement:S}:null));let Q;if(Array.isArray(q)&&q[0]&&typeof q[0]=="object")Q=q[0];else if(q&&typeof q=="object"&&"signedMessage"in q&&"signature"in q)Q=q;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Q&&"signature"in Q&&(typeof Q.signedMessage=="string"||Q.signedMessage instanceof Uint8Array)&&Q.signature instanceof Uint8Array)k=typeof Q.signedMessage=="string"?Q.signedMessage:new TextDecoder().decode(Q.signedMessage),j=Q.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in L)||typeof L.signMessage!="function"||!("publicKey"in L)||typeof L!="object"||!L.publicKey||!("toBase58"in L.publicKey)||typeof L.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");k=[`${M.host} wants you to sign in with your Solana account:`,L.publicKey.toBase58(),...S?["",S,""]:[""],"Version: 1",`URI: ${M.href}`,`Issued At: ${(l=(s=D==null?void 0:D.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&l!==void 0?l:new Date().toISOString()}`,...!((d=D==null?void 0:D.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${D.signInWithSolana.notBefore}`]:[],...!((u=D==null?void 0:D.signInWithSolana)===null||u===void 0)&&u.expirationTime?[`Expiration Time: ${D.signInWithSolana.expirationTime}`]:[],...!((h=D==null?void 0:D.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${D.signInWithSolana.chainId}`]:[],...!((y=D==null?void 0:D.signInWithSolana)===null||y===void 0)&&y.nonce?[`Nonce: ${D.signInWithSolana.nonce}`]:[],...!((x=D==null?void 0:D.signInWithSolana)===null||x===void 0)&&x.requestId?[`Request ID: ${D.signInWithSolana.requestId}`]:[],...!((v=(g=D==null?void 0:D.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||v===void 0)&&v.length?["Resources",...D.signInWithSolana.resources.map(Q=>`- ${Q}`)]:[]].join(`
`);const q=await L.signMessage(new TextEncoder().encode(k),"utf8");if(!q||!(q instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=q}}try{const{data:C,error:A}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:k,signature:rn(j)},!((b=t.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(_=t.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:$t});if(A)throw A;return!C||!C.session||!C.user?{data:{user:null,session:null},error:new qn}:(C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),{data:Object.assign({},C),error:A})}catch(C){if(ge(C))return{data:{user:null,session:null},error:C};throw C}}async _exchangeCodeForSession(t){const r=await Yr(this.storage,`${this.storageKey}-code-verifier`),[s,l]=(r??"").split("/");try{const{data:d,error:u}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:$t});if(await jr(this.storage,`${this.storageKey}-code-verifier`),u)throw u;return!d||!d.session||!d.user?{data:{user:null,session:null,redirectType:null},error:new qn}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:Object.assign(Object.assign({},d),{redirectType:l??null}),error:u})}catch(d){if(ge(d))return{data:{user:null,session:null,redirectType:null},error:d};throw d}}async signInWithIdToken(t){try{const{options:r,provider:s,token:l,access_token:d,nonce:u}=t,h=await ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:l,access_token:d,nonce:u,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:$t}),{data:y,error:x}=h;return x?{data:{user:null,session:null},error:x}:!y||!y.session||!y.user?{data:{user:null,session:null},error:new qn}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:y,error:x})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,s,l,d,u;try{if("email"in t){const{email:h,options:y}=t;let x=null,g=null;this.flowType==="pkce"&&([x,g]=await Bn(this.storage,this.storageKey));const{error:v}=await ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(r=y==null?void 0:y.data)!==null&&r!==void 0?r:{},create_user:(s=y==null?void 0:y.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken},code_challenge:x,code_challenge_method:g},redirectTo:y==null?void 0:y.emailRedirectTo});return{data:{user:null,session:null},error:v}}if("phone"in t){const{phone:h,options:y}=t,{data:x,error:g}=await ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(l=y==null?void 0:y.data)!==null&&l!==void 0?l:{},create_user:(d=y==null?void 0:y.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken},channel:(u=y==null?void 0:y.channel)!==null&&u!==void 0?u:"sms"}});return{data:{user:null,session:null,messageId:x==null?void 0:x.message_id},error:g}}throw new mi("You must provide either an email or phone number.")}catch(h){if(ge(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(t){var r,s;try{let l,d;"options"in t&&(l=(r=t.options)===null||r===void 0?void 0:r.redirectTo,d=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:u,error:h}=await ke(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:d}}),redirectTo:l,xform:$t});if(h)throw h;if(!u)throw new Error("An error occurred on token verification.");const y=u.session,x=u.user;return y!=null&&y.access_token&&(await this._saveSession(y),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",y)),{data:{user:x,session:y},error:null}}catch(l){if(ge(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithSSO(t){var r,s,l;try{let d=null,u=null;return this.flowType==="pkce"&&([d,u]=await Bn(this.storage,this.storageKey)),await ke(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((l=t==null?void 0:t.options)===null||l===void 0)&&l.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:u}),headers:this.headers,xform:sv})}catch(d){if(ge(d))return{data:null,error:d};throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new Pr;const{error:l}=await ke(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:l}})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:l,options:d}=t,{error:u}=await ke(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:l,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:u}}else if("phone"in t){const{phone:s,type:l,options:d}=t,{data:u,error:h}=await ke(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:l,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:h}}throw new mi("You must provide either an email or phone number and a type")}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),l=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await l}catch{}})()),l}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const l=[...this.pendingInLock];await Promise.all(l),this.pendingInLock.splice(0,l.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Yr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<$l:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const u=await Yr(this.userStorage,this.storageKey+"-user");u!=null&&u.user?t.user=u.user:t.user=Ul()}if(this.storage.isServer&&t.user){let u=this.suppressGetSessionWarning;t=new Proxy(t,{get:(y,x,g)=>(!u&&x==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),u=!0,this.suppressGetSessionWarning=!0),Reflect.get(y,x,g))})}return{data:{session:t},error:null}}const{data:l,error:d}=await this._callRefreshToken(t.refresh_token);return d?{data:{session:null},error:d}:{data:{session:l},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Dr}):await this._useSession(async r=>{var s,l,d;const{data:u,error:h}=r;if(h)throw h;return!(!((s=u.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Pr}:await ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(l=u.session)===null||l===void 0?void 0:l.access_token)!==null&&d!==void 0?d:void 0,xform:Dr})})}catch(r){if(ge(r))return Dx(r)&&(await this._removeSession(),await jr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:l,error:d}=s;if(d)throw d;if(!l.session)throw new Pr;const u=l.session;let h=null,y=null;this.flowType==="pkce"&&t.email!=null&&([h,y]=await Bn(this.storage,this.storageKey));const{data:x,error:g}=await ke(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:h,code_challenge_method:y}),jwt:u.access_token,xform:Dr});if(g)throw g;return u.user=x.user,await this._saveSession(u),await this._notifyAllSubscribers("USER_UPDATED",u),{data:{user:u.user},error:null}})}catch(s){if(ge(s))return{data:{user:null},error:s};throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Pr;const r=Date.now()/1e3;let s=r,l=!0,d=null;const{payload:u}=Bl(t.access_token);if(u.exp&&(s=u.exp,l=s<=r),l){const{data:h,error:y}=await this._callRefreshToken(t.refresh_token);if(y)return{data:{user:null,session:null},error:y};if(!h)return{data:{user:null,session:null},error:null};d=h}else{const{data:h,error:y}=await this._getUser(t.access_token);if(y)throw y;d={access_token:t.access_token,refresh_token:t.refresh_token,user:h.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return{data:{user:d.user,session:d},error:null}}catch(r){if(ge(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:u,error:h}=r;if(h)throw h;t=(s=u.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new Pr;const{data:l,error:d}=await this._callRefreshToken(t.refresh_token);return d?{data:{user:null,session:null},error:d}:l?{data:{user:l.user,session:l},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!_t())throw new hi("No browser detected.");if(t.error||t.error_description||t.error_code)throw new hi(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new sh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new hi("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new sh("No code detected.");const{data:S,error:D}=await this._exchangeCodeForSession(t.code);if(D)throw D;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:S.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:l,access_token:d,refresh_token:u,expires_in:h,expires_at:y,token_type:x}=t;if(!d||!h||!u||!x)throw new hi("No session defined in URL");const g=Math.round(Date.now()/1e3),v=parseInt(h);let b=g+v;y&&(b=parseInt(y));const _=b-g;_*1e3<=Hn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${v}s`);const k=b-v;g-k>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",k,b,g):g-k<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",k,b,g);const{data:j,error:C}=await this._getUser(d);if(C)throw C;const A={provider_token:s,provider_refresh_token:l,access_token:d,expires_in:v,expires_at:b,refresh_token:u,token_type:x,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:A,redirectType:t.type},error:null}}catch(s){if(ge(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Yr(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:l,error:d}=r;if(d)return{error:d};const u=(s=l.session)===null||s===void 0?void 0:s.access_token;if(u){const{error:h}=await this.admin.signOut(u,t);if(h&&!(Rx(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return t!=="others"&&(await this._removeSession(),await jr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=Bx(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,l;try{const{data:{session:d},error:u}=r;if(u)throw u;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",t,"session",d)}catch(d){await((l=this.stateChangeEmitters.get(t))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",d),console.error(d)}})}async resetPasswordForEmail(t,r={}){let s=null,l=null;this.flowType==="pkce"&&([s,l]=await Bn(this.storage,this.storageKey,!0));try{return await ke(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:l,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(d){if(ge(d))return{data:null,error:d};throw d}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:l}=await this._useSession(async d=>{var u,h,y,x,g;const{data:v,error:b}=d;if(b)throw b;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(u=t.options)===null||u===void 0?void 0:u.redirectTo,scopes:(h=t.options)===null||h===void 0?void 0:h.scopes,queryParams:(y=t.options)===null||y===void 0?void 0:y.queryParams,skipBrowserRedirect:!0});return await ke(this.fetch,"GET",_,{headers:this.headers,jwt:(g=(x=v.session)===null||x===void 0?void 0:x.access_token)!==null&&g!==void 0?g:void 0})});if(l)throw l;return _t()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:t.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(ge(s))return{data:{provider:t.provider,url:null},error:s};throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:l,data:{session:d}}=r;if(l)throw l;const{options:u,provider:h,token:y,access_token:x,nonce:g}=t,v=await ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=d==null?void 0:d.access_token)!==null&&s!==void 0?s:void 0,body:{provider:h,id_token:y,access_token:x,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:$t}),{data:b,error:_}=v;return _?{data:{user:null,session:null},error:_}:!b||!b.session||!b.user?{data:{user:null,session:null},error:new qn}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("USER_UPDATED",b.session)),{data:b,error:_})}catch(l){if(ge(l))return{data:{user:null,session:null},error:l};throw l}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,l;const{data:d,error:u}=r;if(u)throw u;return await ke(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(l=(s=d.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await Hx(async l=>(l>0&&await zx(200*Math.pow(2,l-1)),this._debug(r,"refreshing attempt",l),await ke(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:$t})),(l,d)=>{const u=200*Math.pow(2,l);return d&&ql(d)&&Date.now()+u-s<Hn})}catch(s){if(this._debug(r,"error",s),ge(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),_t()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const l=await Yr(this.storage,this.storageKey);if(l&&this.userStorage){let u=await Yr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!u&&(u={user:l.user},await Wn(this.userStorage,this.storageKey+"-user",u)),l.user=(t=u==null?void 0:u.user)!==null&&t!==void 0?t:Ul()}else if(l&&!l.user&&!l.user){const u=await Yr(this.storage,this.storageKey+"-user");u&&(u!=null&&u.user)?(l.user=u.user,await jr(this.storage,this.storageKey+"-user"),await Wn(this.storage,this.storageKey,l)):l.user=Ul()}if(this._debug(s,"session from storage",l),!this._isValidSession(l)){this._debug(s,"session is not valid"),l!==null&&await this._removeSession();return}const d=((r=l.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<$l;if(this._debug(s,`session has${d?"":" not"} expired with margin of ${$l}s`),d){if(this.autoRefreshToken&&l.refresh_token){const{error:u}=await this._callRefreshToken(l.refresh_token);u&&(console.error(u),ql(u)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",u),await this._removeSession()))}}else if(l.user&&l.user.__isUserNotAvailableProxy===!0)try{const{data:u,error:h}=await this._getUser(l.access_token);!h&&(u!=null&&u.user)?(l.user=u.user,await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(u){console.error("Error getting user data:",u),this._debug(s,"error getting user data, skipping SIGNED_IN notification",u)}else await this._notifyAllSubscribers("SIGNED_IN",l)}catch(l){this._debug(s,"error",l),console.error(l);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new Pr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const l=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(l,"begin");try{this.refreshingDeferred=new Ti;const{data:d,error:u}=await this._refreshAccessToken(t);if(u)throw u;if(!d.session)throw new Pr;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const h={data:d.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(d){if(this._debug(l,"error",d),ge(d)){const u={data:null,error:d};return ql(d)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(u),u}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(d),d}finally{this.refreshingDeferred=null,this._debug(l,"end")}}async _notifyAllSubscribers(t,r,s=!0){const l=`#_notifyAllSubscribers(${t})`;this._debug(l,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const d=[],u=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(t,r)}catch(y){d.push(y)}});if(await Promise.all(u),d.length>0){for(let h=0;h<d.length;h+=1)console.error(d[h]);throw d[0]}}finally{this._debug(l,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Wn(this.userStorage,this.storageKey+"-user",{user:r.user});const l=Object.assign({},r);delete l.user;const d=ch(l);await Wn(this.storage,this.storageKey,d)}else{const l=ch(r);await Wn(this.storage,this.storageKey,l)}}async _removeSession(){this._debug("#_removeSession()"),await jr(this.storage,this.storageKey),await jr(this.storage,this.storageKey+"-code-verifier"),await jr(this.storage,this.storageKey+"-user"),this.userStorage&&await jr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&_t()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Hn);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const l=Math.floor((s.expires_at*1e3-t)/Hn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${l} ticks, a tick lasts ${Hn}ms, refresh threshold is ${ac} ticks`),l<=ac&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Kh)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_t()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const l=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&l.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&l.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[d,u]=await Bn(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(u)}`});l.push(h.toString())}if(s!=null&&s.queryParams){const d=new URLSearchParams(s.queryParams);l.push(d.toString())}return s!=null&&s.skipBrowserRedirect&&l.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${l.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:l,error:d}=r;return d?{data:null,error:d}:await ke(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=l==null?void 0:l.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,l;const{data:d,error:u}=r;if(u)return{data:null,error:u};const h=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:y,error:x}=await ke(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(s=d==null?void 0:d.session)===null||s===void 0?void 0:s.access_token});return x?{data:null,error:x}:(t.factorType==="totp"&&y.type==="totp"&&(!((l=y==null?void 0:y.totp)===null||l===void 0)&&l.qr_code)&&(y.totp.qr_code=`data:image/svg+xml;utf-8,${y.totp.qr_code}`),{data:y,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:l,error:d}=r;if(d)return{data:null,error:d};const u=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?wv(t.webauthn.credential_response):_v(t.webauthn.credential_response)})}:{code:t.code}),{data:h,error:y}=await ke(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:u,headers:this.headers,jwt:(s=l==null?void 0:l.session)===null||s===void 0?void 0:s.access_token});return y?{data:null,error:y}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),{data:h,error:y})})}catch(r){if(ge(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:l,error:d}=r;if(d)return{data:null,error:d};const u=await ke(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=l==null?void 0:l.session)===null||s===void 0?void 0:s.access_token});if(u.error)return u;const{data:h}=u;if(h.type!=="webauthn")return{data:h,error:null};switch(h.webauthn.type){case"create":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:vv(h.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:bv(h.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(ge(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?{data:null,error:s}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const l={all:[],phone:[],totp:[],webauthn:[]};for(const d of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])l.all.push(d),d.status==="verified"&&l[d.factor_type].push(d);return{data:l,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,s;const{data:{session:l},error:d}=t;if(d)return{data:null,error:d};if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:u}=Bl(l.access_token);let h=null;u.aal&&(h=u.aal);let y=h;((s=(r=l.user.factors)===null||r===void 0?void 0:r.filter(v=>v.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(y="aal2");const g=u.amr||[];return{data:{currentLevel:h,nextLevel:y,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(h=>h.kid===t);if(s)return s;const l=Date.now();if(s=this.jwks.keys.find(h=>h.kid===t),s&&this.jwks_cached_at+Tx>l)return s;const{data:d,error:u}=await ke(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(u)throw u;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=l,s=d.keys.find(h=>h.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:_,error:k}=await this.getSession();if(k||!_.session)return{data:null,error:k};s=_.session.access_token}const{header:l,payload:d,signature:u,raw:{header:h,payload:y}}=Bl(s);r!=null&&r.allowExpired||Yx(d.exp);const x=!l.alg||l.alg.startsWith("HS")||!l.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(l.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!x){const{error:_}=await this.getUser(s);if(_)throw _;return{data:{claims:d,header:l,signature:u},error:null}}const g=Xx(l.alg),v=await crypto.subtle.importKey("jwk",x,g,!0,["verify"]);if(!await crypto.subtle.verify(g,v,u,$x(`${h}.${y}`)))throw new lc("Invalid JWT signature");return{data:{claims:d,header:l,signature:u},error:null}}catch(s){if(ge(s))return{data:null,error:s};throw s}}}Vs.nextInstanceID=0;const Rv=Vs;class Dv extends Rv{constructor(t){super(t)}}var Ov=function(a,t,r,s){function l(d){return d instanceof r?d:new r(function(u){u(d)})}return new(r||(r=Promise))(function(d,u){function h(g){try{x(s.next(g))}catch(v){u(v)}}function y(g){try{x(s.throw(g))}catch(v){u(v)}}function x(g){g.done?d(g.value):l(g.value).then(h,y)}x((s=s.apply(a,t||[])).next())})};class Av{constructor(t,r,s){var l,d,u;this.supabaseUrl=t,this.supabaseKey=r;const h=Ex(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const y=`sb-${h.hostname.split(".")[0]}-auth-token`,x={db:px,realtime:gx,auth:Object.assign(Object.assign({},fx),{storageKey:y}),global:hx},g=kx(s??{},x);this.storageKey=(l=g.auth.storageKey)!==null&&l!==void 0?l:"",this.headers=(d=g.global.headers)!==null&&d!==void 0?d:{},g.accessToken?(this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(v,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((u=g.auth)!==null&&u!==void 0?u:{},this.headers,g.global.fetch),this.fetch=bx(r,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.rest=new Py(new URL("rest/v1",h).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new dx(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new by(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},s={}){return this.rest.rpc(t,r,s)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return Ov(this,void 0,void 0,function*(){var t,r;if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:l,userStorage:d,storageKey:u,flowType:h,lock:y,debug:x},g,v){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Dv({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),g),storageKey:u,autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:l,userStorage:d,flowType:h,lock:y,debug:x,fetch:v,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Vy(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(t,r,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Iv=(a,t,r)=>new Av(a,t,r);function Lv(){if(typeof window<"u"||typeof process>"u")return!1;const a=process.version;if(a==null)return!1;const t=a.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Lv()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const gh={BASE_URL:"/SCM-Hub-V4/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var yh={};const Mv=()=>typeof import.meta<"u"&&gh?gh:typeof process<"u"&&yh?yh:{},Vn=Mv(),$v=Vn.VITE_SUPABASE_URL??Vn.NEXT_PUBLIC_SUPABASE_URL??Vn.SUPABASE_URL,qv=Vn.VITE_SUPABASE_ANON_KEY??Vn.NEXT_PUBLIC_SUPABASE_ANON_KEY??Vn.SUPABASE_ANON_KEY,Bv={supabaseUrl:$v,supabaseAnonKey:qv};let zl=null;const Uv=()=>{if(!zl){const{supabaseUrl:a,supabaseAnonKey:t}=Bv;if(!a||!t||a.includes("YOUR_URL_HERE"))throw new Error("Supabase URL and Anon Key are not configured. Please set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY.");zl=Iv(a,t)}return zl},he=new Proxy({},{get(a,t,r){return Reflect.get(Uv(),t,r)}});class Fv{constructor(){this.streams=new Map,this.consumers=new Map,this.lastIds=new Map,this.pollingIntervals=new Map}async publish(t,r){console.log(`📤 Publishing to ${t}:`,r);const s=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,l={id:s,data:r,timestamp:Date.now()};return this.streams.has(t)||this.streams.set(t,[]),this.streams.get(t).push(l),this.notifyConsumers(t,l),this.persistMessage(t,l),s}async subscribe(t,r,s,l){console.log(`📥 Subscribing to ${t} as ${r}:${s}`);const d=`${t}:${r}:${s}`;this.consumers.has(d)||this.consumers.set(d,[]),this.consumers.get(d).push(l);const u=window.setInterval(()=>{this.pollStream(t,d,l)},1e3);return this.pollingIntervals.set(d,u),()=>{const h=this.consumers.get(d)||[],y=h.indexOf(l);y>-1&&h.splice(y,1);const x=this.pollingIntervals.get(d);x&&(clearInterval(x),this.pollingIntervals.delete(d))}}async readMessages(t,r=10,s="0"){return(this.streams.get(t)||[]).filter(u=>u.id>s).slice(0,r)}async getStreamInfo(t){const r=this.streams.get(t)||[];return{name:t,length:r.length,lastId:r.length>0?r[r.length-1].id:null,firstEntry:r.length>0?r[0]:null,lastEntry:r.length>0?r[r.length-1]:null}}async createConsumerGroup(t,r,s="0"){console.log(`📋 Creating consumer group ${r} for ${t}`)}async pollStream(t,r,s){const l=this.lastIds.get(r)||"0",d=await this.readMessages(t,10,l);for(const u of d)try{await s(u),this.lastIds.set(r,u.id)}catch(h){console.error(`Error handling message ${u.id}:`,h)}}notifyConsumers(t,r){for(const[s,l]of this.consumers.entries())if(s.startsWith(t))for(const d of l)try{d(r)}catch(u){console.error(`Error notifying consumer ${s}:`,u)}}persistMessage(t,r){try{const s=`redis_stream:${t}`,l=localStorage.getItem(s),d=l?JSON.parse(l):[];d.push(r),d.length>100&&d.splice(0,d.length-100),localStorage.setItem(s,JSON.stringify(d))}catch(s){console.error("Error persisting message:",s)}}loadPersistedMessages(t){try{const r=`redis_stream:${t}`,s=localStorage.getItem(r);if(s){const l=JSON.parse(s);this.streams.set(t,l),console.log(`📥 Loaded ${l.length} messages from ${t}`)}}catch(r){console.error("Error loading persisted messages:",r)}}clearStream(t){this.streams.delete(t),localStorage.removeItem(`redis_stream:${t}`),console.log(`🗑️ Cleared stream ${t}`)}getAllStreams(){return Array.from(this.streams.keys())}}const Vt=new Fv,Qt={MRF_READY_FOR_COLLECTION:"materials:mrf:ready_for_collection",MRF_UPDATED:"materials:mrf:updated",MRF_CANCELLED:"materials:mrf:cancelled",MRF_ON_HOLD:"materials:mrf:on_hold",TASK_ACCEPTED:"logistics:task:accepted",TASK_IN_TRANSIT:"logistics:task:in_transit",TASK_DELIVERED:"logistics:task:delivered",TASK_EXCEPTION:"logistics:task:exception"};Object.values(Qt).forEach(a=>{Vt.loadPersistedMessages(a)});const pi=()=>`evt_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,fi=()=>new Date().toISOString();class zv{async publishTaskAccepted(t,r,s,l){if(!t.linked_mrf_id){console.log("Task not linked to MRF, skipping event");return}const d={event_type:"task.accepted",event_id:pi(),timestamp:fi(),source:"logistics",version:"1.0",data:{task_id:t.task_id,task_number:t.task_number,linked_mrf_id:t.linked_mrf_id,driver:{id:r.driver_id,name:r.name,phone:r.phone},vehicle:{id:s.vehicle_id,registration:s.registration,type:s.type},scheduled_date:t.requested_date,estimated_pickup_time:t.requested_date,accepted_by:l}};await Vt.publish(Qt.TASK_ACCEPTED,d),console.log(`✅ Published task.accepted for ${t.task_number}`)}async publishTaskInTransit(t){if(!t.linked_mrf_id){console.log("Task not linked to MRF, skipping event");return}if(!t.driver||!t.pickup_arrived_at){console.warn("Task missing driver or pickup time");return}const r={event_type:"task.in_transit",event_id:pi(),timestamp:fi(),source:"logistics",version:"1.0",data:{task_id:t.task_id,task_number:t.task_number,linked_mrf_id:t.linked_mrf_id,driver:{id:t.driver.driver_id,name:t.driver.name},pickup_time:t.pickup_arrived_at,pickup_location:t.pickup.location,pickup_gps:t.pickup_gps_lat&&t.pickup_gps_lng?{lat:t.pickup_gps_lat,lng:t.pickup_gps_lng}:void 0,estimated_delivery_time:this.estimateDeliveryTime(t)}};await Vt.publish(Qt.TASK_IN_TRANSIT,r),console.log(`✅ Published task.in_transit for ${t.task_number}`)}async publishTaskDelivered(t,r){var l;if(!t.linked_mrf_id){console.log("Task not linked to MRF, skipping event");return}if(!t.driver||!t.completed_at){console.warn("Task missing driver or completion time");return}const s={event_type:"task.delivered",event_id:pi(),timestamp:fi(),source:"logistics",version:"1.0",data:{task_id:t.task_id,task_number:t.task_number,linked_mrf_id:t.linked_mrf_id,driver:{id:t.driver.driver_id,name:t.driver.name},delivery_time:t.completed_at,delivery_location:t.dropoff.location,delivery_gps:t.dropoff_gps_lat&&t.dropoff_gps_lng?{lat:t.dropoff_gps_lat,lng:t.dropoff_gps_lng}:void 0,pod:{pod_id:r.pod_id,delivered_to:r.delivered_to,delivered_to_phone:r.delivered_to_phone,photo_count:r.photo_count,photo_urls:((l=r.photos)==null?void 0:l.map(d=>d.url))||[],signature_url:r.signature_img,notes:r.delivery_notes}}};await Vt.publish(Qt.TASK_DELIVERED,s),console.log(`✅ Published task.delivered for ${t.task_number}`)}async publishTaskException(t,r,s,l,d){if(!t.linked_mrf_id){console.log("Task not linked to MRF, skipping event");return}if(!t.driver){console.warn("Task missing driver");return}const u={event_type:"task.exception",event_id:pi(),timestamp:fi(),source:"logistics",version:"1.0",data:{task_id:t.task_id,task_number:t.task_number,linked_mrf_id:t.linked_mrf_id,exception_type:r,severity:s,description:l,driver:{id:t.driver.driver_id,name:t.driver.name},location:d==null?void 0:d.location,gps:d==null?void 0:d.gps,photo_urls:d==null?void 0:d.photo_urls,requires_action:s==="critical"||s==="high",suggested_resolution:d==null?void 0:d.suggested_resolution}};await Vt.publish(Qt.TASK_EXCEPTION,u),console.log(`✅ Published task.exception for ${t.task_number}`)}estimateDeliveryTime(t){const r=new Date;return new Date(r.getTime()+3600*1e3).toISOString()}}const Jh=new zv;class Hv{constructor(){this.configs=new Map,this.currentSiteId="default"}loadConfig(t){try{const r=localStorage.getItem(`site_config:${t}`);if(r){const s=JSON.parse(r);this.configs.set(t,s),console.log(`✅ Loaded config for site: ${t}`)}else this.configs.set(t,this.getDefaultConfig(t))}catch(r){console.error(`Error loading config for site ${t}:`,r),this.configs.set(t,this.getDefaultConfig(t))}}saveConfig(t,r){try{localStorage.setItem(`site_config:${t}`,JSON.stringify(r)),this.configs.set(t,r),console.log(`✅ Saved config for site: ${t}`)}catch(s){console.error(`Error saving config for site ${t}:`,s)}}getConfig(t){const r=t||this.currentSiteId;return this.configs.has(r)||this.loadConfig(r),this.configs.get(r)||this.getDefaultConfig(r)}setCurrentSite(t){this.currentSiteId=t,this.configs.has(t)||this.loadConfig(t),console.log(`📍 Switched to site: ${t}`)}getCurrentSiteId(){return this.currentSiteId}isFeatureEnabled(t){return this.getConfig().features[t]||!1}getWorkflow(t){return this.getConfig().workflows[t]}getSLARules(){return this.getConfig().sla_rules}getNotificationConfig(){return this.getConfig().notifications}getDefaultConfig(t){return{site_id:t,site_code:t.toUpperCase(),site_name:`Site ${t}`,enabled:!0,features:{task_management:!0,pod_capture:!0,offline_mode:!0,auto_task_creation:!0,real_time_tracking:!0,signature_required:!1,photo_mandatory:!0,materials_integration:!0,toll_ltr_integration:!1,teams_integration:!1,sms_notifications:!1,email_notifications:!0,driver_mobile_app:!0,driver_ratings:!1,driver_notes:!0,advanced_reports:!0,custom_dashboards:!0,data_export:!0,scheduled_reports:!1,multi_site_view:!1,bulk_operations:!0,audit_logging:!0},workflows:{task_creation:{requires_approval:!1,approver_roles:["mlc"],auto_assign:!1,assignment_logic:"manual"},task_execution:{require_pickup_confirmation:!0,require_dropoff_confirmation:!0,allow_partial_completion:!1,require_pod_verification:!1},pod_workflow:{min_photos:1,max_photos:10,signature_required:!1,gps_verification:!0,gps_tolerance_meters:100,require_receiver_phone:!1,require_delivery_notes:!1},exception_workflow:{auto_escalate:!1,escalation_timeout_minutes:60,escalation_chain:["mlc","manager"],require_photos:!0,require_resolution_notes:!0},approval_workflow:{high_priority_approval:!1,critical_priority_approval:!0,after_hours_approval:!1,approver_roles:["mlc","manager"]}},sla_rules:{enabled:!0,default_slas:{critical:60,high:240,normal:480,low:1440},task_type_slas:{delivery:{critical:60,high:240,normal:480,low:1440},collection:{critical:120,high:360,normal:720,low:1440},transfer:{critical:90,high:300,normal:600,low:1440}},business_hours:{enabled:!0,timezone:"Australia/Brisbane",monday:{start:"07:00",end:"17:00"},tuesday:{start:"07:00",end:"17:00"},wednesday:{start:"07:00",end:"17:00"},thursday:{start:"07:00",end:"17:00"},friday:{start:"07:00",end:"17:00"},saturday:null,sunday:null},calculation:{exclude_weekends:!0,exclude_holidays:!0,exclude_after_hours:!0,buffer_minutes:15},alerts:{warn_at_percentage:80,breach_notification:!0,escalate_on_breach:!0}},notifications:{email:{enabled:!0,from_address:"noreply@logistics.com",from_name:"Logistics System",templates:{}},sms:{enabled:!1,provider:"twilio",templates:{}},teams:{enabled:!1,channels:{}},push:{enabled:!1},rules:[]},reporting:{dashboard:{default_kpis:["total_tasks","completed_tasks","in_progress","exceptions","sla_compliance"],refresh_interval_seconds:30,date_range_default:"today"},templates:[],data_retention:{task_history_days:365,pod_history_days:730,audit_log_days:1095,archive_to_cold_storage:!1},export:{formats:["csv","excel","pdf"],max_rows:1e4,include_photos_in_pdf:!1},scheduled_reports:{enabled:!1,reports:[]}},integrations:{materials:{enabled:!0,auto_create_tasks:!0,auto_update_status:!0,sync_interval_seconds:30},toll_ltr:{enabled:!1},external_apis:[],webhooks:{enabled:!1,endpoints:[]}},business_rules:{assignment:{max_tasks_per_driver:5,consider_driver_location:!0,consider_vehicle_capacity:!0,allow_reassignment:!0,require_skills_match:!1},vehicle:{require_vehicle_for_tasks:!0,track_maintenance:!1,enforce_capacity_limits:!1},zones:{enforce_zone_restrictions:!1,require_zone_access_approval:!1,validate_gps_in_zone:!0},priority:{auto_escalate_priority:!1,escalation_rules:[]},cost:{track_task_costs:!1,require_cost_approval_above:0,cost_centers:[]}},ui_config:{branding:{primary_color:"#0066cc",secondary_color:"#44aa44",site_title:"Logistics Management"},layout:{default_view:"dispatcher",show_sidebar:!0,compact_mode:!1},tables:{default_page_size:25,available_page_sizes:[10,25,50,100],show_filters_by_default:!0},maps:{enabled:!1,provider:"google",default_center:{lat:-27.4698,lng:153.0251},default_zoom:12},date_time:{timezone:"Australia/Brisbane",date_format:"DD/MM/YYYY",time_format:"24h",week_starts_on:"monday"},language:{default:"en-AU",available:["en-AU","en-US"]}}}}}const st=new Hv;st.setCurrentSite("default");class Wv{calculateSLATarget(t){const s=st.getConfig().sla_rules;if(!s.enabled)return{sla_minutes:1440,sla_target_at:new Date(new Date(t.created_at).getTime()+864e5).toISOString()};const l=this.getSLAMinutes(t.type,t.priority,s),d=new Date(t.created_at),u=this.calculateTargetDateTime(d,l,s);return{sla_minutes:l,sla_target_at:u.toISOString()}}getSLAStatus(t){const s=st.getConfig().sla_rules;if(!t.sla_target_at||!s.enabled)return{sla_minutes:0,sla_target_at:t.sla_target_at||"",business_minutes_used:0,calendar_minutes_used:0,percentage_used:0,is_breached:!1,is_at_risk:!1,time_remaining_minutes:0};const l=new Date,d=new Date(t.created_at),u=new Date(t.sla_target_at),h=t.completed_at?new Date(t.completed_at):l,y=h.getTime()-d.getTime(),x=u.getTime()-d.getTime(),g=Math.floor(y/6e4),v=this.calculateBusinessMinutes(d,h,s),b=Math.floor(x/6e4),_=b>0?g/b*100:0,k=u.getTime()-l.getTime(),j=Math.floor(k/6e4),C=t.status!=="completed"?l>u:h>u,A=_>=s.alerts.warn_at_percentage;return{sla_minutes:b,sla_target_at:t.sla_target_at,business_minutes_used:v,calendar_minutes_used:g,percentage_used:Math.round(_),is_breached:C,is_at_risk:A&&!C,time_remaining_minutes:j}}checkSLARisk(t){const r=this.getSLAStatus(t);return{is_at_risk:r.is_at_risk,percentage_used:r.percentage_used,time_remaining_minutes:r.time_remaining_minutes}}getTasksAtRisk(t){const r=[],s=[];return t.forEach(l=>{if(l.status==="completed"||l.status==="closed"||l.status==="cancelled")return;const d=this.getSLAStatus(l);d.is_breached?s.push(l):d.is_at_risk&&r.push(l)}),{at_risk:r,breached:s}}calculateComplianceRate(t){const r=t.filter(u=>u.status==="completed"||u.status==="closed");if(r.length===0)return{total:0,on_time:0,breached:0,compliance_rate:100};let s=0,l=0;r.forEach(u=>{this.getSLAStatus(u).is_breached?l++:s++});const d=s/r.length*100;return{total:r.length,on_time:s,breached:l,compliance_rate:Math.round(d)}}formatTimeRemaining(t){if(t<0){const u=Math.abs(t),h=Math.floor(u/60),y=u%60;return`OVERDUE by ${h}h ${y}m`}if(t<60)return`${t}m remaining`;const r=Math.floor(t/60),s=t%60;if(r<24)return`${r}h ${s}m remaining`;const l=Math.floor(r/24),d=r%24;return`${l}d ${d}h remaining`}getSLAMinutes(t,r,s){return s.task_type_slas&&s.task_type_slas[t]?s.task_type_slas[t][r]:s.default_slas[r]}calculateTargetDateTime(t,r,s){const l=s.calculation;if(!l.exclude_after_hours&&!l.exclude_weekends)return new Date(t.getTime()+r*6e4);let d=new Date(t),u=r+(l.buffer_minutes||0);for(;u>0;)if(this.isBusinessDay(d,s)){const h=this.getBusinessHours(d,s);if(h){const y=d.getHours()*60+d.getMinutes(),x=this.parseTime(h.start),g=this.parseTime(h.end);if(y<x)d.setHours(Math.floor(x/60),x%60,0,0);else if(y>=g){d.setDate(d.getDate()+1),d.setHours(0,0,0,0);continue}else{const v=g-y;u<=v?(d=new Date(d.getTime()+u*6e4),u=0):(u-=v,d.setDate(d.getDate()+1),d.setHours(0,0,0,0))}}else d=new Date(d.getTime()+u*6e4),u=0}else d.setDate(d.getDate()+1),d.setHours(0,0,0,0);return d}calculateBusinessMinutes(t,r,s){const l=s.calculation;if(!l.exclude_after_hours&&!l.exclude_weekends)return Math.floor((r.getTime()-t.getTime())/6e4);let d=0,u=new Date(t);for(;u<r;){if(this.isBusinessDay(u,s)){const h=this.getBusinessHours(u,s);if(h){const y=this.parseTime(h.start),x=this.parseTime(h.end),g=u.getHours()*60+u.getMinutes(),v=new Date(u);v.setHours(23,59,59,999);const b=r<v?r:v;if(g<x){const _=Math.max(g,y),k=Math.min(b.getHours()*60+b.getMinutes(),x);k>_&&(d+=k-_)}}}u.setDate(u.getDate()+1),u.setHours(0,0,0,0)}return d}isBusinessDay(t,r){if(!r.calculation.exclude_weekends)return!0;const l=t.getDay();return!(l===0||l===6)}getBusinessHours(t,r){const s=r.business_hours;if(!s.enabled)return null;const l=t.getDay(),u=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][l];return s[u]}parseTime(t){const[r,s]=t.split(":").map(Number);return r*60+s}}const Kv=new Wv;class Vv{constructor(){this.queue=[],this.sentNotifications=[]}async sendNotification(t){const r={...t,notification_id:`notif_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,created_at:new Date().toISOString(),status:"pending"};return this.queue.push(r),console.log("📧 Notification queued:",{type:r.type,event:r.event,recipient:r.recipient.name,priority:r.priority}),this.persistQueue(),r.notification_id}async notifyTaskAssigned(t,r){const s=st.getConfig();s.notifications.email.enabled&&(r.email&&await this.sendNotification({type:"email",event:"task.assigned",recipient:{id:r.driver_id,name:r.name,email:r.email},subject:`New Task Assigned: ${t.task_number}`,message:this.formatTaskAssignedEmail(t,r),data:{task_id:t.task_id,task_number:t.task_number},priority:t.priority==="critical"?"critical":"normal"}),s.notifications.sms.enabled&&r.phone&&await this.sendNotification({type:"sms",event:"task.assigned",recipient:{id:r.driver_id,name:r.name,phone:r.phone},message:`New task ${t.task_number}: ${t.description}. Pickup: ${t.pickup.location}`,data:{task_id:t.task_id},priority:t.priority==="critical"?"critical":"normal"}),t.requester.email&&await this.sendNotification({type:"email",event:"task.assigned",recipient:{name:t.requester.name,email:t.requester.email},subject:`Task Accepted: ${t.task_number}`,message:this.formatTaskAcceptedEmail(t,r),data:{task_id:t.task_id},priority:"normal"}))}async notifyTaskCompleted(t,r){st.getConfig().notifications.email.enabled&&t.requester.email&&await this.sendNotification({type:"email",event:"task.completed",recipient:{name:t.requester.name,email:t.requester.email},subject:`Task Completed: ${t.task_number}`,message:this.formatTaskCompletedEmail(t,r),data:{task_id:t.task_id,pod_id:r==null?void 0:r.pod_id},priority:"normal"})}async notifySLAWarning(t,r){const s=st.getConfig();s.sla_rules.alerts.warn_at_percentage&&(await this.sendNotification({type:"email",event:"sla.warning",recipient:{name:"MLC Team",email:"mlc-team@example.com"},subject:`⚠️ SLA Warning: ${t.task_number}`,message:`Task ${t.task_number} is at ${r}% of SLA time.

Priority: ${t.priority}
SLA Target: ${t.sla_target_at}

Please check the task.`,data:{task_id:t.task_id,percentage_used:r},priority:"high"}),s.notifications.teams.enabled&&await this.sendNotification({type:"teams",event:"sla.warning",recipient:{name:"MLC Team"},message:`⚠️ SLA Warning: Task ${t.task_number} is at ${r}% of SLA time.`,data:{task_id:t.task_id,task_url:`/logistics-dispatcher?task=${t.task_id}`},priority:"high"}))}async notifySLABreach(t){const r=st.getConfig();r.sla_rules.alerts.breach_notification&&(await this.sendNotification({type:"email",event:"sla.breach",recipient:{name:"MLC Team",email:"mlc-team@example.com"},subject:`🚨 SLA BREACH: ${t.task_number}`,message:`CRITICAL: Task ${t.task_number} has breached its SLA!

Priority: ${t.priority}
SLA Target: ${t.sla_target_at}
Status: ${t.status}

Immediate action required.`,data:{task_id:t.task_id},priority:"critical"}),r.notifications.sms.enabled&&await this.sendNotification({type:"sms",event:"sla.breach",recipient:{name:"MLC On-Call",phone:"+61400000000"},message:`🚨 SLA BREACH: ${t.task_number}. Check system immediately.`,data:{task_id:t.task_id},priority:"critical"}))}async notifyException(t,r,s){var l;st.getConfig(),await this.sendNotification({type:"email",event:"task.exception",recipient:{name:"MLC Team",email:"mlc-team@example.com"},subject:`⚠️ Exception: ${t.task_number}`,message:`Exception reported for task ${t.task_number}:

Type: ${r}
Description: ${s}

Driver: ${(l=t.driver)==null?void 0:l.name}
Location: ${t.pickup.location}`,data:{task_id:t.task_id,exception_type:r},priority:"high"}),t.requester.email&&await this.sendNotification({type:"email",event:"task.exception",recipient:{name:t.requester.name,email:t.requester.email},subject:`Issue with Task: ${t.task_number}`,message:`There's an issue with your logistics request ${t.task_number}.

Issue: ${s}

We're working to resolve it.`,data:{task_id:t.task_id},priority:"normal"})}async sendDailySummary(t){st.getConfig().notifications.email.enabled&&await this.sendNotification({type:"email",event:"daily.summary",recipient:{name:"MLC Team",email:"mlc-team@example.com"},subject:`Daily Logistics Summary - ${new Date().toLocaleDateString()}`,message:this.formatDailySummaryEmail(t),data:t,priority:"normal"})}getNotificationEndpoint(t){const r=this.queue.find(l=>l.notification_id===t);if(!r)return null;const s=st.getConfig();switch(r.type){case"email":return{endpoint_type:"email",url:"/api/notifications/email",method:"POST",headers:{"Content-Type":"application/json","X-API-Key":"your-api-key"},payload:{to:r.recipient.email,from:s.notifications.email.from_address,subject:r.subject,html:r.message,text:r.message}};case"sms":return{endpoint_type:"sms",url:"/api/notifications/sms",method:"POST",headers:{"Content-Type":"application/json","X-API-Key":"your-api-key"},payload:{to:r.recipient.phone,from:s.notifications.sms.from_number,message:r.message}};case"teams":return{endpoint_type:"teams",url:s.notifications.teams.webhook_url||"",method:"POST",headers:{"Content-Type":"application/json"},payload:{"@type":"MessageCard","@context":"https://schema.org/extensions",summary:r.subject||r.message,sections:[{activityTitle:r.subject||"Logistics Notification",activitySubtitle:r.message,facts:Object.entries(r.data).map(([l,d])=>({name:l,value:String(d)}))}]}};case"push":return{endpoint_type:"push",url:"/api/notifications/push",method:"POST",headers:{"Content-Type":"application/json"},payload:{title:r.subject||"Notification",body:r.message,data:r.data}};default:return null}}getPendingNotifications(){return this.queue.filter(t=>t.status==="pending")}markAsSent(t){const r=this.queue.find(s=>s.notification_id===t);r&&(r.status="sent",r.sent_at=new Date().toISOString(),this.sentNotifications.push(r),this.queue=this.queue.filter(s=>s.notification_id!==t),this.persistQueue())}markAsFailed(t,r){const s=this.queue.find(l=>l.notification_id===t);s&&(s.status="failed",s.error=r,this.persistQueue())}getHistory(t=100){return[...this.sentNotifications,...this.queue].sort((r,s)=>new Date(s.created_at).getTime()-new Date(r.created_at).getTime()).slice(0,t)}formatTaskAssignedEmail(t,r){return`
            <h2>New Task Assigned</h2>
            <p>Hi ${r.name},</p>
            <p>You have been assigned a new logistics task:</p>
            
            <div style="background: #f9f9f9; padding: 15px; border-left: 4px solid #0066cc;">
                <strong>Task:</strong> ${t.task_number}<br>
                <strong>Priority:</strong> ${t.priority.toUpperCase()}<br>
                <strong>Type:</strong> ${t.type}<br>
                <strong>Description:</strong> ${t.description}<br><br>
                
                <strong>Pickup:</strong> ${t.pickup.location}<br>
                ${t.pickup.contact?`<strong>Contact:</strong> ${t.pickup.contact}<br>`:""}
                
                <strong>Dropoff:</strong> ${t.dropoff.location}<br>
                ${t.dropoff.contact?`<strong>Contact:</strong> ${t.dropoff.contact}<br>`:""}
                
                ${t.sla_target_at?`<br><strong>Complete By:</strong> ${new Date(t.sla_target_at).toLocaleString()}<br>`:""}
            </div>
            
            <p>Please check the driver app for full details.</p>
        `}formatTaskAcceptedEmail(t,r){return`
            <h2>Task Accepted</h2>
            <p>Hi ${t.requester.name},</p>
            <p>Your logistics request has been accepted and assigned to a driver:</p>
            
            <div style="background: #f9f9f9; padding: 15px; border-left: 4px solid #44aa44;">
                <strong>Task:</strong> ${t.task_number}<br>
                <strong>Driver:</strong> ${r.name}<br>
                ${r.phone?`<strong>Driver Phone:</strong> ${r.phone}<br>`:""}
                <strong>Pickup Location:</strong> ${t.pickup.location}<br>
                <strong>Delivery Location:</strong> ${t.dropoff.location}<br>
                ${t.sla_target_at?`<strong>Expected Completion:</strong> ${new Date(t.sla_target_at).toLocaleString()}<br>`:""}
            </div>
            
            <p>You'll receive another notification when the delivery is completed.</p>
        `}formatTaskCompletedEmail(t,r){return`
            <h2>Task Completed</h2>
            <p>Hi ${t.requester.name},</p>
            <p>Your logistics request has been completed:</p>
            
            <div style="background: #f9f9f9; padding: 15px; border-left: 4px solid #44aa44;">
                <strong>Task:</strong> ${t.task_number}<br>
                <strong>Completed At:</strong> ${t.completed_at?new Date(t.completed_at).toLocaleString():"N/A"}<br>
                ${r?`
                    <strong>Delivered To:</strong> ${r.delivered_to}<br>
                    ${r.photo_count?`<strong>Photos:</strong> ${r.photo_count} captured<br>`:""}
                    ${r.delivery_notes?`<strong>Notes:</strong> ${r.delivery_notes}<br>`:""}
                `:""}
            </div>
            
            <p>View the full proof of delivery in the system.</p>
        `}formatDailySummaryEmail(t){return`
            <h2>Daily Logistics Summary</h2>
            <p>Summary for ${new Date().toLocaleDateString()}:</p>
            
            <div style="background: #f9f9f9; padding: 15px;">
                <h3>Overview</h3>
                <strong>Total Tasks:</strong> ${t.total_tasks}<br>
                <strong>Completed:</strong> ${t.completed} (${t.total_tasks>0?Math.round(t.completed/t.total_tasks*100):0}%)<br>
                <strong>In Progress:</strong> ${t.in_progress}<br>
                <strong>Exceptions:</strong> ${t.exceptions}<br>
                <strong>SLA Compliance:</strong> ${t.sla_compliance}%<br>
            </div>
            
            <p>View detailed reports in the system.</p>
        `}persistQueue(){try{localStorage.setItem("notification_queue",JSON.stringify(this.queue)),localStorage.setItem("notification_history",JSON.stringify(this.sentNotifications.slice(-100)))}catch(t){console.error("Error persisting notification queue:",t)}}loadQueue(){try{const t=localStorage.getItem("notification_queue");t&&(this.queue=JSON.parse(t));const r=localStorage.getItem("notification_history");r&&(this.sentNotifications=JSON.parse(r))}catch(t){console.error("Error loading notification queue:",t)}}}const vc=new Vv;vc.loadQueue();const Qv=Object.freeze(Object.defineProperty({__proto__:null,notificationService:vc},Symbol.toStringTag,{value:"Module"}));class Gv{async createTask(t){try{const s=Kv.calculateSLATarget({type:t.type,priority:t.priority,created_at:new Date().toISOString(),requested_date:t.requested_date}).sla_target_at,{data:l,error:d}=await he.from("logistics_tasks").insert({type:t.type,category:t.category,priority:t.priority,requester:t.requester,description:t.description,special_instructions:t.special_instructions,linked_mrf_id:t.linked_mrf_id,linked_wo_id:t.linked_wo_id,linked_entity_type:t.linked_entity_type,linked_entity_id:t.linked_entity_id,pickup:t.pickup,dropoff:t.dropoff,load_info:t.load_info,requested_date:t.requested_date,requested_time:t.requested_time,hard_window_flag:t.hard_window_flag,sla_target_at:s,status:"new",created_at:new Date().toISOString()}).select().single();if(d)throw d;return await this.createEvent({task_id:l.task_id,event_type:"created",notes:`Task created: ${t.description}`}),l}catch(r){throw console.error("Error creating task:",r),r}}async getTaskById(t){try{const{data:r,error:s}=await he.from("logistics_tasks").select(`
                    *,
                    driver:drivers(*),
                    vehicle:vehicles(*),
                    pod:pod_records(*)
                `).eq("task_id",t).is("deleted_at",null).single();if(s)throw s;return r}catch(r){return console.error("Error fetching task:",r),null}}async getTaskByNumber(t){try{const{data:r,error:s}=await he.from("logistics_tasks").select(`
                    *,
                    driver:drivers(*),
                    vehicle:vehicles(*),
                    pod:pod_records(*)
                `).eq("task_number",t).is("deleted_at",null).single();if(s)throw s;return r}catch(r){return console.error("Error fetching task by number:",r),null}}async listTasks(t={}){try{let r=he.from("logistics_tasks").select(`
                    *,
                    driver:drivers(*),
                    vehicle:vehicles(*)
                `).is("deleted_at",null).order("created_at",{ascending:!1});t.status&&(r=r.eq("status",t.status)),t.type&&(r=r.eq("type",t.type)),t.priority&&(r=r.eq("priority",t.priority)),t.driver_id&&(r=r.eq("driver_id",t.driver_id)),t.linked_mrf_id&&(r=r.eq("linked_mrf_id",t.linked_mrf_id)),t.from_date&&(r=r.gte("requested_date",t.from_date)),t.to_date&&(r=r.lte("requested_date",t.to_date));const{data:s,error:l}=await r;if(l)throw l;return s||[]}catch(r){return console.error("Error listing tasks:",r),[]}}async updateTask(t){try{const{task_id:r,...s}=t,{data:l,error:d}=await he.from("logistics_tasks").update({...s,updated_at:new Date().toISOString()}).eq("task_id",r).select().single();if(d)throw d;return s.status&&await this.createEvent({task_id:r,event_type:"status_changed",status_to:s.status,notes:s.status_reason}),l}catch(r){return console.error("Error updating task:",r),null}}async assignTask(t,r,s){try{const{data:l}=await he.from("logistics_tasks").select("task_id").eq("driver_id",r).in("status",["new","scheduled","in_progress"]).is("deleted_at",null);if(l&&l.length>0)throw new Error("Driver is already assigned to another active task");const{data:d,error:u}=await he.from("logistics_tasks").update({driver_id:r,vehicle_id:s,assigned_at:new Date().toISOString(),status:"scheduled",updated_at:new Date().toISOString()}).eq("task_id",t).select().single();if(u)throw u;await he.from("drivers").update({current_task_id:t,updated_at:new Date().toISOString()}).eq("driver_id",r),await he.from("vehicles").update({status:"in_use",current_driver_id:r,updated_at:new Date().toISOString()}).eq("vehicle_id",s),await this.createEvent({task_id:t,event_type:"assigned",notes:`Task assigned to driver ${r} with vehicle ${s}`});const h=await this.getTaskById(t);return h&&h.linked_mrf_id&&h.driver&&h.vehicle&&await Jh.publishTaskAccepted(h,h.driver,h.vehicle,{id:"system",name:"MLC System"}),h&&h.driver&&await vc.notifyTaskAssigned(h,h.driver),d}catch(l){throw console.error("Error assigning task:",l),l}}async startTask(t){try{const{data:r,error:s}=await he.from("logistics_tasks").update({status:"in_progress",started_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("task_id",t).select().single();if(s)throw s;return await this.createEvent({task_id:t,event_type:"driver_started",status_to:"in_progress"}),r}catch(r){return console.error("Error starting task:",r),null}}async completeTask(t){var r,s;try{const{data:l,error:d}=await he.from("logistics_tasks").update({status:"completed",completed_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("task_id",t).select().single();if(d)throw d;return l.driver_id&&await he.from("drivers").update({current_task_id:null,tasks_completed:((r=l.driver)==null?void 0:r.tasks_completed)+1||1}).eq("driver_id",l.driver_id),l.vehicle_id&&await he.from("vehicles").update({status:"available",current_driver_id:null,total_tasks:((s=l.vehicle)==null?void 0:s.total_tasks)+1||1}).eq("vehicle_id",l.vehicle_id),await this.createEvent({task_id:t,event_type:"completed",status_to:"completed"}),l}catch(l){return console.error("Error completing task:",l),null}}async cancelTask(t,r){try{const{data:s,error:l}=await he.from("logistics_tasks").update({status:"cancelled",status_reason:r,updated_at:new Date().toISOString()}).eq("task_id",t).select().single();if(l)throw l;return s.driver_id&&await he.from("drivers").update({current_task_id:null}).eq("driver_id",s.driver_id),s.vehicle_id&&await he.from("vehicles").update({status:"available",current_driver_id:null}).eq("vehicle_id",s.vehicle_id),await this.createEvent({task_id:t,event_type:"cancelled",status_to:"cancelled",notes:r}),s}catch(s){return console.error("Error cancelling task:",s),null}}async getTaskEvents(t){try{const{data:r,error:s}=await he.from("task_events").select("*").eq("task_id",t).order("timestamp",{ascending:!1});if(s)throw s;return r||[]}catch(r){return console.error("Error fetching task events:",r),[]}}async createEvent(t){try{await he.from("task_events").insert({...t,timestamp:new Date().toISOString()})}catch(r){console.error("Error creating task event:",r)}}calculateSLATarget(t,r){const s=new Date(t),d={critical:2,high:4,normal:24,low:48}[r];return s.setHours(s.getHours()-d),s.toISOString()}async deleteTask(t){try{const{error:r}=await he.from("logistics_tasks").update({deleted_at:new Date().toISOString()}).eq("task_id",t);if(r)throw r;return!0}catch(r){return console.error("Error deleting task:",r),!1}}}const ot=new Gv;class Jv{async createDriver(t){try{const{data:r,error:s}=await he.from("drivers").insert({name:t.name,email:t.email,phone:t.phone,employee_id:t.employee_id,license_number:t.license_number,license_class:t.license_class,license_expiry:t.license_expiry,status:t.status||"active",availability:!0,tasks_completed:0,tasks_in_progress:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(s)throw s;return r}catch(r){throw console.error("Error creating driver:",r),r}}async getDriverById(t){try{const{data:r,error:s}=await he.from("drivers").select("*").eq("driver_id",t).is("deleted_at",null).single();if(s)throw s;return r}catch(r){return console.error("Error fetching driver:",r),null}}async listDrivers(t=!1){try{let r=he.from("drivers").select("*").is("deleted_at",null).order("name",{ascending:!0});t&&(r=r.eq("status","active"));const{data:s,error:l}=await r;if(l)throw l;return s||[]}catch(r){return console.error("Error listing drivers:",r),[]}}async getAvailableDrivers(){try{const{data:t,error:r}=await he.from("drivers").select("*").eq("status","active").eq("availability",!0).is("current_task_id",null).is("deleted_at",null).order("name",{ascending:!0});if(r)throw r;return t||[]}catch(t){return console.error("Error fetching available drivers:",t),[]}}async updateDriver(t){try{const{driver_id:r,...s}=t,{data:l,error:d}=await he.from("drivers").update({...s,updated_at:new Date().toISOString()}).eq("driver_id",r).select().single();if(d)throw d;return l}catch(r){return console.error("Error updating driver:",r),null}}async updateDriverLocation(t){try{const{driver_id:r,lat:s,lng:l,accuracy:d}=t,{error:u}=await he.from("drivers").update({current_location:{lat:s,lng:l,accuracy:d,timestamp:new Date().toISOString()},updated_at:new Date().toISOString()}).eq("driver_id",r);if(u)throw u;return!0}catch(r){return console.error("Error updating driver location:",r),!1}}async setDriverAvailability(t,r){try{const{error:s}=await he.from("drivers").update({availability:r,updated_at:new Date().toISOString()}).eq("driver_id",t);if(s)throw s;return!0}catch(s){return console.error("Error setting driver availability:",s),!1}}async getDriverCurrentTask(t){try{const{data:r,error:s}=await he.from("drivers").select(`
                    current_task:logistics_tasks(*)
                `).eq("driver_id",t).single();if(s)throw s;return(r==null?void 0:r.current_task)||null}catch(r){return console.error("Error fetching driver current task:",r),null}}async getDriverStats(t){try{const{data:r,error:s}=await he.from("drivers").select("tasks_completed, tasks_in_progress, rating, avg_completion_time").eq("driver_id",t).single();if(s)throw s;return r}catch(r){return console.error("Error fetching driver stats:",r),null}}async deleteDriver(t){try{const{data:r}=await he.from("logistics_tasks").select("task_id").eq("driver_id",t).in("status",["new","scheduled","in_progress"]);if(r&&r.length>0)throw new Error("Cannot delete driver with active tasks");const{error:s}=await he.from("drivers").update({deleted_at:new Date().toISOString(),status:"inactive"}).eq("driver_id",t);if(s)throw s;return!0}catch(r){throw console.error("Error deleting driver:",r),r}}}const cc=new Jv;class Yv{async createVehicle(t){try{const{data:r,error:s}=await he.from("vehicles").insert({registration:t.registration,make:t.make,model:t.model,year:t.year,vehicle_type:t.vehicle_type,max_weight_kg:t.max_weight_kg,max_volume_m3:t.max_volume_m3,equipment:t.equipment,status:"available",total_tasks:0,total_distance_km:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(s)throw s;return r}catch(r){throw console.error("Error creating vehicle:",r),r}}async getVehicleById(t){try{const{data:r,error:s}=await he.from("vehicles").select("*").eq("vehicle_id",t).is("deleted_at",null).single();if(s)throw s;return r}catch(r){return console.error("Error fetching vehicle:",r),null}}async listVehicles(t=!1){try{let r=he.from("vehicles").select("*").is("deleted_at",null).order("registration",{ascending:!0});t&&(r=r.eq("status","available"));const{data:s,error:l}=await r;if(l)throw l;return s||[]}catch(r){return console.error("Error listing vehicles:",r),[]}}async getAvailableVehicles(t){try{let r=he.from("vehicles").select("*").eq("status","available").is("deleted_at",null).order("registration",{ascending:!0});t&&(r=r.eq("vehicle_type",t));const{data:s,error:l}=await r;if(l)throw l;return s||[]}catch(r){return console.error("Error fetching available vehicles:",r),[]}}async updateVehicle(t){try{const{vehicle_id:r,...s}=t,{data:l,error:d}=await he.from("vehicles").update({...s,updated_at:new Date().toISOString()}).eq("vehicle_id",r).select().single();if(d)throw d;return l}catch(r){return console.error("Error updating vehicle:",r),null}}async updateVehicleStatus(t,r){try{const{error:s}=await he.from("vehicles").update({status:r,updated_at:new Date().toISOString()}).eq("vehicle_id",t);if(s)throw s;return!0}catch(s){return console.error("Error updating vehicle status:",s),!1}}async scheduleMainten(t,r,s){try{const{error:l}=await he.from("vehicles").update({next_service_date:r,service_notes:s,updated_at:new Date().toISOString()}).eq("vehicle_id",t);if(l)throw l;return!0}catch(l){return console.error("Error scheduling maintenance:",l),!1}}async recordServiceCompletion(t,r,s){try{const{error:l}=await he.from("vehicles").update({last_service_date:r,service_notes:s,status:"available",updated_at:new Date().toISOString()}).eq("vehicle_id",t);if(l)throw l;return!0}catch(l){return console.error("Error recording service completion:",l),!1}}async getVehicleStats(t){try{const{data:r,error:s}=await he.from("vehicles").select("total_tasks, total_distance_km").eq("vehicle_id",t).single();if(s)throw s;return r}catch(r){return console.error("Error fetching vehicle stats:",r),null}}async getVehiclesDueForMaintenance(){try{const t=new Date().toISOString().split("T")[0],{data:r,error:s}=await he.from("vehicles").select("*").lte("next_service_date",t).is("deleted_at",null).order("next_service_date",{ascending:!0});if(s)throw s;return r||[]}catch(t){return console.error("Error fetching vehicles due for maintenance:",t),[]}}async deleteVehicle(t){try{const{data:r}=await he.from("logistics_tasks").select("task_id").eq("vehicle_id",t).in("status",["new","scheduled","in_progress"]);if(r&&r.length>0)throw new Error("Cannot delete vehicle with active tasks");const{error:s}=await he.from("vehicles").update({deleted_at:new Date().toISOString(),status:"out_of_service"}).eq("vehicle_id",t);if(s)throw s;return!0}catch(r){throw console.error("Error deleting vehicle:",r),r}}}const dc=new Yv,Xv=({isOpen:a,onClose:t,onTaskCreated:r})=>{const[s,l]=E.useState({type:"delivery",priority:"normal",description:"",requester_name:"",requester_department:"",requester_phone:"",requester_email:"",pickup_location:"",pickup_contact:"",pickup_phone:"",dropoff_location:"",dropoff_contact:"",dropoff_phone:"",requested_date:new Date().toISOString().split("T")[0],requested_time:"",special_instructions:"",linked_mrf_id:"",load_qty:"",load_weight:""}),[d,u]=E.useState(!1),[h,y]=E.useState(null);if(!a)return null;const x=v=>{l({...s,[v.target.name]:v.target.value})},g=async v=>{v.preventDefault(),u(!0),y(null);try{if(!s.description||!s.requester_name||!s.pickup_location||!s.dropoff_location)throw new Error("Please fill in all required fields");await ot.createTask({type:s.type,priority:s.priority,description:s.description,special_instructions:s.special_instructions||void 0,requester:{name:s.requester_name,department:s.requester_department,phone:s.requester_phone||void 0,email:s.requester_email||void 0},pickup:{location:s.pickup_location,contact:s.pickup_contact||void 0,phone:s.pickup_phone||void 0},dropoff:{location:s.dropoff_location,contact:s.dropoff_contact||void 0,phone:s.dropoff_phone||void 0},load_info:s.load_qty||s.load_weight?{qty:s.load_qty?parseInt(s.load_qty):void 0,weight:s.load_weight?parseFloat(s.load_weight):void 0}:void 0,requested_date:`${s.requested_date}T${s.requested_time||"00:00"}:00Z`,requested_time:s.requested_time||void 0,linked_mrf_id:s.linked_mrf_id||void 0}),l({type:"delivery",priority:"normal",description:"",requester_name:"",requester_department:"",requester_phone:"",requester_email:"",pickup_location:"",pickup_contact:"",pickup_phone:"",dropoff_location:"",dropoff_contact:"",dropoff_phone:"",requested_date:new Date().toISOString().split("T")[0],requested_time:"",special_instructions:"",linked_mrf_id:"",load_qty:"",load_weight:""}),r(),t()}catch(b){y(b.message)}finally{u(!1)}};return o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:o.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",maxWidth:"800px",width:"100%",maxHeight:"90vh",overflow:"auto",padding:"24px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[o.jsx("h2",{style:{margin:0},children:"Create New Logistics Task"}),o.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:"×"})]}),h&&o.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",border:"1px solid #fcc",borderRadius:"4px",marginBottom:"16px",color:"#c00"},children:h}),o.jsxs("form",{onSubmit:g,children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Task Type *"}),o.jsxs("select",{name:"type",value:s.type,onChange:x,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[o.jsx("option",{value:"delivery",children:"Delivery"}),o.jsx("option",{value:"collection",children:"Collection"}),o.jsx("option",{value:"container_move",children:"Container Move"}),o.jsx("option",{value:"yard_work",children:"Yard Work"}),o.jsx("option",{value:"project_move",children:"Project Move"}),o.jsx("option",{value:"backload",children:"Backload"}),o.jsx("option",{value:"adhoc",children:"Ad-hoc"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Priority *"}),o.jsxs("select",{name:"priority",value:s.priority,onChange:x,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[o.jsx("option",{value:"critical",children:"Critical (2hr SLA)"}),o.jsx("option",{value:"high",children:"High (4hr SLA)"}),o.jsx("option",{value:"normal",children:"Normal (24hr SLA)"}),o.jsx("option",{value:"low",children:"Low (48hr SLA)"})]})]})]}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Description *"}),o.jsx("textarea",{name:"description",value:s.description,onChange:x,required:!0,rows:3,placeholder:"Describe what needs to be moved and why...",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"inherit"}})]}),o.jsx("h3",{style:{marginTop:"24px",marginBottom:"12px"},children:"Requester Information"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Name *"}),o.jsx("input",{type:"text",name:"requester_name",value:s.requester_name,onChange:x,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Department"}),o.jsx("input",{type:"text",name:"requester_department",value:s.requester_department,onChange:x,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Phone"}),o.jsx("input",{type:"tel",name:"requester_phone",value:s.requester_phone,onChange:x,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Email"}),o.jsx("input",{type:"email",name:"requester_email",value:s.requester_email,onChange:x,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),o.jsx("h3",{style:{marginTop:"24px",marginBottom:"12px"},children:"Pickup Location"}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Location *"}),o.jsx("input",{type:"text",name:"pickup_location",value:s.pickup_location,onChange:x,required:!0,placeholder:"e.g., Warehouse 1, Bay 3",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Contact Person"}),o.jsx("input",{type:"text",name:"pickup_contact",value:s.pickup_contact,onChange:x,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Contact Phone"}),o.jsx("input",{type:"tel",name:"pickup_phone",value:s.pickup_phone,onChange:x,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),o.jsx("h3",{style:{marginTop:"24px",marginBottom:"12px"},children:"Dropoff Location"}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Location *"}),o.jsx("input",{type:"text",name:"dropoff_location",value:s.dropoff_location,onChange:x,required:!0,placeholder:"e.g., Unit 12, Workshop A",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Contact Person"}),o.jsx("input",{type:"text",name:"dropoff_contact",value:s.dropoff_contact,onChange:x,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Contact Phone"}),o.jsx("input",{type:"tel",name:"dropoff_phone",value:s.dropoff_phone,onChange:x,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),o.jsx("h3",{style:{marginTop:"24px",marginBottom:"12px"},children:"Schedule"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Requested Date *"}),o.jsx("input",{type:"date",name:"requested_date",value:s.requested_date,onChange:x,required:!0,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Requested Time"}),o.jsx("input",{type:"time",name:"requested_time",value:s.requested_time,onChange:x,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),o.jsx("h3",{style:{marginTop:"24px",marginBottom:"12px"},children:"Load Information (Optional)"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Quantity"}),o.jsx("input",{type:"number",name:"load_qty",value:s.load_qty,onChange:x,placeholder:"Number of items",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Weight (kg)"}),o.jsx("input",{type:"number",name:"load_weight",value:s.load_weight,onChange:x,placeholder:"Total weight",step:"0.1",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Special Instructions"}),o.jsx("textarea",{name:"special_instructions",value:s.special_instructions,onChange:x,rows:2,placeholder:"Any special handling requirements, access codes, etc...",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"inherit"}})]}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"},children:"Linked MRF ID (if applicable)"}),o.jsx("input",{type:"text",name:"linked_mrf_id",value:s.linked_mrf_id,onChange:x,placeholder:"e.g., MRF-2025-001234",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),o.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"24px"},children:[o.jsx("button",{type:"button",onClick:t,disabled:d,style:{padding:"10px 20px",backgroundColor:"#f0f0f0",color:"#333",border:"none",borderRadius:"4px",cursor:d?"not-allowed":"pointer",fontWeight:"bold"},children:"Cancel"}),o.jsx("button",{type:"submit",disabled:d,style:{padding:"10px 20px",backgroundColor:d?"#ccc":"#0066cc",color:"white",border:"none",borderRadius:"4px",cursor:d?"not-allowed":"pointer",fontWeight:"bold"},children:d?"Creating...":"Create Task"})]})]})]})})},Zv=({slaTargetAt:a,status:t})=>{const[r,s]=E.useState(""),[l,d]=E.useState(!1),[u,h]=E.useState("safe");if(E.useEffect(()=>{const g=()=>{const b=new Date().getTime(),k=new Date(a).getTime()-b;if(k<=0){d(!0);const j=Math.abs(k),C=Math.floor(j/(1e3*60*60)),A=Math.floor(j%(1e3*60*60)/(1e3*60));s(`${C}h ${A}m overdue`),h("critical")}else{d(!1);const j=Math.floor(k/(1e3*60*60)),C=Math.floor(k%(1e3*60*60)/(1e3*60));s(`${j}h ${C}m remaining`),k<=36e5?h("critical"):k<=72e5?h("warning"):h("safe")}};g();const v=setInterval(g,6e4);return()=>clearInterval(v)},[a]),["completed","verified","closed","cancelled"].includes(t))return null;const y=()=>l?"#ff4444":u==="critical"?"#ff9944":u==="warning"?"#ffcc44":"#44aa44",x=()=>l?"⚠️":u==="critical"?"🔥":u==="warning"?"⏰":"✓";return o.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"4px 8px",borderRadius:"4px",backgroundColor:y(),color:"white",fontSize:"12px",fontWeight:"bold"},children:[o.jsx("span",{children:x()}),o.jsx("span",{children:r})]})},eb=({searchTerm:a,onSearchChange:t,statusFilter:r,onStatusFilterChange:s,typeFilter:l,onTypeFilterChange:d,priorityFilter:u,onPriorityFilterChange:h})=>o.jsxs("div",{style:{backgroundColor:"white",padding:"16px",borderRadius:"8px",border:"1px solid #ddd",marginBottom:"16px"},children:[o.jsx("div",{style:{marginBottom:"12px"},children:o.jsx("input",{type:"search",placeholder:"Search tasks by description, task number, or location...",value:a,onChange:y=>t(y.target.value),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontSize:"12px",fontWeight:"bold",color:"#666"},children:"Status"}),o.jsxs("select",{value:r,onChange:y=>s(y.target.value),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"},children:[o.jsx("option",{value:"all",children:"All Statuses"}),o.jsx("option",{value:"new",children:"New"}),o.jsx("option",{value:"scheduled",children:"Scheduled"}),o.jsx("option",{value:"in_progress",children:"In Progress"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"verified",children:"Verified"}),o.jsx("option",{value:"closed",children:"Closed"}),o.jsx("option",{value:"cancelled",children:"Cancelled"}),o.jsx("option",{value:"exception",children:"Exception"}),o.jsx("option",{value:"on_hold",children:"On Hold"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontSize:"12px",fontWeight:"bold",color:"#666"},children:"Task Type"}),o.jsxs("select",{value:l,onChange:y=>d(y.target.value),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"},children:[o.jsx("option",{value:"all",children:"All Types"}),o.jsx("option",{value:"delivery",children:"Delivery"}),o.jsx("option",{value:"collection",children:"Collection"}),o.jsx("option",{value:"container_move",children:"Container Move"}),o.jsx("option",{value:"yard_work",children:"Yard Work"}),o.jsx("option",{value:"project_move",children:"Project Move"}),o.jsx("option",{value:"backload",children:"Backload"}),o.jsx("option",{value:"adhoc",children:"Ad-hoc"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",marginBottom:"4px",fontSize:"12px",fontWeight:"bold",color:"#666"},children:"Priority"}),o.jsxs("select",{value:u,onChange:y=>h(y.target.value),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"},children:[o.jsx("option",{value:"all",children:"All Priorities"}),o.jsx("option",{value:"critical",children:"Critical"}),o.jsx("option",{value:"high",children:"High"}),o.jsx("option",{value:"normal",children:"Normal"}),o.jsx("option",{value:"low",children:"Low"})]})]})]}),(a||r!=="all"||l!=="all"||u!=="all")&&o.jsx("button",{onClick:()=>{t(""),s("all"),d("all"),h("all")},style:{marginTop:"12px",padding:"6px 12px",backgroundColor:"#f0f0f0",color:"#666",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Clear All Filters"})]}),tb=({task:a})=>{const[t,r]=E.useState([]),[s,l]=E.useState(!0);E.useEffect(()=>{d()},[a.task_id]);const d=async()=>{l(!0);try{const g=await ot.getTaskEvents(a.task_id);r(g)}catch(g){console.error("Error loading events:",g)}finally{l(!1)}},u=g=>({created:"🆕",assigned:"👤",status_changed:"🔄",driver_started:"🚀",arrived:"📍",completed:"✅",exception:"⚠️",note_added:"📝",cancelled:"❌",on_hold:"⏸️",resumed:"▶️"})[g]||"•",h=g=>({created:"#0066cc",assigned:"#44aa44",status_changed:"#888",driver_started:"#0066cc",arrived:"#44aa44",completed:"#44aa44",exception:"#ff4444",note_added:"#888",cancelled:"#ff4444",on_hold:"#ff9944",resumed:"#44aa44"})[g]||"#888",y=g=>{switch(g.event_type){case"created":return"Task created";case"assigned":return"Assigned to driver";case"status_changed":return`Status changed: ${g.status_from} → ${g.status_to}`;case"driver_started":return"Driver started task";case"arrived":return g.notes||"Arrived at location";case"completed":return"Task completed";case"exception":return`Exception: ${g.notes||"Issue reported"}`;case"note_added":return`Note: ${g.notes}`;case"cancelled":return`Cancelled: ${g.notes}`;case"on_hold":return`Put on hold: ${g.notes}`;case"resumed":return"Resumed from hold";default:return g.notes||g.event_type}},x=g=>{const v=new Date(g),_=new Date().getTime()-v.getTime(),k=Math.floor(_/6e4),j=Math.floor(_/36e5),C=Math.floor(_/864e5);return k<1?"Just now":k<60?`${k}m ago`:j<24?`${j}h ago`:C<7?`${C}d ago`:v.toLocaleDateString()+" "+v.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return s?o.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:"Loading timeline..."}):t.length===0?o.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:"No events recorded yet"}):o.jsxs("div",{style:{padding:"16px"},children:[o.jsx("h3",{style:{marginBottom:"16px",fontSize:"16px",fontWeight:"bold"},children:"Task Timeline"}),o.jsxs("div",{style:{position:"relative",paddingLeft:"32px"},children:[o.jsx("div",{style:{position:"absolute",left:"12px",top:"8px",bottom:"8px",width:"2px",backgroundColor:"#ddd"}}),t.map((g,v)=>o.jsxs("div",{style:{position:"relative",marginBottom:"16px"},children:[o.jsx("div",{style:{position:"absolute",left:"-26px",top:"0",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:h(g.event_type),color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:u(g.event_type)}),o.jsxs("div",{style:{backgroundColor:v===0?"#f0f8ff":"white",padding:"12px",borderRadius:"8px",border:"1px solid #ddd"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[o.jsx("strong",{style:{fontSize:"14px"},children:y(g)}),o.jsx("span",{style:{fontSize:"12px",color:"#888"},children:x(g.timestamp)})]}),g.actor_name&&o.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:["by ",g.actor_name," ",g.actor_role?`(${g.actor_role})`:""]}),g.gps_lat&&g.gps_lng&&o.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["📍 ",g.gps_lat.toFixed(6),", ",g.gps_lng.toFixed(6)]}),g.photo_refs&&g.photo_refs.length>0&&o.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"8px",flexWrap:"wrap"},children:g.photo_refs.map(b=>o.jsx("img",{src:b.thumbnail_url||b.url,alt:"Event photo",style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"4px",border:"1px solid #ddd"}},b.id))})]})]},g.event_id))]})]})},rb=({isOpen:a,onClose:t,task:r})=>{const[s,l]=E.useState("details");if(!a)return null;const d=h=>({new:"#0066cc",scheduled:"#44aa44",in_progress:"#ff9944",completed:"#44aa44",verified:"#228822",closed:"#888",cancelled:"#ff4444",exception:"#ff4444",on_hold:"#ff9944"})[h]||"#888",u=h=>({critical:"#ff4444",high:"#ff9944",normal:"#44aa44",low:"#888"})[h]||"#888";return o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:o.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",maxWidth:"900px",width:"100%",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[o.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #ddd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("h2",{style:{margin:0,marginBottom:"8px"},children:r.task_number}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",backgroundColor:d(r.status),color:"white",fontWeight:"bold"},children:r.status.toUpperCase().replace("_"," ")}),o.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",backgroundColor:u(r.priority),color:"white",fontWeight:"bold"},children:r.priority.toUpperCase()}),o.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",backgroundColor:"#f0f0f0",color:"#333"},children:r.type})]})]}),o.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:"×"})]}),o.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #ddd",backgroundColor:"#f9f9f9"},children:[o.jsx("button",{onClick:()=>l("details"),style:{padding:"12px 24px",border:"none",backgroundColor:s==="details"?"white":"transparent",borderBottom:s==="details"?"2px solid #0066cc":"none",fontWeight:s==="details"?"bold":"normal",cursor:"pointer"},children:"Details"}),o.jsx("button",{onClick:()=>l("timeline"),style:{padding:"12px 24px",border:"none",backgroundColor:s==="timeline"?"white":"transparent",borderBottom:s==="timeline"?"2px solid #0066cc":"none",fontWeight:s==="timeline"?"bold":"normal",cursor:"pointer"},children:"Timeline"}),r.pod&&o.jsx("button",{onClick:()=>l("pod"),style:{padding:"12px 24px",border:"none",backgroundColor:s==="pod"?"white":"transparent",borderBottom:s==="pod"?"2px solid #0066cc":"none",fontWeight:s==="pod"?"bold":"normal",cursor:"pointer"},children:"POD"})]}),o.jsxs("div",{style:{flex:1,overflow:"auto",padding:"20px"},children:[s==="details"&&o.jsxs("div",{children:[o.jsxs("div",{style:{marginBottom:"24px"},children:[o.jsx("h3",{style:{marginBottom:"8px",fontSize:"14px",color:"#666"},children:"Description"}),o.jsx("p",{style:{margin:0},children:r.description}),r.special_instructions&&o.jsxs("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#fff9e6",borderLeft:"3px solid #ffcc00",borderRadius:"4px"},children:[o.jsx("strong",{children:"⚠️ Special Instructions:"}),o.jsx("p",{style:{margin:"4px 0 0 0"},children:r.special_instructions})]})]}),o.jsxs("div",{style:{marginBottom:"24px"},children:[o.jsx("h3",{style:{marginBottom:"8px",fontSize:"14px",color:"#666"},children:"Requester"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[o.jsx(Ye,{label:"Name",value:r.requester.name}),o.jsx(Ye,{label:"Department",value:r.requester.department}),r.requester.phone&&o.jsx(Ye,{label:"Phone",value:r.requester.phone}),r.requester.email&&o.jsx(Ye,{label:"Email",value:r.requester.email})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",marginBottom:"24px"},children:[o.jsxs("div",{children:[o.jsx("h3",{style:{marginBottom:"12px",fontSize:"14px",color:"#666"},children:"📍 Pickup Location"}),o.jsxs("div",{style:{padding:"12px",backgroundColor:"#f9f9f9",borderRadius:"8px",border:"1px solid #ddd"},children:[o.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:r.pickup.location}),r.pickup.contact&&o.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:["Contact: ",r.pickup.contact]}),r.pickup.phone&&o.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:["Phone: ",r.pickup.phone]}),r.pickup.access_notes&&o.jsxs("div",{style:{marginTop:"8px",padding:"8px",backgroundColor:"white",borderRadius:"4px",fontSize:"12px"},children:[o.jsx("strong",{children:"Access:"})," ",r.pickup.access_notes]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{style:{marginBottom:"12px",fontSize:"14px",color:"#666"},children:"📍 Dropoff Location"}),o.jsxs("div",{style:{padding:"12px",backgroundColor:"#f9f9f9",borderRadius:"8px",border:"1px solid #ddd"},children:[o.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:r.dropoff.location}),r.dropoff.contact&&o.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:["Contact: ",r.dropoff.contact]}),r.dropoff.phone&&o.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:["Phone: ",r.dropoff.phone]}),r.dropoff.access_notes&&o.jsxs("div",{style:{marginTop:"8px",padding:"8px",backgroundColor:"white",borderRadius:"4px",fontSize:"12px"},children:[o.jsx("strong",{children:"Access:"})," ",r.dropoff.access_notes]})]})]})]}),r.load_info&&o.jsxs("div",{style:{marginBottom:"24px"},children:[o.jsx("h3",{style:{marginBottom:"8px",fontSize:"14px",color:"#666"},children:"Load Information"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:[r.load_info.qty&&o.jsx(Ye,{label:"Quantity",value:`${r.load_info.qty} items`}),r.load_info.weight&&o.jsx(Ye,{label:"Weight",value:`${r.load_info.weight} kg`}),r.load_info.equipment_required&&o.jsx(Ye,{label:"Equipment Required",value:r.load_info.equipment_required})]})]}),(r.driver||r.vehicle)&&o.jsxs("div",{style:{marginBottom:"24px"},children:[o.jsx("h3",{style:{marginBottom:"8px",fontSize:"14px",color:"#666"},children:"Assignment"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[r.driver&&o.jsx(Ye,{label:"Driver",value:r.driver.name}),r.vehicle&&o.jsx(Ye,{label:"Vehicle",value:r.vehicle.registration}),r.assigned_at&&o.jsx(Ye,{label:"Assigned At",value:new Date(r.assigned_at).toLocaleString()})]})]}),o.jsxs("div",{style:{marginBottom:"24px"},children:[o.jsx("h3",{style:{marginBottom:"8px",fontSize:"14px",color:"#666"},children:"Timeline"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:[o.jsx(Ye,{label:"Created",value:new Date(r.created_at).toLocaleString()}),o.jsx(Ye,{label:"Requested Date",value:new Date(r.requested_date).toLocaleString()}),r.started_at&&o.jsx(Ye,{label:"Started",value:new Date(r.started_at).toLocaleString()}),r.completed_at&&o.jsx(Ye,{label:"Completed",value:new Date(r.completed_at).toLocaleString()})]})]}),(r.linked_mrf_id||r.linked_wo_id)&&o.jsxs("div",{children:[o.jsx("h3",{style:{marginBottom:"8px",fontSize:"14px",color:"#666"},children:"Linked Entities"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:[r.linked_mrf_id&&o.jsx(Ye,{label:"MRF",value:r.linked_mrf_id}),r.linked_wo_id&&o.jsx(Ye,{label:"Work Order",value:r.linked_wo_id})]})]})]}),s==="timeline"&&o.jsx(tb,{task:r}),s==="pod"&&r.pod&&o.jsxs("div",{children:[o.jsx("h3",{style:{marginBottom:"16px"},children:"Proof of Delivery"}),o.jsxs("div",{style:{marginBottom:"24px"},children:[o.jsx(Ye,{label:"Delivered To",value:r.pod.delivered_to}),r.pod.delivered_to_phone&&o.jsx(Ye,{label:"Phone",value:r.pod.delivered_to_phone}),r.pod.delivery_notes&&o.jsxs("div",{style:{marginTop:"12px"},children:[o.jsx("strong",{children:"Notes:"}),o.jsx("p",{style:{margin:"4px 0 0 0",color:"#666"},children:r.pod.delivery_notes})]})]}),r.pod.photos&&r.pod.photos.length>0&&o.jsxs("div",{style:{marginBottom:"24px"},children:[o.jsxs("h4",{style:{marginBottom:"12px",fontSize:"14px",color:"#666"},children:["Photos (",r.pod.photo_count,")"]}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"12px"},children:r.pod.photos.map(h=>o.jsx("img",{src:h.url,alt:"POD photo",style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px",border:"1px solid #ddd"}},h.id))})]}),r.pod.signature_img&&o.jsxs("div",{style:{marginBottom:"24px"},children:[o.jsx("h4",{style:{marginBottom:"12px",fontSize:"14px",color:"#666"},children:"Signature"}),o.jsx("img",{src:r.pod.signature_img,alt:"Signature",style:{maxWidth:"400px",border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"white"}})]}),r.pod.delivery_gps_lat&&r.pod.delivery_gps_lng&&o.jsxs("div",{children:[o.jsx("h4",{style:{marginBottom:"12px",fontSize:"14px",color:"#666"},children:"GPS Location"}),o.jsxs("div",{style:{padding:"12px",backgroundColor:r.pod.gps_verified?"#e8f5e9":"#fff9e6",borderRadius:"8px",border:"1px solid #ddd"},children:[o.jsxs("div",{style:{marginBottom:"4px"},children:["📍 ",r.pod.delivery_gps_lat.toFixed(6),", ",r.pod.delivery_gps_lng.toFixed(6)]}),o.jsx("div",{style:{fontSize:"12px",color:"#666"},children:r.pod.gps_verified?"✅ Verified within site radius":"⚠️ Outside expected site radius"})]})]})]})]})]})})},Ye=({label:a,value:t})=>t?o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"4px"},children:a}),o.jsx("div",{style:{fontSize:"14px",fontWeight:"500"},children:t})]}):null,nb=()=>{var ae,K,Y;const[a,t]=E.useState([]),[r,s]=E.useState([]),[l,d]=E.useState([]),[u,h]=E.useState(null),[y,x]=E.useState(!0),[g,v]=E.useState(!1),[b,_]=E.useState(!1),[k,j]=E.useState(""),[C,A]=E.useState("all"),[S,D]=E.useState("all"),[L,M]=E.useState("all");E.useEffect(()=>{q()},[]);const q=async()=>{x(!0);try{const[B,z,U]=await Promise.all([ot.listTasks({}),cc.listDrivers(!0),dc.listVehicles(!0)]);t(B),s(z),d(U)}catch(B){console.error("Error loading data:",B)}finally{x(!1)}},Q=a.filter(B=>{if(k){const z=k.toLowerCase();if(!(B.task_number.toLowerCase().includes(z)||B.description.toLowerCase().includes(z)||B.pickup.location.toLowerCase().includes(z)||B.dropoff.location.toLowerCase().includes(z)||B.requester.name.toLowerCase().includes(z)))return!1}return!(C!=="all"&&B.status!==C||S!=="all"&&B.type!==S||L!=="all"&&B.priority!==L)}),me=async(B,z,U)=>{try{await ot.assignTask(B,z,U),await q(),alert("Task assigned successfully!")}catch(re){alert(`Error assigning task: ${re.message}`)}},J=(B=>B.reduce((z,U)=>(z[U.status]||(z[U.status]=[]),z[U.status].push(U),z),{}))(Q);return o.jsxs("div",{className:"logistics-dispatcher-view",style:{padding:"20px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[o.jsx("h1",{children:"📦 Logistics Dispatcher"}),o.jsx("div",{style:{display:"flex",gap:"10px"},children:o.jsx("button",{onClick:()=>v(!0),style:{padding:"10px 20px",backgroundColor:"#44aa44",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"+ Create Task"})}),o.jsx(eb,{searchTerm:k,onSearchChange:j,statusFilter:C,onStatusFilterChange:A,typeFilter:S,onTypeFilterChange:D,priorityFilter:L,onPriorityFilterChange:M}),o.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[o.jsxs("button",{onClick:()=>A("all"),style:{padding:"8px 16px",backgroundColor:C==="all"?"#0066cc":"#f0f0f0",color:C==="all"?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer"},children:["All Tasks (",Q.length,")"]}),o.jsxs("button",{onClick:()=>A("new"),style:{padding:"8px 16px",backgroundColor:C==="new"?"#0066cc":"#f0f0f0",color:C==="new"?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer"},children:["New (",((ae=J.new)==null?void 0:ae.length)||0,")"]}),o.jsxs("button",{onClick:()=>A("scheduled"),style:{padding:"8px 16px",backgroundColor:C==="scheduled"?"#0066cc":"#f0f0f0",color:C==="scheduled"?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer"},children:["Scheduled (",((K=J.scheduled)==null?void 0:K.length)||0,")"]}),o.jsxs("button",{onClick:()=>A("in_progress"),style:{padding:"8px 16px",backgroundColor:C==="in_progress"?"#0066cc":"#f0f0f0",color:C==="in_progress"?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer"},children:["In Progress (",((Y=J.in_progress)==null?void 0:Y.length)||0,")"]})]})]}),y?o.jsx("div",{style:{textAlign:"center",padding:"40px"},children:o.jsx("p",{children:"Loading tasks..."})}):o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"20px"},children:[o.jsxs("div",{children:[o.jsxs("h2",{children:["Task Queue (",Q.length,")"]}),Q.length===0?o.jsx("div",{style:{padding:"40px",textAlign:"center",backgroundColor:"#f9f9f9",borderRadius:"8px"},children:o.jsx("p",{children:"No tasks found matching your filters"})}):o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:Q.map(B=>o.jsxs("div",{onClick:()=>{h(B),_(!0)},style:{padding:"16px",backgroundColor:(u==null?void 0:u.task_id)===B.task_id?"#e6f3ff":"white",border:"1px solid #ddd",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[o.jsx("strong",{children:B.task_number}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",backgroundColor:B.priority==="critical"?"#ff4444":B.priority==="high"?"#ff9944":B.priority==="normal"?"#44aa44":"#888",color:"white"},children:B.priority.toUpperCase()}),B.sla_target_at&&o.jsx(Zv,{slaTargetAt:B.sla_target_at,status:B.status})]})]}),o.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[o.jsx("strong",{children:B.type})," - ",B.description]}),o.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["From: ",B.pickup.location," → To: ",B.dropoff.location]}),B.driver&&o.jsxs("div",{style:{fontSize:"12px",color:"#0066cc",marginTop:"4px"},children:["Driver: ",B.driver.name]})]},B.task_id))})]}),o.jsx("div",{children:u?o.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #ddd",borderRadius:"8px",padding:"16px"},children:[o.jsx("h3",{children:"Task Details"}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Task Number:"})," ",u.task_number]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Type:"})," ",u.type]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Priority:"})," ",u.priority]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Status:"})," ",u.status]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Description:"})," ",u.description]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Requester:"})," ",u.requester.name]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Pickup:"})," ",u.pickup.location]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Dropoff:"})," ",u.dropoff.location]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Requested Date:"})," ",new Date(u.requested_date).toLocaleString()]})]}),u.status==="new"&&o.jsxs("div",{children:[o.jsx("h4",{children:"Assign Driver & Vehicle"}),o.jsxs("div",{style:{marginTop:"8px"},children:[o.jsx("label",{style:{display:"block",marginBottom:"4px"},children:"Driver:"}),o.jsxs("select",{id:"driver-select",style:{width:"100%",padding:"8px",marginBottom:"12px",borderRadius:"4px",border:"1px solid #ddd"},children:[o.jsx("option",{value:"",children:"Select Driver"}),r.filter(B=>B.availability).map(B=>o.jsxs("option",{value:B.driver_id,children:[B.name," (",B.status,")"]},B.driver_id))]}),o.jsx("label",{style:{display:"block",marginBottom:"4px"},children:"Vehicle:"}),o.jsxs("select",{id:"vehicle-select",style:{width:"100%",padding:"8px",marginBottom:"12px",borderRadius:"4px",border:"1px solid #ddd"},children:[o.jsx("option",{value:"",children:"Select Vehicle"}),l.filter(B=>B.status==="available").map(B=>o.jsxs("option",{value:B.vehicle_id,children:[B.registration," (",B.vehicle_type,")"]},B.vehicle_id))]}),o.jsx("button",{onClick:()=>{const B=document.getElementById("driver-select"),z=document.getElementById("vehicle-select"),U=B.value,re=z.value;U&&re?me(u.task_id,U,re):alert("Please select both driver and vehicle")},style:{width:"100%",padding:"12px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Assign Task"})]})]})]}):o.jsx("div",{style:{backgroundColor:"#f9f9f9",border:"1px solid #ddd",borderRadius:"8px",padding:"40px",textAlign:"center"},children:o.jsx("p",{children:"Select a task to view details"})})})]}),o.jsx(Xv,{isOpen:g,onClose:()=>v(!1),onTaskCreated:q}),u&&o.jsx(rb,{isOpen:b,onClose:()=>{_(!1),h(null)},task:u})]})};class sb{async uploadPhoto(t,r){try{const s=Date.now(),l=`pod-photos/${r}/${s}-${t.name}`,{data:d,error:u}=await he.storage.from("logistics-pod").upload(l,t,{cacheControl:"3600",upsert:!1});if(u)throw u;const{data:h}=he.storage.from("logistics-pod").getPublicUrl(l);return h.publicUrl}catch(s){throw console.error("Error uploading photo:",s),s}}async uploadSignature(t,r){try{const s=Date.now(),l=`pod-signatures/${r}/${s}.png`,d=this.base64ToBlob(t),{data:u,error:h}=await he.storage.from("logistics-pod").upload(l,d,{cacheControl:"3600",upsert:!1,contentType:"image/png"});if(h)throw h;const{data:y}=he.storage.from("logistics-pod").getPublicUrl(l);return y.publicUrl}catch(s){throw console.error("Error uploading signature:",s),s}}async createPOD(t){try{const r=[];for(const x of t.photos)if(x instanceof File){const g=await this.uploadPhoto(x,t.task_id);r.push({id:`${Date.now()}-${Math.random()}`,url:g,thumbnail_url:g,type:"delivery",caption:x.name,timestamp:new Date().toISOString()})}else r.push(x);let s;t.signature_img&&(s=await this.uploadSignature(t.signature_img,t.task_id));let l=!1;t.delivery_gps_lat&&t.delivery_gps_lng&&(l=await this.verifyGPSLocation(t.delivery_gps_lat,t.delivery_gps_lng));const{data:d,error:u}=await he.from("pod_records").insert({task_id:t.task_id,signature_img:s||t.signature_img,signature_name:t.signature_name,signature_timestamp:t.signature_img?new Date().toISOString():void 0,photos:r,photo_count:r.length,delivery_gps_lat:t.delivery_gps_lat,delivery_gps_lng:t.delivery_gps_lng,delivery_gps_accuracy:t.delivery_gps_accuracy,gps_verified:l,delivered_to:t.delivered_to,delivered_to_phone:t.delivered_to_phone,delivery_notes:t.delivery_notes,verified:!1,exception_flag:r.length===0,exception_reason:r.length===0?"No photos captured":void 0,created_at:new Date().toISOString()}).select().single();if(u)throw u;await he.from("logistics_tasks").update({pod_id:d.pod_id,updated_at:new Date().toISOString()}).eq("task_id",t.task_id),await he.from("task_events").insert({task_id:t.task_id,event_type:"completed",notes:"POD captured",gps_lat:t.delivery_gps_lat,gps_lng:t.delivery_gps_lng,gps_accuracy:t.delivery_gps_accuracy,photo_refs:r,timestamp:new Date().toISOString()});const h=await ot.getTaskById(t.task_id);if(h&&h.linked_mrf_id&&await Jh.publishTaskDelivered(h,d),h){const{notificationService:x}=await Gn(async()=>{const{notificationService:g}=await Promise.resolve().then(()=>Qv);return{notificationService:g}},void 0);await x.notifyTaskCompleted(h,d)}const y=this.validatePOD(d);return y.length>0&&await this.notifyPODWarnings(t.task_id,y),d}catch(r){throw console.error("Error creating POD:",r),r}}async getPODById(t){try{const{data:r,error:s}=await he.from("pod_records").select("*").eq("pod_id",t).single();if(s)throw s;return r}catch(r){return console.error("Error fetching POD:",r),null}}async getPODByTaskId(t){try{const{data:r,error:s}=await he.from("pod_records").select("*").eq("task_id",t).single();if(s)throw s;return r}catch(r){return console.error("Error fetching POD by task ID:",r),null}}async verifyPOD(t){try{const{data:r,error:s}=await he.from("pod_records").update({verified:!0,verified_by:t.verified_by,verified_at:new Date().toISOString(),verification_notes:t.verification_notes}).eq("pod_id",t.pod_id).select().single();if(s)throw s;return await he.from("logistics_tasks").update({status:"verified",verified_at:new Date().toISOString(),verified_by:t.verified_by}).eq("pod_id",t.pod_id),r}catch(r){return console.error("Error verifying POD:",r),null}}async listUnverifiedPODs(){try{const{data:t,error:r}=await he.from("pod_records").select("*").eq("verified",!1).order("created_at",{ascending:!1});if(r)throw r;return t||[]}catch(t){return console.error("Error listing unverified PODs:",t),[]}}validatePOD(t){const r=[];return t.photo_count===0&&r.push("No photos captured"),t.signature_img||r.push("No signature captured"),!t.delivery_gps_lat||!t.delivery_gps_lng?r.push("GPS location not available"):t.gps_verified||r.push("GPS location outside expected site radius"),(!t.delivered_to||t.delivered_to.trim()==="")&&r.push("Receiver name not provided"),r}async verifyGPSLocation(t,r){try{const{data:s}=await he.from("site_zones").select("*").eq("enabled",!0);if(!s||s.length===0)return!0;for(const l of s)if(l.gps_center&&l.gps_radius&&this.calculateDistance(t,r,l.gps_center.lat,l.gps_center.lng)<=l.gps_radius)return!0;return!1}catch(s){return console.error("Error verifying GPS location:",s),!1}}calculateDistance(t,r,s,l){const u=t*Math.PI/180,h=s*Math.PI/180,y=(s-t)*Math.PI/180,x=(l-r)*Math.PI/180,g=Math.sin(y/2)*Math.sin(y/2)+Math.cos(u)*Math.cos(h)*Math.sin(x/2)*Math.sin(x/2);return 6371e3*(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)))}base64ToBlob(t){const r=atob(t.split(",")[1]),s=t.split(",")[0].split(":")[1].split(";")[0],l=new ArrayBuffer(r.length),d=new Uint8Array(l);for(let u=0;u<r.length;u++)d[u]=r.charCodeAt(u);return new Blob([l],{type:s})}async notifyPODWarnings(t,r){try{console.log(`POD warnings for task ${t}:`,r)}catch(s){console.error("Error sending POD warnings:",s)}}}const Yh=new sb,ab=({isOpen:a,onClose:t,task:r,onComplete:s})=>{const[l,d]=E.useState("camera"),[u,h]=E.useState([]),[y,x]=E.useState(null),[g,v]=E.useState(""),[b,_]=E.useState(""),[k,j]=E.useState(""),[C,A]=E.useState(null),[S,D]=E.useState(!1),[L,M]=E.useState(null),q=E.useRef(null),Q=E.useRef(null),me=E.useRef(null);E.useEffect(()=>{a?ye():(ae(),h([]),x(null),v(""),_(""),j(""),d("camera"),M(null))},[a]);const ye=()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(z=>{A({lat:z.coords.latitude,lng:z.coords.longitude})},z=>{console.error("GPS error:",z)})},J=async()=>{try{const z=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});q.current&&(q.current.srcObject=z,me.current=z)}catch(z){console.error("Camera error:",z),M("Unable to access camera. Please check permissions.")}},ae=()=>{me.current&&(me.current.getTracks().forEach(z=>z.stop()),me.current=null)},K=()=>{if(q.current&&Q.current){const z=q.current,U=Q.current,re=U.getContext("2d");if(re){U.width=z.videoWidth,U.height=z.videoHeight,re.drawImage(z,0,0);const G=U.toDataURL("image/jpeg",.8),H={id:`photo-${Date.now()}`,dataUrl:G,timestamp:new Date().toISOString()};h([...u,H])}}},Y=z=>{h(u.filter(U=>U.id!==z))},B=async()=>{if(u.length===0){M("Please capture at least one photo");return}if(!g.trim()){M("Please enter the name of the person who received the delivery");return}D(!0),M(null);try{const z=await Promise.all(u.map(async(U,re)=>{const H=await(await fetch(U.dataUrl)).blob();return new File([H],`photo-${re+1}.jpg`,{type:"image/jpeg"})}));await Yh.createPOD({task_id:r.task_id,photos:z,signature_img:y||void 0,signature_name:g,delivered_to:g,delivered_to_phone:b||void 0,delivery_notes:k||void 0,delivery_gps_lat:C==null?void 0:C.lat,delivery_gps_lng:C==null?void 0:C.lng}),ae(),s(),t()}catch(z){M(z.message||"Failed to submit POD")}finally{D(!1)}};return a?o.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",flexDirection:"column",zIndex:1e3},children:[o.jsxs("div",{style:{padding:"16px",backgroundColor:"#1a1a1a",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("h2",{style:{margin:0,fontSize:"18px"},children:["📸 Proof of Delivery - ",r.task_number]}),o.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"white",fontSize:"24px",cursor:"pointer"},children:"×"})]}),L&&o.jsx("div",{style:{padding:"12px",backgroundColor:"#ff4444",color:"white",textAlign:"center"},children:L}),o.jsxs("div",{style:{padding:"16px",backgroundColor:"#2a2a2a",display:"flex",justifyContent:"center",gap:"8px"},children:[o.jsx(Hl,{label:"Photos",active:l==="camera"||l==="photos",completed:u.length>0}),o.jsx(Hl,{label:"Signature",active:l==="signature",completed:!!y}),o.jsx(Hl,{label:"Details",active:l==="details",completed:!!g})]}),o.jsxs("div",{style:{flex:1,overflow:"auto",padding:"16px"},children:[l==="camera"&&o.jsx(ib,{videoRef:q,canvasRef:Q,onStartCamera:J,onCapture:K,onNext:()=>{ae(),d("photos")},photoCount:u.length,hasPhotos:u.length>0}),l==="photos"&&o.jsx(ob,{photos:u,onDelete:Y,onAddMore:()=>{J(),d("camera")},onNext:()=>d("signature")}),l==="signature"&&o.jsx(lb,{signature:y,onSignatureChange:x,onSkip:()=>d("details"),onNext:()=>d("details")}),l==="details"&&o.jsx(cb,{deliveredTo:g,deliveredToPhone:b,deliveryNotes:k,onDeliveredToChange:v,onDeliveredToPhoneChange:_,onDeliveryNotesChange:j,gpsLocation:C,onSubmit:B,submitting:S})]})]}):null},Hl=({label:a,active:t,completed:r})=>o.jsxs("div",{style:{padding:"8px 16px",borderRadius:"20px",backgroundColor:r?"#44aa44":t?"#0066cc":"#555",color:"white",fontSize:"12px",fontWeight:"bold"},children:[r?"✓ ":"",a]}),ib=({videoRef:a,canvasRef:t,onStartCamera:r,onCapture:s,onNext:l,photoCount:d,hasPhotos:u})=>{const[h,y]=E.useState(!1);return o.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[o.jsxs("div",{style:{backgroundColor:"#000",borderRadius:"8px",overflow:"hidden",marginBottom:"16px",position:"relative"},children:[o.jsx("video",{ref:a,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",height:"auto",display:h?"block":"none"}}),!h&&o.jsxs("div",{style:{padding:"100px 20px",textAlign:"center",color:"white"},children:[o.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"📷"}),o.jsx("p",{children:"Camera ready to capture POD photos"})]})]}),o.jsx("canvas",{ref:t,style:{display:"none"}}),o.jsx("div",{style:{textAlign:"center"},children:h?o.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[o.jsxs("button",{onClick:s,style:{padding:"16px 32px",backgroundColor:"#44aa44",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:["📸 Capture Photo ",d>0?`(${d})`:""]}),u&&o.jsx("button",{onClick:l,style:{padding:"16px 32px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"Next →"})]}):o.jsx("button",{onClick:()=>{r(),y(!0)},style:{padding:"16px 32px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"Start Camera"})})]})},ob=({photos:a,onDelete:t,onAddMore:r,onNext:s})=>o.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[o.jsxs("h3",{style:{color:"white",marginBottom:"16px"},children:["Review Photos (",a.length,")"]}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px",marginBottom:"16px"},children:a.map(l=>o.jsxs("div",{style:{position:"relative"},children:[o.jsx("img",{src:l.dataUrl,alt:"POD photo",style:{width:"100%",height:"200px",objectFit:"cover",borderRadius:"8px"}}),o.jsx("button",{onClick:()=>t(l.id),style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"#ff4444",color:"white",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",fontSize:"18px"},children:"×"})]},l.id))}),o.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[o.jsx("button",{onClick:r,style:{padding:"12px 24px",backgroundColor:"#666",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"+ Add More Photos"}),o.jsx("button",{onClick:s,style:{padding:"12px 24px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"8px",fontWeight:"bold",cursor:"pointer"},children:"Next →"})]})]}),lb=({signature:a,onSignatureChange:t,onSkip:r,onNext:s})=>{const l=E.useRef(null),[d,u]=E.useState(!1),h=v=>{u(!0);const b=l.current;if(b){const _=b.getBoundingClientRect(),k="touches"in v?v.touches[0].clientX-_.left:v.clientX-_.left,j="touches"in v?v.touches[0].clientY-_.top:v.clientY-_.top,C=b.getContext("2d");C&&(C.beginPath(),C.moveTo(k,j))}},y=v=>{if(!d)return;const b=l.current;if(b){const _=b.getBoundingClientRect(),k="touches"in v?v.touches[0].clientX-_.left:v.clientX-_.left,j="touches"in v?v.touches[0].clientY-_.top:v.clientY-_.top,C=b.getContext("2d");C&&(C.lineTo(k,j),C.stroke())}},x=()=>{u(!1);const v=l.current;v&&t(v.toDataURL())},g=()=>{const v=l.current;if(v){const b=v.getContext("2d");b&&(b.clearRect(0,0,v.width,v.height),t(null))}};return E.useEffect(()=>{const v=l.current;if(v){const b=v.getContext("2d");b&&(b.strokeStyle="#000",b.lineWidth=2,b.lineCap="round")}},[]),o.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[o.jsx("h3",{style:{color:"white",marginBottom:"16px"},children:"Signature (Optional)"}),o.jsx("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"8px",marginBottom:"16px"},children:o.jsx("canvas",{ref:l,width:560,height:200,onMouseDown:h,onMouseMove:y,onMouseUp:x,onMouseLeave:x,onTouchStart:h,onTouchMove:y,onTouchEnd:x,style:{border:"2px dashed #ddd",borderRadius:"4px",cursor:"crosshair",touchAction:"none"}})}),o.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[o.jsx("button",{onClick:g,style:{padding:"12px 24px",backgroundColor:"#666",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Clear"}),o.jsx("button",{onClick:r,style:{padding:"12px 24px",backgroundColor:"#888",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Skip"}),o.jsx("button",{onClick:s,style:{padding:"12px 24px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"8px",fontWeight:"bold",cursor:"pointer"},children:"Next →"})]})]})},cb=({deliveredTo:a,deliveredToPhone:t,deliveryNotes:r,onDeliveredToChange:s,onDeliveredToPhoneChange:l,onDeliveryNotesChange:d,gpsLocation:u,onSubmit:h,submitting:y})=>o.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[o.jsx("h3",{style:{color:"white",marginBottom:"16px"},children:"Delivery Details"}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsx("label",{style:{display:"block",color:"white",marginBottom:"8px",fontWeight:"bold"},children:"Delivered To (Name) *"}),o.jsx("input",{type:"text",value:a,onChange:x=>s(x.target.value),placeholder:"Enter receiver's name",required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"16px"}})]}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsx("label",{style:{display:"block",color:"white",marginBottom:"8px"},children:"Contact Phone"}),o.jsx("input",{type:"tel",value:t,onChange:x=>l(x.target.value),placeholder:"Optional",style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"16px"}})]}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsx("label",{style:{display:"block",color:"white",marginBottom:"8px"},children:"Delivery Notes"}),o.jsx("textarea",{value:r,onChange:x=>d(x.target.value),placeholder:"Any additional notes about the delivery...",rows:4,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"16px",fontFamily:"inherit"}})]}),u&&o.jsxs("div",{style:{padding:"12px",backgroundColor:"#2a2a2a",borderRadius:"8px",marginBottom:"16px"},children:[o.jsx("div",{style:{color:"white",fontSize:"14px"},children:"📍 GPS Location Captured"}),o.jsxs("div",{style:{color:"#aaa",fontSize:"12px",marginTop:"4px"},children:[u.lat.toFixed(6),", ",u.lng.toFixed(6)]})]}),o.jsx("button",{onClick:h,disabled:y||!a.trim(),style:{width:"100%",padding:"16px",backgroundColor:y||!a.trim()?"#666":"#44aa44",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:y||!a.trim()?"not-allowed":"pointer"},children:y?"Submitting POD...":"✓ Complete Delivery"})]}),db=({driverId:a})=>{const[t,r]=E.useState([]),[s,l]=E.useState(null),[d,u]=E.useState(!0),[h,y]=E.useState(!1),[x,g]=E.useState(null);E.useEffect(()=>{v();const C=setInterval(v,3e4);return()=>clearInterval(C)},[a]);const v=async()=>{u(!0);try{const C=await ot.listTasks({driver_id:a});r(C.filter(A=>["scheduled","in_progress"].includes(A.status)))}catch(C){console.error("Error loading tasks:",C)}finally{u(!1)}},b=async C=>{try{await ot.startTask(C),await v(),alert("Task started!")}catch(A){alert(`Error starting task: ${A.message}`)}},_=async(C,A)=>{try{const S={task_id:C};A==="pickup"?S.pickup_arrived_at=new Date().toISOString():S.dropoff_arrived_at=new Date().toISOString(),await ot.updateTask(S),await v(),alert(`Arrived at ${A}!`)}catch(S){alert(`Error recording arrival: ${S.message}`)}},k=C=>{g(C),y(!0)},j=async()=>{try{x&&(await ot.completeTask(x.task_id),await v(),alert("Task completed successfully!"))}catch(C){alert(`Error completing task: ${C.message}`)}};return o.jsxs("div",{className:"logistics-driver-view",style:{padding:"16px",maxWidth:"600px",margin:"0 auto"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[o.jsx("h1",{style:{fontSize:"24px",margin:0},children:"🚚 My Tasks"}),o.jsx("button",{onClick:v,style:{padding:"8px 16px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Refresh"})]}),d?o.jsx("div",{style:{textAlign:"center",padding:"40px"},children:o.jsx("p",{children:"Loading tasks..."})}):t.length===0?o.jsx("div",{style:{padding:"40px",textAlign:"center",backgroundColor:"#f9f9f9",borderRadius:"8px"},children:o.jsx("p",{children:"No active tasks"})}):o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:t.map(C=>o.jsxs("div",{style:{backgroundColor:"white",border:"2px solid #ddd",borderRadius:"8px",padding:"16px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px"},children:[o.jsx("strong",{style:{fontSize:"18px"},children:C.task_number}),o.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backgroundColor:C.status==="in_progress"?"#44aa44":"#888",color:"white"},children:C.status.toUpperCase().replace("_"," ")})]}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsxs("p",{style:{margin:"8px 0",fontSize:"16px"},children:[o.jsx("strong",{children:"📍 Pickup:"})," ",C.pickup.location]}),o.jsxs("p",{style:{margin:"8px 0",fontSize:"16px"},children:[o.jsx("strong",{children:"📍 Dropoff:"})," ",C.dropoff.location]}),o.jsx("p",{style:{margin:"8px 0",fontSize:"14px",color:"#666"},children:C.description})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[C.status==="scheduled"&&o.jsx("button",{onClick:()=>b(C.task_id),style:{padding:"12px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"▶️ Start Task"}),C.status==="in_progress"&&!C.pickup_arrived_at&&o.jsx("button",{onClick:()=>_(C.task_id,"pickup"),style:{padding:"12px",backgroundColor:"#44aa44",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"✓ Arrived at Pickup"}),C.status==="in_progress"&&C.pickup_arrived_at&&!C.dropoff_arrived_at&&o.jsx("button",{onClick:()=>_(C.task_id,"dropoff"),style:{padding:"12px",backgroundColor:"#44aa44",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"✓ Arrived at Dropoff"}),C.status==="in_progress"&&C.dropoff_arrived_at&&o.jsx("button",{onClick:()=>k(C),style:{padding:"12px",backgroundColor:"#ff9944",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"📸 Capture POD & Complete"})]})]},C.task_id))}),x&&o.jsx(ab,{isOpen:h,onClose:()=>{y(!1),g(null)},task:x,onComplete:j})]})};class ub{constructor(){this.isRunning=!1,this.unsubscribers=[]}async start(){if(this.isRunning){console.warn("Materials event consumer already running");return}console.log("🚀 Starting Materials event consumer..."),this.isRunning=!0,await this.subscribeToReadyForCollection(),await this.subscribeToUpdated(),await this.subscribeToCancelled(),await this.subscribeToOnHold(),console.log("✅ Materials event consumer started")}stop(){console.log("⏹️ Stopping Materials event consumer..."),this.unsubscribers.forEach(t=>t()),this.unsubscribers=[],this.isRunning=!1,console.log("✅ Materials event consumer stopped")}async subscribeToReadyForCollection(){const t=await Vt.subscribe(Qt.MRF_READY_FOR_COLLECTION,"logistics","auto-task-creator",async r=>{try{const s=r.data;await this.handleReadyForCollection(s)}catch(s){console.error("Error handling ready_for_collection event:",s)}});this.unsubscribers.push(t)}async subscribeToUpdated(){const t=await Vt.subscribe(Qt.MRF_UPDATED,"logistics","task-updater",async r=>{try{const s=r.data;await this.handleUpdated(s)}catch(s){console.error("Error handling updated event:",s)}});this.unsubscribers.push(t)}async subscribeToCancelled(){const t=await Vt.subscribe(Qt.MRF_CANCELLED,"logistics","task-canceller",async r=>{try{const s=r.data;await this.handleCancelled(s)}catch(s){console.error("Error handling cancelled event:",s)}});this.unsubscribers.push(t)}async subscribeToOnHold(){const t=await Vt.subscribe(Qt.MRF_ON_HOLD,"logistics","task-holder",async r=>{try{const s=r.data;await this.handleOnHold(s)}catch(s){console.error("Error handling on_hold event:",s)}});this.unsubscribers.push(t)}async handleReadyForCollection(t){console.log(`📦 MRF ${t.data.mrf_number} ready for collection - creating task...`);try{const r=await ot.createTask({type:"delivery",priority:t.data.priority,description:`Collect and deliver materials for MRF ${t.data.mrf_number}`,requester:{name:t.data.requester.name,department:t.data.requester.department,phone:t.data.requester.phone,email:t.data.requester.email},pickup:{location:t.data.pickup.location,contact:t.data.pickup.contact,phone:t.data.pickup.phone,access_notes:t.data.pickup.access_notes},dropoff:{location:t.data.delivery.location,contact:t.data.delivery.contact,phone:t.data.delivery.phone,access_notes:t.data.delivery.access_notes},load_info:{description:t.data.materials.map(s=>`${s.qty} ${s.unit} ${s.description}`).join(", "),qty:t.data.materials.reduce((s,l)=>s+l.qty,0)},requested_date:t.data.requested_date,special_instructions:t.data.special_instructions,linked_mrf_id:t.data.mrf_id});console.log(`✅ Created logistics task ${r.task_number} for MRF ${t.data.mrf_number}`),this.storeMRFTaskMapping(t.data.mrf_id,r.task_id)}catch(r){throw console.error(`❌ Failed to create task for MRF ${t.data.mrf_number}:`,r),r}}async handleUpdated(t){console.log(`🔄 MRF ${t.data.mrf_number} updated - updating task...`);try{const r=t.data.logistics_task_id||this.getMRFTaskMapping(t.data.mrf_id);if(!r){console.warn(`No task found for MRF ${t.data.mrf_id}`);return}await ot.updateTask(r,{priority:t.data.updates.priority,requested_date:t.data.updates.requested_date,special_instructions:t.data.updates.special_instructions}),console.log(`✅ Updated task ${r} for MRF ${t.data.mrf_number}`)}catch(r){console.error(`❌ Failed to update task for MRF ${t.data.mrf_number}:`,r)}}async handleCancelled(t){console.log(`❌ MRF ${t.data.mrf_number} cancelled - cancelling task...`);try{const r=t.data.logistics_task_id||this.getMRFTaskMapping(t.data.mrf_id);if(!r){console.warn(`No task found for MRF ${t.data.mrf_id}`);return}await ot.updateTask(r,{status:"cancelled"}),console.log(`✅ Cancelled task ${r} for MRF ${t.data.mrf_number}`)}catch(r){console.error(`❌ Failed to cancel task for MRF ${t.data.mrf_number}:`,r)}}async handleOnHold(t){console.log(`⏸️ MRF ${t.data.mrf_number} on hold - holding task...`);try{const r=t.data.logistics_task_id||this.getMRFTaskMapping(t.data.mrf_id);if(!r){console.warn(`No task found for MRF ${t.data.mrf_id}`);return}await ot.updateTask(r,{status:"on_hold"}),console.log(`✅ Put task ${r} on hold for MRF ${t.data.mrf_number}`)}catch(r){console.error(`❌ Failed to put task on hold for MRF ${t.data.mrf_number}:`,r)}}storeMRFTaskMapping(t,r){try{const s=this.loadMRFTaskMappings();s[t]=r,localStorage.setItem("mrf_task_mappings",JSON.stringify(s))}catch(s){console.error("Error storing MRF-Task mapping:",s)}}getMRFTaskMapping(t){return this.loadMRFTaskMappings()[t]||null}loadMRFTaskMappings(){try{const t=localStorage.getItem("mrf_task_mappings");return t?JSON.parse(t):{}}catch(t){return console.error("Error loading MRF-Task mappings:",t),{}}}getStats(){return{running:this.isRunning,subscribedStreams:this.unsubscribers.length}}}const Wl=new ub,mb="LogisticsOfflineDB",hb=1,Te={TASKS:"tasks",POD_QUEUE:"pod_queue",PHOTOS:"photos",SYNC_LOG:"sync_log"};class pb{constructor(){this.db=null,this.initPromise=null}async init(){if(!this.db)return this.initPromise?this.initPromise:(this.initPromise=new Promise((t,r)=>{const s=indexedDB.open(mb,hb);s.onerror=()=>{r(new Error("Failed to open IndexedDB"))},s.onsuccess=()=>{this.db=s.result,t()},s.onupgradeneeded=l=>{const d=l.target.result;if(!d.objectStoreNames.contains(Te.TASKS)){const u=d.createObjectStore(Te.TASKS,{keyPath:"task_id"});u.createIndex("driver_id","driver_id",{unique:!1}),u.createIndex("status","status",{unique:!1})}if(!d.objectStoreNames.contains(Te.POD_QUEUE)){const u=d.createObjectStore(Te.POD_QUEUE,{keyPath:"id"});u.createIndex("task_id","task_id",{unique:!1}),u.createIndex("synced","synced",{unique:!1})}if(d.objectStoreNames.contains(Te.PHOTOS)||d.createObjectStore(Te.PHOTOS,{keyPath:"id"}),!d.objectStoreNames.contains(Te.SYNC_LOG)){const u=d.createObjectStore(Te.SYNC_LOG,{keyPath:"id",autoIncrement:!0});u.createIndex("synced","synced",{unique:!1}),u.createIndex("timestamp","timestamp",{unique:!1})}}}),this.initPromise)}async cacheTasks(t){if(await this.init(),!this.db)throw new Error("DB not initialized");const r=this.db.transaction([Te.TASKS],"readwrite"),s=r.objectStore(Te.TASKS);for(const l of t)s.put(l);return new Promise((l,d)=>{r.oncomplete=()=>l(),r.onerror=()=>d(r.error)})}async getCachedTasks(t){if(await this.init(),!this.db)throw new Error("DB not initialized");return new Promise((r,s)=>{const d=this.db.transaction([Te.TASKS],"readonly").objectStore(Te.TASKS);let u;t?u=d.index("driver_id").getAll(t):u=d.getAll(),u.onsuccess=()=>{r(u.result||[])},u.onerror=()=>{s(u.error)}})}async queuePODUpload(t){if(await this.init(),!this.db)throw new Error("DB not initialized");const r={...t,id:`offline-pod-${Date.now()}`,captured_at:new Date().toISOString(),synced:!1};return new Promise((s,l)=>{const h=this.db.transaction([Te.POD_QUEUE],"readwrite").objectStore(Te.POD_QUEUE).add(r);h.onsuccess=()=>{s(r.id)},h.onerror=()=>{l(h.error)}})}async getUnsyncedPODs(){if(await this.init(),!this.db)throw new Error("DB not initialized");return new Promise((t,r)=>{const u=this.db.transaction([Te.POD_QUEUE],"readonly").objectStore(Te.POD_QUEUE).index("synced").getAll(!1);u.onsuccess=()=>{t(u.result||[])},u.onerror=()=>{r(u.error)}})}async markPODSynced(t){if(await this.init(),!this.db)throw new Error("DB not initialized");return new Promise((r,s)=>{const l=this.db.transaction([Te.POD_QUEUE],"readwrite"),d=l.objectStore(Te.POD_QUEUE),u=d.get(t);u.onsuccess=()=>{const h=u.result;h&&(h.synced=!0,d.put(h))},l.oncomplete=()=>r(),l.onerror=()=>s(l.error)})}async deletePOD(t){if(await this.init(),!this.db)throw new Error("DB not initialized");return new Promise((r,s)=>{const u=this.db.transaction([Te.POD_QUEUE],"readwrite").objectStore(Te.POD_QUEUE).delete(t);u.onsuccess=()=>r(),u.onerror=()=>s(u.error)})}async addToSyncLog(t){if(await this.init(),!this.db)throw new Error("DB not initialized");const r={...t,timestamp:new Date().toISOString(),retry_count:0};return new Promise((s,l)=>{const h=this.db.transaction([Te.SYNC_LOG],"readwrite").objectStore(Te.SYNC_LOG).add(r);h.onsuccess=()=>s(),h.onerror=()=>l(h.error)})}async getUnsyncedLogEntries(){if(await this.init(),!this.db)throw new Error("DB not initialized");return new Promise((t,r)=>{const u=this.db.transaction([Te.SYNC_LOG],"readonly").objectStore(Te.SYNC_LOG).index("synced").getAll(!1);u.onsuccess=()=>{t(u.result||[])},u.onerror=()=>{r(u.error)}})}async clearAllData(){if(await this.init(),!this.db)throw new Error("DB not initialized");const t=[Te.TASKS,Te.POD_QUEUE,Te.PHOTOS,Te.SYNC_LOG];return new Promise((r,s)=>{const l=this.db.transaction(t,"readwrite");for(const d of t)l.objectStore(d).clear();l.oncomplete=()=>r(),l.onerror=()=>s(l.error)})}isOnline(){return navigator.onLine}async getStorageStats(){if(await this.init(),!this.db)throw new Error("DB not initialized");const[t,r,s]=await Promise.all([this.getCachedTasks(),this.getUnsyncedPODs(),this.getUnsyncedLogEntries()]);return{cachedTasks:t.length,unsyncedPODs:r.length,unsyncedLogs:s.length}}}const gi=new pb;class fb{constructor(){this.syncInterval=null,this.isSyncing=!1,this.listeners=[]}startAutoSync(t=3e4){window.addEventListener("online",()=>{console.log("📡 Connection restored, starting sync..."),this.syncAll()}),window.addEventListener("offline",()=>{console.log("📡 Connection lost, data will be queued for sync")}),this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=window.setInterval(()=>{navigator.onLine&&!this.isSyncing&&this.syncAll()},t),navigator.onLine&&this.syncAll()}stopAutoSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null)}async syncAll(){if(this.isSyncing)return console.log("Sync already in progress, skipping..."),{success:!1,error:"Sync already in progress"};if(!navigator.onLine)return console.log("Device offline, skipping sync"),{success:!1,error:"Device offline"};this.isSyncing=!0,this.notifyListeners({syncing:!0,progress:0});const t={success:!0,podssynced:0,podsFailed:0,errors:[]};try{const r=await gi.getUnsyncedPODs();console.log(`📤 Syncing ${r.length} PODs...`);for(let s=0;s<r.length;s++){const l=r[s];try{const u=await Promise.all(l.photos.map(async(h,y)=>{const g=await(await fetch(h)).blob();return new File([g],`photo-${y+1}.jpg`,{type:"image/jpeg"})}));await Yh.createPOD({task_id:l.task_id,photos:u,signature_img:l.signature||void 0,signature_name:l.delivered_to,delivered_to:l.delivered_to,delivered_to_phone:l.delivered_to_phone,delivery_notes:l.delivery_notes,delivery_gps_lat:l.gps_lat,delivery_gps_lng:l.gps_lng}),await gi.markPODSynced(l.id),await ot.completeTask(l.task_id),await gi.deletePOD(l.id),t.podsSynced++,console.log(`✅ Synced POD for task ${l.task_id}`)}catch(u){t.podsFailed++,t.errors.push({type:"pod",id:l.id,error:u.message}),console.error(`❌ Failed to sync POD ${l.id}:`,u)}const d=(s+1)/r.length*100;this.notifyListeners({syncing:!0,progress:d})}console.log(`✅ Sync complete: ${t.podsSynced} succeeded, ${t.podsFailed} failed`)}catch(r){t.success=!1,t.error=r.message,console.error("❌ Sync error:",r)}finally{this.isSyncing=!1,this.notifyListeners({syncing:!1,progress:100})}return t}async manualSync(){return this.syncAll()}async getSyncStatus(){const t=await gi.getStorageStats();return{online:navigator.onLine,syncing:this.isSyncing,pendingPODs:t.unsyncedPODs,lastSyncAttempt:localStorage.getItem("last_sync_attempt")}}onSyncStatus(t){return this.listeners.push(t),()=>{this.listeners=this.listeners.filter(r=>r!==t)}}notifyListeners(t){this.listeners.forEach(r=>r(t))}}const Kl=new fb,gb=()=>{const[a,t]=E.useState(null),[r,s]=E.useState(null),[l,d]=E.useState(!1);E.useEffect(()=>{u();const v=Kl.onSyncStatus(_=>{s(_)}),b=setInterval(u,1e4);return()=>{v(),clearInterval(b)}},[]);const u=async()=>{try{const v={};for(const[j,C]of Object.entries(Qt)){const A=await Vt.getStreamInfo(C);v[j]={status:"healthy",lastMessage:A.lastId,messageCount:A.length}}const b=Wl.getStats(),_=await Kl.getSyncStatus();let k="healthy";b.running||(k="degraded"),!navigator.onLine&&_.pendingPODs>5&&(k="degraded"),t({overall:k,lastCheck:new Date().toISOString(),streams:v,consumer:b,sync:_})}catch(v){console.error("Error checking integration health:",v)}},h=async()=>{await Wl.start(),u()},y=()=>{Wl.stop(),u()},x=async()=>{try{const v=await Kl.manualSync();alert(`Sync complete!
PODs synced: ${v.podsSynced}
Failed: ${v.podsFailed}`),u()}catch(v){alert(`Sync failed: ${v.message}`)}},g=v=>({healthy:"✅",degraded:"⚠️",down:"❌"})[v]||"•";return a?o.jsxs("div",{style:{padding:"16px",backgroundColor:"white",borderRadius:"8px",border:"1px solid #ddd"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"16px":"0"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[o.jsx("span",{style:{fontSize:"20px"},children:g(a.overall)}),o.jsxs("div",{children:[o.jsxs("div",{style:{fontWeight:"bold",fontSize:"14px"},children:["Integration Status: ",a.overall.toUpperCase()]}),o.jsxs("div",{style:{fontSize:"11px",color:"#888"},children:["Last check: ",new Date(a.lastCheck).toLocaleTimeString()]})]})]}),o.jsx("button",{onClick:()=>d(!l),style:{padding:"6px 12px",backgroundColor:"#f0f0f0",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:l?"Hide Details":"Show Details"})]}),l&&o.jsxs("div",{children:[o.jsxs("div",{style:{padding:"12px",backgroundColor:"#f9f9f9",borderRadius:"8px",marginBottom:"12px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[o.jsx("strong",{style:{fontSize:"14px"},children:"Offline Sync"}),o.jsx("button",{onClick:x,disabled:a.sync.syncing||!navigator.onLine,style:{padding:"4px 12px",backgroundColor:a.sync.syncing||!navigator.onLine?"#ccc":"#0066cc",color:"white",border:"none",borderRadius:"4px",cursor:a.sync.syncing||!navigator.onLine?"not-allowed":"pointer",fontSize:"12px"},children:a.sync.syncing?"Syncing...":"Manual Sync"})]}),o.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:["Network: ",a.sync.online?"🟢 Online":"🔴 Offline"]}),o.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:["Pending PODs: ",a.sync.pendingPODs]}),r&&r.syncing&&o.jsx("div",{style:{marginTop:"8px",height:"6px",backgroundColor:"#e0e0e0",borderRadius:"3px",overflow:"hidden"},children:o.jsx("div",{style:{width:`${r.progress}%`,height:"100%",backgroundColor:"#0066cc",transition:"width 0.3s"}})})]}),o.jsxs("div",{style:{padding:"12px",backgroundColor:"#f9f9f9",borderRadius:"8px",marginBottom:"12px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[o.jsx("strong",{style:{fontSize:"14px"},children:"Event Consumer"}),a.consumer.running?o.jsx("button",{onClick:y,style:{padding:"4px 12px",backgroundColor:"#ff4444",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Stop"}):o.jsx("button",{onClick:h,style:{padding:"4px 12px",backgroundColor:"#44aa44",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Start"})]}),o.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:["Status: ",a.consumer.running?"🟢 Running":"🔴 Stopped"]}),o.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Subscribed Streams: ",a.consumer.subscribedStreams]})]}),o.jsxs("div",{style:{padding:"12px",backgroundColor:"#f9f9f9",borderRadius:"8px"},children:[o.jsx("strong",{style:{fontSize:"14px",display:"block",marginBottom:"8px"},children:"Event Streams"}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:Object.entries(a.streams).map(([v,b])=>o.jsxs("div",{style:{padding:"8px",backgroundColor:"white",borderRadius:"4px",border:"1px solid #ddd"},children:[o.jsx("div",{style:{fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:v.replace(/_/g," ")}),o.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:["Messages: ",b.messageCount]})]},v))})]}),o.jsx("button",{onClick:u,style:{width:"100%",marginTop:"12px",padding:"8px",backgroundColor:"#f0f0f0",border:"1px solid #ddd",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"🔄 Refresh Status"})]})]}):o.jsx("div",{style:{padding:"12px",backgroundColor:"#f9f9f9",borderRadius:"8px",textAlign:"center",color:"#888"},children:"Loading integration status..."})},yb=()=>{const[a,t]=E.useState("drivers"),[r,s]=E.useState([]),[l,d]=E.useState([]),[u,h]=E.useState(!0);E.useEffect(()=>{y()},[]);const y=async()=>{h(!0);try{const[v,b]=await Promise.all([cc.listDrivers(),dc.listVehicles()]);s(v),d(b)}catch(v){console.error("Error loading data:",v)}finally{h(!1)}},x=async()=>{const v=prompt("Driver Name:");if(!v)return;const b=prompt("Phone Number:");if(b)try{await cc.createDriver({name:v,phone:b}),await y(),alert("Driver added successfully!")}catch(_){alert(`Error adding driver: ${_.message}`)}},g=async()=>{const v=prompt("Vehicle Registration:");if(!v)return;const b=prompt("Vehicle Type (truck/van/forklift/crane/ute/other):");if(b)try{await dc.createVehicle({registration:v,vehicle_type:b}),await y(),alert("Vehicle added successfully!")}catch(_){alert(`Error adding vehicle: ${_.message}`)}};return o.jsxs("div",{className:"logistics-config-view",style:{padding:"20px"},children:[o.jsx("h1",{children:"⚙️ Logistics Configuration"}),o.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[o.jsx("button",{onClick:()=>t("drivers"),style:{padding:"10px 20px",backgroundColor:a==="drivers"?"#0066cc":"#f0f0f0",color:a==="drivers"?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Drivers"}),o.jsx("button",{onClick:()=>t("vehicles"),style:{padding:"10px 20px",backgroundColor:a==="vehicles"?"#0066cc":"#f0f0f0",color:a==="vehicles"?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Vehicles"}),o.jsx("button",{onClick:()=>t("integration"),style:{padding:"10px 20px",backgroundColor:a==="integration"?"#0066cc":"#f0f0f0",color:a==="integration"?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Integration"}),o.jsx("button",{onClick:()=>t("settings"),style:{padding:"10px 20px",backgroundColor:a==="settings"?"#0066cc":"#f0f0f0",color:a==="settings"?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Settings"})]}),u?o.jsx("div",{style:{textAlign:"center",padding:"40px"},children:o.jsx("p",{children:"Loading..."})}):o.jsxs(o.Fragment,{children:[a==="drivers"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[o.jsxs("h2",{children:["Drivers (",r.length,")"]}),o.jsx("button",{onClick:x,style:{padding:"10px 20px",backgroundColor:"#44aa44",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"+ Add Driver"})]}),o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"white"},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Name"}),o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Phone"}),o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Status"}),o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Tasks Completed"}),o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Available"})]})}),o.jsx("tbody",{children:r.map(v=>o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #ddd"},children:v.name}),o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #ddd"},children:v.phone}),o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #ddd"},children:o.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",backgroundColor:v.status==="active"?"#44aa44":"#888",color:"white"},children:v.status})}),o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #ddd"},children:v.tasks_completed}),o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #ddd"},children:v.availability?"✓":"✗"})]},v.driver_id))})]})]}),a==="vehicles"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[o.jsxs("h2",{children:["Vehicles (",l.length,")"]}),o.jsx("button",{onClick:g,style:{padding:"10px 20px",backgroundColor:"#44aa44",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"+ Add Vehicle"})]}),o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"white"},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Registration"}),o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Type"}),o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Make/Model"}),o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Status"}),o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Tasks Completed"})]})}),o.jsx("tbody",{children:l.map(v=>o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #ddd"},children:v.registration}),o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #ddd"},children:v.vehicle_type}),o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #ddd"},children:v.make&&v.model?`${v.make} ${v.model}`:"-"}),o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #ddd"},children:o.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",backgroundColor:v.status==="available"?"#44aa44":"#888",color:"white"},children:v.status})}),o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #ddd"},children:v.total_tasks})]},v.vehicle_id))})]})]}),a==="integration"&&o.jsxs("div",{children:[o.jsx("h2",{children:"Materials Integration"}),o.jsx("div",{style:{marginBottom:"24px"},children:o.jsx(gb,{})}),o.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #ddd",borderRadius:"8px",padding:"20px"},children:[o.jsx("h3",{style:{marginBottom:"12px"},children:"Event-Driven Integration"}),o.jsx("p",{style:{color:"#666",marginBottom:"16px"},children:"The Logistics App integrates with the Materials app via Redis Streams for real-time event communication."}),o.jsx("h4",{style:{marginBottom:"8px"},children:"Materials → Logistics Events:"}),o.jsxs("ul",{style:{color:"#666",marginBottom:"16px"},children:[o.jsx("li",{children:"✅ MRF Ready for Collection (auto-creates logistics task)"}),o.jsx("li",{children:"✅ MRF Updated (updates logistics task)"}),o.jsx("li",{children:"✅ MRF Cancelled (cancels logistics task)"}),o.jsx("li",{children:"✅ MRF On Hold (holds logistics task)"})]}),o.jsx("h4",{style:{marginBottom:"8px"},children:"Logistics → Materials Events:"}),o.jsxs("ul",{style:{color:"#666"},children:[o.jsx("li",{children:"✅ Task Accepted (driver assigned)"}),o.jsx("li",{children:"✅ Task In Transit (materials picked up)"}),o.jsx("li",{children:"✅ Task Delivered (POD captured)"}),o.jsx("li",{children:"✅ Task Exception (issues reported)"})]})]})]}),a==="settings"&&o.jsxs("div",{children:[o.jsx("h2",{children:"System Settings"}),o.jsx("div",{style:{backgroundColor:"white",border:"1px solid #ddd",borderRadius:"8px",padding:"20px"},children:o.jsx("p",{children:"Coming soon: Request types, SLA configuration, site zones, notification rules, etc."})})]})]})]})};class xb{async generateKPIDashboard(t){const s=st.getConfig().reporting.dashboard.default_kpis,l=[],d=await this.getTasksForPeriod(t);if(s.includes("total_tasks")&&l.push({id:"total_tasks",label:"Total Tasks",value:d.length,format:"number",icon:"📋",color:"#0066cc"}),s.includes("completed_tasks")){const u=d.filter(y=>y.status==="completed"||y.status==="closed").length,h=d.length>0?u/d.length*100:0;l.push({id:"completed_tasks",label:"Completed",value:u,change:h,trend:h>80?"up":h>50?"neutral":"down",format:"number",icon:"✅",color:"#44aa44"})}if(s.includes("in_progress")){const u=d.filter(h=>h.status==="in_progress").length;l.push({id:"in_progress",label:"In Progress",value:u,format:"number",icon:"🚚",color:"#ff9944"})}if(s.includes("exceptions")){const u=d.filter(y=>y.status==="exception").length,h=d.length>0?u/d.length*100:0;l.push({id:"exceptions",label:"Exceptions",value:u,change:h,trend:h<5?"up":h<10?"neutral":"down",format:"number",icon:"⚠️",color:"#ff4444"})}if(s.includes("sla_compliance")){const u=this.calculateSLACompliance(d);l.push({id:"sla_compliance",label:"SLA Compliance",value:`${u}%`,change:u,trend:u>90?"up":u>75?"neutral":"down",format:"percentage",icon:"⏱️",color:u>90?"#44aa44":u>75?"#ff9944":"#ff4444"})}if(s.includes("avg_turnaround")){const u=this.calculateAverageTurnaround(d);l.push({id:"avg_turnaround",label:"Avg Turnaround",value:this.formatDuration(u),format:"duration",icon:"⏰",color:"#0066cc"})}return l}async generateReport(t,r){const s=st.getConfig(),l=s.reporting.templates.find(g=>g.id===t);if(!l)throw new Error(`Report template ${t} not found`);const d=await this.getTasksForPeriod(),u=this.applyFilters(d,{...l.filters,...r}),h=this.groupData(u,l.grouping),y=this.sortData(h,l.sorting),x={title:l.name,generated_at:new Date().toISOString(),site_id:s.site_id,date_range:{start:(r==null?void 0:r.start_date)||new Date(Date.now()-720*60*60*1e3).toISOString(),end:(r==null?void 0:r.end_date)||new Date().toISOString()},data:y,summary:this.generateSummary(u)};return l.charts&&l.charts.length>0&&(x.charts=l.charts.map(g=>this.generateChart(u,g))),x}async generateDriverPerformanceReport(t){var d;const r=await this.getTasksForPeriod(t),s=new Map;r.forEach(u=>{if(!u.driver)return;const h=u.driver.driver_id;s.has(h)||s.set(h,{driver_id:h,driver_name:u.driver.name,total_tasks:0,completed_tasks:0,in_progress_tasks:0,exception_tasks:0,avg_completion_time:0,sla_compliance_rate:0,pod_quality_score:0});const y=s.get(h);y.total_tasks++,u.status==="completed"||u.status==="closed"?y.completed_tasks++:u.status==="in_progress"?y.in_progress_tasks++:u.status==="exception"&&y.exception_tasks++});const l=Array.from(s.values()).map(u=>(u.completion_rate=u.total_tasks>0?(u.completed_tasks/u.total_tasks*100).toFixed(1)+"%":"0%",u.exception_rate=u.total_tasks>0?(u.exception_tasks/u.total_tasks*100).toFixed(1)+"%":"0%",u));return{title:"Driver Performance Report",generated_at:new Date().toISOString(),site_id:st.getCurrentSiteId(),date_range:t||{start:new Date(Date.now()-720*60*60*1e3).toISOString(),end:new Date().toISOString()},data:l,summary:{total_drivers:l.length,avg_tasks_per_driver:l.length>0?(l.reduce((u,h)=>u+h.total_tasks,0)/l.length).toFixed(1):0,top_performer:((d=l.sort((u,h)=>h.completed_tasks-u.completed_tasks)[0])==null?void 0:d.driver_name)||"N/A"}}}async generateDailySummary(t){const r=t?new Date(t):new Date,s=new Date(r.setHours(0,0,0,0)).toISOString(),l=new Date(r.setHours(23,59,59,999)).toISOString(),d=await this.getTasksForPeriod({start:s,end:l}),u={total_tasks:d.length,new_tasks:d.filter(h=>h.status==="new").length,scheduled_tasks:d.filter(h=>h.status==="scheduled").length,in_progress_tasks:d.filter(h=>h.status==="in_progress").length,completed_tasks:d.filter(h=>h.status==="completed"||h.status==="closed").length,exception_tasks:d.filter(h=>h.status==="exception").length,on_hold_tasks:d.filter(h=>h.status==="on_hold").length,cancelled_tasks:d.filter(h=>h.status==="cancelled").length,by_priority:{critical:d.filter(h=>h.priority==="critical").length,high:d.filter(h=>h.priority==="high").length,normal:d.filter(h=>h.priority==="normal").length,low:d.filter(h=>h.priority==="low").length},sla_compliance:this.calculateSLACompliance(d),avg_turnaround:this.calculateAverageTurnaround(d)};return{title:`Daily Summary - ${r.toLocaleDateString()}`,generated_at:new Date().toISOString(),site_id:st.getCurrentSiteId(),date_range:{start:s,end:l},data:d,summary:u}}exportToCSV(t){if(t.data.length===0)return"";const r=Object.keys(t.data[0]);let s=r.join(",")+`
`;return t.data.forEach(l=>{const d=r.map(u=>{const h=l[u];return typeof h=="string"&&(h.includes(",")||h.includes('"'))?`"${h.replace(/"/g,'""')}"`:h||""});s+=d.join(",")+`
`}),s}downloadCSV(t){const r=this.exportToCSV(t),s=new Blob([r],{type:"text/csv"}),l=URL.createObjectURL(s),d=document.createElement("a");d.href=l,d.download=`${t.title.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.csv`,d.click(),URL.revokeObjectURL(l)}async getTasksForPeriod(t){const r=await ot.listTasks({});return t?r.filter(s=>{const l=new Date(s.created_at),d=new Date(t.start),u=new Date(t.end);return l>=d&&l<=u}):r}calculateSLACompliance(t){if(t.length===0)return 100;const r=t.filter(l=>l.status==="completed"||l.status==="closed");if(r.length===0)return 100;const s=r.filter(l=>!l.sla_target_at||!l.completed_at?!0:new Date(l.completed_at)<=new Date(l.sla_target_at)).length;return Math.round(s/r.length*100)}calculateAverageTurnaround(t){const r=t.filter(l=>(l.status==="completed"||l.status==="closed")&&l.completed_at&&l.created_at);if(r.length===0)return 0;const s=r.reduce((l,d)=>{const u=new Date(d.created_at).getTime(),h=new Date(d.completed_at).getTime();return l+(h-u)},0);return Math.round(s/r.length)}formatDuration(t){const r=Math.floor(t/36e5),s=Math.floor(t%(1e3*60*60)/(1e3*60));return r>24?`${Math.floor(r/24)}d ${r%24}h`:`${r}h ${s}m`}applyFilters(t,r){let s=[...t];return r.status&&(s=s.filter(l=>l.status===r.status)),r.priority&&(s=s.filter(l=>l.priority===r.priority)),r.type&&(s=s.filter(l=>l.type===r.type)),r.driver_id&&(s=s.filter(l=>{var d;return((d=l.driver)==null?void 0:d.driver_id)===r.driver_id})),s}groupData(t,r){if(!r||r.length===0)return t;const s=new Map,l=r[0];return t.forEach(d=>{const u=d[l]||"Unknown";s.has(u)||s.set(u,[]),s.get(u).push(d)}),Array.from(s.entries()).map(([d,u])=>({[l]:d,count:u.length,items:u}))}sortData(t,r){if(!r||r.length===0)return t;const s=[...t],{field:l,direction:d}=r[0];return s.sort((u,h)=>{const y=u[l],x=h[l];return y<x?d==="asc"?-1:1:y>x?d==="asc"?1:-1:0}),s}generateSummary(t){return{total_count:t.length,by_status:this.countByField(t,"status"),by_priority:this.countByField(t,"priority"),by_type:this.countByField(t,"type")}}countByField(t,r){const s={};return t.forEach(l=>{const d=String(l[r]||"Unknown");s[d]=(s[d]||0)+1}),s}generateChart(t,r){r.data_field;const s=r.label_field,l=this.countByField(t,s);return{type:r.type,title:`Tasks by ${s}`,labels:Object.keys(l),datasets:[{label:"Count",data:Object.values(l),backgroundColor:this.generateColors(Object.keys(l).length)}]}}generateColors(t){const r=["#0066cc","#44aa44","#ff9944","#ff4444","#9944ff","#44cccc","#ff44cc","#cccc44"];return Array.from({length:t},(s,l)=>r[l%r.length])}}const yi=new xb,vb=()=>{const[a,t]=E.useState("dashboard"),[r,s]=E.useState([]),[l,d]=E.useState(!0),[u,h]=E.useState("today"),[y,x]=E.useState(null),[g,v]=E.useState(null);E.useEffect(()=>{a==="dashboard"?b():a==="daily"?_():a==="driver"&&k()},[a,u]),E.useEffect(()=>{const D=st.getConfig().reporting.dashboard.refresh_interval_seconds*1e3,L=setInterval(()=>{a==="dashboard"&&b()},D);return()=>clearInterval(L)},[a]);const b=async()=>{d(!0);try{const S=j(u),D=await yi.generateKPIDashboard(S);s(D)}catch(S){console.error("Error loading KPIs:",S)}finally{d(!1)}},_=async()=>{d(!0);try{const S=await yi.generateDailySummary();x(S)}catch(S){console.error("Error loading daily summary:",S)}finally{d(!1)}},k=async()=>{d(!0);try{const S=j(u),D=await yi.generateDriverPerformanceReport(S);v(D)}catch(S){console.error("Error loading driver report:",S)}finally{d(!1)}},j=S=>{const D=new Date;let L;switch(S){case"today":L=new Date(D.setHours(0,0,0,0));break;case"week":L=new Date(D.setDate(D.getDate()-7));break;case"month":L=new Date(D.setDate(D.getDate()-30));break;default:L=new Date(D.setHours(0,0,0,0))}return{start:L.toISOString(),end:new Date().toISOString()}},C=S=>{S&&yi.downloadCSV(S)},A=st.getConfig();return o.jsxs("div",{className:"logistics-reports-view",style:{padding:"20px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[o.jsxs("div",{children:[o.jsx("h1",{style:{margin:0,marginBottom:"8px"},children:"📊 Reports & Analytics"}),o.jsxs("p",{style:{margin:0,color:"#666",fontSize:"14px"},children:["Site: ",A.site_name," (",A.site_code,")"]})]}),o.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[o.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"Period:"}),o.jsxs("select",{value:u,onChange:S=>h(S.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"},children:[o.jsx("option",{value:"today",children:"Today"}),o.jsx("option",{value:"week",children:"Last 7 Days"}),o.jsx("option",{value:"month",children:"Last 30 Days"})]})]})]}),o.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"24px",borderBottom:"1px solid #ddd",paddingBottom:"0"},children:[{key:"dashboard",label:"📊 Dashboard",enabled:!0},{key:"daily",label:"📅 Daily Summary",enabled:!0},{key:"driver",label:"👤 Driver Performance",enabled:!0},{key:"custom",label:"📝 Custom Reports",enabled:A.features.advanced_reports}].map(S=>S.enabled&&o.jsx("button",{onClick:()=>t(S.key),style:{padding:"12px 20px",border:"none",backgroundColor:"transparent",borderBottom:a===S.key?"3px solid #0066cc":"none",color:a===S.key?"#0066cc":"#666",fontWeight:a===S.key?"bold":"normal",cursor:"pointer",fontSize:"14px"},children:S.label},S.key))}),l?o.jsxs("div",{style:{textAlign:"center",padding:"60px",color:"#888"},children:[o.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"⏳"}),o.jsx("div",{children:"Loading report data..."})]}):o.jsxs(o.Fragment,{children:[a==="dashboard"&&o.jsxs("div",{children:[o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px",marginBottom:"32px"},children:r.map(S=>o.jsx(bb,{kpi:S},S.id))}),r.length===0&&o.jsxs("div",{style:{padding:"40px",textAlign:"center",backgroundColor:"#f9f9f9",borderRadius:"8px",color:"#888"},children:[o.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"📊"}),o.jsx("div",{children:"No KPI data available for this period"})]})]}),a==="daily"&&y&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[o.jsx("h2",{style:{margin:0},children:y.title}),o.jsx("button",{onClick:()=>C(y),style:{padding:"8px 16px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"📥 Download CSV"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"16px",marginBottom:"32px"},children:[o.jsx(Cr,{label:"Total Tasks",value:y.summary.total_tasks,color:"#0066cc"}),o.jsx(Cr,{label:"Completed",value:y.summary.completed_tasks,color:"#44aa44"}),o.jsx(Cr,{label:"In Progress",value:y.summary.in_progress_tasks,color:"#ff9944"}),o.jsx(Cr,{label:"Exceptions",value:y.summary.exception_tasks,color:"#ff4444"}),o.jsx(Cr,{label:"On Hold",value:y.summary.on_hold_tasks,color:"#888"})]}),o.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #ddd",borderRadius:"8px",padding:"20px"},children:[o.jsx("h3",{style:{marginTop:0},children:"By Priority"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[o.jsx(xi,{label:"Critical",count:y.summary.by_priority.critical,color:"#ff4444"}),o.jsx(xi,{label:"High",count:y.summary.by_priority.high,color:"#ff9944"}),o.jsx(xi,{label:"Normal",count:y.summary.by_priority.normal,color:"#44aa44"}),o.jsx(xi,{label:"Low",count:y.summary.by_priority.low,color:"#888"})]})]})]}),a==="driver"&&g&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[o.jsx("h2",{style:{margin:0},children:g.title}),o.jsx("button",{onClick:()=>C(g),style:{padding:"8px 16px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"📥 Download CSV"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",marginBottom:"24px"},children:[o.jsx(Cr,{label:"Total Drivers",value:g.summary.total_drivers,color:"#0066cc"}),o.jsx(Cr,{label:"Avg Tasks/Driver",value:g.summary.avg_tasks_per_driver,color:"#44aa44"}),o.jsx(Cr,{label:"Top Performer",value:g.summary.top_performer,color:"#ff9944"})]}),o.jsx("div",{style:{backgroundColor:"white",border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[o.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #ddd"},children:"Driver"}),o.jsx("th",{style:{padding:"12px",textAlign:"right",borderBottom:"2px solid #ddd"},children:"Total Tasks"}),o.jsx("th",{style:{padding:"12px",textAlign:"right",borderBottom:"2px solid #ddd"},children:"Completed"}),o.jsx("th",{style:{padding:"12px",textAlign:"right",borderBottom:"2px solid #ddd"},children:"In Progress"}),o.jsx("th",{style:{padding:"12px",textAlign:"right",borderBottom:"2px solid #ddd"},children:"Exceptions"}),o.jsx("th",{style:{padding:"12px",textAlign:"right",borderBottom:"2px solid #ddd"},children:"Completion Rate"})]})}),o.jsx("tbody",{children:g.data.map(S=>o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"12px",borderBottom:"1px solid #f0f0f0"},children:o.jsx("strong",{children:S.driver_name})}),o.jsx("td",{style:{padding:"12px",textAlign:"right",borderBottom:"1px solid #f0f0f0"},children:S.total_tasks}),o.jsx("td",{style:{padding:"12px",textAlign:"right",borderBottom:"1px solid #f0f0f0"},children:S.completed_tasks}),o.jsx("td",{style:{padding:"12px",textAlign:"right",borderBottom:"1px solid #f0f0f0"},children:S.in_progress_tasks}),o.jsx("td",{style:{padding:"12px",textAlign:"right",borderBottom:"1px solid #f0f0f0"},children:S.exception_tasks}),o.jsx("td",{style:{padding:"12px",textAlign:"right",borderBottom:"1px solid #f0f0f0"},children:o.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",backgroundColor:parseFloat(S.completion_rate)>80?"#e8f5e9":"#fff3e0",color:parseFloat(S.completion_rate)>80?"#44aa44":"#ff9944",fontWeight:"bold"},children:S.completion_rate})})]},S.driver_id))})]})})]}),a==="custom"&&o.jsxs("div",{style:{padding:"60px",textAlign:"center",backgroundColor:"#f9f9f9",borderRadius:"8px"},children:[o.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"📝"}),o.jsx("h3",{children:"Custom Report Builder"}),o.jsx("p",{style:{color:"#666"},children:"Coming soon - Build your own custom reports with drag-and-drop fields"})]})]})]})},bb=({kpi:a})=>o.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #ddd",borderRadius:"12px",padding:"20px",position:"relative",overflow:"hidden"},children:[o.jsx("div",{style:{position:"absolute",top:0,left:0,width:"4px",height:"100%",backgroundColor:a.color}}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px"},children:[o.jsx("span",{style:{fontSize:"14px",color:"#666"},children:a.label}),o.jsx("span",{style:{fontSize:"24px"},children:a.icon})]}),o.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",marginBottom:"8px",color:a.color},children:a.value}),a.change!==void 0&&o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"12px"},children:[o.jsx("span",{style:{color:a.trend==="up"?"#44aa44":a.trend==="down"?"#ff4444":"#888"},children:a.trend==="up"?"↑":a.trend==="down"?"↓":"→"}),o.jsx("span",{style:{color:"#666"},children:typeof a.change=="number"?`${a.change.toFixed(1)}%`:a.change})]})]}),Cr=({label:a,value:t,color:r})=>o.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #ddd",borderRadius:"8px",padding:"16px",textAlign:"center"},children:[o.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px"},children:a}),o.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:r},children:t})]}),xi=({label:a,count:t,color:r})=>o.jsxs("div",{style:{padding:"16px",backgroundColor:r+"20",borderRadius:"8px",border:`2px solid ${r}`,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:r},children:t}),o.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:a})]}),wb=({user:a})=>c.createElement("div",{className:"p-8 border-4 border-dashed border-gray-200 rounded-lg bg-white h-full flex items-center justify-center"},c.createElement("div",{className:"text-center"},c.createElement("h2",{className:"text-2xl font-bold text-gray-700"},`${a.role} Dashboard`),c.createElement("p",{className:"text-gray-500 mt-2"},`Interface for ${a.name} would be displayed here.`))),_b=()=>{var D,L;const[a,t]=E.useState(Or.requestor),[r,s]=E.useState("hub"),[l,d]=E.useState(null),[u,h]=E.useState({isOpen:!1,request:null}),[y,x]=E.useState(!1),[g,v]=E.useState(!1);E.useEffect(()=>{fy({onQuickSearch:()=>{const M=document.querySelector('input[type="search"], input[placeholder*="Search"]');M?(M.focus(),v(!0)):s("material-requests")},onNewRequest:()=>{(a.id==="requestor"||a.id==="ac")&&s("wo-materials")},onShowHelp:()=>{x(!0)}})},[a]),E.useEffect(()=>{var M,q;if(r!=="hub"){const Q=((q=(M=Nm[a.id])==null?void 0:M[0])==null?void 0:q.view)||"dashboard";s(Q)}},[a.id]);const b=M=>{t(M)},_=(M,q=null)=>{s(M),d(q)},k=M=>h({isOpen:!0,request:M}),j=()=>h({isOpen:!1,request:null}),C={hub:{title:"Operations Hub",component:()=>c.createElement(Sg,{currentUser:a,onNavigate:_,onUserChange:b})},"wo-materials":{title:"Work Order Materials",component:()=>c.createElement(Yg,{openDetailPanel:k,currentUser:a,navigate:_})},"material-requests":{title:"Material Requests",component:()=>c.createElement(o0,{openDetailPanel:k,navigate:_})},picklist:{title:"Warehouse Pick List",component:()=>c.createElement(u0,{openDetailPanel:k,navigate:_,currentUser:a})},onhold:{title:"On Hold Requests",component:()=>c.createElement(k0,{navigate:_})},picking:{title:"Picking In Progress",component:()=>c.createElement(w0,{params:l,navigate:_})},"ac-scope-command":{title:"Scope Command: Welding",component:()=>c.createElement(S0,{openDetailPanel:k,navigate:_})},"p1-approval":{title:"P1 Approval Queue",component:()=>c.createElement(ly,{navigate:_})},"priority-queue":{title:"Priority Queue Management",component:()=>c.createElement(cy,{navigate:_,currentUser:a})},"workflow-diagram":{title:"Workflow Diagram",component:()=>c.createElement(uy,{})},"location-management":{title:"Delivery Locations",component:()=>c.createElement(my,{navigate:_})},"control-panel":{title:"Control Panel",component:()=>c.createElement(B0,{})},"exception-dashboard":{title:"Partial Picks Dashboard",component:()=>c.createElement(U0,{})},integrations:{title:"Integrations & Notifications",component:()=>c.createElement(iy,{})},"logistics-dispatcher":{title:"Logistics Dispatcher",component:()=>c.createElement(nb,{})},"logistics-driver":{title:"Driver Tasks",component:()=>c.createElement(db,{driverId:"demo-driver-1"})},"logistics-config":{title:"Logistics Configuration",component:()=>c.createElement(yb,{})},"logistics-reports":{title:"Reports & Analytics",component:()=>c.createElement(vb,{})}},A=((D=C[r])==null?void 0:D.component)||(()=>c.createElement(wb,{user:a})),S=((L=C[r])==null?void 0:L.title)||"Dashboard";return r==="hub"?c.createElement("div",{className:"min-h-screen bg-gray-50 font-sans"},c.createElement(A,null),c.createElement(Pm,{...u,onClose:j,currentUser:a}),c.createElement(Fm,{isOpen:y,onClose:()=>x(!1)})):c.createElement("div",{className:"flex h-screen bg-gray-50 font-sans"},c.createElement(pg,{currentUser:a,onUserChange:b,currentView:r,onNavigate:_,navLinks:Nm}),c.createElement("div",{className:"flex-1 flex flex-col overflow-hidden"},c.createElement(wg,{title:S,user:a,currentView:r}),c.createElement("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6"},c.createElement(A,null))),c.createElement(Pm,{...u,onClose:j,currentUser:a}),c.createElement(Fm,{isOpen:y,onClose:()=>x(!1)}))},kb=()=>{const a=new Uint8Array(32);return crypto.getRandomValues(a),Array.from(a,t=>t.toString(16).padStart(2,"0")).join("")},Eb=a=>{sessionStorage.setItem("csrf_token",a)},Sb=()=>sessionStorage.getItem("csrf_token"),Nb=()=>{let a=Sb();return a||(a=kb(),Eb(a)),console.log("🔒 CSRF protection initialized"),a},Vl={"Content-Security-Policy":["default-src 'self'","script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://esm.sh https://aistudiocdn.com","style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com","img-src 'self' data: https:","font-src 'self' data:","connect-src 'self' https://esm.sh https://aistudiocdn.com","frame-ancestors 'none'","base-uri 'self'","form-action 'self'"].join("; "),"X-Frame-Options":"DENY","Referrer-Policy":"strict-origin-when-cross-origin"},jb=()=>{const a=document.head,t=document.createElement("meta");t.httpEquiv="Content-Security-Policy",t.content=Vl["Content-Security-Policy"],a.appendChild(t);const r=document.createElement("meta");r.httpEquiv="X-Frame-Options",r.content=Vl["X-Frame-Options"],a.appendChild(r);const s=document.createElement("meta");s.name="referrer",s.content=Vl["Referrer-Policy"],a.appendChild(s),console.log("🔒 Security headers applied")},Cb=()=>{let t=Date.now();const r=()=>{Date.now()-t>18e5&&(console.warn("🔒 Session expired"),sessionStorage.clear(),window.location.href="/")},s=()=>{t=Date.now()};["mousedown","keydown","scroll","touchstart"].forEach(l=>{document.addEventListener(l,s,{passive:!0})}),setInterval(r,6e4),console.log("🔒 Secure session management initialized")},Tb=()=>{Nb(),jb(),Cb(),console.log("🔒 Security features initialized")},bc="auth_token",wc="refresh_token",_c="current_user",xh=(a,t=60)=>{const r=btoa(JSON.stringify({alg:"HS256",typ:"JWT"})),s=btoa(JSON.stringify({sub:a.name,role:a.role,permissions:a.permissions,iat:Date.now(),exp:Date.now()+t*60*1e3})),l=btoa(`mock_signature_${a.name}_${Date.now()}`);return`${r}.${s}.${l}`},Xh=a=>{try{const t=a.split(".");if(t.length!==3)throw new Error("Invalid token format");return JSON.parse(atob(t[1]))}catch(t){return console.error("Failed to parse JWT:",t),null}},Zh=a=>{const t=Xh(a);return!t||!t.exp?!0:Date.now()>=t.exp},Pb=(a,t)=>{localStorage.setItem(bc,a.accessToken),localStorage.setItem(wc,a.refreshToken),localStorage.setItem(_c,JSON.stringify(t)),console.log("🔑 Auth tokens stored")},ep=()=>localStorage.getItem(bc),Rb=()=>localStorage.getItem(wc),kc=()=>{const a=localStorage.getItem(_c);if(!a)return null;try{return JSON.parse(a)}catch{return null}},tp=()=>{localStorage.removeItem(bc),localStorage.removeItem(wc),localStorage.removeItem(_c),console.log("🔑 Auth tokens cleared")},rp=async()=>{const a=Rb(),t=kc();if(!a||!t)return null;if(Zh(a))return console.warn("🔑 Refresh token expired"),tp(),null;await new Promise(d=>setTimeout(d,200));const r=xh(t,60),s=xh(t,10080),l={accessToken:r,refreshToken:s,expiresAt:Date.now()+3600*1e3};return Pb(l,t),console.log("🔑 Access token refreshed"),l},Db=()=>{const a=ep(),t=kc();return!a||!t?!1:Zh(a)?(rp().catch(()=>{tp()}),!1):!0},Ob=()=>{const a=setInterval(async()=>{const t=ep();if(!t)return;const r=Xh(t);if(!r||!r.exp)return;const s=r.exp-Date.now(),l=600*1e3;s<l&&s>0&&(console.log("🔑 Token expiring soon, refreshing..."),await rp())},3e5);return console.log("🔑 Automatic token refresh enabled"),()=>{clearInterval(a)}},Ab=()=>{if(Ob(),Db()){const a=kc();console.log(`🔑 User session restored: ${a==null?void 0:a.name}`)}console.log("🔑 Authentication service initialized")},Ib={BASE_URL:"/SCM-Hub-V4/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Kt=(a,t="")=>Ib[a]||t,nr=(a,t=!1)=>{const r=Kt(a);return r===""?t:r==="true"||r==="1"},Tr=(a,t=0)=>{const r=Kt(a);return r===""?t:parseInt(r,10)},Lb=()=>{const a={app:{name:Kt("VITE_APP_NAME","SCM Hub"),version:Kt("VITE_APP_VERSION","4.0.0"),url:Kt("VITE_APP_URL","http://localhost:5173"),environment:Kt("NODE_ENV","development")},api:{baseUrl:Kt("VITE_API_BASE_URL","/api"),timeout:Tr("VITE_API_TIMEOUT",3e4),retryAttempts:Tr("VITE_API_RETRY_ATTEMPTS",3)},auth:{tokenExpiry:Tr("VITE_AUTH_TOKEN_EXPIRY",3600),refreshTokenExpiry:Tr("VITE_AUTH_REFRESH_TOKEN_EXPIRY",604800),sessionTimeout:Tr("VITE_SESSION_TIMEOUT",18e5)},security:{csrfEnabled:nr("VITE_CSRF_ENABLED",!0),rateLimitMaxRequests:Tr("VITE_RATE_LIMIT_MAX_REQUESTS",100),rateLimitWindowMs:Tr("VITE_RATE_LIMIT_WINDOW_MS",6e4),enforceHttps:nr("VITE_ENFORCE_HTTPS",!0)},features:{enableP1Approval:nr("VITE_ENABLE_P1_APPROVAL",!0),enableOfflineMode:nr("VITE_ENABLE_OFFLINE_MODE",!0),enablePhotoUpload:nr("VITE_ENABLE_PHOTO_UPLOAD",!0),enableNotifications:nr("VITE_ENABLE_NOTIFICATIONS",!0),enableAnalytics:nr("VITE_ENABLE_ANALYTICS",!1)},monitoring:{sentryDsn:Kt("VITE_SENTRY_DSN"),logLevel:Kt("VITE_LOG_LEVEL","info"),enablePerformanceMonitoring:nr("VITE_ENABLE_PERFORMANCE_MONITORING",!0),enableErrorTracking:nr("VITE_ENABLE_ERROR_TRACKING",!0)},storage:{maxFileSize:Tr("VITE_MAX_FILE_SIZE",10485760),allowedFileTypes:Kt("VITE_ALLOWED_FILE_TYPES","image/jpeg,image/png,image/gif,application/pdf").split(",")}};return a.app.environment==="production"&&(a.api.baseUrl||console.error("❌ VITE_API_BASE_URL is required in production"),a.security.enforceHttps&&!a.app.url.startsWith("https://")&&console.warn("⚠️ HTTPS is enforced but app URL is not HTTPS")),a},or=Lb();console.log(`🔧 Environment: ${or.app.environment}`);console.log(`🔧 API Base URL: ${or.api.baseUrl}`);const nn=[],np=100,vh=(a,t,r)=>{const s={message:a,stack:t==null?void 0:t.stack,level:"error",timestamp:new Date().toISOString(),context:r,userId:Ec()};nn.push(s),nn.length>np&&nn.shift(),console.error(`❌ [${s.timestamp}] ${a}`,{error:t,context:r}),or.monitoring.enableErrorTracking&&or.monitoring.sentryDsn&&Wb(s)},Mb=(a,t)=>{const r={message:a,level:"warn",timestamp:new Date().toISOString(),context:t,userId:Ec()};nn.push(r),nn.length>np&&nn.shift(),console.warn(`⚠️ [${r.timestamp}] ${a}`,t)},$b=(a,t)=>{if(or.monitoring.logLevel==="info"||or.monitoring.logLevel==="debug"){const r={timestamp:new Date().toISOString(),userId:Ec()};console.log(`ℹ️ [${r.timestamp}] ${a}`,t)}},Ql=(a,t,r="ms",s)=>{new Date().toISOString(),or.monitoring.logLevel==="debug"&&console.log(`📊 Metric: ${a} = ${t}${r}`,s)},bh=()=>{if(!window.performance)return;const a=window.performance.timing,t=a.loadEventEnd-a.navigationStart,r=a.domContentLoadedEventEnd-a.navigationStart,s=a.responseEnd-a.requestStart;Ql("page_load_time",t,"ms"),Ql("dom_ready_time",r,"ms"),Ql("response_time",s,"ms"),console.log(`⚡ Page loaded in ${t}ms`)},qb=async()=>{const a=performance.now(),t={api:await Bb(),auth:await Ub(),storage:await Fb(),database:await zb()},r=performance.now()-a,s=Object.values(t).every(x=>x==="up"),l=Object.values(t).some(x=>x==="down"),d=s?"healthy":l?"unhealthy":"degraded",h=nn.filter(x=>x.level==="error"&&Date.now()-new Date(x.timestamp).getTime()<3e5).length/100,y={status:d,timestamp:new Date().toISOString(),checks:t,metrics:{responseTime:Math.round(r),errorRate:Math.round(h*100),activeUsers:Hb()}};return $b("Health check completed",y),y},Bb=async()=>{try{return or.api.baseUrl?"up":"down"}catch{return"down"}},Ub=async()=>{try{return localStorage.getItem("auth_token")!==null?"up":"down"}catch{return"down"}},Fb=async()=>{try{return localStorage.setItem("health_check","test"),localStorage.removeItem("health_check"),"up"}catch{return"down"}},zb=async()=>{try{return"up"}catch{return"down"}},Ec=()=>{try{const a=localStorage.getItem("current_user");if(a)return JSON.parse(a).name}catch{}},Hb=()=>1,Wb=a=>{or.monitoring.sentryDsn&&console.log("📤 Sending error to Sentry:",a.message)},Kb=()=>{window.addEventListener("unhandledrejection",a=>{vh("Unhandled promise rejection",new Error(a.reason),{reason:a.reason})}),window.addEventListener("error",a=>{vh(a.message,a.error,{filename:a.filename,lineno:a.lineno,colno:a.colno})}),console.log("🔧 Global error handlers initialized")},Vb=()=>{Kb(),document.readyState==="complete"?bh():window.addEventListener("load",bh),setInterval(async()=>{const a=await qb();a.status==="unhealthy"&&Mb("System health is unhealthy",{health:a})},300*1e3),console.log("📊 Monitoring service initialized")};Vb();Tb();Ab();$g();const Qb=cg.createRoot(document.getElementById("root"));Qb.render(c.createElement(_b));
